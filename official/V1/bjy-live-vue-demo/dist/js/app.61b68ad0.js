(function(e){function t(t){for(var i,o,s=t[0],c=t[1],l=t[2],d=0,f=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(t);while(f.length)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(i=!1)}i&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},a={app:0},r=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0ee1":function(e,t,n){},"0f6d":function(e,t,n){"use strict";n("993c")},"15d6":function(e,t,n){"use strict";n("97d7")},"1ca4":function(e,t,n){"use strict";n("8720")},"1eb3":function(e,t,n){},"1fce":function(e,t,n){},"237e":function(e,t,n){"use strict";n("0ee1")},2698:function(e,t,n){"use strict";n("2f8b")},"2f8b":function(e,t,n){},"3b72":function(e,t,n){},4558:function(e,t,n){"use strict";n("8db6")},"48dc":function(e,t,n){"use strict";n("b516")},"54ff":function(e,t,n){},5515:function(e,t,n){"use strict";n("1fce")},"56d7":function(e,t,n){"use strict";n.r(t);n("44a9"),n("3a99"),n("2c238"),n("6ae4");var i=n("a593"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Loading"),e.loaded?n("div",{ref:"main",attrs:{id:"main"}},[n("HorseLamp"),n("div",{staticClass:"class-panel"},[n("WhiteBorad"),e.showStartBtn?n("div",{staticClass:"start-btn",on:{click:e.handleClassStart}},[e._v("上课")]):e._e()],1),n("div",{staticClass:"media-panel"},[n("div",{staticClass:"wrap"},[n("TeacherPlayer"),n("InteractionPanel")],1),e.isTeacher?n("DocList"):e._e()],1),n("div",{staticClass:"footer"},[n("SettingPanel"),n("FunctionPanel")],1),n("ModalPanel")],1):e._e()],1)},r=[],o=(n("8601"),n("883f"),n("7d72"),n("c12e"),n("079b"),n("3b93"),n("48d1"),n("85a2"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"loading"}})}),s=[],c={components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){var e=BJY.Loading.create({element:$("#loading"),logoUrl:"http://img.baijiayun.com/0baijiacloud/logo/ydzb/v5/www-loading.png"}),t=BJY.eventEmitter;t.one(t.LOADING_PANEL_START,(function(e,t){})).one(t.LOADING_PANEL_END,(function(t,n){e.destroy()})).one(t.VIEW_RENDER_TRIGGER,(function(e,t){}))},beforeDestroy:function(){}},l=c,u=(n("2698"),n("5d22")),d=Object(u["a"])(l,o,s,!1,null,"11846876",null),f=d.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"whiteboard"}},[n("div",{staticClass:"placeholder"}),e.canChangePage?n("div",{staticClass:"pre-page"},[n("span",{staticClass:"icon-chevron-left",class:{forbid:!e.canPrePage}},[e._v("<")])]):e._e(),e.canChangePage?n("div",{staticClass:"next-page"},[n("span",{staticClass:"icon-chevron-right",class:{forbid:!e.canNextPage}},[e._v(">")])]):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.canPaint,expression:"canPaint"}],staticClass:"bjy-toolbar"},[n("div",{staticClass:"bjy-toolbar-placeholder"})])])},_=[],m=(n("bf00"),n("08c7"),BJY.eventEmitter),v=BJY.auth,p=BJY.store,g=(BJY.config,{components:{},data:function(){return{canPrePage:!1,canNextPage:!1,pageData:null,forbidChange:!0,isTeacher:v.isTeacher(),canStudentPanit:!1}},computed:{canChangePage:function(){return v.isTeacher()||!this.forbidChange},canPaint:function(){return v.isTeacher()||this.canStudentPanit}},methods:{setPageAuth:function(){var e=$(".icon-chevron-left"),t=$(".icon-chevron-right");this.canPrePage?e.addClass("has-page"):e.removeClass("has-page"),this.canNextPage?t.addClass("has-page"):t.removeClass("has-page")}},created:function(){this.pageData=BJY.data.page,this.canPrePage=this.pageData.getClientPage()>0,this.canNextPage=this.pageData.getClientPage()<this.pageData.getMaxPage},mounted:function(){var e=this,t=$("#whiteboard");BJY.Whiteboard.create({element:t.find(".placeholder"),fit:1}),BJY.PainterToolBar.create({element:$(".bjy-toolbar-placeholder"),replace:!0,isVertical:!1,canUseSelectTool:!0,canUsePencilTool:!0,canUseShapeTool:!0,canUseFontTool:!0,canUsePaletteTool:!0,canUseDeleteTool:!0,canUsePointTool:!0}),this.setPageAuth(),t.find(".pre-page").on("click",(function(){e.canPrePage&&e.canChangePage&&m.trigger(m.PAGE_PREV_TRIGGER)})),t.find(".next-page").on("click",(function(){e.canNextPage&&e.canChangePage&&m.trigger(m.PAGE_NEXT_TRIGGER)})),m.on(m.WHITEBOARD_LAYOUT_CHANGE,(function(e,t){})).on(m.CLIENT_PAGE_CHANGE,(function(){console.log("客户端翻页")})).on(m.PAGE_CHANGE_END,(function(t,n){var i=e.pageData.getClientPage(),a=e.pageData.getMaxPage();e.canPrePage=i>0,e.canNextPage=i<a,e.setPageAuth()})).on(m.STUDENT_PPT_AUTH_CHANGE,(function(t,n){console.log(n.forbid),e.forbidChange=n.forbid})).on(m.SWITCH_STUDENT_PAINT,(function(t,n){if(v.isStudent()){var i=n.studentPaintAuth;i.filter((function(e){return p.get("user.number")===e})),e.canStudentPanit=i.length>0,m.trigger(m.PAINT_AUTH_CHANGE,{canPaint:e.canStudentPanit,fromTeacher:!0,cache:1})}})).on(m.MEDIA_PUBLISH,(function(t,n){!1===n.audioOn&&!1===n.videoOn&&n.user.id==p.get("user.id")&&(e.canStudentPanit=!1)}))},beforeDestroy:function(){}}),T=g,E=(n("5515"),Object(u["a"])(T,h,_,!1,null,null,null)),S=E.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"setting"}},[n("CameraMenu"),n("MicMenu"),n("SpeakerMenu")],1)},C=[],y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"menu-mic"}})},L=[],R=n("f091"),A=R,O=A,P=BJY.store,I=BJY.config,w={components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){var e=this;BJY.MicMenu.create({element:$("#menu-mic"),maxVolume:100,canSelectDevice:!0,canAdjustVolume:!0,onSwitcherClick:function(){if(P.get("class.started"))if(P.get("class.speakState")!=I.SPEAK_STATE_LIMIT){var t=BJY.Player.instances[BJY.store.get("user.id")];BJY.userPublish.setDevice(t,null,!t.audioOn)}else e.$Toast(O.TIP_SPEAK_LIMIT);else e.$Toast(O.TIP_CLASS_NOT_START)}})},beforeDestroy:function(){}},N=w,B=(n("0f6d"),Object(u["a"])(N,y,L,!1,null,"23cbc776",null)),Y=B.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"menu-speaker"}})},D=[],k={components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){BJY.SpeakerMenu.create({element:$("#menu-speaker"),canAdjustVolume:!0,maxVolume:100})},beforeDestroy:function(){}},M=k,x=(n("fb05"),Object(u["a"])(M,J,D,!1,null,"8c6cbd5c",null)),U=x.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"menu-camera"}})},G=[],H=BJY.store,F=BJY.config,W={components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){var e=this;BJY.CameraMenu.create({element:$("#menu-camera"),canSelectDevice:!0,onSwitcherClick:function(){if(H.get("class.started"))if(BJY.auth.isTeacher()||H.get("class.speakState")!=F.SPEAK_STATE_LIMIT){var t=BJY.Player.instances[BJY.store.get("user.id")];BJY.userPublish.setDevice(t,!t.videoOn)}else e.$Toast(O.TIP_SPEAK_LIMIT);else e.$Toast(O.TIP_CLASS_NOT_START)}})},beforeDestroy:function(){}},K=W,z=Object(u["a"])(K,j,G,!1,null,"7056324e",null),Q=z.exports,V={components:{MicMenu:Y,SpeakerMenu:U,CameraMenu:Q},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){},beforeDestroy:function(){}},q=V,X=(n("da48"),Object(u["a"])(q,b,C,!1,null,"8a195c8c",null)),Z=X.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"interaction"},[n("div",{staticClass:"list-wrap"},[n("div",{staticClass:"tab-title"},[n("span",{staticClass:"tab-list",class:{active:e.checkActive("user")},attrs:{id:"btn-user-list"},on:{click:function(t){return e.setTab("user")}}},[e._v(" 用户列表 "),n("label",{attrs:{id:"user-count"}},[e._v("(1)")])]),n("span",{staticClass:"tab-list",class:{active:e.checkActive("message")},attrs:{id:"btn-message-list"},on:{click:function(t){return e.setTab("message")}}},[e._v(" 聊天列表 ")]),n("span",{staticClass:"tab-list",class:{active:e.checkActive("action")},attrs:{id:"btn-action-list"},on:{click:function(t){return e.setTab("action")}}},[e._v(" 发言列表 ")])]),n("div",{staticClass:"tab-container"},[n("div",{staticClass:"user-list",class:{active:e.checkActive("user")}},[n("UserList")],1),n("div",{staticClass:"message-list",class:{active:e.checkActive("message")}},[n("MessageList")],1),n("div",{staticClass:"action-list",class:{active:e.checkActive("action")}},[n("ActiveList")],1),n("div",{staticClass:"question-answer fold"},[n("QuestionAnswer")],1)])])])},te=[],ne=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},ie=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"message-panel"}},[n("div",{staticClass:"notice"}),n("div",{staticClass:"message-list"}),n("div",{staticClass:"message-sender"})])}],ae=(n("425f"),{}),re=BJY.config;ae[re.ROLE_TYPE_TEACHER]={en:"teacher",cn:"老师"},ae[re.ROLE_TYPE_ASSISTANT]={en:"assistant",cn:"助教"},ae[re.ROLE_TYPE_STUDENT]={en:"student",cn:"学生"},ae[re.ROLE_TYPE_GUEST]={en:"guest",cn:"游客"};var oe=ae,se=BJY.auth,ce=BJY.store,le=BJY.eventEmitter,ue={data:function(){return{}},methods:{},created:function(){le.on(le.MESSAGE_RECEIVE,(function(e,t){var n=$("#btn-message-list");n.hasClass("active")||n.addClass("has-new")}))},mounted:function(){BJY.Notice.create({element:$("#message-panel .notice"),replace:!1,defaultContent:"这里空空如也...",maxLength:140,contentPlaceholder:"请输入公告正文内容",linkPlaceholder:"请输入公告跳转链接（可选）",linkErrorHint:"URL 格式错误",canEdit:se.isTeacher()||se.isAssistant()}),BJY.MessageList.create({element:$("#message-panel .message-list"),renderEmoji:function(e,t){return BJY.isAlicloudImage(t)?'<img ondragstart="return false" src="'+t+'@100w_1e_1l.png" srcset="'+t+'@200w_1e_1l.png 2x">':'<img ondragstart="return false" src="'+t+'">'},renderImage:function(e){return BJY.isAlicloudImage(e)?'<img ondragstart="return false" src="'+e+'@100w_1e_1l.png" srcset="'+e+'@200w_1e_1l.png 2x">':'<img ondragstart="return false" src="'+e+'">'},renderUser:function(e,t,n){return{id:e.id,name:e.name,number:e.number,avatar:BJY.compressImage({url:e.avatar,width:t,height:n}),avatar2x:BJY.compressImage({url:e.avatar,width:2*t,height:2*n}),role:oe[e.type].en,localRole:oe[e.type].cn,type:e.type}},loadDistance:0}),BJY.MessageSender.create({element:$("#message-panel .message-sender"),canSendEmoji:!0,canSendImage:!0,multiline:!0,messageMaxLength:140,placeholder:"请输入...",emotionList:{emotionPerRow:6,rowPerPage:4},imageUploader:{action:"/web/doc/uploadChatFile",data:{room_id:ce.get("class.id"),token:ce.get("token")},fileName:"Filedata"}})},beforeDestroy:function(){}},de=ue,fe=(n("8027"),Object(u["a"])(de,ne,ie,!1,null,null,null)),he=fe.exports,_e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"user-list"}})},me=[],ve=BJY.auth,pe=BJY.config,ge={components:{},data:function(){return{userLayerInstance:null,lastUser:null}},computed:{},watch:{},methods:{setLayer:function(e,t){var n=$(".bjy-user-layer");if(!this.userLayerInstance||this.userLayerInstance&&!n[0]){this.userLayerInstance&&!n[0]&&this.userLayerInstance.destroy();var i=document.createElement("div");$("#app").append(i),this.userLayerInstance=BJY.UserLayer.create({user:this.lastUser,element:$(i),renderUser:function(e,t,n){return{id:e.id,name:e.name,number:e.number,avatar:BJY.compressImage({url:e.avatar,width:t,height:n}),avatar2x:BJY.compressImage({url:e.avatar,width:2*t,height:2*n}),role:oe[e.type].en,localRole:oe[e.type].cn}},useParameterUser:e,speakInviteTimeout:1e4,setMediaTimeout:1e4,hasSwitchPaint:function(e){return!(!ve.isTeacher()&&!ve.isAssistant()||!ve.isStudent(e.type))&&(e.endType!==pe.END_TYPE_MOBILE_BROWSER&&e.endType!==pe.END_TYPE_XIAOCHENGXU&&!(!e.videoOn&&!e.audioOn))},hasSwitchDocumentControl:function(e){return!1},onKickOutConfirm:function(e,t,n){return window.confirm("确定要将该学生踢出教室吗？")?e.resolve(!0):e.reject(!1),e}})}else this.userLayerInstance.set("useParameterUser",e),this.userLayerInstance.set("user",this.lastUser);$(".bjy-user-layer").css({top:t.originalEvent.clientY+10+"px",left:t.originalEvent.clientX-150+"px"}),$(".bjy-user-layer").toggle()}},created:function(){var e=BJY.eventEmitter;e.on(e.USER_COUNT_CHANGE,(function(e,t){$("#user-count").text("("+t.userCount+")")}))},mounted:function(){var e=BJY.eventEmitter,t=this;if(BJY.UserList.create({element:$("#user-list"),renderUser:function(e,t,n){return{id:e.id,name:e.name,number:e.number,avatar:BJY.compressImage({url:e.avatar,width:t,height:n}),avatar2x:BJY.compressImage({url:e.avatar,width:2*t,height:2*n}),role:oe[e.type].en,localRole:oe[e.type].cn}}}),BJY.auth.isTeacher())BJY.auth.canSpeakInvite=function(e){return BJY.auth.isTeacher()&&(!e||!e.group)},BJY.auth.canSpeakForce=function(e){return!1},$(".user-list").delegate(".bjy-user-item","click",(function(n){event.stopPropagation();var i=n.currentTarget.dataset.number,a=BJY.data.user.findByNumber(i);a?(t.lastUser=a,t.setLayer(!1,n)):(e.one(e.USER_SEARCH_RES,(function(e,i){i.result&&i.result.length>0&&(a=i.result[0],BJY.data.user.add(a),t.lastUser=a,t.setLayer(!1,n))})),e.trigger(e.USER_SEARCH_REQ,{query:userNumber,field:"number"}))})),$("#app").delegate(".bjy-user-layer","click",(function(e){e.stopPropagation()})),$("#app").click((function(){$(".bjy-user-layer")&&$(".bjy-user-layer").hide()}));else{var n=BJY.userSpeak;e.on(e.SPEAK_INVITE_CONFIRM,(function(){var e=confirm("老师邀请你上麦发言");e?n.processInvite(!0):n.processInvite(!1)}))}},beforeDestroy:function(){}},Te=ge,Ee=(n("dd6a"),Object(u["a"])(Te,_e,me,!1,null,null,null)),Se=Ee.exports,be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{empty:e.noOneSpeaking},attrs:{id:"active"}},[e.isTeacher?n("div",{attrs:{id:"active-list"}},[n("div",{staticClass:"placeholder"})]):e._e(),e.isTeacher?n("div",{staticClass:"bjy-apply-list"},[n("div",{staticClass:"placeholder"})]):n("div",{staticClass:"live-self-player"},[n("SelfPlayer")],1)])},Ce=[],ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"live-self-player"}})},Le=[],Re=BJY.store,Ae=BJY.eventEmitter,Oe={components:{},data:function(){return{player:null}},computed:{},watch:{},methods:{createMyPlayer:function(e){this.player=BJY.DefaultThemePlayer.create({element:$("#live-self-player"),replace:!1,user:Re.get("user"),extension:BJY.getExtension(),canFold:!0,canSwitchCamera:!0,canSwitchMic:!0,onComplete:function(){Ae.trigger(Ae.MEDIA_SWITCH_TRIGGER,{videoOn:!1,audioOn:!1})}})}},created:function(){},mounted:function(){this.createMyPlayer(),Ae.on(Ae.MEDIA_SWITCH_TRIGGER,(function(e,t){var n=BJY.Player.instances[Re.get("user.id")];n&&BJY.userPublish.setDevice(n,t.videoOn,t.audioOn)})),this.player&&this.player.watch("isFolded",(function(e){var t=$(".live-self-player");e?t.addClass("hide"):t.removeClass("hide")}))},beforeDestroy:function(){}},Pe=Oe,Ie=(n("7705"),Object(u["a"])(Pe,ye,Le,!1,null,null,null)),we=Ie.exports,Ne=BJY.eventEmitter,Be=BJY.auth,Ye={name:"activeList",components:{SelfPlayer:we},data:function(){return{activeList:null,noOneSpeaking:!0,isTeacher:!1}},computed:{},watch:{},methods:{},created:function(){this.isTeacher=Be.isTeacher()},mounted:function(){var e=this;if(this.isTeacher){var t=BJY.ActiveList.create({element:$("#active-list .placeholder"),extension:BJY.getExtension(),width:260,replace:!1});Ne.on(Ne.ACTIVE_LIST_PRESENTER_CHANGE_TRIGGER,(function(e,n){t.changePresenter(n.newPresenter,n.oldPresenter)})),t.watch("userList.length",(function(t,n){e.noOneSpeaking=0===t})),BJY.ApplyList.create({element:$(".bjy-apply-list .placeholder"),replace:!1})}}},Je=Ye,De=(n("237e"),Object(u["a"])(Je,be,Ce,!1,null,null,null)),$e=De.exports,ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"question-answer"}},[n("div",{staticClass:"question-answer-bar"},[e._m(0),n("span",{staticClass:"toggle",on:{click:function(t){return e.toggleQuestionAnswer()}}},[e._v(" "+e._s(e.status)+" ")])]),n("div",{staticClass:"placeholder"})])},Me=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticStyle:{display:"flex","align-items":"center"}},[n("i",{staticClass:"icon icon-answer-machine"}),e._v(" 问答 ")])}],xe={components:{},data:function(){return{status:"展开"}},computed:{},watch:{},methods:{toggleQuestionAnswer:function(){var e=$(".question-answer");e.hasClass("fold")?(e.removeClass("fold"),this.status="折叠"):(e.addClass("fold"),this.status="展开")}},created:function(){},mounted:function(){BJY.QuestionAnswer.create({element:$("#question-answer .placeholder"),replace:!0,canManageQuestion:BJY.auth.isTeacher(),limitPerMinute:100,countPerPage:50,inputMaxLength:140,pageBySwipe:!1,onCopyFinish:function(){}})},beforeDestroy:function(){}},Ue=xe,je=(n("d456"),Object(u["a"])(Ue,ke,Me,!1,null,null,null)),Ge=je.exports,He={components:{MessageList:he,UserList:Se,ActiveList:$e,QuestionAnswer:Ge},data:function(){return{activeTab:"user"}},computed:{},watch:{},methods:{setTab:function(e){this.activeTab=e},checkActive:function(e){return e===this.activeTab}},created:function(){var e=this;BJY.eventEmitter.on(BJY.eventEmitter.SPEAK_APPLY_RESULT_ACCEPT,(function(t,n){e.activeTab="action"}))},mounted:function(){},beforeDestroy:function(){}},Fe=He,We=(n("b448"),Object(u["a"])(Fe,ee,te,!1,null,"44d3c4e6",null)),Ke=We.exports,ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"live-teacher-player"}})},Qe=[],Ve=BJY.store,qe=BJY.auth,Xe=BJY.eventEmitter,Ze=BJY.data.user,et=BJY.config,tt={components:{},data:function(){return{player:null}},methods:{createTeacherPlayer:function(e){void 0===e&&(e=qe.isWebRTC()),e&&(Ve.get("webrtcMixUser").name="老师"),this.player&&this.player.destroy(),this.player=null;var t=qe.isPresenter()?Ve.get("presenter"):e?Ve.get("webrtcMixUser"):Ve.get("presenter")||Ve.get("teacher"),n={element:$("#live-teacher-player"),replace:!1,user:t,extension:BJY.getExtension(),canSwitchCamera:qe.isSelf(Ve.get("teacher.id")),canSwitchMic:qe.isSelf(Ve.get("teacher.id")),footerOptions:{onToggleClick:this.pptVideoSwitch}};!qe.isTeacher()&&(n.isWebRTCMix=e),this.player=BJY.DefaultThemePlayer.create(n)},swap:function(e,t){var n=e.parentNode,i=t.parentNode,a=document.createElement("div"),r=document.createElement("div");n.insertBefore(a,e),i.insertBefore(r,t),t&&n.insertBefore(t,a),e&&i.insertBefore(e,r),n.removeChild(a),i.removeChild(r)},pptVideoSwitch:function(){var e=$(".bjy-player-theme-default")[0],t=$(".bjy-whiteboard")[0];this.swap(e,t),Xe.trigger(Xe.WINDOW_RESIZE)}},created:function(){var e=this,t=this.player;Xe.on(Xe.CLASS_START,(function(t,n){e.createTeacherPlayer(),(qe.isTeacher()||qe.isAssistant())&&Ve.set("class.speakState",et.SPEAK_STATE_FREE),qe.isTeacher()&&Xe.trigger(Xe.MEDIA_SWITCH_TRIGGER,{audioOn:!0,videoOn:!0})})).on(Xe.MEDIA_SWITCH_TRIGGER,(function(e,t){var n=BJY.Player.instances[Ve.get("user.id")];n&&BJY.userPublish.setDevice(n,t.videoOn,t.audioOn)})).on(Xe.TEACHER_MEDIA_ON,(function(){e.player||e.createTeacherPlayer()})).on(Xe.MEDIA_STATUS_CHANGE,(function(t,n){console.log(n),n.videoOn?!qe.isPresenter()&&e.createTeacherPlayer(!1):!qe.isPresenter()&&e.createTeacherPlayer(!0)})).on(Xe.TEACHER_MEDIA_OFF,(function(){})).on(Xe.CLASSROOM_CONNECT_SUCCESS,(function(){e.createTeacherPlayer()})),!qe.isTeacher()&&Ve.watch("presenterId",(function(t,n){var i=Ze.find(t),a=Ze.find(n);Xe.ACTIVE_LIST_PRESENTER_CHANGE_TRIGGER="active_list_presenter_change_trigger",Xe.trigger(Xe.ACTIVE_LIST_PRESENTER_CHANGE_TRIGGER,{newPresenter:i,oldPresenter:a}),i&&e.player&&e.createTeacherPlayer()}));var n=document.documentElement;n.requestFullscreen?document.addEventListener("fullscreenchange",(function(){var e=t&&t.isFullScreen;document.fullscreen==e||document.fullscreen||Xe.trigger(Xe.FULLSCREEN_EXIT_TRIGGER)})):n.webkitRequestFullScreen?document.addEventListener("webkitfullscreenchange",(function(){var e=t&&t.isFullScreen;document.webkitIsFullScreen==e||document.webkitIsFullScreen||Xe.trigger(Xe.FULLSCREEN_EXIT_TRIGGER)})):n.mozRequestFullScreen&&document.addEventListener("mozfullscreenchange",(function(){var e=t&&t.isFullScreen;document.mozFullScreen==e||document.mozFullScreen||Xe.trigger(Xe.FULLSCREEN_EXIT_TRIGGER)}))}},nt=tt,it=(n("c056"),Object(u["a"])(nt,ze,Qe,!1,null,null,null)),at=it.exports,rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"function-panel"},[n("div",{staticClass:"left"},[n("div",{staticClass:"bjy-spacer"}),e.isStudent?e._e():n("div",{on:{click:e.toggleClassStart}},[e._v(" "+e._s(e.statusTip)+" ")]),e.isStudent?e._e():n("Record",{staticClass:"bjy-custom-record"}),e.isStudent?e._e():n("div",{on:{click:e.toggleQuiz}},[e._v("测验")]),e.isStudent?e._e():n("div",{on:{click:e.toggleAnswer}},[e._v("答题器")]),e.isStudent?e._e():n("div",{on:{click:e.toggleMediaPlayer}},[e._v("播放")]),e.isStudent?e._e():n("div",{on:{click:e.toggleRollCall}},[e._v("点名")]),e.isStudent?e._e():n("div",{on:{click:e.toggleLottery}},[e._v("抽奖")]),e.isStudent?e._e():n("div",{on:{click:e.toggleAttentionDetection}},[e._v("专注度检测")])],1),n("div",{staticClass:"right"},[e.isStudent?n("div",{staticClass:"btn-wrap"},[n("SpeakApplyMenu")],1):e._e(),n("div",{staticClass:"btn-wrap"},[n("ShareScreenMenu")],1),n("div",{staticClass:"btn-wrap",on:{click:function(t){return e.toggleBarrage()}}},[e.isBarrageOn?n("i",{staticClass:"icon icon-barrage-on"}):n("i",{staticClass:"icon icon-barrage-off"}),e._v(" "+e._s(e.barrageState)+" ")]),e.cdnList.length>1&&e.canSwitchCdn?n("select",{directives:[{name:"model",rawName:"v-model",value:e.currentNode,expression:"currentNode"}],staticClass:"cdn-node-list",attrs:{name:"cdn",id:"cdn-list"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.currentNode=t.target.multiple?n:n[0]}}},e._l(e.cdnList.length,(function(t){return n("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(e._f("cdnListFilter")(t))+" ")])})),0):e._e()])])},ot=[],st=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"menu-speak-apply"}})},ct=[],lt=BJY.store,ut=BJY.eventEmitter,dt=BJY.auth,ft=BJY.data.user;dt.canOpenCameraWhenSpeaking=function(e){return!0};var ht={components:{},data:function(){return{player:null}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){var e=this;ut.STOP_SPEAK_TRIGGER="stop_speak_trigger",ut.on(ut.SPEAK_APPLY_RESULT_TIMEOUT,(function(t,n){console.log("timeout"),e.$Toast(O.TIP_SPEAK_APPLY_TIMEOUT)})).on(ut.SPEAK_APPLY_RESULT_REJECT,(function(t,n){console.log("reject"),e.$Toast(O.TIP_SPEAK_APPLY_REJECT)})).on(ut.SPEAK_APPLY_RESULT_ACCEPT,(function(t,n){console.log("accept"),e.$Toast(O.TIP_SPEAK_APPLY_ACCEPT),ut.trigger(ut.MEDIA_SWITCH_TRIGGER,{videoOn:!0,audioOn:!0})})),BJY.SpeakApplyMenu.create({element:$("#menu-speak-apply"),replace:!1,onApplyClick:function(){lt.get("class.started")?ft.active().length>=2?e.$Toast("当前上台人数已满"):BJY.userSpeak.startApply(1e4):e.$Toast(O.TIP_CLASS_NOT_START)},onCancelClick:function(){BJY.userSpeak.cancelApply()},onStopClick:function(){BJY.userSpeak.stopSpeak(BJY.store.get("user.id")),ut.trigger(ut.STOP_SPEAK_TRIGGER),ut.trigger(ut.MEDIA_SWITCH_TRIGGER,{videoOn:!1,audioOn:!1})}})},beforeDestroy:function(){}},_t=ht,mt=(n("4558"),Object(u["a"])(_t,st,ct,!1,null,"52b7dbe8",null)),vt=mt.exports,pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.canShareScreen,expression:"canShareScreen"}],attrs:{id:"menu-share-screen"}},[n("i",{staticClass:"icon icon-share"}),n("span",{staticClass:"bjy-screen-share"})])},gt=[],Tt=BJY.auth,Et=BJY.store,St=BJY.eventEmitter,bt=BJY.config;Tt.isClassStarted=function(){return Et.get("class.started")},Tt.canShareScreen=function(){return Et.get("class.mediaType")!==bt.MEDIA_TYPE_AUDIO&&(Tt.inClient()||Tt.isWebRTC())},Tt.inClient=function(){return"undefined"!==typeof window.cefQuery},Tt.canSpeak=function(){return Tt.isTeacher()||Et.get("class.speakState")!==bt.SPEAK_STATE_LIMIT},Tt.canProgramShareDesktop=function(){return Tt.inClient()&&Et.get("cefVersion")>="6.3.0"};var Ct={components:{},data:function(){return{canSpeak:!1,canShareScreen:Tt.canShareScreen()}},computed:{},watch:{},methods:{checkCondition:function(){return Tt.isClassStarted()&&Tt.canShareScreen()?!!Tt.canSpeak()||(this.$Toast(O.TIP_SPEAK_LIMIT),!1):(this.$Toast(O.TIP_CLASS_NOT_START),!1)}},mounted:function(){var e=this,t=$(".bjy-screen-share");if(t.text(O.BUTTON_SCREEN_START),Tt.isWebRTC()){var n=!1;St.on(St.ASSIST_MEDIA_PUBLISH,(function(e,i){BJY.is.mediaMainScreenShare(i.mediaId)&&(i.videoOn?(n=!0,t.text(O.BUTTON_SCREEN_STOP)):(n=!1,t.text(O.BUTTON_SCREEN_START)))})),t.click((function(){if(n)St.trigger(St.SCREEN_SHARE_STOP_TRIGGER);else{if(!Tt.canSpeak())return void e.$Toast("发言请先举手");e.checkCondition()&&BJY.ScreenShareExtensionWebrtc.start((function(t){e.$Toast(t.msg)}))}}))}},beforeDestroy:function(){}},yt=Ct,Lt=(n("6f6bf"),Object(u["a"])(yt,pt,gt,!1,null,"3f3467c5",null)),Rt=Lt.exports,At=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"record-menu"}})},Ot=[],Pt=(BJY.store,BJY.eventEmitter,BJY.auth,{data:function(){return{record:null}},methods:{},created:function(){},mounted:function(){this.record=BJY.Record.create({element:$("#record-menu"),canUseHotKey:!0,stopLocalRecordHotKey:"ctrl + s",canUseCloudRecord:!0,canUseLocalRecord:!1,onStartCloudRecord:function(e){e&&(confirm("是否开始新的录制？")?e.resolve(1):e.resolve(0))},onStartLocalRecord:function(){return{width:500,height:300}},onPlaybackGenerateConfirm:function(e){confirm("是否立即生成回放？")?e.resolve(1):e.resolve(0)}})},beforeDestroy:function(){}}),It=Pt,wt=Object(u["a"])(It,At,Ot,!1,null,"89d7e5a8",null),Nt=wt.exports,Bt=BJY.store,Yt=BJY.eventEmitter,Jt=BJY.auth,Dt={components:{SpeakApplyMenu:vt,ShareScreenMenu:Rt,Record:Nt},data:function(){return{statusTip:"",language:O,isStudent:Jt.isStudent(),barrage:null,isBarrageOn:!1,cdnList:[],currentNode:1,canSwitchCdn:!BJY.auth.isWebRTC()}},computed:{barrageState:function(){return this.isBarrageOn?O.BARRAGE_ON:O.BARRAGE_OFF}},watch:{currentNode:function(e,t){console.log(e),Yt.trigger(Yt.DOWNLINK_SERVER_NODE_CHANGE_TRIGGER,{index:e-1})}},filters:{cdnListFilter:function(e){return"线路"+e}},methods:{toggleClassStart:function(){Bt.get("class.started")?Yt.trigger(Yt.CLASS_END_TRIGGER):Yt.trigger(Yt.CLASS_START_TRIGGER)},toggleBarrage:function(){var e=this.barrage.isOpened();e?(this.barrage.close(),this.isBarrageOn=!1):(this.barrage.open(),this.isBarrageOn=!0)},toggleQuiz:function(){Yt.trigger("toggle_quiz_dialog")},toggleAnswer:function(){Yt.trigger("toggle_answer_dialog")},toggleMediaPlayer:function(){Yt.trigger("toggle_media_player")},toggleRollCall:function(){Yt.trigger("toggle_roll_call")},toggleLottery:function(){Yt.trigger("toggle_lottery")},toggleAttentionDetection:function(){Yt.trigger("toggle_attention_detection")}},created:function(){var e=this;Bt.watch("class.started",(function(t){t?(e.statusTip=O.CLASS_END,e.$Toast(O.TIP_CLASS_START)):(e.statusTip=O.CLASS_START,e.$Toast(O.TIP_CLASS_END)),e.started=t}),!0),this.cdnList=BJY.data.server.getLiveServerList()},mounted:function(){this.barrage=new BJY.Barrage({container:$(".class-panel"),speed:100,maxLength:20,top:30,bottom:30,trackHeight:30,textOnly:!1,renderContent:function(e){return e.content}})},beforeDestroy:function(){}},$t=Dt,kt=(n("f3b3"),Object(u["a"])($t,rt,ot,!1,null,null,null)),Mt=kt.exports,xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal-panel"},[e.isStudent?n("RollCall"):n("RollCallTeacher"),n("AnswerMachine"),n("Quiz"),n("MediaPlayer"),n("Lottery"),n("AttentionDetection")],1)},Ut=[],jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],attrs:{id:"answer-machine"}},[n("div",{staticClass:"placeholder"})])},Gt=[],Ht=BJY.eventEmitter,Ft=BJY.auth,Wt={components:{},data:function(){return{language:O,visible:!1}},methods:{open:function(e,t){var n=this;this.visible=!0,Ft.isStudent()&&BJY.AnswerStudent.open($.extend({element:$("#answer-machine .placeholder")[0],autoCloseAfterSubmit:!1,onClose:function(){n.close()},onHide:function(){n.close()},replace:!1,showResult:t,autoShowResultAfterEnd:!!e.isShowCorrectAnswer},e))},close:function(){this.visible=!1}},created:function(){var e=this;Ht.on(Ht.START_ANSWER,(function(t,n){console.log(n),e.open(n,!1)})).on(Ht.END_ANSWER,(function(){})).on(Ht.ANSER_RESULT_SHOW,(function(t,n){e.open(n,!0)})).on("toggle_answer_dialog",(function(){e.visible?e.close():e.open()}))},mounted:function(){var e=this;Ft.isTeacher()?BJY.AnswerTeacher.init({element:$("#answer-machine .placeholder")[0],onClose:function(){e.close()},onHide:function(){e.close()}}):BJY.AnswerStudent.init()},beforeDestroy:function(){}},Kt=Wt,zt=(n("1ca4"),Object(u["a"])(Kt,jt,Gt,!1,null,null,null)),Qt=zt.exports,Vt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"roll-call-dialog"}})},qt=[],Xt=BJY.auth,Zt=BJY.eventEmitter,en={components:{},data:function(){return{language:O,status:0,isStudent:Xt.isStudent(),applyTimer:null,timeLeft:"",result:""}},computed:{},watch:{},methods:{},created:function(){var e=this;Zt.on(Zt.ROLL_CALL,(function(t,n){e.timeLeft=n.duration,e.$Dialog.show({title:"点名",content:'请在<span id="roll-call-time-left">'.concat(n.duration,"</span>秒内响应"),confirmText:"答到"}).then((function(){Zt.trigger(Zt.ROLL_CALL_RES)})).catch((function(e){console.log(e)})),e.applyTimer=setInterval((function(){0===e.timeLeft&&(clearInterval(e.applyTimer),e.$Dialog.hide()),$("#roll-call-time-left").text(e.timeLeft),e.timeLeft--}),1e3)}))},mounted:function(){},beforeDestroy:function(){}},tn=en,nn=(n("15d6"),Object(u["a"])(tn,Vt,qt,!1,null,"35e5e5ec",null)),an=nn.exports,rn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"teacher",attrs:{id:"roll-call-dialog"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.status===e.statusMap.before,expression:"status === statusMap.before"}],staticClass:"before-roll-call"},[n("p",[e._v(" 请设置学生需要在 "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.rollCallDuration,expression:"rollCallDuration"}],attrs:{type:"number"},domProps:{value:e.rollCallDuration},on:{input:function(t){t.target.composing||(e.rollCallDuration=t.target.value)}}}),e._v(" 秒内响应 ")]),n("div",{staticClass:"btn start-btn",on:{click:e.startRollCall}},[e._v("发起点名")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.status===e.statusMap.ing,expression:"status === statusMap.ing"}],staticClass:"roll-call-ing"},[e._v("学生正在陆续答到中，"+e._s(e.resultTimer)+"秒后可查看点名结果，请稍后")]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.status===e.statusMap.after,expression:"status === statusMap.after"}],staticClass:"after-roll-call"},[n("p",{staticClass:"result"},[e._v("答到情况：答到"+e._s(e.ackCount)+"人，未答到"+e._s(e.nackCount)+"人")]),n("div",{staticClass:"btn",on:{click:e.reCall}},[e._v("再次点名")])]),n("div",{staticClass:"btn-close",on:{click:e.close}},[e._v("X")])])},on=[],sn=n("28f8"),cn=BJY.auth,ln=BJY.eventEmitter,un={before:0,ing:1,after:2},dn={data:function(){var e;return e={language:O,status:0,isTeacher:cn.isTeacher(),resultTimer:60,nextTimer:60,result:"",rollCallDuration:60,visible:!1},Object(sn["a"])(e,"status",un.before),Object(sn["a"])(e,"statusMap",un),Object(sn["a"])(e,"resultInterval",null),Object(sn["a"])(e,"ackCount",0),Object(sn["a"])(e,"nackCount",0),e},created:function(){var e=this;ln.on("toggle_roll_call",(function(){e.show()})).on(ln.ROLL_CALL_RESULT,(function(t,n){var i=n;console.log(i),e.status=un.after,e.ackCount=i.ackList.length,e.nackCount=i.nackList.length})).on(ln.ROLL_CALL,(function(){e.resultTimer=e.rollCallDuration,e.status=un.ing,e.resultInterval=null,e.resultInterval=setInterval((function(){e.resultTimer>0?--e.resultTimer:(ln.trigger(ln.ROLL_CALL_FINISH),clearInterval(e.resultInterval))}),1e3)}))},methods:{show:function(){this.visible=!0},close:function(){this.visible=!1},startRollCall:function(){ln.trigger(ln.ROLL_CALL_TRIGGER,{duration:this.rollCallDuration})},reCall:function(){this.status=un.before}},beforeDestroy:function(){}},fn=dn,hn=(n("fe8e"),Object(u["a"])(fn,rn,on,!1,null,"3aa48e46",null)),_n=hn.exports,mn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],class:e.isTeacher?"teacher":"student",attrs:{id:"quiz-placeholder"}},[n("div",{staticClass:"close-bar"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.isTeacher||!e.forceJoin,expression:"isTeacher || !forceJoin"}],staticClass:"bjy-close",on:{click:e.close}},[e._v("X")])]),n("div",{staticClass:"placeholder"})])},vn=[],pn=BJY.eventEmitter,gn=BJY.auth,Tn={data:function(){return{visible:!1,isTeacher:gn.isTeacher(),forceJoin:!1}},methods:{open:function(e){var t=this;this.visible=!0,this.$nextTick((function(){!t.isTeacher&&BJY.quizStudent.open({element:$("#quiz-placeholder .placeholder")[0],replace:!1,forceJoin:e.forceJoin,quizId:e.quizId,solution:e.solution,onReady:function(){},onError:function(){}})}))},close:function(){this.visible=!1},initTeacher:function(){BJY.quizTeacher.init({element:$("#quiz-placeholder .placeholder")[0],replace:!1,onError:function(e){alert(e.msg)},onBeforeStartQuiz:function(){return!0},onBeforePublishSolution:function(){return!0},onBeforeQuizDelete:function(){var e=$.Deferred(),t=confirm("确定要删除吗？");return t?e.resolve(!0):e.resolve(!1),e}})},initStudent:function(){BJY.quizStudent.init()}},created:function(){var e=this;pn.on(pn.QUIZ_START,(function(t,n){console.log(n),e.forceJoin=n.forceJoin,e.open(n)})).on(pn.QUIZ_END,(function(t,n){!e.isTeacher&&e.close()})).on(pn.QUIZ_CLOSE,(function(t,n){n.force||!$.isEmptyObject(n.solution)?e.close():alert("请至少回答一个题目之后提交")})).on(pn.QUIZ_SOLUTION,(function(t,n){e.forceJoin=!1,e.open(n)})).on(pn.QUIZ_SUBMIT,(function(t,n){console.log(n),e.close()})).on("toggle_quiz_dialog",(function(t,n){e.visible?e.close():e.open()})),pn.trigger(pn.QUIZ_REQ)},mounted:function(){this.isTeacher?this.initTeacher():this.initStudent()},beforeDestroy:function(){}},En=Tn,Sn=(n("48dc"),Object(u["a"])(En,mn,vn,!1,null,"19c44e75",null)),bn=Sn.exports,Cn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],attrs:{id:"media-player"}})},yn=[],Ln=BJY.eventEmitter,Rn=BJY.auth,An={data:function(){return{visible:!1,isTeacher:Rn.isTeacher(),mediaPlayer:null}},methods:{open:function(){var e=this;this.visible=!0,this.mediaPlayer||(this.mediaPlayer=BJY.NewMediaPlayer.create({element:$("#media-player"),volume:100,draggale:!0,draggableRectSelector:"body",replace:!1,onCloseButtonClick:function(){e.close()},onMinimizeButtonClick:function(){e.visible=!1},onPlayFileFail:function(){alert("打开文件失败")}}))},close:function(){this.visible=!1,this.mediaPlayer=null}},created:function(){},mounted:function(){var e=this;Ln.on("toggle_media_player",(function(){e.mediaPlayer?e.close():e.open()}))},beforeDestroy:function(){}},On=An,Pn=(n("da8f"),Object(u["a"])(On,Cn,yn,!1,null,"137d2148",null)),In=Pn.exports,wn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],class:{"command-lottery-hint":e.commandLotteryDuration},attrs:{id:"bjy-lottery"}},[e.commandLotteryDuration?e._e():n("div",{staticClass:"mask"}),n("div",{staticClass:"lottery-wrap"},[n("div",{attrs:{id:"lottery"}},[n("div",{staticClass:"placeholder"}),n("div",{staticClass:"bjy-close",on:{click:e.close}},[e._v("X")])]),e._m(0),n("div",{attrs:{id:"lottery-history"}},[n("div",{staticClass:"bjy-close",on:{click:e.close}},[e._v(" X ")]),n("div",{staticClass:"placeholder"})])]),e.commandLotteryDuration?n("div",{staticClass:"command-lottery-count"},[n("p",[e._v("抽奖中，剩余"+e._s(e.commandLotteryDuration)+"秒")]),e.isStudent?n("div",[e._v("聊天框输入"+e._s(e.lotteryCommand)+"参与抽奖")]):n("div",{staticClass:"btn",on:{click:e.drawLottery}},[e._v("现在开奖")])]):e._e()])},Nn=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"lottery-hit"}},[n("div",{staticClass:"placeholder"})])}],Bn=BJY.eventEmitter,Yn=BJY.auth,Jn={data:function(){return{visible:!1,commandLotteryDuration:0,lotteryTimer:null,isStudent:Yn.isStudent(),lotteryCommand:"",lottery:null}},created:function(){var e=this;BJY.Lottery.init(),Bn.on(Bn.LOTTERY_HISTORY_RES,(function(t,n){e.show(),$("#lottery").hide(),$("#lottery-history").show();BJY.LotteryHistory.create({replace:!1,element:$("#lottery-history .placeholder"),list:n.history,roomId:+BJY.store.get("class.id")})})).on(Bn.STANDARD_LOTTERY_BEGIN,(function(){e.show()})).on(Bn.STANDARD_LOTTERY_BEGIN_TRIGGER,(function(){$("#lottery").hide()})).on(Bn.STANDARD_LOTTERY_END,(function(t,n){e.show(),e.createHitList(n)})).on(Bn.COMMAND_LOTTERY_ABORT,(function(t,n){e.show(),e.createHitList(n)})).on(Bn.COMMAND_LOTTERY_END_TRIGGER,(function(t,n){e.commandLotteryDuration=0,$("#lottery").hide(),console.log("command lottery end.")})).on(Bn.COMMAND_LOTTERY_BEIGIN,(function(t,n){$("#lottery").hide(),e.show(),console.log(n),e.commandLotteryDuration=n.duration,e.lotteryCommand=n.command,e.lotteryTimer&&(clearInterval(e.lotteryTimer),e.lotteryTimer=null),e.lotteryTimer=setInterval((function(){e.commandLotteryDuration>0?--e.commandLotteryDuration:(Yn.isTeacher()&&e.drawLottery(),clearInterval(e.lotteryTimer),e.lotteryTimer=null)}),1e3)})).on("toggle_lottery",(function(){e.visible=!e.visible,e.createLottery()}))},mounted:function(){this.createLottery()},methods:{close:function(){this.visible=!1,$("#lottery").show(),$("#lottery-history").hide()},show:function(){this.visible=!0},drawLottery:function(){clearInterval(this.lotteryTimer),this.lotteryTimer=null,this.commandLotteryDuration=0,Bn.trigger(Bn.COMMAND_LOTTERY_ABORT_TRIGGER)},createHitList:function(e){var t=this;$("#lottery").hide(),$("#lottery-hit").show();var n=BJY.LotteryHit.create({element:$("#lottery-hit .placeholder"),list:e.hitList,replace:!1,lotteryName:e.lotteryName,onClose:function(){console.log("lottery close."),$("#lottery-hit").hide(),$("#lottery").show(),t.close()},onSubmit:function(e,t){console.log(e,t)}});Yn.isStudent()||n.get("isHit")||n.set("status",0)},createLottery:function(){console.log("create lottery."),Yn.isTeacher()&&(this.lottery=null,this.lottery=BJY.Lottery.create({replace:!1,element:$("#lottery .placeholder"),skin:"red"}),this.lottery.on("refresh",(function(){})))}}},Dn=Jn,$n=(n("88af"),Object(u["a"])(Dn,wn,Nn,!1,null,"3f8fb610",null)),kn=$n.exports,Mn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible&&!e.isStudent,expression:"visible && !isStudent"}],attrs:{id:"attention-detection"}},[n("div",{staticClass:"close-bar"},[n("span",{staticClass:"bjy-close",on:{click:e.close}},[e._v("X")])]),n("div",{staticClass:"placeholder"})])},xn=[],Un=BJY.eventEmitter,jn=BJY.auth,Gn={components:{},data:function(){return{language:O,visible:!1,isStudent:jn.isStudent()}},methods:{open:function(){this.visible=!0},close:function(){this.visible=!1}},created:function(){var e=this;jn.isStudent()&&Un.on(Un.ATTENTION_DETECTION_ALERT,(function(e,t){t.content&&alert(t.content)})),Un.on("toggle_attention_detection",(function(){e.visible=!e.visible}))},mounted:function(){BJY.AttentionDetection.create({element:$("#attention-detection .placeholder"),replace:!1,skin:"light"})},beforeDestroy:function(){}},Hn=Gn,Fn=(n("fac4"),Object(u["a"])(Hn,Mn,xn,!1,null,"7d6e8c54",null)),Wn=Fn.exports,Kn=BJY.auth,zn={components:{AnswerMachine:Qt,RollCall:an,RollCallTeacher:_n,Quiz:bn,MediaPlayer:In,Lottery:kn,AttentionDetection:Wn},data:function(){return{isStudent:Kn.isStudent()}},beforeDestroy:function(){}},Qn=zn,Vn=(n("b4f5"),Object(u["a"])(Qn,xt,Ut,!1,null,"187fa6d6",null)),qn=Vn.exports,Xn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"horselamp-fake"})},Zn=[],ei={components:{},data:function(){return{content:""}},created:function(){this.content="我是跑马灯";var e="font-size: 18px;color: #fff;opacity: 0.5;",t=new BJY.HorseLamp({container:$("#main"),timeout:10,interval:5,trackCount:8,speed:30,count:5,mode:0,top:0,bottom:0,content:this.content,additionalStyle:e});t.start()},mounted:function(){}},ti=ei,ni=(n("8564"),Object(u["a"])(ti,Xn,Zn,!1,null,"20617e9c",null)),ii=ni.exports,ai=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bjy-sidebar",class:{"bjy-active":e.show}},[n("div",{staticClass:"bjy-toggle-btn",on:{click:function(t){e.show=!e.show}}},[e._v("文档列表")]),n("div",{staticClass:"bjy-doc-list"})])},ri=[],oi={data:function(){return{show:!1}},mounted:function(){BJY.Catalogue.create({element:$(".bjy-doc-list"),thumbnailWidth:100,hasWhiteboard:!0})}},si=oi,ci=(n("5b3e"),Object(u["a"])(si,ai,ri,!1,null,"b67585ae",null)),li=ci.exports,ui=BJY.eventEmitter,di=BJY.auth,fi=BJY.store,hi=BJY.config,_i={name:"app",components:{Loading:f,WhiteBorad:S,SettingPanel:Z,InteractionPanel:Ke,TeacherPlayer:at,FunctionPanel:Mt,HorseLamp:ii,ModalPanel:qn,DocList:li},data:function(){return{loaded:!1,webrtc:1,isTeacher:!1,showStartBtn:!1}},mounted:function(){var e="//live-cdn.baijiayun.com/js-sdk/1.15.0/player/extension/flash.swf",t=BJY.createSWF("temp","",e),n=$(t);$("body").prepend(n),n.css({position:"absolute",top:0,width:398,height:298,opacity:0}),this.supportFlash()||this.webrtc||this.$Dialog.show({title:"提示",content:'网页Flash插件加载不成功，请重新<a class="opt-button"\n            href="http://www.adobe.com/go/getflashplayer">启用flash</a>',confirmText:"关闭"}).then((function(){console.log("flash启用")})).catch((function(e){console.log(e)})),this.webrtc&&this.$Dialog.show({title:"提示",content:"正在进入教室。。。",confirmText:"确认"}).then((function(){console.log("教室内首次交互完成")})).catch((function(e){console.log(e)}))},created:function(){var e=this,t=$("body");fi.watch("class.started",(function(t){e.showStartBtn=di.isTeacher()&&!t}),!0),ui.one(ui.CLASSROOM_CONNECT_TRIGGER,(function(e,t){var n=BJY.getExtension();return n.init().then((function(){ui.trigger(ui.CLASSROOM_CONNECT_TRIGGER,t)})),!1})).on(ui.CLASSROOM_CONNECT_FAIL,(function(){alert(O.ROOM_SERVER_CONNECT_FAIL)})).on(ui.LOGIN_CONFLICT,(function(){alert(O.LOGIN_CONFLICT)})).one(ui.VIEW_RENDER_TRIGGER,(function(){e.loaded=!0,e.isTeacher=di.isTeacher(),ui.trigger(ui.DOC_ALL_REQ),di.isTeacher()||di.isAssistant()?fi.set("class.speakState",hi.SPEAK_STATE_FREE):fi.set("class.speakState",hi.SPEAK_STATE_LIMIT),di.isPresenter()&&fi.get("class.started")&&setTimeout((function(){var e=BJY.Player.instances[BJY.store.get("user.id")];BJY.userPublish.setDevice(e,!e.videoOn,!e.audioOn)}),1e3),di.isStudent()&&t.addClass("student"),di.isWebRTC()&&BJY.ScreenShareExtensionWebrtc.init()})).one(ui.LOADING_PANEL_END,(function(){$("#main").css("opacity",1)})).on(ui.CLASS_END,(function(){ui.trigger(ui.MEDIA_SWITCH_TRIGGER,{audioOn:!1,videoOn:!1})})).on(ui.CLASS_START,(function(){di.isPresenter()&&setTimeout((function(){var e=BJY.Player.instances[BJY.store.get("user.id")];BJY.userPublish.setDevice(e,!e.videoOn,!e.audioOn)}),1e3)})).on(ui.CLASSROOM_CONNECT_SUCCESS,(function(e,t){})).on(ui.COMMAND_RECEIVE,(function(e,t){t.command&&"logout"===t.command.command_type&&t.toId===fi.get("user.id")&&(alert("你已被踢出教室"),location.reload())})),this.init()},methods:{init:function(){console.log("******************************************************************************"),console.log("*   欢迎使用 BJY JS SDK - 百家云直播 - "+BJY.version),console.log("*   API 文档：https://www.baijiayun.com/js-sdk/doc/#/README"),console.log("*   版本更新日志：https://www.baijiayun.com/js-sdk/doc/#/change-log"),console.log("*   常见问题：https://www.baijiayun.com/js-sdk/doc/#/live?id=%e5%b8%b8%e8%a7%81%e9%97%ae%e9%a2%98"),console.log("*   注意事项：自己创建教室测试时，注意非webrtc类型教室传入webrtc: 0"),console.log("*   sign签名规则：https://dev.baijiayun.com/wiki/detail/1"),console.log("******************************************************************************");var e={prefixName:"tiansujing",env:"production",room_id:"19112041735674",user_number:"0",user_avatar:"//img.baijiayun.com/0bjcloud/live/avatar/v2/teacher.png",user_name:"游客",user_role:0,sign:"731f5299af5179f99a17746f7c1bd20e",webrtc:1};if(location.href.includes("teacher=1")&&(e=Object.assign(e,{user_name:"老师",user_role:1,user_number:"1",sign:"53df87fc8d9bcf018269f0c6328a71cf"})),location.href.includes("debug=1")){var t=prompt("输入教室链接进入教室");e=Object.assign(e,this.urlParser(t)),console.log(e)}var n={id:e.room_id,speakState:BJY.config.SPEAK_STATE_LIMIT};Number(e.webrtc)&&(n.webrtcType=Number(e.webrtc)),this.webrtc=n.webrtcType,BJY.init({env:e.env,privateDomainPrefix:e.prefixName,class:n,user:{number:e.user_number,avatar:decodeURIComponent(e.user_avatar),name:decodeURIComponent(e.user_name),type:Number(e.user_role)},teacher:{number:e.user_number,avatar:decodeURIComponent(e.user_avatar),name:decodeURIComponent(e.user_name),type:Number(e.user_role)},sign:e.sign})},urlParser:function(e){var t={};if(e)try{var n=e.split("?")[1],i=n.split("&");i.forEach((function(e){var n=e.split("=");t[n[0]]=n[1]})),t.env=this.getEnv(e),t.prefixName=e.split(".")[0].split("//")[1]}catch(a){alert("url格式错误，已进入默认教室")}return t},getEnv:function(e){var t=e.match(/\/\/(.*)\./)[1];return/test/.test(t)||/localhost/.test(t)||/\d{1,3}\.\d{1,3}\.\d{1,3}/.test(t)?"test":/beta/.test(t)?"beta":(/www/.test(t),"")},supportFlash:function(){var e,t=navigator.plugins;return t&&t.length>0?e=t["Shockwave Flash"]:document.all&&(e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")),!!e},handleClassStart:function(){ui.trigger(ui.CLASS_START_TRIGGER)}}},mi=_i,vi=(n("5c0b"),Object(u["a"])(mi,a,r,!1,null,null,null)),pi=vi.exports,gi=(n("bc4a"),n("3e83")),Ti=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"}},[e.visible?n("div",{staticClass:"dialog-wrap",on:{click:function(t){return e.cancel()}}},[n("div",{staticClass:"dialog",on:{click:function(e){e.stopPropagation()}}},[e.title?n("h3",{staticClass:"title"},[e._v(e._s(e.title))]):e._e(),n("div",{staticClass:"content",domProps:{innerHTML:e._s(e.content)}}),n("p",{staticClass:"btn-wrap"},[e.cancelText?n("button",{staticClass:"btn cancel-btn",on:{click:function(t){return e.cancel()}}},[e._v(e._s(e.cancelText))]):e._e(),e.confirmText?n("button",{staticClass:"btn confirm-btn",on:{click:function(t){return e.confirm()}}},[e._v(e._s(e.confirmText))]):e._e()])])]):e._e()])},Ei=[],Si={name:"Dialog",props:{title:{type:String,default:"提示"},content:{type:String,default:"确定要执行该操作吗？"},cancelText:{type:String},confirmText:{type:String}},data:function(){return{visible:!1,resolve:"",reject:"",promise:""}},methods:{confirm:function(){this.visible=!1,this.resolve("confirm"),this.remove()},cancel:function(){this.visible=!1,this.reject("cancel"),this.remove()},show:function(){var e=this;return this.visible=!0,this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),this.promise},remove:function(){var e=this;setTimeout((function(){e.$destroy()}),100)}}},bi=Si,Ci=(n("bb57"),Object(u["a"])(bi,Ti,Ei,!1,null,null,null)),yi=Ci.exports,Li={install:function(e,t){var n,i=e.extend(yi),a=function(){n=new i;var e=n.$mount().$el;document.body.appendChild(e)};e.prototype.$Dialog={show:function(e){return n||a(),"string"===typeof e?n.content=e:"object"===Object(gi["a"])(e)&&Object.assign(n,e),n.show().then((function(e){return n=null,Promise.resolve(e)})).catch((function(e){return n=null,Promise.reject(e)}))},hide:function(){if(n)return n.cancel()}}}},Ri=Li,Ai=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"}},[e.visible?n("div",{staticClass:"toast-wrap"},[n("p",{staticClass:"content"},[e._v(e._s(e.content))])]):e._e()])},Oi=[],Pi={components:{},props:{content:{type:String,default:"Toast"},duration:{type:Number,default:2e3}},data:function(){return{visible:!1,hideTimer:null}},computed:{},watch:{},methods:{show:function(){var e=this;this.visible=!0,this.hideTimer&&clearTimeout(this.hideTimer),this.hideTimer=setTimeout((function(){e.visible=!1}),this.duration)}},created:function(){},mounted:function(){},beforeDestroy:function(){}},Ii=Pi,wi=(n("a45c"),Object(u["a"])(Ii,Ai,Oi,!1,null,"675e1ad0",null)),Ni=wi.exports,Bi={install:function(e,t){var n,i=e.extend(Ni),a=function(){n=new i;var e=n.$mount().$el;document.body.appendChild(e)};e.prototype.$Toast=function(e){return n||a(),"string"===typeof e?n.content=e:"object"===Object(gi["a"])(e)&&Object.assign(n,e),n.show()}}},Yi=Bi;i["a"].use(Ri),i["a"].use(Yi),i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(pi)}}).$mount("#app")},"5b3e":function(e,t,n){"use strict";n("54ff")},"5c0b":function(e,t,n){"use strict";n("ac27")},6237:function(e,t,n){},"68a4":function(e,t,n){},"69e3":function(e,t,n){},"6e58":function(e,t,n){},"6f6bf":function(e,t,n){"use strict";n("6237")},7705:function(e,t,n){"use strict";n("3b72")},8027:function(e,t,n){"use strict";n("69e3")},8564:function(e,t,n){"use strict";n("fba7")},8720:function(e,t,n){},"88af":function(e,t,n){"use strict";n("924d")},"8a51":function(e,t,n){},"8db6":function(e,t,n){},"924d":function(e,t,n){},"92f4":function(e,t,n){},"97d7":function(e,t,n){},"993c":function(e,t,n){},a45c:function(e,t,n){"use strict";n("1eb3")},ac27:function(e,t,n){},b448:function(e,t,n){"use strict";n("caf3")},b4f5:function(e,t,n){"use strict";n("68a4")},b516:function(e,t,n){},bb57:function(e,t,n){"use strict";n("6e58")},c056:function(e,t,n){"use strict";n("e526")},c241:function(e,t,n){},c27c:function(e,t,n){},caf3:function(e,t,n){},cf25:function(e,t,n){},d456:function(e,t,n){"use strict";n("8a51")},d694:function(e,t,n){},da48:function(e,t,n){"use strict";n("92f4")},da8f:function(e,t,n){"use strict";n("ed24")},dd6a:function(e,t,n){"use strict";n("d694")},e526:function(e,t,n){},ed24:function(e,t,n){},f091:function(e,t,n){"use strict";t.LABEL_CONFIRM="确定",t.TIME_SECONED="秒",t.USER_ROLE_TEACHER="老师",t.USER_ROLE_STUDENT="学生",t.USER_ROLE_GUEST="游客",t.USER_ROLE_ASSISTANT="助教",t.MAIN_MENU_CLASS_START="上课",t.MAIN_MENU_CLASS_END="下课",t.BUTTON_CONTENT_FULLSCREEN="全屏",t.BUTTON_CONTENT_FULLSCREEN_EXIT="退出全屏",t.BUTTON_ROLL_CALL="点名",t.BUTTON_SCREEN_START="屏幕分享",t.BUTTON_SCREEN_STOP="结束分享",t.BUTTON_ANSWER_MACHINE="答题器",t.CLASS_START="上课",t.CLASS_END="下课",t.DIALOG_TITLE_DOCUMENT="课件管理",t.DIALOG_TITLE_PROGRAM="选择分享的程序",t.BUTTON_CONTENT_DOCUMENT="课件管理",t.BUTTON_CONTENT_MY_DOCUMENT="我的课件",t.BUTTON_CONTENT_FULLSCREEN="全屏",t.BUTTON_CONTENT_FULLSCREEN_EXIT="退出全屏",t.BUTTON_ROLL_CALL="点名",t.ROLL_CALL_STUDENT_TIME="请输入学生响应时间: ",t.ROLL_CALL_TEACHER_TIME="秒后查看点名结果",t.ROLL_CALL_STUDENT_RES="老师发起了点名，请点击确定，剩余: ",t.ROLL_CALL_SUCCESS="已签到",t.ROLL_CALL_FINISH="点名结束",t.ROLL_CALL_RESULT="查看结果",t.ROLL_CALL_AGAIN="再来一次",t.TITLE_ROLL_CALL_RESULT="点名结果",t.ROLL_CALL_YES="已签到",t.ROLL_CALL_NO="未签到",t.ROOM_SERVER_CONNECT_FAIL="网络已断开，请检查网络连接或者刷新页面重新进入房间",t.LOGIN_CONFLICT="你已被踢，请确认用户 number 是否唯一或者刷新页面重新进入房间",t.CLOUD_RECORD_START_NEW="是否开始新的录制？",t.CLOUD_RECORD_GENERATE_PLAYBACK_NOW="是否立即生成回放？",t.TIP_CLASS_START="已上课",t.TIP_CLASS_END="已下课",t.TIP_CLASS_NOT_START="课程未开始",t.TIP_SPEAK_LIMIT="发言请先举手",t.TIP_SPEAK_APPLY_TIMEOUT="老师未做响应，已自动取消申请发言",t.TIP_SPEAK_APPLY_REJECT="老师拒绝了你的发言申请",t.TIP_SPEAK_APPLY_ACCEPT="老师已允许你发言",t.TIP_CLOUD_RECORD_OVERTIME="已过直播结束时间，不可开启云端录制",t.TIP_CLOUD_RECORD_END_PLAYBACK_START="正在生成回放，无法继续使用云端录制",t.TIP_NET_DISK_POOR="存储空间不足",t.TIP_HTTP_REQUEST_ERROR="网络请求失败, 请检查网络",t.TIP_LOCAL_RECORD_PATH_NULL="请选择本地存放视频路径",t.BARRAGE_ON="弹幕开",t.BARRAGE_OFF="弹幕关"},f3b3:function(e,t,n){"use strict";n("c241")},f5ec:function(e,t,n){},fac4:function(e,t,n){"use strict";n("c27c")},fb05:function(e,t,n){"use strict";n("f5ec")},fba7:function(e,t,n){},fe8e:function(e,t,n){"use strict";n("cf25")}});
//# sourceMappingURL=app.61b68ad0.js.map