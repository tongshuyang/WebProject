!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.BRTM=e():t.BRTM=e()}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=163)}([function(t,e,n){t.exports=n(184)},function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},function(t,e,n){var i=n(117),r=n(68);function a(e){return t.exports=a="function"==typeof r&&"symbol"==typeof i?function(t){return typeof t}:function(t){return t&&"function"==typeof r&&t.constructor===r&&t!==r.prototype?"symbol":typeof t},a(e)}t.exports=a},function(t,e,n){t.exports=n(186)},function(t,e,n){t.exports=n(176)},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){var i=n(0);function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),i(t,r.key,r)}}t.exports=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}},function(t,e){var n=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.func=function(t){return(0,c.default)(t)===h.RAW_FUNCTION},e.array=function(t){return(0,u.default)(t)},e.object=d,e.string=p,e.number=v,e.boolean=function(t){return"boolean"==typeof t},e.numeric=function(t){return v(t)||p(t)&&!isNaN((0,l.default)(t))&&isFinite(+t)},e.isPlainObject=function(t){if(!d(t)||t.nodeType||t===t.window)return!1;if(t.constructor&&!g.call(t,"constructor")&&!g.call(t.constructor.prototype||{},"isPrototypeOf"))return!1;var e;for(e in t);return void 0===e||g.call(t,e)},e.range=function(t,e,n){return t>=e&&t<=n};var u=s(n(76)),l=s(n(207)),c=s(n(2)),h=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(18));function f(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(f=function(t){return t?n:e})(t)}function d(t){return t!==h.NULL&&"object"===(0,c.default)(t)}function p(t){return"string"==typeof t}function v(t){return"number"==typeof t&&!isNaN(t)}var g={}.hasOwnProperty},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.each=d,e.push=function(t,e){g(t,e,p)},e.unshift=function(t,e){g(t,e,v)},e.indexOf=E,e.last=function(t){var e=t.length;if(e>0)return t[e-1]},e.pop=function(t){if(t.length>0)return t.pop()},e.remove=function(t,e,n){var i=0;return d(t,(function(r,a){(n===l.FALSE?r==e:r===e)&&(t.splice(a,1),i++)}),l.TRUE),i},e.has=function(t,e,n){return E(t,e,n)>=0},e.toArray=function(t){return u.array(t)?t:(0,c.default)(l.EMPTY_ARRAY.slice,t)},e.toObject=function(t,e,n){var i={};return d(t,(function(t){i[e?t[e]:t]=n||t})),i},e.join=function(t,e){return t.join(e)},e.falsy=function(t){return!u.array(t)||!t.length};var u=f(n(8)),l=f(n(18)),c=s(n(13));function h(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(h=function(t){return t?n:e})(t)}function f(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function d(t,e,n){var i=t.length;if(i)if(n)for(var r=i-1;r>=0&&e(t[r],r)!==l.FALSE;r--);else for(var a=0;a<i&&e(t[a],a)!==l.FALSE;a++);}function p(t,e){t[t.length]=e}function v(t,e){t.unshift(e)}function g(t,e,n){u.array(e)?d(e,(function(e){n(t,e)})):n(t,e)}function E(t,e,n){var i=l.MINUS_ONE;return d(t,(function(t,r){if(n===l.FALSE?t==e:t===e)return i=r,l.FALSE})),i}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.keys=v,e.sort=function(t,e){return v(t).sort(e?E:g)},e.each=_,e.clear=function(t){_(t,(function(e,n){delete t[n]}))},e.extend=y,e.merge=function(t,e){return t&&e?y(y({},t),e):t||e},e.copy=function t(e,n){var i=e;l.array(e)?n?(i=[],c.each(e,(function(e,r){i[r]=t(e,n)}))):i=e.slice():l.object(e)&&(i={},_(e,(function(e,r){i[r]=n?t(e,n):e})));return i},e.get=function(t,e,n){var i;f.each(e,(function(e,n){if(t==h.NULL)return i=h.UNDEFINED,h.FALSE;var r=t[e],a=r!==h.UNDEFINED;n?i=a?r:h.UNDEFINED:t=r})),i===h.UNDEFINED&&(i=n);return i},e.set=function(t,e,n,i){f.each(e,(function(e,r){if(r)t[e]=n;else if(t[e])t=t[e];else{if(!i)return h.FALSE;t=t[e]={}}}))},e.has=function(t,e){return t[e]!==h.UNDEFINED},e.falsy=function(t){return!l.object(t)||l.array(t)||!v(t).length},e.diff=function t(e,n){var i=[];return _(e,(function(e,r){l.array(e)||l.isPlainObject(e)?(null==n[r]||t(e,n[r]).length>0)&&i.push(r):e!==n[r]&&i.push(r)})),i},e.param=function(t){var e=[],n=function(t,n){n=l.func(n)?n():null==n?"":n,e[e.length]=encodeURIComponent(t)+"="+encodeURIComponent(n)};(l.array(t)||l.isPlainObject(t))&&(l.array(t)?c.each(t,(function(t,e){n(e,t)})):_(t,(function(t,e){n(e,t)})));return e.join("&").replace(/%20/g,"+")},e.toArray=function(t){var e=[];return _(t,(function(t){e.push(t)})),e};var u=s(n(57)),l=p(n(8)),c=p(n(9)),h=p(n(18)),f=p(n(214));function d(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(d=function(t){return t?n:e})(t)}function p(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=d(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function v(t){return(0,u.default)(t)}function g(t,e){return t.length-e.length}function E(t,e){return e.length-t.length}function _(t,e){for(var n in t)if(e(t[n],n)===h.FALSE)break}function y(t,e){return l.object(t)?l.object(e)?(_(e,(function(e,n){t[n]=e})),t):t:e}},function(t,e,n){var i=n(12),r=n(7),a=n(31),o=n(35),s=n(33),u=function(t,e,n){var l,c,h,f=t&u.F,d=t&u.G,p=t&u.S,v=t&u.P,g=t&u.B,E=t&u.W,_=d?r:r[e]||(r[e]={}),y=_.prototype,m=d?i:p?i[e]:(i[e]||{}).prototype;for(l in d&&(n=e),n)(c=!f&&m&&void 0!==m[l])&&s(_,l)||(h=c?m[l]:n[l],_[l]=d&&"function"!=typeof m[l]?n[l]:g&&c?a(h,i):E&&m[l]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):v&&"function"==typeof h?a(Function.call,h):h,v&&((_.virtual||(_.virtual={}))[l]=h,t&u.R&&y&&!y[l]&&o(y,l,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.default=function(t,e,n){if(s.func(t))return s.array(n)?t.apply(e,n):e!==u.UNDEFINED?t.call(e,n):n!==u.UNDEFINED?t(n):t()};var s=c(n(8)),u=c(n(18));function l(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(l=function(t){return t?n:e})(t)}function c(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=l(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var c=s?o(t,u):null;c&&(c.get||c.set)?a(r,u,c):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}},function(t,e,n){t.exports=n(189)},function(t,e,n){var i=n(17);function r(t,e,n,r,a,o,s){try{var u=t[o](s),l=u.value}catch(t){return void n(t)}u.done?e(l):i.resolve(l).then(r,a)}t.exports=function(t){return function(){var e=this,n=arguments;return new i((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,u,"next",t)}function u(t){r(o,i,a,s,u,"throw",t)}s(void 0)}))}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){t.exports=n(190)},function(t,e,n){"use strict";(function(t){var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.EMPTY_STRING=e.EMPTY_ARRAY=e.EMPTY_OBJECT=e.EMPTY_FUNCTION=e.GLOBAL=e.DOCUMENT=e.WINDOW=e.KEYPATH_CURRENT=e.KEYPATH_PARENT=e.RAW_TAG=e.RAW_SLASH=e.RAW_DOT=e.RAW_WILDCARD=e.RAW_FUNCTION=e.RAW_LENGTH=e.RAW_VALUE=e.RAW_THIS=e.RAW_UNDEFINED=e.RAW_NULL=e.RAW_FALSE=e.RAW_TRUE=e.MINUS_ONE=e.UNDEFINED=e.NULL=e.FALSE=e.TRUE=void 0;var a=r(n(211)),o=r(n(2));e.TRUE=!0;e.FALSE=!1;e.NULL=null;e.UNDEFINED=void 0;e.MINUS_ONE=-1;e.RAW_TRUE="true";e.RAW_FALSE="false";e.RAW_NULL="null";e.RAW_UNDEFINED="undefined";e.RAW_THIS="this";e.RAW_VALUE="value";e.RAW_LENGTH="length";e.RAW_FUNCTION="function";e.RAW_WILDCARD="*";e.RAW_DOT=".";e.RAW_SLASH="/";e.RAW_TAG="tag";e.KEYPATH_PARENT="..";e.KEYPATH_CURRENT="this";var s="undefined"!==("undefined"==typeof window?"undefined":(0,o.default)(window))?window:void 0;e.WINDOW=s;var u="undefined"!==("undefined"==typeof document?"undefined":(0,o.default)(document))?document:void 0;e.DOCUMENT=u;var l="undefined"!==(void 0===t?"undefined":(0,o.default)(t))?t:s;e.GLOBAL=l;e.EMPTY_FUNCTION=function(){};var c=(0,a.default)({});e.EMPTY_OBJECT=c;var h=(0,a.default)([]);e.EMPTY_ARRAY=h;e.EMPTY_STRING=""}).call(this,n(58))},function(t,e,n){var i=n(93)("wks"),r=n(67),a=n(12).Symbol,o="function"==typeof a;(t.exports=function(t){return i[t]||(i[t]=o&&a[t]||(o?a:r)("Symbol."+t))}).store=i},function(t,e,n){var i=n(16);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.KEYBOARD_RETURN=e.KEYBOARD_CLOSE_ALL_MIC=e.KEYBOARD_TOGGLE_STUDENT_CAMERA=e.KEYBOARD_TOGGLE_STUDENT_MIC=e.LOGIN_CONFLICT_KEY=e.NONE_GROUP_ID=e.ROOM_SERVER_OFFLINE_BY_SERVER=e.ROOM_SERVER_OFFLINE_BY_BROWSER=e.STREAM_ID_EXTRA_DEFINITION=e.STREAM_ID_MIX_AUDIO=e.STREAM_ID_ASSISTANT=e.STREAM_ID_ORIGIN=e.REPLAY_BY_CHANGE_SERVER=e.LINK_TYPE_CHANGE_BY_BAD_NETWORK=e.MEDIA_PUBLISH_BY_PROGRAM=e.MEDIA_PUBLISH_BY_DEVICE_ERROR=e.MEDIA_PUBLISH_BY_CHANGE_SERVER=e.MEDIA_PUBLISH_BY_OFFLINE=e.MEDIA_PUBLISH_BY_STOP_SCREEN_SHARE=e.MEDIA_PUBLISH_BY_START_SCREEN_SHARE=e.MEDIA_PUBLISH_BY_LINK_TYPE=e.MEDIA_PUBLISH_BY_MIC_SETTING=e.MEDIA_PUBLISH_BY_MIC_DEVICE=e.MEDIA_PUBLISH_BY_CAMERA_SETTING=e.MEDIA_PUBLISH_BY_CAMERA_DEVICE=e.MEDIA_PUBLISH_BY_CLASS=e.MEDIA_PUBLISH_BY_USER=e.MESSAGE_TO_ALL=e.CAN_WHISPER=e.SPEAKER_VOLUME_DEFAULT=e.SPEAKER_VOLUME_MAX=e.MIC_VOLUME_DEFAULT=e.MIC_VOLUME_MIN=e.MIC_VOLUME_MAX=e.LINK_TYPE_UDP=e.LINK_TYPE_TCP=e.AUDIO_CODEC_SPEEX=e.AUDIO_CODEC_AAC=e.MESSAGE_TYPE_IMAGE=e.MESSAGE_TYPE_EMOJI=e.MESSAGE_TYPE_TEXT=e.MESSAGE_TIME_GAP=e.MESSAGE_DEBUG=e.SPEAK_STATE_FREE=e.SPEAK_STATE_LIMIT=e.CAMERA_RATIO_9_16=e.CAMERA_RATIO_16_9=e.CAMERA_RATIO_4_3=e.CAMERA_QUALITY_MAP=e.VIDEO_QUALITY_720P_HIGH=e.VIDEO_QUALITY_4K=e.VIDEO_QUALITY_1080P_HIGH=e.VIDEO_QUALITY_1080P=e.VIDEO_QUALITY_720P=e.VIDEO_QUALITY_SUPER=e.VIDEO_QUALITY_HIGH=e.VIDEO_QUALITY_MEDIUM=e.VIDEO_QUALITY_LOW=e.USER_AUDITION=e.USER_STATUS_NOT_ACTIVE=e.USER_STATUS_ACTIVE=e.USER_STATUS_HIDDEN=e.USER_STATUS_ONLINE=e.MORE_USER_COUNT=e.ROLE_TYPE_PUBLIC=e.ROLE_TYPE_GUEST=e.ROLE_TYPE_STUDENT=e.ROLE_TYPE_ASSISTANT=e.ROLE_TYPE_TEACHER=e.MEDIA_TYPE_VIDEO=e.MEDIA_TYPE_AUDIO=e.CLASSROOM_CONNECT_TIMEOUT=e.CLASSROOM_TRY_ENTER_COUNT=e.END_TYPE_XIAOCHENGXU=e.END_TYPE_MAC_CLIENT=e.END_TYPE_MOBILE_ANDROID=e.END_TYPE_MOBILE_APPLE=e.END_TYPE_MOBILE_BROWSER=e.END_TYPE_PC_CLIENT=e.END_TYPE_PC_BROWSER=e.SIGNAL_REQUEST_TIMEOUT=e.SERVER_CONNECT_DELAY=e.CHAT_SERVER_CONNECT_TIMEOUT=e.ROOM_SERVER_CONNECT_TIMEOUT=e.SERVER_INFO_FETCH_TIMEOUT=e.MASTER_SERVER_CONNECT_TIMEOUT=e.HEARTBEAT_INTERVAL=e.WEBSOCKET_TRY_CONNECT_COUNT=e.DOC_ID_OF_WHITEBOARD=e.DOC_VISIBLE_FALSE=e.DOC_VISIBLE_TRUE=e.DOC_FIT_WIDTH=e.DOC_FIT_VIEW=e.DOC_QUALITY_LOW_RATIO=e.DOC_QUALITY_HIGH=e.DOC_QUALITY_LOW=e.DAY=e.HOUR=e.MINUTE=e.SECOND=void 0,e.STORAGE_KEY_LOCAL_DOC_FIT=e.HOMEWORK_COUNT_EACH_PAGE_REQ=e.TYPE_HOMEWORK=e.TYPE_SELF_CLOUD=e.TYPE_LOCAL=e.CHARGE_MODE_RMB=e.CLASS_END_OPERATION_END_SUB_CLASS=e.CLASS_END_OPERATION_TO_SUB_CLASS=e.ON_OFF_STAGE_TYPE_BATCH=e.ON_OFF_STAGE_TYPE_SINGLE=e.DEFAULT_IMAGE_URL_OF_DOC=e.BJY_DISPOSE_TYPE_OUT_ROOM=e.BJY_DISPOSE_TYPE_UNKNOW=e.BJY_DISPOSE_TYPE_CONNECT_FAIL=e.BJY_DISPOSE_TYPE_LOGIN_CONFLICT=e.BJY_DISPOSE_TYPE_UNLOAD=e.BJY_DISPOSE_TYPE_BACK_PREV_PAGE=e.BJY_DISPOSE_TYPE_SHUNTDOWN_BY_USER=e.VIDEO_CAPTURE_MODE=e.DOC_ADD_LOCATION_BACKSTAGE=e.DOC_ADD_LOCATION_ROOM=e.SWITCH_NEXT_CAMERA=e.NET_DETECTION=e.HANDLE_HANDUP=e.INTERACTION=e.VIRTUAL_CAMERA_NAME=e.DEFAULT_USER_IN_TIPS_CONTENT=e.USER_NAME=e.USER_SPECIAL_GUIDE_STA=e.USER_ACTIVE_ADD_DENY_REASON_NOT_EXIST=e.USER_ACTIVE_ADD_DENY_REASON_OVERLOAD=e.INTERVAL_PAINTER_LASER_BROADCAST=e.THUMBUP_COUNT_LIMIT=e.DRAGGING_CLASS_NAME_FOR_BODY=e.ANSWER_TYPE_JUDGEMENT=e.ANSWER_TYPE_MULTI_CHOICE=e.BUFFERED_BROADCAST_LIST=e.CLASS_SWITCH_TYPE_RELOAD=e.CLASS_SWITCH_TYPE_RECONNECT=e.PLAYER_TYPE=e.AGORA_APPID=e.DISPLAY_TYPE_MAX=e.DISPLAY_TYPE_FULLSCREEN=e.DISPLAY_TYPE_REPOSITION=e.DISPLAY_TYPE_NORMAL=e.DISPLAY_TYPE_HIDE=e.SNIPPET_LAYER_OF_ALL=e.SNIPPET_LAYER_OF_MANAGER=e.SNIPPET_DOC_PAGE=e.SNIPPET_DOC_ID_BROAD=e.SNIPPET_DOC_ID_LOCAL=e.PREFIX_OF_SNIPPET_SHAPE_MESSAGE=e.MEDIA_TYPE_ASSIST_SCREEN_SHARE=e.MEDIA_TYPE_MAIN_SCREEN_SHARE=e.MEDIA_TYPE_FILE=e.MEDIA_TYPE_ASSIST_CAMERA=e.MEDIA_TYPE_MAIN_CAMERA=e.TOKEN_GENERATE_TYPE=e.WEBRTC_TYPE_TENCENT=e.WEBRTC_TYPE_AGORA=e.WEBRTC_TYPE_BJY=e.CLASS_TYPE_SHUANGSHI=e.CLASS_TYPE_SMALLCOURSE=e.CLASS_TYPE_ONE_TO_MANY=e.SHARE_TARGET_MAIN=e.SHARE_TARGET_ASSIST=e.ENGLISH=e.CHINESE_SIMPLIFIED=e.STORAGE_KEY_HIDDEN_VIRTUAL_CAMERAS=e.STORAGE_KEY_COMPOSED_VIRTUAL_CAMERAS=e.STORAGE_KEY_REMOTER_TIP_SHOW=e.STORAGE_KEY_REMOTER_KEYCODE_MAP=e.STORAGE_KEY_SYSTEM_LANGUAGE=e.SIGNAL_RES_ERROR=e.SIGNAL_RES_TIMEOUT=e.SIGNAL_RES_WAIT_TIME=e.KEYBOARD_UI_AUTO_HIDE_TIME=e.KEYBOARD_NET_DETECTION=e.KEYBOARD_HANDUP=e.KEYBOARD_REMOTER_BLUE=e.KEYBOARD_REMOTER_GREEN=e.KEYBOARD_REMOTER_RED=e.KEYBOARD_REMOTER_GREY=e.KEYBOARD_TOGGLE_SELF_VIDEO=e.KEYBOARD_DEBUG_PANEL_SHOW=e.KEYBOARD_SPEAKER_ADD=e.KEYBOARD_SPEAKER_MINUS=e.KEYBOARD_MIC_ADD=e.KEYBOARD_MIC_MINUS=e.KEYBOARD_TOGGLE_CAMERA=e.KEYBOARD_TOGGLE_CLOUD_RECORD=e.KEYBOARD_PAGEDOWN=e.KEYBOARD_PAGEUP=e.KEYBOARD_REFRESH=e.KEYBOARD_TOGGLE_CLASS_STATUS=void 0;var a,o=r(n(34));e.SECOND=1e3;e.MINUTE=6e4;e.HOUR=36e5;e.DAY=864e5;e.DOC_QUALITY_LOW=1;e.DOC_QUALITY_HIGH=2;e.DOC_QUALITY_LOW_RATIO=.4;e.DOC_FIT_VIEW=1;e.DOC_FIT_WIDTH=2;e.DOC_VISIBLE_TRUE=1;e.DOC_VISIBLE_FALSE=0;e.DOC_ID_OF_WHITEBOARD="0";e.WEBSOCKET_TRY_CONNECT_COUNT=3;e.HEARTBEAT_INTERVAL=1e4;e.MASTER_SERVER_CONNECT_TIMEOUT=2e4;e.SERVER_INFO_FETCH_TIMEOUT=3e3;e.ROOM_SERVER_CONNECT_TIMEOUT=2e4;e.CHAT_SERVER_CONNECT_TIMEOUT=2e4;e.SERVER_CONNECT_DELAY=4e3;e.SIGNAL_REQUEST_TIMEOUT=8e3;e.END_TYPE_PC_BROWSER=0;e.END_TYPE_PC_CLIENT=1;e.END_TYPE_MOBILE_BROWSER=2;e.END_TYPE_MOBILE_APPLE=3;e.END_TYPE_MOBILE_ANDROID=4;e.END_TYPE_MAC_CLIENT=5;e.END_TYPE_XIAOCHENGXU=6;e.CLASSROOM_TRY_ENTER_COUNT=20;e.CLASSROOM_CONNECT_TIMEOUT=15e3;e.MEDIA_TYPE_AUDIO=1;e.MEDIA_TYPE_VIDEO=0;e.ROLE_TYPE_TEACHER=1;e.ROLE_TYPE_ASSISTANT=2;e.ROLE_TYPE_STUDENT=0;e.ROLE_TYPE_GUEST=3;e.ROLE_TYPE_PUBLIC=5;e.MORE_USER_COUNT=20;e.USER_STATUS_ONLINE=0;e.USER_STATUS_HIDDEN=1;e.USER_STATUS_ACTIVE=1;e.USER_STATUS_NOT_ACTIVE=0;e.USER_AUDITION=1;e.VIDEO_QUALITY_LOW=0;e.VIDEO_QUALITY_MEDIUM=1;e.VIDEO_QUALITY_HIGH=2;e.VIDEO_QUALITY_SUPER=3;e.VIDEO_QUALITY_720P=4;e.VIDEO_QUALITY_1080P=5;e.VIDEO_QUALITY_1080P_HIGH=6;e.VIDEO_QUALITY_4K=7;e.VIDEO_QUALITY_720P_HIGH=8;var s=(a={},(0,o.default)(a,0,"low"),(0,o.default)(a,1,"std"),(0,o.default)(a,2,"high"),(0,o.default)(a,3,"super"),(0,o.default)(a,4,"720p"),(0,o.default)(a,8,"720pHigh"),(0,o.default)(a,5,"1080p"),(0,o.default)(a,6,"1080pHigh"),(0,o.default)(a,7,"4k"),a);e.CAMERA_QUALITY_MAP=s;e.CAMERA_RATIO_4_3=0;e.CAMERA_RATIO_16_9=1;e.CAMERA_RATIO_9_16=2;e.SPEAK_STATE_LIMIT=1;e.SPEAK_STATE_FREE=0;e.MESSAGE_DEBUG=["zhls","sgsx"];e.MESSAGE_TIME_GAP=12e4;e.MESSAGE_TYPE_TEXT=0;e.MESSAGE_TYPE_EMOJI=1;e.MESSAGE_TYPE_IMAGE=2;e.AUDIO_CODEC_AAC=1;e.AUDIO_CODEC_SPEEX=2;e.LINK_TYPE_TCP=0;e.LINK_TYPE_UDP=1;e.MIC_VOLUME_MAX=100;e.MIC_VOLUME_MIN=0;e.MIC_VOLUME_DEFAULT=50;e.SPEAKER_VOLUME_MAX=100;e.SPEAKER_VOLUME_DEFAULT=50;e.CAN_WHISPER=1;e.MESSAGE_TO_ALL="-1";e.MEDIA_PUBLISH_BY_USER=0;e.MEDIA_PUBLISH_BY_CLASS=1;e.MEDIA_PUBLISH_BY_CAMERA_DEVICE=2;e.MEDIA_PUBLISH_BY_CAMERA_SETTING=3;e.MEDIA_PUBLISH_BY_MIC_DEVICE=4;e.MEDIA_PUBLISH_BY_MIC_SETTING=5;e.MEDIA_PUBLISH_BY_LINK_TYPE=6;e.MEDIA_PUBLISH_BY_START_SCREEN_SHARE=7;e.MEDIA_PUBLISH_BY_STOP_SCREEN_SHARE=8;e.MEDIA_PUBLISH_BY_OFFLINE=9;e.MEDIA_PUBLISH_BY_CHANGE_SERVER=10;e.MEDIA_PUBLISH_BY_DEVICE_ERROR=11;e.MEDIA_PUBLISH_BY_PROGRAM=12;e.LINK_TYPE_CHANGE_BY_BAD_NETWORK=0;e.REPLAY_BY_CHANGE_SERVER=1;e.STREAM_ID_ORIGIN=0;e.STREAM_ID_ASSISTANT=1;e.STREAM_ID_MIX_AUDIO=2;e.STREAM_ID_EXTRA_DEFINITION=8;e.ROOM_SERVER_OFFLINE_BY_BROWSER=0;e.ROOM_SERVER_OFFLINE_BY_SERVER=1;e.NONE_GROUP_ID=0;e.LOGIN_CONFLICT_KEY="loginConflict";e.KEYBOARD_TOGGLE_STUDENT_MIC=85;e.KEYBOARD_TOGGLE_STUDENT_CAMERA=87;e.KEYBOARD_CLOSE_ALL_MIC=86;e.KEYBOARD_RETURN=84;e.KEYBOARD_TOGGLE_CLASS_STATUS=83;e.KEYBOARD_REFRESH=82;e.KEYBOARD_PAGEUP=33;e.KEYBOARD_PAGEDOWN=34;e.KEYBOARD_TOGGLE_CLOUD_RECORD=79;e.KEYBOARD_TOGGLE_CAMERA=78;e.KEYBOARD_MIC_MINUS=75;e.KEYBOARD_MIC_ADD=77;e.KEYBOARD_SPEAKER_MINUS=74;e.KEYBOARD_SPEAKER_ADD=72;e.KEYBOARD_DEBUG_PANEL_SHOW=80;e.KEYBOARD_TOGGLE_SELF_VIDEO=78;e.KEYBOARD_REMOTER_GREY=65;e.KEYBOARD_REMOTER_RED=66;e.KEYBOARD_REMOTER_GREEN=67;e.KEYBOARD_REMOTER_BLUE=68;e.KEYBOARD_HANDUP=73;e.KEYBOARD_NET_DETECTION=71;e.KEYBOARD_UI_AUTO_HIDE_TIME=5e3;e.SIGNAL_RES_WAIT_TIME=5e3;e.SIGNAL_RES_TIMEOUT="timeout";e.SIGNAL_RES_ERROR="error";e.STORAGE_KEY_SYSTEM_LANGUAGE="bjy_system_language";e.STORAGE_KEY_REMOTER_KEYCODE_MAP="bjy_remoter_keycode_map";e.STORAGE_KEY_REMOTER_TIP_SHOW="bjy_remoter_tip_show";e.STORAGE_KEY_COMPOSED_VIRTUAL_CAMERAS="bjy_composed_virtual_camera";e.STORAGE_KEY_HIDDEN_VIRTUAL_CAMERAS="bjy_hidden_virtual_camera";e.CHINESE_SIMPLIFIED="chinese";e.ENGLISH="english";e.SHARE_TARGET_ASSIST=1;e.SHARE_TARGET_MAIN=2;e.CLASS_TYPE_ONE_TO_MANY=2;e.CLASS_TYPE_SMALLCOURSE=4;e.CLASS_TYPE_SHUANGSHI=5;e.WEBRTC_TYPE_BJY=1;e.WEBRTC_TYPE_AGORA=2;e.WEBRTC_TYPE_TENCENT=3;e.TOKEN_GENERATE_TYPE={DEFAULT:0,SINGLE_CHANNEL:1};e.MEDIA_TYPE_MAIN_CAMERA="0";e.MEDIA_TYPE_ASSIST_CAMERA="1";e.MEDIA_TYPE_FILE="2";e.MEDIA_TYPE_MAIN_SCREEN_SHARE="3";e.MEDIA_TYPE_ASSIST_SCREEN_SHARE="4";e.PREFIX_OF_SNIPPET_SHAPE_MESSAGE="s_";e.SNIPPET_DOC_ID_LOCAL="s_0";e.SNIPPET_DOC_ID_BROAD="0";e.SNIPPET_DOC_PAGE=0;e.SNIPPET_LAYER_OF_MANAGER="0";e.SNIPPET_LAYER_OF_ALL="all";e.DISPLAY_TYPE_HIDE=0;e.DISPLAY_TYPE_NORMAL=1;e.DISPLAY_TYPE_REPOSITION=2;e.DISPLAY_TYPE_FULLSCREEN=3;e.DISPLAY_TYPE_MAX=4;e.AGORA_APPID="6f80992cb6b64da1985c306f29d07ca6";e.PLAYER_TYPE={MAIN_CAMERA:0,ASSIST_CAMERA:1,MEDIA_FILE:2,MAIN_SCREEN_SHARE:3,ASSIST_SCREEN_SHARE:4};e.CLASS_SWITCH_TYPE_RECONNECT=0;e.CLASS_SWITCH_TYPE_RELOAD=1;e.BUFFERED_BROADCAST_LIST=["answer_start","answer_end"];e.ANSWER_TYPE_MULTI_CHOICE=0;e.ANSWER_TYPE_JUDGEMENT=1;e.DRAGGING_CLASS_NAME_FOR_BODY="bjy-dragging";e.THUMBUP_COUNT_LIMIT=5;e.INTERVAL_PAINTER_LASER_BROADCAST=200;e.USER_ACTIVE_ADD_DENY_REASON_OVERLOAD=1;e.USER_ACTIVE_ADD_DENY_REASON_NOT_EXIST=2;e.USER_SPECIAL_GUIDE_STA=2;e.USER_NAME="昵称";e.DEFAULT_USER_IN_TIPS_CONTENT="欢迎“昵称”进入教室";e.VIRTUAL_CAMERA_NAME="百家云虚拟摄像头";e.INTERACTION="INTERACTION";e.HANDLE_HANDUP="HANDLE_HANDUP";e.NET_DETECTION="NET_DETECTION";e.SWITCH_NEXT_CAMERA="SWITCH_NEXT_CAMERA";e.DOC_ADD_LOCATION_ROOM=0;e.DOC_ADD_LOCATION_BACKSTAGE=1;e.VIDEO_CAPTURE_MODE=["DirectShow","MediaFoundation"];e.BJY_DISPOSE_TYPE_SHUNTDOWN_BY_USER="shuntdown_by_user";e.BJY_DISPOSE_TYPE_BACK_PREV_PAGE="back_prev_page";e.BJY_DISPOSE_TYPE_UNLOAD="unload";e.BJY_DISPOSE_TYPE_LOGIN_CONFLICT="loginConflict";e.BJY_DISPOSE_TYPE_CONNECT_FAIL="connectFail";e.BJY_DISPOSE_TYPE_UNKNOW="unknow";e.BJY_DISPOSE_TYPE_OUT_ROOM="outRoom";e.DEFAULT_IMAGE_URL_OF_DOC="//img.baijiayun.com/baijiacloud/61418367_8vk0tmg2.png";e.ON_OFF_STAGE_TYPE_SINGLE=0;e.ON_OFF_STAGE_TYPE_BATCH=1;e.CLASS_END_OPERATION_TO_SUB_CLASS=0;e.CLASS_END_OPERATION_END_SUB_CLASS=1;e.CHARGE_MODE_RMB=4;e.TYPE_LOCAL="local";e.TYPE_SELF_CLOUD="cloud";e.TYPE_HOMEWORK="homework";e.HOMEWORK_COUNT_EACH_PAGE_REQ=20;e.STORAGE_KEY_LOCAL_DOC_FIT="bjy_doc_image_fit"},function(t,e,n){t.exports=!n(32)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){"use strict";var i=n(29),r=n(0),a=n(1);r(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n(5)),s=a(n(6)),u=a(n(37)),l=a(n(38)),c=a(n(30)),h=a(n(243)),f=n(247);function d(t){var e=function(){if("undefined"==typeof Reflect||!i)return!1;if(i.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,c.default)(t);if(e){var a=(0,c.default)(this).constructor;n=i(r,arguments,a)}else n=r.apply(this,arguments);return(0,l.default)(this,n)}}var p=function(t){(0,u.default)(n,t);var e=d(n);function n(t,i,r,a){var s;return(0,o.default)(this,n),(s=e.call(this)).code=void 0,s.eName=void 0,s.error=void 0,s.code=t,s.error=r,s.eName=a||(f.BRTCErrorMessage[s.code]?f.BRTCErrorMessage[s.code].name:"BRTMError"),s.message="[code: ".concat(s.code,"] [error_name: ").concat(s.eName,"] ").concat(i||(f.BRTCErrorMessage[s.code]?f.BRTCErrorMessage[s.code].message:"unkown")),s}return(0,s.default)(n,[{key:"getCode",value:function(){return this.code}}],[{key:"instanceOf",value:function(t){return t&&t.code&&t.message}}]),n}((0,h.default)(Error));e.default=p},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.UNKNOWN=e.DOC_ANIMATION_TRANSFORM_ERROR=e.DOC_FORMAT_ERROR=e.DOC_TRANSFORM_ERROR=e.DOC_ADD_ERROR=e.ROOM_CLOSED_ERROR=e.TOKEN_EXPIRE_ERROR=e.USER_SIG_ERROR=e.FETCH_ERROR=e.USER_KICKED=e.CLIENT_BANNED=e.SIGNAL_ERROR=e.SIGNAL_SETUP_FAILED=e.JOIN_ROOM_ERROR=e.PERMISSION_DENY=e.NOT_SUPPORTED=e.INVALID_OPERATION=e.INVALID_PARAMETER=e.LOCAL_ERROR=void 0;e.LOCAL_ERROR=1e3;e.INVALID_PARAMETER=1001;e.INVALID_OPERATION=1002;e.NOT_SUPPORTED=1003;e.PERMISSION_DENY=1010;e.JOIN_ROOM_ERROR=4e3;e.SIGNAL_SETUP_FAILED=4001;e.SIGNAL_ERROR=4002;e.CLIENT_BANNED=4005;e.USER_KICKED=4009;e.FETCH_ERROR=5e3;e.USER_SIG_ERROR=5001;e.TOKEN_EXPIRE_ERROR=5002;e.ROOM_CLOSED_ERROR=5003;e.DOC_ADD_ERROR=6e3;e.DOC_TRANSFORM_ERROR=6001;e.DOC_FORMAT_ERROR=6002;e.DOC_ANIMATION_TRANSFORM_ERROR=6001;e.UNKNOWN=9e3},function(t,e,n){var i=n(20),r=n(118),a=n(89),o=Object.defineProperty;e.f=n(22)?Object.defineProperty:function(t,e,n){if(i(t),e=a(e,!0),i(n),r)try{return o(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){t.exports=n(218)},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.default=function(t,e){return t!=s.NULL&&t.toString?t.toString():e!==s.UNDEFINED?e:s.EMPTY_STRING};var s=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=u(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var l in t)if("default"!==l&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?o(t,l):null;c&&(c.get||c.set)?a(r,l,c):r[l]=t[l]}r.default=t,n&&n.set(t,r);return r}(n(18));function u(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(u=function(t){return t?n:e})(t)}},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.AUTH_LENGTH=e.PRIVATE_EVENT_PREFIX=e.URL_REMARK_REQUEST=e.ACCEPT_FORMAT_OF_ANIMATION=e.ACCEPT_FORMAT_OF_STATIC=e.URL_COMMON_DOC_UPLOAD=e.MD5_SEARCH_URL=e.Type2Role=e.Role2Type=e.TOKEN_PATH=e.DOMAIN_PRO=e.DOMAIN_BETA=e.DOMAIN_TEST=e.VERSION=void 0;e.VERSION="1.0.4";e.DOMAIN_TEST="https://brtc-apitest.baijiayun.com";e.DOMAIN_BETA="https://brtc-apibeta.baijiayun.com";e.DOMAIN_PRO="https://brtc-api.baijiayun.com";e.TOKEN_PATH="/vrm/api/rmc/room/enter";e.Role2Type={root:1,admin:2,user:0};e.Type2Role={1:"root",2:"admin",0:"user"};e.MD5_SEARCH_URL="/web/doc/checkMd5";e.URL_COMMON_DOC_UPLOAD="/web/doc/file";e.ACCEPT_FORMAT_OF_STATIC=["doc","docx","ppt","pptx","pdf","jpg","jpeg","png"];e.ACCEPT_FORMAT_OF_ANIMATION=["ppt","pptx","zip"];e.URL_REMARK_REQUEST="/web/doc/getPPTRemark";e.PRIVATE_EVENT_PREFIX="$brtm_private_";e.AUTH_LENGTH=64},function(t,e,n){t.exports=n(231)},function(t,e,n){var i=n(240),r=n(142);function a(e){return t.exports=a=r?i:function(t){return t.__proto__||i(t)},a(e)}t.exports=a},function(t,e,n){var i=n(39);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(0);t.exports=function(t,e,n){return e in t?i(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){var i=n(25),r=n(49);t.exports=n(22)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(91),r=n(65);t.exports=function(t){return i(r(t))}},function(t,e,n){var i=n(141),r=n(105);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=i(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){var i=n(2),r=n(239);t.exports=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?r(t):e}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(65);t.exports=function(t){return Object(i(t))}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.default=function(t){return t!==s.UNDEFINED};var s=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=u(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var l in t)if("default"!==l&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?o(t,l):null;c&&(c.get||c.set)?a(r,l,c):r[l]=t[l]}r.default=t,n&&n.set(t,r);return r}(n(18));function u(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(u=function(t){return t?n:e})(t)}},function(t,e,n){"use strict";var i=n(165)(!0);n(87)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},function(t,e){t.exports={}},function(t,e,n){n(169);for(var i=n(12),r=n(35),a=n(43),o=n(19)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var l=s[u],c=i[l],h=c&&c.prototype;h&&!h[o]&&r(h,o,l),a[l]=a.Array}},function(t,e,n){var i=n(67)("meta"),r=n(16),a=n(33),o=n(25).f,s=0,u=Object.isExtensible||function(){return!0},l=!n(32)((function(){return u(Object.preventExtensions({}))})),c=function(t){o(t,i,{value:{i:"O"+ ++s,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!u(t))return"F";if(!e)return"E";c(t)}return t[i].i},getWeak:function(t,e){if(!a(t,i)){if(!u(t))return!0;if(!e)return!1;c(t)}return t[i].w},onFreeze:function(t){return l&&h.NEED&&u(t)&&!a(t,i)&&c(t),t}}},function(t,e,n){var i=n(31),r=n(124),a=n(125),o=n(20),s=n(66),u=n(101),l={},c={};(e=t.exports=function(t,e,n,h,f){var d,p,v,g,E=f?function(){return t}:u(t),_=i(n,h,e?2:1),y=0;if("function"!=typeof E)throw TypeError(t+" is not iterable!");if(a(E)){for(d=s(t.length);d>y;y++)if((g=e?_(o(p=t[y])[0],p[1]):_(t[y]))===l||g===c)return g}else for(v=E.call(t);!(p=v.next()).done;)if((g=r(v,_,p.value,e))===l||g===c)return g}).BREAK=l,e.RETURN=c},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=function t(e,n){var i=l.array(e)?[]:{};l.array(e)?h.each(e,(function(e,r){(l.isPlainObject(e)||l.array(e))&&(e=t(e)),i[(0,u.default)(r,n)]=e})):c.each(e,(function(e,r){(l.isPlainObject(e)||l.array(e))&&(e=t(e)),i[(0,u.default)(r,n)]=e}));return i};var u=s(n(226)),l=d(n(8)),c=d(n(10)),h=d(n(9));function f(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(f=function(t){return t?n:e})(t)}function d(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}},function(t,e){t.exports=!0},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(20),r=n(119),a=n(94),o=n(92)("IE_PROTO"),s=function(){},u=function(){var t,e=n(88)("iframe"),i=a.length;for(e.style.display="none",n(121).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;i--;)delete u.prototype[a[i]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=i(t),n=new s,s.prototype=null,n[o]=t):n=u(),void 0===e?n:r(n,e)}},function(t,e,n){var i=n(120),r=n(94);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(25).f,r=n(33),a=n(19)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,a)&&i(t,a,{configurable:!0,value:e})}},function(t,e,n){var i=n(70),r=n(49),a=n(36),o=n(89),s=n(33),u=n(118),l=Object.getOwnPropertyDescriptor;e.f=n(22)?l:function(t,e){if(t=a(t),e=o(e,!0),u)try{return l(t,e)}catch(t){}if(s(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){var i=n(16);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){var i=n(0),r=n(57);t.exports=function(t,e,n,a,o){var s={};return r(a).forEach((function(t){s[t]=a[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=n.slice().reverse().reduce((function(n,i){return i(t,e,n)||n}),s),o&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(o):void 0,s.initializer=void 0),void 0===s.initializer&&(i(t,e,s),s=null),s}},function(t,e,n){t.exports=n(196)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.default=function(t){return s.string(t)&&!/^0[0-9]+/.test(t)&&/^[0-9]{1,15}$/g.test(t)?+t:t};var s=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=u(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var l in t)if("default"!==l&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?o(t,l):null;c&&(c.get||c.set)?a(r,l,c):r[l]=t[l]}r.default=t,n&&n.set(t,r);return r}(n(8));function u(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(u=function(t){return t?n:e})(t)}},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.CLIENT_PAGE_CHANGE=e.SERVER_PAGE_CHANGE=e.PAGE_CHANGE_END=e.PAGE_CHANGE_START=e.PAGE_CHANGE_TRIGGER=e.MESSAGE_PULL_RES=e.MESSAGE_PULL_REQ=e.MESSAGE_REVOKE=e.MESSAGE_REVOKE_RES=e.MESSAGE_REVOKE_REQ=e.MESSAGE_RECEIVE=e.MESSAGE_SEND=e.SHAPE_TEXT_INPUT=e.SHAPE_LASER=e.SHAPE_LASER_TRIGGER=e.SHAPE_UPDATE=e.SHAPE_UPDATE_TRIGGER=e.SHAPE_REMOVE=e.SHAPE_REMOVE_TRIGGER=e.SHAPE_ADD=e.SHAPE_ADD_TRIGGER=e.SHAPE_APPEND=e.SHAPE_APPEND_TRIGGER=e.SHAPE_ALL_RES=e.SHAPE_ALL_REQ=e.DOC_REMOVE=e.DOC_REMOVE_TRIGGER=e.DOC_UPDATE=e.DOC_UPDATE_TRIGGER=e.DOC_ADD=e.DOC_ADD_TRIGGER=e.DOC_LIBRARY_LIST_RES=e.DOC_LIBRARY_LIST_REQ=e.DOC_DETACH_RES=e.DOC_DETACH_REQ=e.DOC_ATTACH_RES=e.DOC_ATTACH_REQ=e.DOC_ALL_RES=e.DOC_ALL_REQ=e.FORBID_USER_REMOVE=e.FORBID_USER_ADD=e.BLOCKED_LIST_SHOW_All=e.BLOCKED_LIST_TOGGLE=e.BLOCKED_USER_REMOVE=e.ALL_BLOCKED_USERS_REMOVE=e.BLOCKED_USER_ADD=e.USER_BLOCKED=e.USER_MORE_RES=e.USER_MORE_REQ=e.REPORT_USER_IN_AND_OUT=e.USER_OUT=e.USER_IN=e.USER_UPDATE=e.USER_REMOVE=e.USER_ADD=e.USER_ACTIVE_RES=e.USER_ACTIVE_REQ=e.USER_SEARCH_RES=e.USER_SEARCH_REQ=e.CLASS_END_TRIGGER=e.CLASS_START_TRIGGER=e.CLASS_END=e.CLASS_START=e.SERVER_INFO_FETCH_FAIL=e.SERVER_INFO_FETCH_SUCCESS=e.ROOM_SERVER_LOGIN_EXPIRED=e.LOGIN_CONFLICT=e.ROOM_SERVER_LOGIN_CONFLICT=e.ROOM_SERVER_LOGIN_AUDITION_END=e.ROOM_SERVER_LOGIN_KICKED_OUT=e.ROOM_SERVER_LOGIN_OVERFLOW=e.ROOM_SERVER_LOGIN_FAIL=e.ROOM_SERVER_LOGIN_SUCCESS=e.ROOM_SERVER_CONNECT_TIMEOUT=e.ROOM_SERVER_CONNECT_FAIL=e.ROOM_SERVER_CONNECT_SUCCESS=e.CHAT_SERVER_LOGIN_FAIL=e.CHAT_SERVER_LOGIN_SUCCESS=e.CHAT_SERVER_CONNECT_FAIL=e.CHAT_SERVER_CONNECT_SUCCESS=e.CHAT_SERVER_CONNECT_TRIGGER=e.MASTER_SERVER_CONNECT_TIMEOUT=e.MASTER_SERVER_CONNECT_FAIL=e.MASTER_SERVER_CONNECT_SUCCESS=e.WEBSOCKET_CLOSE=e.WEBSOCKET_RECEIVE=e.WEBSOCKET_SEND=e.CHAT_SERVER_OFFLINE=e.ROOM_SERVER_OFFLINE=e.UNSUPPORTED_END_TYPE=e.CLASSROOM_EXIT_END=e.CLASSROOM_EXIT_START=e.CLASSROOM_EXIT_TRIGGER=e.CLASSROOM_CONNECT_DEBUG=e.CLASSROOM_CONNECT_END=e.CLASSROOM_CONNECT_START=e.CLASSROOM_CONNECT_FAIL=e.CLASSROOM_CONNECT_SUCCESS=e.CLASSROOM_CONNECT_TIMEOUT=e.CLASSROOM_CONNECT_TRIGGER=void 0,e.RTM_ABILITIES_CHANGE=e.PAGE_DELETE=e.PAGE_DELETE_TRIGGER=e.PAGE_ADD=e.PAGE_ADD_TRIGGER=e.SHAPE_PREVIEW_CHANGE=e.USER_UPDATE_RES=e.USER_UPDATE_TRIGGER=e.HEARTBEAT_RECEIVE=e.HEARTBEAT_SEND=e.ALL_USERS_UNBLOCK=e.ALL_USERS_UNBLOCK_TRIGGER=e.USER_UNBLOCK=e.USER_UNBLOCK_TRIGGER=e.KICK_OUT=e.KICK_OUT_TRIGGER=e.DEVICE_SETTINGS_START=e.DEVICE_SETTINGS_OPEN=e.REMOTER_HANDLE_SPEAK_APPLY=e.DOWNLINK_LINK_TYPE_CHANGE=e.UPLINK_LINK_TYPE_CHANGE=e.VIDEO_RESOLUTION_CHANGE=e.MIXAUDIO_MUTE_PUBLISH_TRIGGER=e.VIDEO_RESOLUTION_CHANGE_TRIGGER=e.FULLSCREEN_ENTER_TRIGGER=e.FULLSCREEN_EXIT_TRIGGER=e.FULLSCREEN_EXIT=e.FULLSCREEN_ENTER=e.SPEAK_DISABLE=e.SPEAK_ENABLE=e.PRESENTER_CHANGE=e.PRESENTER_CHANGE_TRIGGER=e.SPEAK_INVITE_RES=e.SPEAK_INVITE_PENDING_LIST=e.SPEAK_INVITE_RES_TRIGGER=e.SPEAK_INVITE_REQ=e.SPEAK_INVITE_REQ_TRIGGER=e.ROLL_CALL_RESULT=e.ROLL_CALL_FINISH=e.ROLL_CALL_RES=e.ROLL_CALL=e.ROLL_CALL_TRIGGER=e.CLOUD_RECORD_COMMAND_ACCEPT=e.CLOUD_RECORD_COMMAND_SEND=e.CLOUD_RECORD_END=e.CLOUD_RECORD_PAUSE=e.CLOUD_RECORD_RESTART=e.CLOUD_RECORD_START=e.CLOUD_RECORD_START_SEND=e.CLOUD_RECORD_RESTART_TRIGGER=e.CLOUD_RECORD_PAUSE_TRIGGER=e.CLOUD_RECORD_START_TRIGGER=e.VIEW_RENDER_TRIGGER=e.LOTTERY_RESULT_RES=e.LOTTERY_RESULT_REQ=e.LOTTERY_DRAW_RES=e.LOTTERY_DRAW_REQ=e.LOTTERY_RECEIVE=e.LOTTERY_SEND=e.LOTTERY_COMPLETE_RES=e.LOTTERY_COMPLETE_REQ=e.CALL_CUSTOM_SERVICE_TRIGGER=e.GROUP_SIZE_RES=e.GROUP_SIZE_REQ=e.USER_STATE_RES=e.USER_STATE_REQ=e.BLOCK_TASK_CREATE=e.CLOUD_RECORD_END_SEND=e.START_PROCESSING_CLOUD_RECORD=e.CLOUD_RECORD_END_TRIGGER=e.STUDENT_LIST_RES=e.STUDENT_LIST_REQ=e.TOTAL_USER_COUNT_CHANGE=e.USER_COUNT_CHANGE=e.MIC_FORBID_ALL_CHANGE=e.MIC_FORBID_ALL_CHANGE_TRIGGER=e.REMOTER_TOGGLE_APPLYLIST=e.MESSAGE_SEND_FORBID_ALL_CHANGE=e.MESSAGE_SEND_FORBID_ALL_CHANGE_TRIGGER=e.MESSAGE_SEND_FORBID=e.MESSAGE_SEND_FORBID_TRIGGER=e.CUSTOMCAST_CACHE_RES=e.CUSTOMCAST_RECEIVE=e.BROADCAST_CACHE_RES=e.BROADCAST_RECEIVE=e.BROADCAST_SEND=e.COMMAND_RECEIVE=e.COMMAND_SEND=e.MEDIA_CONTROL_TRIGGER=e.MEDIA_REMOTE_CONTROL_TRIGGER=e.SPEAK_APPLY_RES=e.SPEAK_APPLY_REQ=e.SPEAK_APPLY_RES_TRIGGER=e.SPEAK_APPLY_REQ_TRIGGER=e.PPT_PAGE_COUNT_CHANGE=e.MAX_PAGE_CHANGE=void 0;e.CLASSROOM_CONNECT_TRIGGER="classroom_connect_trigger";e.CLASSROOM_CONNECT_TIMEOUT="classroom_connect_timeout";e.CLASSROOM_CONNECT_SUCCESS="classroom_connect_success";e.CLASSROOM_CONNECT_FAIL="classroom_connect_fail";e.CLASSROOM_CONNECT_START="classroom_connect_start";e.CLASSROOM_CONNECT_END="classroom_connect_end";e.CLASSROOM_CONNECT_DEBUG="classroom_connect_debug";e.CLASSROOM_EXIT_TRIGGER="classroom_exit_trigger";e.CLASSROOM_EXIT_START="classroom_exit_start";e.CLASSROOM_EXIT_END="classroom_exit_end";e.UNSUPPORTED_END_TYPE="unsupported_end_type";e.ROOM_SERVER_OFFLINE="room_server_offline";e.CHAT_SERVER_OFFLINE="chat_server_offline";e.WEBSOCKET_SEND="websocket_send";e.WEBSOCKET_RECEIVE="websocket_receive";e.WEBSOCKET_CLOSE="websocket_close";e.MASTER_SERVER_CONNECT_SUCCESS="master_server_connect_success";e.MASTER_SERVER_CONNECT_FAIL="master_server_connect_fail";e.MASTER_SERVER_CONNECT_TIMEOUT="master_server_connect_timeout";e.CHAT_SERVER_CONNECT_TRIGGER="chat_server_connect_trigger";e.CHAT_SERVER_CONNECT_SUCCESS="chat_server_connect_success";e.CHAT_SERVER_CONNECT_FAIL="chat_server_connect_fail";e.CHAT_SERVER_LOGIN_SUCCESS="chat_server_login_success";e.CHAT_SERVER_LOGIN_FAIL="chat_server_login_fail";e.ROOM_SERVER_CONNECT_SUCCESS="room_server_connect_success";e.ROOM_SERVER_CONNECT_FAIL="room_server_connect_fail";e.ROOM_SERVER_CONNECT_TIMEOUT="room_server_connect_timeout";e.ROOM_SERVER_LOGIN_SUCCESS="room_server_login_success";e.ROOM_SERVER_LOGIN_FAIL="room_server_login_fail";e.ROOM_SERVER_LOGIN_OVERFLOW="room_server_login_overflow";e.ROOM_SERVER_LOGIN_KICKED_OUT="room_server_login_kicked_out";e.ROOM_SERVER_LOGIN_AUDITION_END="room_server_login_audition_end";e.ROOM_SERVER_LOGIN_CONFLICT="room_server_login_conflict";e.LOGIN_CONFLICT="login_conflict";e.ROOM_SERVER_LOGIN_EXPIRED="room_server_login_expired";e.SERVER_INFO_FETCH_SUCCESS="server_info_fetch_success";e.SERVER_INFO_FETCH_FAIL="server_info_fetch_fail";e.CLASS_START="class_start";e.CLASS_END="class_end";e.CLASS_START_TRIGGER="class_start_trigger";e.CLASS_END_TRIGGER="class_end_trigger";e.USER_SEARCH_REQ="user_search_req";e.USER_SEARCH_RES="user_search_res";e.USER_ACTIVE_REQ="user_active_req";e.USER_ACTIVE_RES="user_active_res";e.USER_ADD="user_add";e.USER_REMOVE="user_remove";e.USER_UPDATE="user_update";e.USER_IN="user_in";e.USER_OUT="user_out";e.REPORT_USER_IN_AND_OUT="report_user_in_and_out";e.USER_MORE_REQ="user_more_req";e.USER_MORE_RES="user_more_res";e.USER_BLOCKED="user_blocked";e.BLOCKED_USER_ADD="blocked_user_add";e.ALL_BLOCKED_USERS_REMOVE="all_blocked_users_remove";e.BLOCKED_USER_REMOVE="blocked_user_remove";e.BLOCKED_LIST_TOGGLE="blocked_list_toggle";e.BLOCKED_LIST_SHOW_All="blocked_list_show_all";e.FORBID_USER_ADD="forbid_user_add";e.FORBID_USER_REMOVE="forbid_user_remove";e.DOC_ALL_REQ="doc_all_req";e.DOC_ALL_RES="doc_all_res";e.DOC_ATTACH_REQ="doc_attach_req";e.DOC_ATTACH_RES="doc_attach_res";e.DOC_DETACH_REQ="doc_detach_req";e.DOC_DETACH_RES="doc_detach_res";e.DOC_LIBRARY_LIST_REQ="doc_library_list_req";e.DOC_LIBRARY_LIST_RES="doc_library_list_res";e.DOC_ADD_TRIGGER="doc_add_trigger";e.DOC_ADD="doc_add";e.DOC_UPDATE_TRIGGER="doc_update_trigger";e.DOC_UPDATE="doc_update";e.DOC_REMOVE_TRIGGER="doc_remove_trigger";e.DOC_REMOVE="doc_remove";e.SHAPE_ALL_REQ="shape_all_req";e.SHAPE_ALL_RES="shape_all_res";e.SHAPE_APPEND_TRIGGER="shape_append_trigger";e.SHAPE_APPEND="shape_append";e.SHAPE_ADD_TRIGGER="shape_add_trigger";e.SHAPE_ADD="shape_add";e.SHAPE_REMOVE_TRIGGER="shape_remove_trigger";e.SHAPE_REMOVE="shape_remove";e.SHAPE_UPDATE_TRIGGER="shape_update_trigger";e.SHAPE_UPDATE="shape_update";e.SHAPE_LASER_TRIGGER="shape_laser_trigger";e.SHAPE_LASER="shape_laser";e.SHAPE_TEXT_INPUT="shape_text_input";e.MESSAGE_SEND="message_send";e.MESSAGE_RECEIVE="message_receive";e.MESSAGE_REVOKE_REQ="message_revoke_req";e.MESSAGE_REVOKE_RES="message_revoke_res";e.MESSAGE_REVOKE="message_revoke";e.MESSAGE_PULL_REQ="message_pull_req";e.MESSAGE_PULL_RES="message_pull_res";e.PAGE_CHANGE_TRIGGER="page_change_trigger";e.PAGE_CHANGE_START="page_change_start";e.PAGE_CHANGE_END="page_change_end";e.SERVER_PAGE_CHANGE="server_page_change";e.CLIENT_PAGE_CHANGE="client_page_change";e.MAX_PAGE_CHANGE="max_page_change";e.PPT_PAGE_COUNT_CHANGE="ppt_page_count_change";e.SPEAK_APPLY_REQ_TRIGGER="speak_apply_trigger";e.SPEAK_APPLY_RES_TRIGGER="speak_apply_res_trigger";e.SPEAK_APPLY_REQ="speak_apply_req";e.SPEAK_APPLY_RES="speak_apply_res";e.MEDIA_REMOTE_CONTROL_TRIGGER="media_remote_control_trigger";e.MEDIA_CONTROL_TRIGGER="media_remote_control";e.COMMAND_SEND="command_send";e.COMMAND_RECEIVE="command_receive";e.BROADCAST_SEND="broadcast_send";e.BROADCAST_RECEIVE="broadcast_receive";e.BROADCAST_CACHE_RES="broadcast_cache_res";e.CUSTOMCAST_RECEIVE="customcast_receive";e.CUSTOMCAST_CACHE_RES="customcast_cache_res";e.MESSAGE_SEND_FORBID_TRIGGER="message_send_forbid_trigger";e.MESSAGE_SEND_FORBID="message_send_forbid";e.MESSAGE_SEND_FORBID_ALL_CHANGE_TRIGGER="message_send_forbid_all_change_trigger";e.MESSAGE_SEND_FORBID_ALL_CHANGE="message_send_forbid_all_change";e.REMOTER_TOGGLE_APPLYLIST="remoter_toggle_applylist";e.MIC_FORBID_ALL_CHANGE_TRIGGER="mic_forbid_all_change_trigger";e.MIC_FORBID_ALL_CHANGE="mic_forbid_all_change";e.USER_COUNT_CHANGE="user_count_change";e.TOTAL_USER_COUNT_CHANGE="total_user_count_change";e.STUDENT_LIST_REQ="student_list_req";e.STUDENT_LIST_RES="student_list_res";e.CLOUD_RECORD_END_TRIGGER="cloud_record_end_trigger";e.START_PROCESSING_CLOUD_RECORD="start_processing_cloud_record";e.CLOUD_RECORD_END_SEND="cloud_record_end_send";e.BLOCK_TASK_CREATE="block_task_create";e.USER_STATE_REQ="user_state_req";e.USER_STATE_RES="user_state_res";e.GROUP_SIZE_REQ="group_size_req";e.GROUP_SIZE_RES="group_size_res";e.CALL_CUSTOM_SERVICE_TRIGGER="call_custom_service_trigger";e.LOTTERY_COMPLETE_REQ="lottery_complete_req";e.LOTTERY_COMPLETE_RES="lottery_complete_res";e.LOTTERY_SEND="lottery_send";e.LOTTERY_RECEIVE="lottery_receive";e.LOTTERY_DRAW_REQ="lottery_draw_req";e.LOTTERY_DRAW_RES="lottery_draw_res";e.LOTTERY_RESULT_REQ="lottery_result_req";e.LOTTERY_RESULT_RES="lottery_result_res";e.VIEW_RENDER_TRIGGER="view_render_trigger";e.CLOUD_RECORD_START_TRIGGER="cloud_record_start_trigger";e.CLOUD_RECORD_PAUSE_TRIGGER="cloud_record_pause_trigger";e.CLOUD_RECORD_RESTART_TRIGGER="cloud_record_restart_trigger";e.CLOUD_RECORD_START_SEND="cloud_record_start_send";e.CLOUD_RECORD_START="cloud_record_start";e.CLOUD_RECORD_RESTART="cloud_record_restart";e.CLOUD_RECORD_PAUSE="cloud_record_pause";e.CLOUD_RECORD_END="cloud_record_end";e.CLOUD_RECORD_COMMAND_SEND="cloud_record_command_send";e.CLOUD_RECORD_COMMAND_ACCEPT="cloud_record_command_accept";e.ROLL_CALL_TRIGGER="roll_call_trigger";e.ROLL_CALL="roll_call";e.ROLL_CALL_RES="roll_call_res";e.ROLL_CALL_FINISH="roll_call_finish";e.ROLL_CALL_RESULT="roll_call_result";e.SPEAK_INVITE_REQ_TRIGGER="speak_invite_req_trigger";e.SPEAK_INVITE_REQ="speak_invite_req";e.SPEAK_INVITE_RES_TRIGGER="speak_invite_res_trigger";e.SPEAK_INVITE_PENDING_LIST="speak_invite_pending_list";e.SPEAK_INVITE_RES="speak_invite_res";e.PRESENTER_CHANGE_TRIGGER="presenter_change_trigger";e.PRESENTER_CHANGE="presenter_change";e.SPEAK_ENABLE="speak_enable";e.SPEAK_DISABLE="speak_disable";e.FULLSCREEN_ENTER="fullscreen_enter";e.FULLSCREEN_EXIT="fullscreen_exit";e.FULLSCREEN_EXIT_TRIGGER="fullscreen_exit_trigger";e.FULLSCREEN_ENTER_TRIGGER="fullscreen_enter_trigger";e.VIDEO_RESOLUTION_CHANGE_TRIGGER="video_resolution_change_trigger";e.MIXAUDIO_MUTE_PUBLISH_TRIGGER="mixaudio_mute_publish_trigger";e.VIDEO_RESOLUTION_CHANGE="video_resolution_change";e.UPLINK_LINK_TYPE_CHANGE="uplink_link_type_change";e.DOWNLINK_LINK_TYPE_CHANGE="downlink_link_type_change";e.REMOTER_HANDLE_SPEAK_APPLY="remoter_handle_speak_apply";e.DEVICE_SETTINGS_OPEN="device_settings_open";e.DEVICE_SETTINGS_START="device_settings_start";e.KICK_OUT_TRIGGER="kick_out_trigger";e.KICK_OUT="kick_out";e.USER_UNBLOCK_TRIGGER="user_unblock_trigger";e.USER_UNBLOCK="user_unblock";e.ALL_USERS_UNBLOCK_TRIGGER="all_user_unblock_trigger";e.ALL_USERS_UNBLOCK="all_users_unblock";e.HEARTBEAT_SEND="heartbeat_send";e.HEARTBEAT_RECEIVE="heartbeat_receive";e.USER_UPDATE_TRIGGER="user_update_trigger";e.USER_UPDATE_RES="user_update_res";e.SHAPE_PREVIEW_CHANGE="shape_preview_change";e.PAGE_ADD_TRIGGER="page_add_trigger";e.PAGE_ADD="page_add";e.PAGE_DELETE_TRIGGER="page_delete_trigger";e.PAGE_DELETE="page_delete";e.RTM_ABILITIES_CHANGE="rtm_abilities_change"},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.BRTM_COMMAND_TYPE=e.PRODUCTION=e.LOGGER_TAG_CLIENT=e.DEVELOPMENT=e.BETA=void 0;e.BETA="beta";e.DEVELOPMENT="test";e.LOGGER_TAG_CLIENT="c";e.PRODUCTION="production";e.BRTM_COMMAND_TYPE="rtm_custom_command"},function(t,e,n){"use strict";(function(t){var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.setLevel=function(e){t.BRTM_LOG_LEVEL=e},e.debug=p,e.info=v,e.warn=g,e.error=E,e.fatal=function(t,e,n){throw new u.default(t,e,n)},e.enableUploadLog=function(){!0},e.disableUploadLog=function(){!1},e.LogMap=e.FATAL=e.CLOSE=e.ERROR=e.WARN=e.INFO=e.DEBUG=void 0;var a,o=r(n(34)),s=r(n(2)),u=r(n(23)),l=r(n(27));e.DEBUG=1;e.INFO=2;e.WARN=3;e.ERROR=4;e.CLOSE=5;e.FATAL=6;var c=void 0!==("undefined"==typeof console?"undefined":(0,s.default)(console))?console:null,h=/BRTM/.test((0,l.default)((function(){})))?1:3;function f(t,e,n,i){var r=[];return n&&r.push(n),i&&r.push(i),"[".concat((new Date).toLocaleTimeString("chinese",{hour12:!1}),"] <").concat(t,"> [").concat(r.join("|"),"] ").concat(e)}function d(){if(t){var e=t.BRTM_LOG_LEVEL;if(e>=1&&e<=6)return e}return h}function p(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];c&&d()<=1&&(i.unshift(f("DEBUG",t,e,n)),c.log.apply(c.log,i))}function v(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];c&&d()<=2&&(i.unshift(f("INFO",t,e,n)),c.log.apply(c.log,i))}function g(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];c&&d()<=3&&(i.unshift(f("WARN",t,e,n)),c.warn.apply(c.warn,i))}function E(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];c&&d()<=4&&(i.unshift(f("ERROR",t,e,n)),c.error.apply(c.error,i))}var _=(a={},(0,o.default)(a,1,p),(0,o.default)(a,2,v),(0,o.default)(a,3,g),(0,o.default)(a,4,E),a);e.LogMap=_}).call(this,n(58))},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.setRequestEnv=function(t){e.env=m=t},e.getURL=T,e.getTokenAuthUrl=A,e.post=x,e.get=function(t,e,n,i){return O.apply(this,arguments)},e.checkSign=function(t,e,n,i,r,a,o){return I.apply(this,arguments)},e.env=void 0;var u=s(n(14)),l=s(n(15)),c=s(n(80)),h=s(n(17)),f=n(143),d=y(n(28)),p=y(n(61)),v=s(n(269)),g=s(n(270)),E=y(n(10));function _(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(_=function(t){return t?n:e})(t)}function y(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=_(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var m="production";e.env=m;function T(t){var e=d.DOMAIN_PRO;return m===p.DEVELOPMENT?e=d.DOMAIN_TEST:m===p.BETA&&(e=d.DOMAIN_BETA),e+t}function A(){return T(d.TOKEN_PATH)}function R(t){return E.param(t)}function S(t,e){return"application/x-www-form-urlencoded"===t?R(e):"multipart/form-data"===t?function(t){var e=new FormData;return t&&E.each(t,(function(t,n){e.append(encodeURIComponent(n),encodeURIComponent(t))})),e}(e):(0,c.default)(e)}function x(t,e,n,i){return P.apply(this,arguments)}function P(){return(P=(0,l.default)(u.default.mark((function t(e,n,i,r){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new h.default((function(t,i){var a=0;function o(){return s.apply(this,arguments)}function s(){return(s=(0,l.default)(u.default.mark((function s(){var l;return u.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:a++,s.prev=1,s.next=8;break;case 8:return s.next=10,fetch(e,{body:S(r,n),cache:"no-cache",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":null!=r?r:"application/json"},method:"POST",mode:"cors",redirect:"follow",referrer:"no-referrer"});case 10:l=s.sent,t(l.json());case 12:s.next=23;break;case 14:if(s.prev=14,s.t0=s.catch(1),!(a<3)){s.next=22;break}return s.next=19,new v.default(1);case 19:o(),s.next=23;break;case 22:i(s.t0);case 23:case"end":return s.stop()}}),s,null,[[1,14]])})))).apply(this,arguments)}o()})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(){return(O=(0,l.default)(u.default.mark((function t(e,n,i,r){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new h.default((function(t,i){var r=0;function a(){return o.apply(this,arguments)}function o(){return(o=(0,l.default)(u.default.mark((function o(){var s;return u.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:r++,o.prev=1,o.next=8;break;case 8:return o.next=10,fetch("".concat(e,"?").concat(R(n)),{cache:"no-cache",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET",mode:"cors",redirect:"follow",referrer:"no-referrer"});case 10:s=o.sent,t(s.json());case 12:o.next=23;break;case 14:if(o.prev=14,o.t0=o.catch(1),!(r<3)){o.next=22;break}return o.next=19,new v.default(1);case 19:a(),o.next=23;break;case 22:i(o.t0);case 23:case"end":return o.stop()}}),o,null,[[1,14]])})))).apply(this,arguments)}a()})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(){return(I=(0,l.default)(u.default.mark((function t(e,n,i,r,a,o,s){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",x(A(),{sig:i,room_type:1,room_id:n,user_id:r,user_role:a,user_name:o,user_avatar:s,platform:"Web",version:d.VERSION,network:g.default.name,ts:(0,f.timestamp)(),app_id:e}));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.Debounce=function(t){return function(e,n,i){var r=i.value;return i.value=(0,p.default)(r,t),i}},e.Throttling=function(t){return function(e,n,i){var r=i.value;return i.value=(0,v.default)(r,t),i}},e.Log=function(){return function(t,e,n){var i=n.value;return n.value=function(){return(0,d.default)(i,this,f.toArray(arguments))},n}},e.frequency=_,e.frequency60=function(){return _((function(t,e){var n,i,r=e.length,a=null!==(n=e[r-5])&&void 0!==n?n:-1,o=null!==(i=e[r-60])&&void 0!==i?i:-1;return t-a<h.SECOND||t-o<h.MINUTE}),60,"请求超出频率限制，一秒钟不能超过 5 次，一分钟不能超过 60 次")},e.limit=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;return _((function(e,n){var i;return e-(null!==(i=n[0])&&void 0!==i?i:-1)<t}),1,"调用超出频率限制，".concat(t,"ms 内只能调一次"))};var u=s(n(78)),l=s(n(23)),c=E(n(24)),h=n(21),f=E(n(9)),d=s(n(13)),p=s(n(272)),v=s(n(147));function g(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(g=function(t){return t?n:e})(t)}function E(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=g(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function _(t,e,n){return function(i,r,a){var o=a.value,s=[];return a.value=function(){var i=(0,u.default)();if(t(i,s))throw new l.default(c.INVALID_OPERATION,"".concat(r," ").concat(null!=n?n:"方法执行超出频率限制"));return s.push(i),s.length>e&&s.shift(),(0,d.default)(o,this,f.toArray(arguments))},a}}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var i=n(86),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e,n){t.exports=n(171)},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){},function(t,e,n){var i=n(35);t.exports=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:i(t,r,e[r]);return t}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(52),r=n(19)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?n:a?i(e):"Object"==(o=i(e))&&"function"==typeof e.callee?"Arguments":o}},function(t,e,n){var i=n(11),r=n(7),a=n(32);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],o={};o[t]=e(n),i(i.S+i.F*a((function(){n(1)})),"Object",o)}},function(t,e,n){t.exports=n(205)},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.camelize=function(t){p[t]||(p[t]=t.replace(h,(function(t,e){return y(e)})));return p[t]},e.hyphenate=function(t){v[t]||(v[t]=t.replace(f,(function(t,e){return"-"+m(e)})));return v[t]},e.capitalize=function(t){g[t]||(g[t]=t.replace(d,y));return g[t]},e.trim=function(t){return T(t)?u.EMPTY_STRING:t.trim()},e.slice=function(t,e,n){return s.number(n)?e===n?u.EMPTY_STRING:t.slice(e,n):t.slice(e)},e.indexOf=E,e.lastIndexOf=_,e.startsWith=function(t,e){return 0===E(t,e)},e.endsWith=function(t,e){var n=t.length-e.length;return n>=0&&_(t,e)===n},e.charAt=function(t,e){return t.charAt(e||0)},e.codeAt=function(t,e){return t.charCodeAt(e||0)},e.upper=y,e.lower=m,e.has=function(t,e){return E(t,e)>=0},e.falsy=T;var s=c(n(8)),u=c(n(18));function l(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(l=function(t){return t?n:e})(t)}function c(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=l(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var c=s?o(t,u):null;c&&(c.get||c.set)?a(r,u,c):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var h=/-([a-z])/gi,f=/\B([A-Z])/g,d=/^[a-z]/,p={},v={},g={};function E(t,e,n){return t.indexOf(e,n!==u.UNDEFINED?n:0)}function _(t,e,n){return t.lastIndexOf(e,n!==u.UNDEFINED?n:t.length)}function y(t){return t.toUpperCase()}function m(t){return t.toLowerCase()}function T(t){return!s.string(t)||!t.length}},function(t,e,n){t.exports=n(249)},function(t,e,n){var i=n(3),r=n(251),a=n(254);function o(e,n,s){return"undefined"!=typeof Reflect&&r?t.exports=o=r:t.exports=o=function(t,e,n){var r=a(t,e);if(r){var o=i(r,e);return o.get?o.get.call(n):o.value}},o(e,n,s||e)}t.exports=o},function(t,e,n){t.exports=n(256)},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(259)),l=s(n(2)),c=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(18)),h=s(n(262));function f(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(f=function(t){return t?n:e})(t)}(void 0===u.default?"undefined":(0,l.default)(u.default))===c.RAW_FUNCTION&&(0,h.default)(u.default)&&u.default;var d=("undefined"==typeof MessageChannel?"undefined":(0,l.default)(MessageChannel))===c.RAW_FUNCTION&&(0,h.default)(MessageChannel)?function(t){var e=new MessageChannel;e.port1.onmessage=t,e.port2.postMessage(1)}:setTimeout;e.default=d},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=s(n(13)),h=s(n(265)),f=_(n(8)),d=_(n(9)),p=_(n(10)),v=_(n(77)),g=(_(n(266)),_(n(18)));function E(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(E=function(t){return t?n:e})(t)}function _(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=E(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var y=function(){function t(e){(0,u.default)(this,t),this.ns=void 0,this.listeners=void 0,this.nativeListeners=void 0,this.ns=e||g.FALSE,this.listeners={}}return(0,l.default)(t,[{key:"fire",value:function(t,e,n){var i=this,r=f.string(t)?i.parse(t):t,a=i.listeners[r.type],o=g.TRUE;if(a){a=p.copy(a);var s=e&&e[0]instanceof h.default?e[0]:g.UNDEFINED;d.each(a,(function(t){if(A(r.ns,t,g.TRUE)&&d.has(a,t)&&(!n||n(r,e,t))){s&&(s.listener=t.fn);var u=(0,c.default)(t.fn,t.ctx,e);return s&&(s.listener=g.UNDEFINED),t.num=t.num?t.num+1:1,t.num===t.max&&i.off(r,t.fn),s&&(u===g.FALSE?s.prevent().stop():s.isStoped&&(u=g.FALSE)),u===g.FALSE?o=g.FALSE:void 0}}))}return o}},{key:"on",value:function(t,e){var n=this.listeners,i=f.func(e)?{fn:e}:e;if(f.object(i)&&f.func(i.fn)){var r=f.string(t)?this.parse(t):t;i.ns=r.ns,d.push(n[r.type]||(n[r.type]=[]),i)}else 0;return this}},{key:"off",value:function(t,e){var n=this.listeners;if(t){var i=f.string(t)?this.parse(t):t,r=i.type,a=i.ns,o=T(e);r?n[r]&&function(t,e){d.each(t,(function(e,n){o(e)&&t.splice(n,1)}),g.TRUE),t.length||delete n[e]}(n[r],r):a&&p.each(n,(function(t,e){d.each(t,(function(e,n){A(a,e)&&t.splice(n,1)}),g.TRUE),t.length||delete n[e]}))}else this.listeners={}}},{key:"has",value:function(t,e){var n=this.listeners,i=f.string(t)?this.parse(t):t,r=i.type,a=i.ns,o=g.TRUE,s=T(e),u=function(t){return d.each(t,(function(t){if(s(t))return o=g.FALSE})),o};return r?n[r]&&u(n[r]):a&&p.each(n,u),!o}},{key:"parse",value:function(t){var e={type:t,ns:g.EMPTY_STRING};if(this.ns){var n=v.indexOf(t,g.RAW_DOT);n>=0&&(e.type=v.slice(t,0,n),e.ns=v.slice(t,n+1))}return e}}]),t}();function m(){return g.TRUE}function T(t){return f.func(t)?function(e){return t===e.fn}:m}function A(t,e,n){var i=e.ns;return i&&t?i===t:n?g.TRUE:g.FALSE}e.default=y},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=v(n(8)),h=s(n(82)),f=s(n(41)),d=v(n(10));function p(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(p=function(t){return t?n:e})(t)}function v(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=p(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var g=function(){function t(e){(0,u.default)(this,t),this.room=void 0,this.messageTypes=void 0,this.runned=void 0,this.emitter=void 0,this.emitter=e||new h.default(!0),this.messageTypes={},this.runned=!1}return(0,l.default)(t,[{key:"isRunning",value:function(){return this.runned}},{key:"run",value:function(t){this.runned&&this.stop(),this.room=t,this.room.roomServer.addMessageTypes(this.messageTypes),this.runned=!0}},{key:"stop",value:function(){this.runned&&(this.room.roomServer.removeMessageTypes(this.messageTypes),this.runned=!1,this.room=null)}},{key:"addMessageType",value:function(t,e){this.messageTypes[t]=e}},{key:"removeMeaageType",value:function(t,e){this.messageTypes[t]===e&&delete this.messageTypes[t]}},{key:"addMessageTypes",value:function(t){var e=this;d.each(t,(function(t,n){e.addMessageType(n,t)}))}},{key:"removeMessageTypes",value:function(t){var e=this;d.each(t,(function(t,n){e.removeMeaageType(n,t)}))}},{key:"fire",value:function(t,e){this.emitter.fire(t,c.array(e)?e:(0,f.default)(e)?[e]:void 0)}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,{fn:e,ctx:n.ctx?n.ctx:this}),this}},{key:"one",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,{fn:e,ctx:n.ctx?n.ctx:this,max:1}),this}},{key:"off",value:function(t,e){return arguments.length>1?this.emitter.off(t,e):this.emitter.off(t),this}},{key:"destroy",value:function(){this.stop(),this.messageTypes=null,this.emitter.off(),this.emitter=null}}]),t}();e.default=g},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.BRTM_ABILITIES_CHANGED=e.MESSAGE_RECEIVED=e.CUSTOMCAST_MESSAGE_RECEIVED=e.BROADCAST_MESSAGE_RECEIVED=e.CLIENT_BANNED=e.USER_KICKED=void 0;e.USER_KICKED="user-kicked";e.CLIENT_BANNED="client-banned";e.BROADCAST_MESSAGE_RECEIVED="broadcast-message-received";e.CUSTOMCAST_MESSAGE_RECEIVED="customcast-message-received";e.MESSAGE_RECEIVED="message-received";e.BRTM_ABILITIES_CHANGED="brtm-abilities-changed"},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t){var e=location.protocol;0!==t.indexOf(e)&&("file:"===e?0!==t.indexOf("https")&&(t="https:"+t.slice(5)):t=0===t.indexOf("http")?0===t.indexOf("https")?e+t.slice(6):e+t.slice(5):e+t);return t}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){"use strict";var i=n(48),r=n(11),a=n(90),o=n(35),s=n(43),u=n(166),l=n(53),c=n(95),h=n(19)("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,p,v,g,E){u(n,e,p);var _,y,m,T=function(t){if(!f&&t in x)return x[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},A=e+" Iterator",R="values"==v,S=!1,x=t.prototype,P=x[h]||x["@@iterator"]||v&&x[v],O=P||T(v),I=v?R?T("entries"):O:void 0,w="Array"==e&&x.entries||P;if(w&&(m=c(w.call(new t)))!==Object.prototype&&m.next&&(l(m,A,!0),i||"function"==typeof m[h]||o(m,h,d)),R&&P&&"values"!==P.name&&(S=!0,O=function(){return P.call(this)}),i&&!E||!f&&!S&&x[h]||o(x,h,O),s[e]=O,s[A]=d,v)if(_={values:R?O:T("values"),keys:g?O:T("keys"),entries:I},E)for(y in _)y in x||a(x,y,_[y]);else r(r.P+r.F*(f||S),e,_);return _}},function(t,e,n){var i=n(16),r=n(12).document,a=i(r)&&i(r.createElement);t.exports=function(t){return a?r.createElement(t):{}}},function(t,e,n){var i=n(16);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){t.exports=n(35)},function(t,e,n){var i=n(52);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){var i=n(93)("keys"),r=n(67);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(7),r=n(12),a=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(48)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var i=n(33),r=n(40),a=n(92)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},function(t,e,n){e.f=n(19)},function(t,e,n){var i=n(12),r=n(7),a=n(48),o=n(96),s=n(25).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=a?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:o.f(t)})}},function(t,e,n){var i=n(52);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(120),r=n(94).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(31),r=n(91),a=n(40),o=n(66),s=n(178);t.exports=function(t,e){var n=1==t,u=2==t,l=3==t,c=4==t,h=6==t,f=5==t||h,d=e||s;return function(e,s,p){for(var v,g,E=a(e),_=r(E),y=i(s,p,3),m=o(_.length),T=0,A=n?d(e,m):u?d(e,0):void 0;m>T;T++)if((f||T in _)&&(g=y(v=_[T],T,E),t))if(n)A[T]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return T;case 2:A.push(v)}else if(c)return!1;return h?-1:l||c?c:A}}},function(t,e,n){var i=n(74),r=n(19)("iterator"),a=n(43);t.exports=n(7).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||a[i(t)]}},function(t,e,n){var i,r,a,o=n(31),s=n(130),u=n(121),l=n(88),c=n(12),h=c.process,f=c.setImmediate,d=c.clearImmediate,p=c.MessageChannel,v=c.Dispatch,g=0,E={},_=function(){var t=+this;if(E.hasOwnProperty(t)){var e=E[t];delete E[t],e()}},y=function(t){_.call(t.data)};f&&d||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return E[++g]=function(){s("function"==typeof t?t:Function(t),e)},i(g),g},d=function(t){delete E[t]},"process"==n(52)(h)?i=function(t){h.nextTick(o(_,t,1))}:v&&v.now?i=function(t){v.now(o(_,t,1))}:p?(a=(r=new p).port2,r.port1.onmessage=y,i=o(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(t){c.postMessage(t+"","*")},c.addEventListener("message",y,!1)):i="onreadystatechange"in l("script")?function(t){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),_.call(t)}}:function(t){setTimeout(o(_,t,1),0)}),t.exports={set:f,clear:d}},function(t,e,n){"use strict";var i=n(39);function r(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)}t.exports.f=function(t){return new r(t)}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var i=n(142);function r(e,n){return t.exports=r=i||function(t,e){return t.__proto__=e,t},r(e,n)}t.exports=r},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(14)),l=s(n(26)),c=s(n(17)),h=s(n(15)),f=s(n(5)),d=s(n(6)),p=R(n(21)),v=R(n(60)),g=R(n(62)),E=s(n(255)),_=(s(n(257)),R(n(8))),y=s(n(41)),m=R(n(9)),T=R(n(10));function A(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(A=function(t){return t?n:e})(t)}function R(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=A(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var S=function(){function t(e,n,i,r){(0,f.default)(this,t),this.server=void 0,this.proxies=void 0,this.ws=void 0,this.queue=void 0,this.options=void 0,this.emitter=void 0,this.promiseHolder=void 0,this.messageTypes=void 0,this.activeServer=void 0,this.seq=void 0,this.tag="server",this.server=n,this.proxies=i,this.options=r,this.emitter=e,this.promiseHolder=new l.default,this.messageTypes=new l.default,this.queue=[],this.seq=0}var e;return(0,d.default)(t,[{key:"getActiveServer",value:function(){return this.activeServer}},{key:"setServer",value:function(t){this.server=t}},{key:"setProxies",value:function(t){this.proxies=t}},{key:"fire",value:function(t,e){this.emitter.fire(t,_.array(e)?e:(0,y.default)(e)?[e]:void 0)}},{key:"connect",value:function(t){var e=this;t&&(this.options=t);var n=T.extend({interval:p.SECOND,retryCount:p.WEBSOCKET_TRY_CONNECT_COUNT,timeout:p.ROOM_SERVER_CONNECT_TIMEOUT},this.options);this.ws=new E.default({native:window.WebSocket,onSend:function(t){n.onSend&&n.onSend(t),e.fire(v.WEBSOCKET_SEND,t)},onReceive:function(t){var i=t.seq&&e.promiseHolder.get(t.seq);i&&(t.user_id||g.warn("no user_id",e.tag,0,[t]),clearTimeout(i.timer),e.promiseHolder.delete(t.seq),i.resolve(t));var r=e.messageTypes.get(t.message_type);r&&r.length&&m.each(r,(function(e){e(t)})),n.onReceive&&n.onReceive(t),e.fire(v.WEBSOCKET_RECEIVE,t)},onOpen:function(t){for(n.onOpen&&n.onOpen(t);e.queue.length;)e.send(e.queue.pop());e.activeServer=t.server},onClose:n.onClose,onError:n.onError,onTimeout:n.onTimeout,connectOnClose:!0}),this.ws.connect(this.server,this.proxies)}},{key:"request",value:(e=(0,h.default)(u.default.mark((function t(e){var n=this;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new c.default((function(t,i){e.seq=n.options.seqPrefix?"".concat(n.options.seqPrefix,"_").concat(n.seq++):n.seq++,n.promiseHolder.set(e.seq,{resolve:t,reject:i,seq:e.seq,timer:setTimeout((function(){g.error("request timeout",n.tag,0,[e]),i("timeout"),n.promiseHolder.delete(e.seq)}),p.SIGNAL_REQUEST_TIMEOUT)}),n.send(e)})));case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"send",value:function(t){this.ws&&this.ws.isOpen()?this.ws.send(t):this.queue.push(t)}},{key:"logout",value:function(){this.ws&&(this.ws.close(),this.ws=null),this.promiseHolder.forEach((function(t){t.timer&&clearTimeout(t.timer)})),this.promiseHolder.clear()}},{key:"close",value:function(){this.logout(),this.messageTypes.clear(),this.emitter=null,this.promiseHolder=null,this.messageTypes=null,this.queue=null,this.seq=0}},{key:"addMessageType",value:function(t,e){var n=this.messageTypes.get(t);n?n.push(e):this.messageTypes.set(t,[e])}},{key:"removeMeaageType",value:function(t,e){var n=this.messageTypes.get(t),i=-1;m.each(n,(function(t,n){if(e===t)return i=n,!1})),i>-1&&n.splice(i,1),n.length||this.messageTypes.delete(t)}},{key:"addMessageTypes",value:function(t){var e=this;T.each(t,(function(t,n){e.addMessageType(n,t)}))}},{key:"removeMessageTypes",value:function(t){var e=this;T.each(t,(function(t,n){e.removeMeaageType(n,t)}))}}]),t}();e.default=S},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(5)),o=r(n(6)),s=function(){function t(e,n,i){(0,a.default)(this,t),this.task=void 0,this.timeout=void 0,this.interval=void 0,this.timer=void 0,this.count=void 0,this.task=e,this.timeout=n,this.interval=i,this.count=0}return(0,o.default)(t,[{key:"start",value:function(){var t=this;t.stop();var e=t.timeout,n=t.interval;null==e&&(e=n),t.timer=setTimeout((function e(){t.count++,!1!==t.task()&&t.timer?t.timer=setTimeout(e,n):t.stop()}),e)}},{key:"stop",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null,this.count=0)}},{key:"isStarted",value:function(){return!!this.timer}},{key:"destroy",value:function(){this.stop(),this.task=this.timeout=this.interval=null}}]),t}();e.default=s},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=void 0;var i=n(9),r=[["iphone",/iphone os ([\d_.]+)/],["ipad",/ipad; cpu os ([\d_.]+)/],["itouch",/itouch; cpu os ([\d_.]+)/],["android",/android ([\d_.]+)/],["wp",/windows phone ([\d_.]+)/],["windows",/windows nt ([\d_.]+)/],["linux",/linux/],["mac",/mac os x ([\d_.]+)/]];var a,o,s,u=(a=(navigator.userAgent||"").toLowerCase(),(0,i.each)(r,(function(t){var e=t[1].exec(a);if(e)return o=t[0],(s=e[1])&&(s=s.replace(/_/g,".")),!1})),{name:o||"",version:s||""});u.name&&(u[u.name]=!0,{iphone:1,ipad:1,itouch:1}[u.name]&&(u.ios=!0));var l=u;e.default=l},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.encode=function(t){var e=[],n=0;for(;n<t.length;)e.push(d(t.slice(n,n+64))),n+=64;return e.slice(0,Math.ceil(c.AUTH_LENGTH/64)).join("|").replace(/\|+?$/,"")},e.decode=function(t){for(var e=new Array(c.AUTH_LENGTH),n=0;n<c.AUTH_LENGTH;n++)e[n]=!1;if(t)for(var i=t.split("|"),r=0;r<i.length&&!(64*r>=c.AUTH_LENGTH);r++)e.splice.apply(e,[64*r,64].concat((0,u.default)(p(i[r]))));return e},e.getBooleanByIndex=function(t,e){if(!t)return!1;var n=t.split("|")[Math.floor(e/64)];if(!n)return!1;var i=e-64*Math.floor(e/64),r=Math.floor(i/6);if(n.length<=r)return!1;return 0!=(l.map[n[r]]&f[i-6*r])};var u=s(n(148)),l=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(111)),c=n(28);function h(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(h=function(t){return t?n:e})(t)}var f={0:1,1:2,2:4,3:8,4:16,5:32};function d(t){for(var e="",n=Math.floor(t.length/6),i=0;i<n;i++){for(var r=0,a=0;a<6;a++)t[6*i+a]&&(r+=Math.pow(2,a));e+=l.list[r]}if(6*n<t.length){for(var o=0,s=6*n;s<t.length;s++)t[s]&&(o+=Math.pow(2,s-6*n));e+=l.list[o]}var u=Math.ceil(64/6);return e.substr(0,u).replace(/A+?$/,"")}function p(t){for(var e=new Array(64),n=0;n<64;n++)e[n]=!1;var i=t.length;if(i)for(var r=0,a=0;a<i;){for(var o=l.map[t[a]],s=0;s<6&&(e[r++]=0!=(o&f[s]),64!==r);s++);if(64===r)break;a++}return e}},function(t,e,n){t.exports=n(275)},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.base64Decode=function(t){var e,n,i,r,a,o,s,u="",c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(;t.length%4;)t+="=";for(;c<t.length;)r=l.indexOf(t.charAt(c++)),a=l.indexOf(t.charAt(c++)),o=l.indexOf(t.charAt(c++)),s=l.indexOf(t.charAt(c++)),e=r<<2|a>>4,n=(15&a)<<4|o>>2,i=(3&o)<<6|s,u+=String.fromCharCode(e),64!==o&&(u+=String.fromCharCode(n)),64!==s&&(u+=String.fromCharCode(i));return function(t){var e="",n=0,i=0,r=0,a=0;for(;n<t.length;)(i=t.charCodeAt(n))<128?(e+=String.fromCharCode(i),n++):i>191&&i<224?(r=t.charCodeAt(n+1),e+=String.fromCharCode((31&i)<<6|63&r),n+=2):(r=t.charCodeAt(n+1),a=t.charCodeAt(n+2),e+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&a),n+=3);return e}(u)},e.map=e.list=void 0;var s=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=u(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var l in t)if("default"!==l&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?o(t,l):null;c&&(c.get||c.set)?a(r,l,c):r[l]=t[l]}r.default=t,n&&n.set(t,r);return r}(n(9));function u(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(u=function(t){return t?n:e})(t)}var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];e.list=c;var h={};s.each(c,(function(t,e){h[t]=e}));var f=h;e.map=f},function(t,e,n){t.exports=n(282)},function(t,e,n){t.exports=n(283)},function(t,e,n){t.exports=n(286)},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.LASER_RECEIVED=e.SHAPE_REMOVED=e.SHAPE_UPDATED=e.SHAPE_APPENDED=e.SHAPE_ADDED=e.PAGE_REMOVED=e.PAGE_ADDED=e.PAGE_CHANGED=e.DOC_REMOVED=e.DOC_UPDATED=e.DOC_ADDED=e.DOC_ALL=void 0;e.DOC_ALL="doc-all";e.DOC_ADDED="doc-added";e.DOC_UPDATED="doc-updated";e.DOC_REMOVED="doc-removed";e.PAGE_CHANGED="page-changed";e.PAGE_ADDED="page-added";e.PAGE_REMOVED="page-removed";e.SHAPE_ADDED="shape-added";e.SHAPE_APPENDED="shape-appended";e.SHAPE_UPDATED="shape-updated";e.SHAPE_REMOVED="shape-removed";e.LASER_RECEIVED="laser-received"},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.SHAPE_TEXT_INPUT=e.SHAPE_UPDATE_TRIGGER=e.SHAPE_APPEND_TRIGGER=e.SHAPE_ADD_TRIGGER=e.SHAPE_REMOVE_TRIGGER=e.CANVAS_LOAD_COMPLETE=e.IMAGE_UPLOAD_SUCCESS=e.PAINTER_RECTEARE_TRIGGER=e.WEBGL_CONTEXT_RESTORED=e.WEBGL_CONTEXT_LOST=e.HISTORY_RECORD_CHANGED=e.PAINTER_ERROR=e.PAGE_COUNT_CHANGED=e.STEP_CHANGED=e.PAGE_CHANGED=e.LOADING_ENDED=e.LOADING_START=e.IMAGE_SHAPE_LOAD_FAIL=e.SELECTING_END=e.MOUSE_MOVE=e.DRAWING_END=e.DRAWING_START=void 0;e.DRAWING_START="drawing-start";e.DRAWING_END="drawing-end";e.MOUSE_MOVE="mouse-move";e.SELECTING_END="selecting-end";e.IMAGE_SHAPE_LOAD_FAIL="image-shape-load-fail";e.LOADING_START="loading-start";e.LOADING_ENDED="loading-ended";e.PAGE_CHANGED="page-changed";e.STEP_CHANGED="step-changed";e.PAGE_COUNT_CHANGED="page-count-changed";e.PAINTER_ERROR="painter-error";e.HISTORY_RECORD_CHANGED="history-record-changed";e.WEBGL_CONTEXT_LOST="webgl-context-lost";e.WEBGL_CONTEXT_RESTORED="webgl-context-restored";e.PAINTER_RECTEARE_TRIGGER="painter-recreate-trigger";e.IMAGE_UPLOAD_SUCCESS="image-upload-success";e.CANVAS_LOAD_COMPLETE="painter-load-complete";e.SHAPE_REMOVE_TRIGGER="shape-remove-trigger";e.SHAPE_ADD_TRIGGER="shape-add-trigger";e.SHAPE_APPEND_TRIGGER="shape-append-trigger";e.SHAPE_UPDATE_TRIGGER="shape-update-trigger";e.SHAPE_TEXT_INPUT="shape-text-input"},function(t,e,n){t.exports=n(164)},function(t,e,n){t.exports=!n(22)&&!n(32)((function(){return 7!=Object.defineProperty(n(88)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var i=n(25),r=n(20),a=n(51);t.exports=n(22)?Object.defineProperties:function(t,e){r(t);for(var n,o=a(e),s=o.length,u=0;s>u;)i.f(t,n=o[u++],e[n]);return t}},function(t,e,n){var i=n(33),r=n(36),a=n(167)(!1),o=n(92)("IE_PROTO");t.exports=function(t,e){var n,s=r(t),u=0,l=[];for(n in s)n!=o&&i(s,n)&&l.push(n);for(;e.length>u;)i(s,n=e[u++])&&(~a(l,n)||l.push(n));return l}},function(t,e,n){var i=n(12).document;t.exports=i&&i.documentElement},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var i=n(12),r=n(33),a=n(22),o=n(11),s=n(90),u=n(45).KEY,l=n(32),c=n(93),h=n(53),f=n(67),d=n(19),p=n(96),v=n(97),g=n(172),E=n(98),_=n(20),y=n(16),m=n(40),T=n(36),A=n(89),R=n(49),S=n(50),x=n(173),P=n(54),O=n(69),I=n(25),w=n(51),b=P.f,D=I.f,C=x.f,L=i.Symbol,N=i.JSON,M=N&&N.stringify,k=d("_hidden"),U=d("toPrimitive"),G={}.propertyIsEnumerable,F=c("symbol-registry"),V=c("symbols"),H=c("op-symbols"),W=Object.prototype,B="function"==typeof L&&!!O.f,Y=i.QObject,j=!Y||!Y.prototype||!Y.prototype.findChild,z=a&&l((function(){return 7!=S(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=b(W,e);i&&delete W[e],D(t,e,n),i&&t!==W&&D(W,e,i)}:D,X=function(t){var e=V[t]=S(L.prototype);return e._k=t,e},q=B&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},K=function(t,e,n){return t===W&&K(H,e,n),_(t),e=A(e,!0),_(n),r(V,e)?(n.enumerable?(r(t,k)&&t[k][e]&&(t[k][e]=!1),n=S(n,{enumerable:R(0,!1)})):(r(t,k)||D(t,k,R(1,{})),t[k][e]=!0),z(t,e,n)):D(t,e,n)},J=function(t,e){_(t);for(var n,i=g(e=T(e)),r=0,a=i.length;a>r;)K(t,n=i[r++],e[n]);return t},Q=function(t){var e=G.call(this,t=A(t,!0));return!(this===W&&r(V,t)&&!r(H,t))&&(!(e||!r(this,t)||!r(V,t)||r(this,k)&&this[k][t])||e)},Z=function(t,e){if(t=T(t),e=A(e,!0),t!==W||!r(V,e)||r(H,e)){var n=b(t,e);return!n||!r(V,e)||r(t,k)&&t[k][e]||(n.enumerable=!0),n}},$=function(t){for(var e,n=C(T(t)),i=[],a=0;n.length>a;)r(V,e=n[a++])||e==k||e==u||i.push(e);return i},tt=function(t){for(var e,n=t===W,i=C(n?H:T(t)),a=[],o=0;i.length>o;)!r(V,e=i[o++])||n&&!r(W,e)||a.push(V[e]);return a};B||(s((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===W&&e.call(H,n),r(this,k)&&r(this[k],t)&&(this[k][t]=!1),z(this,t,R(1,n))};return a&&j&&z(W,t,{configurable:!0,set:e}),X(t)}).prototype,"toString",(function(){return this._k})),P.f=Z,I.f=K,n(99).f=x.f=$,n(70).f=Q,O.f=tt,a&&!n(48)&&s(W,"propertyIsEnumerable",Q,!0),p.f=function(t){return X(d(t))}),o(o.G+o.W+o.F*!B,{Symbol:L});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)d(et[nt++]);for(var it=w(d.store),rt=0;it.length>rt;)v(it[rt++]);o(o.S+o.F*!B,"Symbol",{for:function(t){return r(F,t+="")?F[t]:F[t]=L(t)},keyFor:function(t){if(!q(t))throw TypeError(t+" is not a symbol!");for(var e in F)if(F[e]===t)return e},useSetter:function(){j=!0},useSimple:function(){j=!1}}),o(o.S+o.F*!B,"Object",{create:function(t,e){return void 0===e?S(t):J(S(t),e)},defineProperty:K,defineProperties:J,getOwnPropertyDescriptor:Z,getOwnPropertyNames:$,getOwnPropertySymbols:tt});var at=l((function(){O.f(1)}));o(o.S+o.F*at,"Object",{getOwnPropertySymbols:function(t){return O.f(m(t))}}),N&&o(o.S+o.F*(!B||l((function(){var t=L();return"[null]"!=M([t])||"{}"!=M({a:t})||"{}"!=M(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(y(e)||void 0!==t)&&!q(t))return E(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!q(e))return e}),i[1]=e,M.apply(N,i)}}),L.prototype[U]||n(35)(L.prototype,U,L.prototype.valueOf),h(L,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var i=n(20);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var a=t.return;throw void 0!==a&&i(a.call(t)),e}}},function(t,e,n){var i=n(43),r=n(19)("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[r]===t)}},function(t,e,n){"use strict";var i=n(12),r=n(11),a=n(45),o=n(32),s=n(35),u=n(72),l=n(46),c=n(73),h=n(16),f=n(53),d=n(25).f,p=n(100)(0),v=n(22);t.exports=function(t,e,n,g,E,_){var y=i[t],m=y,T=E?"set":"add",A=m&&m.prototype,R={};return v&&"function"==typeof m&&(_||A.forEach&&!o((function(){(new m).entries().next()})))?(m=e((function(e,n){c(e,m,t,"_c"),e._c=new y,null!=n&&l(n,E,e[T],e)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(t){var e="add"==t||"set"==t;!(t in A)||_&&"clear"==t||s(m.prototype,t,(function(n,i){if(c(this,m,t),!e&&_&&!h(n))return"get"==t&&void 0;var r=this._c[t](0===n?0:n,i);return e?this:r}))})),_||d(m.prototype,"size",{get:function(){return this._c.size}})):(m=g.getConstructor(e,t,E,T),u(m.prototype,n),a.NEED=!0),f(m,t),R[t]=m,r(r.G+r.W+r.F,R),_||g.setStrong(m,t,E),m}},function(t,e,n){"use strict";var i=n(11);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var i=n(11),r=n(39),a=n(31),o=n(46);t.exports=function(t){i(i.S,t,{from:function(t){var e,n,i,s,u=arguments[1];return r(this),(e=void 0!==u)&&r(u),null==t?new this:(n=[],e?(i=0,s=a(u,arguments[2],2),o(t,!1,(function(t){n.push(s(t,i++))}))):o(t,!1,n.push,n),new this(n))}})}},function(t,e,n){var i=n(20),r=n(39),a=n(19)("species");t.exports=function(t,e){var n,o=i(t).constructor;return void 0===o||null==(n=i(o)[a])?e:r(n)}},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var i=n(20),r=n(16),a=n(103);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=a.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var i=n(12),r=n(7),a=n(25),o=n(22),s=n(19)("species");t.exports=function(t){var e="function"==typeof r[t]?r[t]:i[t];o&&e&&!e[s]&&a.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(19)("iterator"),r=!1;try{var a=[7][i]();a.return=function(){r=!0},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var a=[7],o=a[i]();o.next=function(){return{done:n=!0}},a[i]=function(){return o},t(a)}catch(t){}return n}},function(t,e,n){(function(e,n){t.exports=function(){"use strict";var t=!0,i=!1,r=null,a=void 0,o="undefined",s="length",u="function",l=".",c=typeof window!==o?window:a,h=typeof e!==o?e:c,f=function(){},d=Object.freeze({}),p=Object.freeze([]),v="";function g(t){return typeof t===u}function E(t){return Array.isArray(t)}function _(t){return t!==r&&"object"==typeof t}function y(t){return"string"==typeof t}function m(t){return"number"==typeof t&&!isNaN(t)}function T(t){return"boolean"==typeof t}function A(t){return m(t)||y(t)&&!isNaN(parseFloat(t))&&isFinite(t)}var R=Object.freeze({__proto__:null,func:g,array:E,object:_,string:y,number:m,boolean:T,numeric:A});function S(t,e,n){if(g(t))return E(n)?t.apply(e,n):e!==a?t.call(e,n):n!==a?t(n):t()}var x=function(t,e){this.type=t,this.phase=x.PHASE_CURRENT,e&&(this.originalEvent=e)};function P(t,e,n){var r=t.length;if(r)if(n)for(var a=r-1;a>=0&&e(t[a],a)!==i;a--);else for(var o=0;o<r&&e(t[o],o)!==i;o++);}function O(t,e){t[t.length]=e}function I(t,e){t.unshift(e)}function w(t,e,n){E(e)?P(e,(function(e){n(t,e)})):n(t,e)}function b(t,e){w(t,e,O)}function D(t,e){w(t,e,I)}function C(t,e,n){var r=-1;return P(t,(function(t,a){if(n===i?t==e:t===e)return r=a,i})),r}function L(e,n,r){var a=0;return P(e,(function(t,o){(r===i?t==n:t===n)&&(e.splice(o,1),a++)}),t),a}function N(t,e,n){return C(t,e,n)>=0}function M(t){return!E(t)||!t.length}x.is=function(t){return t instanceof x},x.prototype.preventDefault=function(){var e=this;if(!e.isPrevented){var n=e.originalEvent;n&&n.preventDefault(),e.isPrevented=t}return e},x.prototype.stopPropagation=function(){var e=this;if(!e.isStoped){var n=e.originalEvent;n&&n.stopPropagation(),e.isStoped=t}return e},x.prototype.prevent=function(){return this.preventDefault()},x.prototype.stop=function(){return this.stopPropagation()},x.PHASE_CURRENT=0,x.PHASE_UPWARD=1,x.PHASE_DOWNWARD=-1;var k=Object.freeze({__proto__:null,each:P,push:b,unshift:D,indexOf:C,last:function(t){var e=t.length;if(e>0)return t[e-1]},pop:function(t){if(t.length>0)return t.pop()},remove:L,has:N,toArray:function(t){return E(t)?t:S(p.slice,t)},toObject:function(t,e,n){var i={};return P(t,(function(t){i[e?t[e]:t]=n||t})),i},join:function(t,e){return t.join(e)},falsy:M}),U=/-([a-z])/gi,G=/\B([A-Z])/g,F=/^[a-z]/,V={},H={},W={};function B(t,e,n){return m(n)?e===n?v:t.slice(e,n):t.slice(e)}function Y(t,e,n){return t.indexOf(e,n!==a?n:0)}function j(t,e,n){return t.lastIndexOf(e,n!==a?n:t.length)}function z(t,e){return 0===Y(t,e)}function X(t,e){return t.charCodeAt(e||0)}function q(t){return t.toUpperCase()}function K(t){return t.toLowerCase()}function J(t,e){return Y(t,e)>=0}function Q(t){return!y(t)||!t.length}var Z=Object.freeze({__proto__:null,camelize:function(t){return V[t]||(V[t]=t.replace(U,(function(t,e){return q(e)}))),V[t]},hyphenate:function(t){return H[t]||(H[t]=t.replace(G,(function(t,e){return"-"+K(e)}))),H[t]},capitalize:function(t){return W[t]||(W[t]=t.replace(F,q)),W[t]},trim:function(t){return Q(t)?v:t.trim()},slice:B,indexOf:Y,lastIndexOf:j,startsWith:z,endsWith:function(t,e){var n=t.length-e.length;return n>=0&&j(t,e)===n},charAt:function(t,e){return t.charAt(e||0)},codeAt:X,upper:q,lower:K,has:J,falsy:Q}),$=/\./g,tt=/\*/g,et=/\*\*/g,nt={},it={};function rt(t,e){var n;E(nt[t])?n=nt[t]:(n=Y(t,l)<0?[t]:t.split(l),nt[t]=n);for(var r=0,a=n.length-1;r<=a&&e(n[r],r,a)!==i;r++);}function at(t,e){var n=it[e];if(!n){var i=e.replace($,"\\.").replace(tt,"(\\w+)").replace(et,"([.\\w]+?)");n=it[e]=new RegExp("^"+i+"$")}var r=t.match(n);if(r)return r[1]}var ot={value:a};function st(t){return Object.keys(t)}function ut(t,e){for(var n in t)if(e(t[n],n)===i)break}function lt(t){ut(t,(function(e,n){delete t[n]}))}function ct(t,e){return ut(e,(function(e,n){t[n]=e})),t}function ht(t,e){var n=t;return E(t)?e?(n=[],P(t,(function(t,i){n[i]=ht(t,e)}))):n=t.slice():_(t)&&(n={},ut(t,(function(t,i){n[i]=e?ht(t,e):t}))),n}function ft(t,e){return rt(e,(function(e,n,o){if(t==r)return t=a,i;var s=t[e],u=s!==a;s&&g(s.get)&&(s=s.get()),n===o?u?(ot.value=s,t=ot):t=a:t=s})),t}function dt(t,e){return t[e]!==a}var pt=Object.freeze({__proto__:null,keys:st,each:ut,clear:lt,extend:ct,merge:function(t,e){return t&&e?ct(ct({},t),e):t||e},copy:ht,get:ft,set:function(t,e,n,r){rt(e,(function(e,a,o){if(a===o)t[e]=n;else if(t[e])t=t[e];else{if(!r)return i;t=t[e]={}}}))},has:dt,falsy:function(t){return!_(t)||E(t)||!st(t).length}});function vt(t,e){return t!=r&&t.toString?t.toString():e!==a?e:v}var gt=typeof console!==o?console:r,Et=/yox/.test(vt(f))?2:3,_t=c&&/edge|msie|trident/i.test(c.navigator.userAgent)?v:"%c",yt=gt?_t?function(t,e,n){gt.log(_t+t,n,e)}:function(t,e){gt.log(t,e)}:f;function mt(){if(h){var t=h.YOX_LOG_LEVEL;if(t>=1&&t<=5)return t}return Et}function Tt(t){return"background-color:"+t+";border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;"}var At=Object.freeze({__proto__:null,DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5,debug:function(t,e){mt()<=1&&yt(e||"Yox debug",t,Tt("#999"))},info:function(t,e){mt()<=2&&yt(e||"Yox info",t,Tt("#2db7f5"))},warn:function(t,e){mt()<=3&&yt(e||"Yox warn",t,Tt("#f90"))},error:function(t,e){mt()<=4&&yt(e||"Yox error",t,Tt("#ed4014"))},fatal:function(t,e){if(mt()<=5)throw new Error("["+(e||"Yox fatal")+"]: "+t)}}),Rt=function(t){this.ns=t||i,this.listeners={}};function St(e,n){return e?e===n.listener:t}function xt(e,n){var i=n.ns;return i&&e?i===e:t}function Pt(t){return g(t)&&J(vt(t),"[native code]")}Rt.prototype.fire=function(e,n,r){var o=this,s=y(e)?o.toEvent(e):e,u=o.listeners[s.type],l=t;if(u){u=u.slice();for(var c=n&&x.is(n[0])?n[0]:a,h=0,f=u.length;h<f;h++){var d=u[h];if(xt(s.ns,d)&&N(u,d)&&(!r||r(s,n,d))){c&&(c.listener=d.listener);var p=S(d.listener,d.ctx,n);if(c&&(c.listener=a),d.num=d.num?d.num+1:1,d.num===d.max&&o.off(s.type,{ns:s.ns,listener:d.listener}),c&&(p===i?c.prevent().stop():c.isStoped&&(p=i)),p===i){l=i;break}}}}return l},Rt.prototype.on=function(t,e){var n=this.listeners,i=g(e)?{listener:e}:e;if(_(i)&&g(i.listener)){if(!y(i.ns)){var r=this.toEvent(t);i.ns=r.ns,t=r.type}b(n[t]||(n[t]=[]),i)}},Rt.prototype.off=function(e,n){var i=this,r=i.listeners;if(e){var a=i.toFilter(e,n),o=function(e,n){P(e,(function(t,n){St(a.listener,t)&&xt(a.ns,t)&&e.splice(n,1)}),t),e.length||delete r[n]};a.type?r[a.type]&&o(r[a.type],a.type):a.ns&&ut(r,o)}else i.listeners={}},Rt.prototype.has=function(e,n){var r=this.listeners,a=this.toFilter(e,n),o=t,s=function(t){return P(t,(function(t){if(St(a.listener,t)&&xt(a.ns,t))return o=i})),o};return a.type?r[a.type]&&s(r[a.type]):a.ns&&ut(r,s),!o},Rt.prototype.toEvent=function(t){var e={type:t,ns:v};if(this.ns){var n=Y(t,l);n>=0&&(e.type=B(t,0,n),e.ns=B(t,n+1))}return e},Rt.prototype.toFilter=function(t,e){var n;if(y((n=e?g(e)?{listener:e}:e:{}).ns))n.type=t;else{var i=this.toEvent(t);n.type=i.type,n.ns=i.ns}return n},typeof n===u&&Pt(n);var Ot,It=typeof MessageChannel===u&&Pt(MessageChannel)?function(t){var e=new MessageChannel;e.port1.onmessage=t,e.port2.postMessage(1)}:setTimeout,wt=function(){this.tasks=[]};function bt(t,e){return A(t)?+t:e!==a?e:0}wt.shared=function(){return Ot||(Ot=new wt)},wt.prototype.append=function(t,e){var n=this,i=n.tasks;b(i,{fn:t,ctx:e}),1===i.length&&It((function(){n.run()}))},wt.prototype.prepend=function(t,e){var n=this,i=n.tasks;D(i,{fn:t,ctx:e}),1===i.length&&It((function(){n.run()}))},wt.prototype.clear=function(){this.tasks.length=0},wt.prototype.run=function(){var t=this.tasks;t.length&&(this.tasks=[],P(t,(function(t){S(t.fn,t.ctx)})))};var Dt=function(e,n,i,r,a,o,s){var u=this;u.keypath=e,u.cache=i,u.deps=r,u.context=a.context,u.observer=a,u.getter=o,u.setter=s,u.unique={},u.watcher=function(n,i,r){var o=u.value,s=u.get(t);s!==o&&a.diff(e,s,o)},u.watcherOptions={sync:n,watcher:u.watcher},(u.fixed=!M(r))&&P(r,(function(t){a.watch(t,u.watcherOptions)}))};function Ct(t,e){if(t==r||e===v)return t;var n=ft(t,e);return n?n.value:void 0}function Lt(e,n,i,r,o){var u=function(t,n,i){if(n!==i){var s=(c=t,(u=e)&&c?u+l+c:u||c);P(r,(function(t){at(s,t)!==a&&o(t,s,n,i)})),Lt(s,n,i,r,o)}var u,c};(function(e,n,i){var r=y(e),o=y(n);if(r||o)return i(s,r?e.length:a,o?n.length:a),t})(n,i,u)||function(e,n,i){var r=E(e),o=E(n);if(r||o){var u=r?e.length:a,l=o?n.length:a;i(s,u,l);for(var c=0,h=Math.max(u||0,l||0);c<h;c++)i(""+c,e?e[c]:a,n?n[c]:a);return t}}(n,i,u)||function(t,e,n){var i=_(t),r=_(e);(i||r)&&(t=i?t:d,e=r?e:d,i&&ut(t,(function(t,i){t!==e[i]&&n(i,t,e[i])})),r&&ut(e,(function(e,i){e!==t[i]&&n(i,t[i],e)})))}(n,i,u)}function Nt(t,e,n,i,r,o){var s;ut(i,(function(i,u){if(function(t){return J(t,"*")}(u))at(t,u)!==a?o(u,t,e,n):r&&(s?b(s,u):s=[u]);else{var c=function(t,e){return t===e||z(t,e+=l)?e.length:-1}(u,t);if(c>=0){var h=B(u,c),f=Ct(e,h),d=Ct(n,h);f!==d&&o(u,u,f,d)}}})),s&&Lt(t,e,n,s,o)}function Mt(t,e,n){if(n.count&&e)return n.count--,e[0]!==e[1]}Dt.prototype.get=function(t){var e=this,n=e.getter,i=e.context;if(e.cache){if(t||!dt(e,"value"))if(e.fixed)e.value=S(n,i);else{e.unbind();var r=Dt.current;Dt.current=e,e.value=S(n,i),e.bind(),Dt.current=r}}else e.value=S(n,i);return e.value},Dt.prototype.set=function(t){var e=this.setter,n=this.context;e&&e.call(n,t)},Dt.prototype.add=function(e){this.unique[e]=t},Dt.prototype.bind=function(){var t=this,e=t.unique,n=t.deps,i=t.observer,r=t.watcherOptions;ut(e,(function(t,e){b(n,e),i.watch(e,r)})),this.unique={}},Dt.prototype.unbind=function(){var e=this,n=e.deps,i=e.observer,r=e.watcher;P(n,(function(t){i.unwatch(t,r)}),t),n.length=0};var kt={watcher:f};function Ut(e,n){return g(e)?(kt.watcher=e,kt.immediate=n===t,kt):e&&e.watcher?e:void 0}var Gt=function(t,e){var n=this;n.data=t||{},n.context=e||n,n.nextTask=new wt,n.syncEmitter=new Rt,n.asyncEmitter=new Rt,n.asyncChanges={}};Gt.prototype.get=function(t,e,n){var i,r=Dt.current,a=this.data,o=this.computed;return t===v?a:(r&&!n&&r.add(t),o&&(i=ft(o,t)),i||(i=ft(a,t)),i?i.value:e)},Gt.prototype.set=function(t,e){var n=this,i=n.data,r=n.computed,a=function(t,e){var a,o=n.get(e);t!==o&&(rt(e,(function(e,n,o){0!==n?a&&(n===o?a[e]=t:a=a[e]||(a[e]={})):r&&r[e]?0===o?r[e].set(t):a=r[e].get():0===o?i[e]=t:a=i[e]||(i[e]={})})),n.diff(e,t,o))};y(t)?a(e,t):_(t)&&ut(t,a)},Gt.prototype.diff=function(e,n,i){var r=this,o=r.syncEmitter,s=r.asyncEmitter,u=r.asyncChanges,l=36!==X(e);Nt(e,n,i,o.listeners,l,(function(t,e,n,i){o.fire({type:t,ns:v},[n,i,e])})),Nt(e,n,i,s.listeners,l,(function(e,n,i,o){P(s.listeners[e],(function(t){t.count++}));var l=(u[n]||(u[n]={value:o,keypaths:[]})).keypaths;N(l,e)||b(l,e),r.pending||(r.pending=t,r.nextTask.append((function(){r.pending&&(r.pending=a,r.diffAsync())})))}))},Gt.prototype.diffAsync=function(){var t=this,e=t.asyncEmitter,n=t.asyncChanges;t.asyncChanges={},ut(n,(function(n,i){var r=[t.get(i),n.value,i];P(n.keypaths,(function(t){e.fire({type:t,ns:v},r,Mt)}))}))},Gt.prototype.addComputed=function(e,n){var i,r,a=t,o=t,s=[];if(g(n))i=n;else if(_(n)){var u=n;T(u.cache)&&(a=u.cache),T(u.sync)&&(o=u.sync),E(u.deps)&&(s=ht(u.deps)),g(u.get)&&(i=u.get),g(u.set)&&(r=u.set)}if(i){var l=this,c=new Dt(e,o,a,s,l,i,r);return l.computed||(l.computed={}),l.computed[e]=c,c}},Gt.prototype.removeComputed=function(t){var e=this.computed;e&&dt(e,t)&&delete e[t]},Gt.prototype.watch=function(t,e,n){var i=this,r=i.context,o=i.syncEmitter,s=i.asyncEmitter,u=function(t,e){var n=e.sync?o:s,u={ns:v,listener:e.watcher,ctx:r,count:0};e.once&&(u.max=1),n.on(t,u),e.immediate&&S(e.watcher,r,[i.get(t),a,t])};y(t)?u(t,Ut(e,n)):ut(t,(function(t,e){u(e,Ut(t))}))},Gt.prototype.unwatch=function(t,e){var n={ns:v,listener:e};this.syncEmitter.off(t,n),this.asyncEmitter.off(t,n)},Gt.prototype.toggle=function(t){var e=!this.get(t);return this.set(t,e),e},Gt.prototype.increase=function(t,e,n){var i=bt(this.get(t),0)+(e||1);if(!m(n)||i<=n)return this.set(t,i),i},Gt.prototype.decrease=function(t,e,n){var i=bt(this.get(t),0)-(e||1);if(!m(n)||i>=n)return this.set(t,i),i},Gt.prototype.insert=function(e,n,r){var a=this.get(e),o=(a=E(a)?ht(a):[]).length;if(r===t||r===o)a.push(n);else if(r===i||0===r)a.unshift(n);else{if(!(r>0&&r<o))return;a.splice(r,0,n)}return this.set(e,a),t},Gt.prototype.append=function(e,n){return this.insert(e,n,t)},Gt.prototype.prepend=function(t,e){return this.insert(t,e,i)},Gt.prototype.removeAt=function(e,n){var i=this.get(e);if(E(i)&&n>=0&&n<i.length)return(i=ht(i)).splice(n,1),this.set(e,i),t},Gt.prototype.remove=function(e,n){var i=this.get(e);if(E(i)&&L(i=ht(i),n))return this.set(e,i),t},Gt.prototype.copy=function(t,e){return ht(t,e)},Gt.prototype.destroy=function(){var t=this;t.syncEmitter.off(),t.asyncEmitter.off(),t.nextTask.clear(),lt(t)};var Ft=function(e){var n=this,i=e||d;n.$emitter=new Rt(t),i.events&&n.on(i.events);var r=i.data,a=i.props,o=(i.vnode,i.propTypes,i.computed),s=i.methods,u=i.watchers,l=i.extensions;n.$options=i,l&&ct(n,l);var c=a?ht(a):{},h=n.$observer=new Gt(c,n);o&&ut(o,(function(t,e){h.addComputed(e,t)}));var f=g(r)?S(r,n,e):r;_(f)&&ut(f,(function(t,e){c[e]=t})),s&&ut(s,(function(t,e){n[e]=t})),u&&n.watch(u)};function Vt(t,e,n,i){var r=t.$emitter.toFilter(e,n),a={listener:r.listener,ns:r.ns,ctx:t};i&&(a.max=1),t.$emitter.on(r.type,a)}function Ht(t,e,n,i){y(e)?Vt(t,e,n,i):ut(e,(function(e,n){Vt(t,n,e,i)}))}return Ft.define=function(t){return t},Ft.use=function(t){t.install(Ft)},Ft.nextTick=function(t,e){wt.shared().append(t,e)},Ft.compile=function(t,e){return t},Ft.directive=function(t,e){},Ft.transition=function(t,e){},Ft.component=function(t,e){},Ft.partial=function(t,e){},Ft.filter=function(t,e){},Ft.prototype.get=function(t,e){return this.$observer.get(t,e)},Ft.prototype.set=function(t,e){var n=this.$observer;n&&n.set(t,e)},Ft.prototype.on=function(t,e){return Ht(this,t,e),this},Ft.prototype.once=function(e,n){return Ht(this,e,n,t),this},Ft.prototype.off=function(t,e){return this.$emitter.off(t,e),this},Ft.prototype.fire=function(e,n,i){var r,o=this,s=o.$emitter,u=o.$parent,l=o.$children;if(x.is(e))r=e;else if(y(e))r=new x(e);else{var c=e;(r=new x(c.type)).ns=c.ns}if(r.ns===a){var h=s.toEvent(r.type);r.type=h.type,r.ns=h.ns}r.target||(r.target=o);var f,d=[r];return _(n)?b(d,n):n===t&&(i=t),(f=i&&r.target===o?t:s.fire(r,d))&&(i?l&&(r.phase=x.PHASE_DOWNWARD,P(l,(function(e){return f=e.fire(r,n,t)}))):u&&(r.phase=x.PHASE_UPWARD,f=u.fire(r,n))),f},Ft.prototype.watch=function(t,e,n){return this.$observer.watch(t,e,n),this},Ft.prototype.unwatch=function(t,e){return this.$observer.unwatch(t,e),this},Ft.prototype.loadComponent=function(t,e){},Ft.prototype.createComponent=function(t,e){return this},Ft.prototype.directive=function(t,e){},Ft.prototype.transition=function(t,e){},Ft.prototype.component=function(t,e){},Ft.prototype.partial=function(t,e){},Ft.prototype.filter=function(t,e){},Ft.prototype.forceUpdate=function(t){},Ft.prototype.render=function(){},Ft.prototype.update=function(t,e){},Ft.prototype.checkProp=function(t,e){},Ft.prototype.destroy=function(){var t=this,e=(t.$parent,t.$options,t.$emitter);t.$observer.destroy(),e.off(),lt(t)},Ft.prototype.nextTick=function(t){this.$observer.nextTask.append(t,this)},Ft.prototype.toggle=function(t){return this.$observer.toggle(t)},Ft.prototype.increase=function(t,e,n){return this.$observer.increase(t,e,n)},Ft.prototype.decrease=function(t,e,n){return this.$observer.decrease(t,e,n)},Ft.prototype.insert=function(t,e,n){return this.$observer.insert(t,e,n)},Ft.prototype.append=function(t,e){return this.$observer.append(t,e)},Ft.prototype.prepend=function(t,e){return this.$observer.prepend(t,e)},Ft.prototype.removeAt=function(t,e){return this.$observer.removeAt(t,e)},Ft.prototype.remove=function(t,e){return this.$observer.remove(t,e)},Ft.prototype.copy=function(t,e){return this.$observer.copy(t,e)},Ft.version="1.0.0-alpha.125",Ft.is=R,Ft.array=k,Ft.object=pt,Ft.string=Z,Ft.logger=At,Ft.Event=x,Ft.Emitter=Rt,Ft}()}).call(this,n(58),n(199).setImmediate)},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.default=function(t,e){var n=[];s.number(t)&&(t+="");t&&s.string(t)&&u.each(t.split(e),(function(t,e){(t=t.trim())&&n.push(t)}));return n};var s=c(n(8)),u=c(n(9));function l(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(l=function(t){return t?n:e})(t)}function c(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=l(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var c=s?o(t,u):null;c&&(c.get||c.set)?a(r,u,c):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}},function(t,e,n){var i=n(11),r=n(65),a=n(32),o=n(104),s="["+o+"]",u=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),c=function(t,e,n){var r={},s=a((function(){return!!o[t]()||"​"!="​"[t]()})),u=r[t]=s?e(h):o[t];n&&(r[n]=u),i(i.P+i.F*s,"String",r)},h=c.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(l,"")),t};t.exports=c},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.default=function(t,e){return s.numeric(t)?+t:e!==u.UNDEFINED?e:0};var s=c(n(8)),u=c(n(18));function l(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(l=function(t){return t?n:e})(t)}function c(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=l(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var c=s?o(t,u):null;c&&(c.get||c.set)?a(r,u,c):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=s(n(34)),h=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(10));function f(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(f=function(t){return t?n:e})(t)}var d=(0,c.default)({},"document",0),p=function(){function t(e){(0,u.default)(this,t),this.store=void 0,this.store=e}return(0,l.default)(t,[{key:"code",get:function(){return this.store.get("class.rtmAbilities",0)}},{key:"canUseDocument",value:function(){return!!((this.code>>d.document)%2)}},{key:"getAbilities",value:function(){return{document:this.canUseDocument()}}},{key:"isEnable",value:function(t){return!!((this.code>>d[t])%2)}},{key:"getAbilitiesCode",value:function(t,e){var n=this,i=0;return h.each(d,(function(r,a){a===t?e&&(i+=Math.pow(2,r)):n.isEnable(a)&&(i+=Math.pow(2,r))})),i}}]),t}();e.default=p,p.ABILITY_DOCUMENT="document"},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(){return"https:"===location.protocol||"file:"===location.protocol}},function(t,e,n){t.exports=n(234)},function(t,e,n){t.exports=n(236)},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.generateUUID=function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)}))},e.callbackToPromise=function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new a.default((function(r,a){i&&e.push((function(t){r(t)})),e.push((function(t){a(t)})),(0,o.default)(t,n,e),i||(0,s.default)((function(){r()}))}))},e.timestamp=function(){return Math.floor((new Date).getTime()/1e3)},e.timestampMillisecond=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(new Date).getTime()+t};var a=r(n(17)),o=r(n(13)),s=r(n(81))},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=function t(e){var n=u.array(e)?[]:{};u.array(e)?c.each(e,(function(e,i){(u.isPlainObject(e)||u.array(e))&&(e=t(e)),n[(0,h.default)(i)]=e})):l.each(e,(function(e,i){(u.isPlainObject(e)||u.array(e))&&(e=t(e)),n[(0,h.default)(i)]=e}));return n};var u=d(n(8)),l=d(n(10)),c=d(n(9)),h=s(n(264));function f(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(f=function(t){return t?n:e})(t)}function d(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.ERROR=void 0;e.ERROR="error"},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.USER_REPORT=e.USER_COUNT_CHANGED=e.USER_AUTH_CHANGED=e.USER_OUT=e.USER_IN=void 0;e.USER_IN="user-in";e.USER_OUT="user-out";e.USER_AUTH_CHANGED="user-auth-changed";e.USER_COUNT_CHANGED="user-count-changed";e.USER_REPORT="user-report"},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=function(t,e,n){var i;function r(r,a){i=setTimeout((function(){n||(0,u.default)(t,r,a),clearTimeout(i),i=null}),e)}return function(){var e=this,a=l.toArray(arguments);i||(n&&(0,u.default)(t,e,a),r(e,a))}};var u=s(n(13)),l=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(9));function c(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(c=function(t){return t?n:e})(t)}},function(t,e,n){var i=n(273),r=n(274),a=n(152),o=n(279);t.exports=function(t){return i(t)||r(t)||a(t)||o()}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}},function(t,e,n){"use strict";var i=n(25),r=n(49);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){t.exports=n(277)},function(t,e,n){var i=n(110),r=n(149);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?i(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.MESSAGE_REVOKED=e.MESSAGE_WHISPER_REVEIVED=e.MESSAGE_RECEIVED=void 0;e.MESSAGE_RECEIVED="message-received";e.MESSAGE_WHISPER_REVEIVED="message-whisper-received";e.MESSAGE_REVOKED="message-revoked"},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(26)),l=s(n(5)),c=s(n(6)),h=_(n(18)),f=_(n(77)),d=_(n(9)),p=_(n(8)),v=_(n(10)),g=s(n(13));function E(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(E=function(t){return t?n:e})(t)}function _(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=E(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var y=function(){function t(e){(0,l.default)(this,t),this.map=void 0,this.ns=void 0,this.ns=e,this.map=new u.default}return(0,c.default)(t,[{key:"add",value:function(t,e){var n=p.func(e)?{fn:e}:e;if(p.object(n)&&p.func(n.fn)){var i=p.string(t)?this.parse(t):t;n.ns=i.ns;var r=this.map.get(i.type);p.array(r)?r.push(n):this.map.set(i.type,[n])}}},{key:"remove",value:function(t,e){var n,i,r=this;if(t){var a=p.string(t)?this.parse(t):t,o=T(e);a.type?this.map.get(a.type)&&(n=this.map.get(a.type),i=a.type,d.each(n,(function(t,e){o(t)&&n.splice(e,1)}),h.TRUE),n.length||r.map.delete(i)):a.ns&&this.map.forEach((function(t,e){d.each(t,(function(e,n){A(a.ns,e)&&t.splice(n,1)}),h.TRUE),t.length||r.map.delete(e)}))}else this.map.clear()}},{key:"execute",value:function(t,e,n){var i=this,r=p.string(t)?i.parse(t):t,a=this.map.get(r.type),o=h.TRUE;if(a)return a=v.copy(a),d.each(a,(function(t){if(!(r.ns&&!A(r.ns,t)||!d.has(a,t)||n&&!n(r,e,t))){var s=(0,g.default)(t.fn,t.ctx,e);return t.num=t.num?t.num+1:1,t.num===t.max&&i.remove(r,t.fn),s===h.FALSE?o=h.FALSE:void 0}})),o}},{key:"has",value:function(t,e){var n,i=h.TRUE;if(t){var r=p.string(t)?this.parse(t):t,a=T(e);r.type?this.map.get(r.type)&&(n=this.map.get(r.type),r.type,d.each(n,(function(t,e){if(a(t))return i=h.FALSE}),h.TRUE)):r.ns&&this.map.forEach((function(t,e){return d.each(t,(function(t,e){if(A(r.ns,t))return i=h.FALSE}),h.TRUE),i}))}return!i}},{key:"parse",value:function(t){var e={type:t,ns:h.EMPTY_STRING};if(this.ns){var n=f.indexOf(t,h.RAW_DOT);n>=0&&(e.type=f.slice(t,0,n),e.ns=f.slice(t,n+1))}return e}},{key:"destroy",value:function(){this.map.clear(),this.map=null}}]),t}();function m(){return h.TRUE}function T(t){return p.func(t)?function(e){return t===e.fn}:m}function A(t,e){var n=e.ns;return n&&t?n===t:h.FALSE}e.default=y},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=e.LINE_DASH_TYPES=void 0;var u,l=s(n(14)),c=s(n(15)),h=s(n(5)),f=s(n(6)),d=s(n(34)),p=s(n(156)),v=I(n(116)),g=I(n(305)),E=n(157),_=s(n(108)),y=s(n(158)),m=I(n(8)),T=s(n(41)),A=I(n(9)),R=I(n(10)),S=s(n(81)),x=s(n(27)),P=s(n(159));function O(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(O=function(t){return t?n:e})(t)}function I(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=O(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}u=(u=window.nativeDevicePixelRatio||window.devicePixelRatio)>1?Math.floor(u):1;var w=0,b=!0,D=[[],[10,10]];function C(t,e,n){return t+"-"+e+(n?"-"+n:"")}function L(t){return(""+t).slice(0,t<0?9:8)}function N(t,e,n,i){var r=R.extend({},t),a=e.width/u,o=e.height/u*n;if(r.name===p.default.shapeType.LINE)r.x=r.points[0].x,r.y=r.points[0].y;else if(r.name===p.default.shapeType.IMAGE){var s=r.width/a,l=r.height/o;i&&(s/=2,l/=2),r.points=[{x:r.x,y:r.y},{x:r.x+s,y:r.y},{x:r.x+s,y:r.y+l},{x:r.x,y:r.y+l}],r.width=r.imageWidth/a,r.height=r.imageHeight/o}else r.name===p.default.shapeType.CIRCLE&&(r.height=r.height/(i?n:1));return r.name!==p.default.shapeType.CIRCLE&&r.name!==p.default.shapeType.TEXT&&(r.autoClosePath=r.name!==p.default.shapeType.DOODLE,r.smooth=r.name===p.default.shapeType.DOODLE&&r.points&&r.points.length>2,r.name=r.name===p.default.shapeType.IMAGE?"Bitmap":"Doodle"),r.points&&(r.points=r.points.map((function(t){return{x:L(t.x),y:L(t.y)}})),r.points.length&&(r.x||(r.x=r.points[0].x),r.y||(r.y=r.points[0].y))),r.fontSize&&(r.fontSize=L(r.fontSize/a),r.fontSize=Math.max(1e-4,r.fontSize),r.fontSize=Math.min(1,r.fontSize)),m.boolean(r.bold)&&(r.fontWeight=r.bold?1:0),r.maxWidth&&(r.maxWidth=L(r.maxWidth/a)),r.width&&(r.width=L(r.width)),r.height&&(r.height=L(r.height)),m.number(r.angle)&&"Bitmap"===r.name&&(r.rotate=r.angle*Math.PI/180,delete r.angle),m.number(r.x)&&(r.x=L(r.x)),m.number(r.y)&&(r.y=L(r.y)),r.dash?r.dashType=1:(delete r.dash,delete r.dashSegments),r.label&&(r.userName=r.label,delete r.label),r.name===p.default.shapeType.CIRCLE||r.name===p.default.shapeType.TEXT||r.autoClosePath||(r.fillAlpha=0,r.fillStyle="#000000"),r.name===p.default.shapeType.CIRCLE?r.name="Oval":r.name===p.default.shapeType.TEXT&&(r.name="Text",r.fillAlpha=1,r.strokeAlpha=0),r.ended&&(r.isEnd=r.ended),delete r.ended,r}function M(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=e.width/u,o=e.height/u*n,s=R.extend({},t);if(null==s.strokeAlpha&&null==s.fillAlpha&&(s.fillStyle&&s.close?(s.fillAlpha=1,s.strokeAlpha=0):s.strokeStyle&&(s.fillAlpha=0,s.strokeAlpha=1)),s.isFill=!!s.fillAlpha,s.isStroke=!!s.strokeAlpha,s.isEnd&&(s.ended=s.isEnd),s.points&&(s.points=s.points.map((function(t){return{x:+t.x,y:+t.y}}))),s.fontSize&&(s.fontSize=Math.max(1e-4,s.fontSize),s.fontSize=Math.min(1,s.fontSize),s.fontSize=Math.ceil(s.fontSize*a)),(0,T.default)(s.fontWeight)&&!(0,T.default)(s.bold)&&(s.bold=!!s.fontWeight),s.maxWidth&&(s.maxWidth=Math.ceil(s.maxWidth*a)),s.width&&(s.width=+s.width),s.height&&(s.height=+s.height),m.number(s.rotate)&&(s.angle=Math.floor(180*s.rotate/Math.PI)),s.x&&(s.x=+s.x),s.y&&(s.y=+s.y),s.dashType?(s.dash=!0,s.dashSegments=D[t.dashType]):s.dash=!1,s.userName&&(s.label=s.userName,delete s.userName),s.close=!!s.autoClosePath,delete s.autoClosePath,"Text"!==t.name||s.fontFamily||(s.fontFamily=E.DEFALUT_FONT_FAMILY),t.points||("Arrow"===t.name&&(s.points=[{x:s.x,y:s.y},{x:s.endX,y:s.endY}],s.lineWidth=s.thickness,s.name=p.default.shapeType.ARROW),"Rect"===t.name&&(s.points=[{x:s.x,y:s.y},{x:s.x+s.width,y:s.y+s.height}],s.name=p.default.shapeType.RECT)),"Bitmap"===s.name?(s.width=Math.floor((s.points[1].x-s.x)*a),s.height=Math.floor((s.points[2].y-s.y)*o),s.points=[s.points[0]],s.name=p.default.shapeType.IMAGE,i&&(s.width*=2,s.height*=2)):"Text"===s.name?(s.points=[{x:s.x,y:s.y}],s.name=p.default.shapeType.TEXT,s.isFill=!1,s.strokeAlpha=1,s.fillAlpha=0):"Oval"===s.name&&(s.points=[{x:s.x+s.width/2,y:s.y+s.height/2}],s.a=s.width/2,s.b=s.height*(i?n:1)/2,s.name=p.default.shapeType.CIRCLE),s.name="Doodle"===s.name?s.close?"Polygon":"Doodle":s.name,"Polygon"===s.name)switch(s.points.length){case 2:s.name=p.default.shapeType.LINE;break;default:s.name=p.default.shapeType.PATH}else"Doodle"===s.name?2!==s.points.length||r?(s.name=p.default.shapeType.DOODLE,1===s.points.length&&s.points.push({x:s.points[0].x+1/a,y:s.points[0].y+1/o})):s.name=p.default.shapeType.LINE:"Oval"===s.name&&(s.name=p.default.shapeType.CIRCLE);return s.name===p.default.shapeType.DOODLE&&1===s.fillAlpha&&1===s.strokeAlpha&&(s.fillAlpha=0,s.isFill=!1,s.strokeStyle=s.strokeStyle||s.fillStyle),s.fillAlpha&&(s.strokeAlpha=0),delete s.hasAppend,delete s.x,delete s.y,s}function k(t,e){e&&e.number&&(F.numberToTextShapePendingMap[t]?F.numberToTextShapePendingMap[t][e.number]=e:F.numberToTextShapePendingMap[t]=(0,d.default)({},e.number,e))}function U(t,e){return F.numberToTextShapePendingMap[t]&&F.numberToTextShapePendingMap[t][e]}function G(t,e){if(F.numberToTextShapePendingMap[t]&&F.numberToTextShapePendingMap[t][e]){var n=F.numberToTextShapePendingMap[t][e];return delete F.numberToTextShapePendingMap[t][e],n}}e.LINE_DASH_TYPES=D;var F=function(){function t(e,n,i,r,a){var o,s,l,c=this;(0,h.default)(this,t),this.canvas=void 0,this.container=void 0,this.painter=void 0,this.canPaint=void 0,this.docId=void 0,this.page=void 0,this.layer=void 0,this.updated=void 0,this.totalPage=void 0,this.useWebgl=void 0,this.playback=void 0,this.onWebglContextLost=void 0,this.onWebglContextRestored=void 0,this.webglContextLostTimer=void 0,this.painterPathWatcher=void 0,this.config=void 0,this.user=void 0,this.emitter=void 0,this.options=void 0,this.canvas=e,this.container=n,this.canPaint=!1,this.updated=!1,this.playback=!1,this.config=i,this.user=a.user,this.emitter=r,this.docId=this.page=this.layer=void 0,this.totalPage=a.page,this.useWebgl=void 0===a.useWebgl?g.webgl&&b:a.useWebgl;var f={container:n,useWebGL:this.useWebgl,enableColorBufferCache:!0,preserveDrawingBuffer:null!==(o=a.preserveDrawingBuffer)&&void 0!==o&&o,shapeIdPrefix:(0,x.default)(this.user.id),shapeLabel:this.user.name,totalPage:this.totalPage,canUseWebGL2:g.webgl2,canUseWorker:!1,enableBrushTip:!1,aa:(_.default.mac||_.default.ios)&&u>1?"":"fxaa",devicePixelRatio:null!==(s=a.devicePixelRatio)&&void 0!==s?s:u,textareaClass:"bjy-webgl-painter-textarea",enableScrollTextarea:!0,eraserSensitivity:(0,P.default)(null!==(l=a.eraserSensitivity)&&void 0!==l?l:20,5,30),customCanvasEvent:!1,createTextarea:a.createTextarea,cacheCanvas:a.cacheCanvas,cacheCanvasContext:a.cacheCanvasContext,maxSpeed:4e3};this.painter=new p.default(e,f),this.painterPathWatcher=this.updatePainter.bind(this),this.useWebgl&&(this.onWebglContextLost=function(t){c.webglContextLostTimer=setTimeout((function(){c.webglContextLostTimer=void 0,c.fire(v.WEBGL_CONTEXT_LOST,{canvas:c}),b=!1,c.fire(v.PAINTER_RECTEARE_TRIGGER,{canvas:c,switchContext:!0})}),8e3),++w>3&&(b=!1),t.preventDefault()},this.onWebglContextRestored=function(t){c.webglContextLostTimer&&(clearTimeout(c.webglContextLostTimer),c.webglContextLostTimer=void 0),c.fire(v.WEBGL_CONTEXT_RESTORED,{canvas:c}),c.fire(v.PAINTER_RECTEARE_TRIGGER,{canvas:c})},e.addEventListener("webglcontextlost",this.onWebglContextLost),e.addEventListener("webglcontextrestored",this.onWebglContextRestored))}var e,n,i,r;return(0,f.default)(t,[{key:"fire",value:function(t,e){this.emitter.fire(t,m.array(e)?e:(0,T.default)(e)?[e]:void 0)}},{key:"ready",value:(r=(0,c.default)(l.default.mark((function e(n,i){var r=this;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.canPaint=n,this.canvas.setAttribute&&this.canvas.setAttribute("data-can-paint",n?"1":"0"),e.prev=2,e.next=5,this.painter.ready(n,i);case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(2),console.log(e.t0),this.useWebgl&&(0,S.default)((function(){b=!1,r.fire(v.PAINTER_RECTEARE_TRIGGER,{canvas:r,switchContext:!0})})),e.abrupt("return");case 12:this.config.watch(this.painterPathWatcher),this.painter.on(p.default.Event.MOUSE_MOVE,(function(t,e){r.canPaint&&(e.docId=r.docId,e.page=r.page,r.fire(v.MOUSE_MOVE,e))})).on(p.default.Event.SHAPE_DRAWING_START,(function(t,e){r.canPaint&&r.fire(v.DRAWING_START)})).on(p.default.Event.SHAPE_DRAWING_END,(function(t,e){r.canPaint&&r.fire(v.DRAWING_END)})).on(p.default.Event.LOCAL_SHAPE_ADD,(function(t,e){r.onLocalShapeAdd(e.shape,e.hasAppend)})).on(p.default.Event.LOCAL_SHAPE_APPEND,(function(t,e){r.onLocalShapeAppend(e.shape,e.index)})).on(p.default.Event.LOCAL_SHAPE_REMOVE,(function(t,e){r.onLocalShapeRemove(e.shapes)})).on(p.default.Event.LOCAL_SHAPE_UPDATE,(function(t,e){r.onLocalShapeUpdate(e.shapes)})).on(p.default.Event.LOCAL_SHAPE_CLEAR,(function(t,e){r.canPaint&&r.fire(v.SHAPE_REMOVE_TRIGGER,{docId:r.docId,page:r.page,layer:r.layer,shapeId:""})})).on(p.default.Event.LOCAL_TEXT_CHANGE,(function(t,e){r.fire(v.SHAPE_TEXT_INPUT,e);var n=e.text,i=C(r.docId,r.page,r.layer);r.onLocalTextChange(i,n)})).on(p.default.Event.LOCAL_TEXT_BLUR,(function(e,n){var i=n.text,a=C(r.docId,r.page,r.layer);t.numberToIdMap[a]&&t.numberToIdMap[a][i.number]&&!i.text.trim()&&r.onLocalShapeRemove([i])})).on(p.default.Event.ACTIVE_SHAPE_CHANGE,(function(t,e){r.fire(v.SELECTING_END,{hasActive:e.shapes.length>0})})).on(p.default.Event.IMAGE_LOAD_FAIL,(function(t,e){r.fire(v.IMAGE_SHAPE_LOAD_FAIL,{image:e.image})})).on(p.default.Event.HISTORY_RECORD_CHANGE,(function(t,e){r.fire(v.HISTORY_RECORD_CHANGED,{record:e.record})})),t.instances.push(this),t.activeInstance||(t.activeInstance=this);case 16:case"end":return e.stop()}}),e,this,[[2,7]])}))),function(t,e){return r.apply(this,arguments)})},{key:"setCanPaint",value:function(t){this.painter.setCanPaint(t)}},{key:"updatePainter",value:function(t){var e={fontSize:t.fontSize,caretColor:t.caretColor,dash:t.dash,bold:t.bold,fontItalic:t.fontItalic,fillColor:t.fillColor,strokeColor:t.strokeColor,isStroke:t.isStroke,isFill:t.isFill,sides:t.sides,lineWidth:t.lineWidth,hoverColor:t.hoverColor,double:t.double};this.painter.setPainterShape(t.shapeType),this.canvas.setAttribute&&this.canvas.setAttribute("data-tool",t.shapeType),this.painter.updateShapeSetting(e)}},{key:"onLocalShapeAdd",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(C(this.docId,this.page,this.layer),N(e,this.canvas,this.totalPage,this.useWebgl));n&&(i.hasAppend=1,i.doodleVersion=1),this.fire(v.SHAPE_ADD_TRIGGER,{docId:this.docId,page:this.page,layer:this.layer,shape:i}),this.updated=!0,t.activeInstance=this}},{key:"onLocalTextChange",value:function(e,n){t.numberToIdMap[e]&&t.numberToIdMap[e][n.number]?this.onLocalShapeUpdate([n]):n.text.trim()&&(U(e,n&&n.number)||this.onLocalShapeAdd(n),k(e,n))}},{key:"onLocalShapeAppend",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=N(e,this.canvas,this.totalPage,this.useWebgl);i.index=n,this.fire(v.SHAPE_APPEND_TRIGGER,{docId:this.docId,page:this.page,layer:this.layer,shape:i}),this.updated=!0,t.activeInstance=this}},{key:"onLocalShapeUpdate",value:function(e){var n=this,i=C(this.docId,this.page,this.layer),r=[];A.each(e,(function(e){if(e&&e.number){var a=N(e,n.canvas,n.totalPage,n.useWebgl);a.id||(a.id=t.numberToIdMap[i][e.number]),r.push(a)}})),this.fire(v.SHAPE_UPDATE_TRIGGER,{docId:this.docId,page:this.page,layer:this.layer,shapeList:r}),this.updated=!0,t.activeInstance=this}},{key:"onLocalShapeRemove",value:function(e){var n=C(this.docId,this.page,this.layer),i=[];A.each(e,(function(e){if(e&&e.number){var r=e.id||t.numberToIdMap[n][e.number];r&&i.push(r)}})),i.length&&this.fire(v.SHAPE_REMOVE_TRIGGER,{docId:this.docId,page:this.page,layer:this.layer,shapeId:i.join(",")}),this.updated=!0,t.activeInstance=this}},{key:"onServerShapeAdd",value:(i=(0,c.default)(l.default.mark((function t(e){var n,i,r=this,a=arguments;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],i=[],A.each(e,(function(t){var e=M(t,r.canvas,r.totalPage,r.useWebgl);n?i.push({type:e.name,shape:e}):r.painter.addShape(e.name,e,!1,r.playback&&!!t.hasAppend)})),!n){t.next=6;break}return t.next=6,this.painter.addShapes(i);case 6:this.updated=!0;case 7:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"onServerShapeAppend",value:function(t){var e=M(t,this.canvas,this.totalPage,this.useWebgl,!0);this.painter.addShape(e.name,e,!0),this.updated=!0}},{key:"onServerShapeUpdate",value:function(t){var e=this;this.painter.updateShapes(t.map((function(t){return M(t,e.canvas,e.totalPage,e.useWebgl)}))),this.updated=!0}},{key:"onServerShapeRemove",value:function(t){this.painter.removeShapes(t),this.updated=!0}},{key:"addLocalShape",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.trigger=!0,this.painter.addShape(t.name,t,e)}},{key:"getCanPaint",value:function(){return this.canPaint}},{key:"clear",value:function(t){this.painter.clear(t)}},{key:"resize",value:(n=(0,c.default)(l.default.mark((function t(e,n){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.painter.resize(e,n);case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"hasPrev",value:function(){return this.painter.hasPrev()}},{key:"hasNext",value:function(){return this.painter.hasNext()}},{key:"prev",value:function(){this.hasPrev()&&this.painter.prev()}},{key:"next",value:function(){this.hasNext()&&this.painter.next()}},{key:"addBitmap",value:function(t){var e=t.url;e&&((0,y.default)(e)&&-1===e.indexOf("?")&&(e+="?x-oss-process=image/quality,q_90"),this.painter.addShape(p.default.shapeType.IMAGE,{url:e,points:[{x:t.position.x*u/this.canvas.width,y:t.position.y*u/this.canvas.height/this.totalPage}],maxWidth:Math.floor(.3*this.canvas.width/u)*(this.useWebgl?2:1),maxHeight:Math.floor(.3*this.canvas.height/u*(this.useWebgl?2*this.totalPage:1)),trigger:!0}))}},{key:"deleteActive",value:function(){this.painter.deleteSelectedShapes()}},{key:"updatePaintAuth",value:function(t){this.canPaint=t,this.canvas.setAttribute&&this.canvas.setAttribute("data-can-paint",t?"1":"0"),this.painter.setCanPaint(t)}},{key:"loadLayerShape",value:(e=(0,c.default)(l.default.mark((function e(n){var i;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.getCanvasLayerInstance(this.docId,this.page,this.layer)){e.next=2;break}return e.abrupt("return");case 2:return i=C(this.docId,this.page,this.layer),A.each(n,(function(e){t.numberToIdMap[i]?(t.numberToIdMap[i][e.number]=e.id,t.idToNumberMap[i][e.id]=e.number):(t.numberToIdMap[i]=(0,d.default)({},e.number,e.id),t.idToNumberMap[i]=(0,d.default)({},e.id,e.number))})),e.next=6,this.onServerShapeAdd(n,!0);case 6:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"setCanvasLayer",value:function(t,e,n){this.docId=t,this.page=e,this.layer=n,this.clear(!0)}},{key:"isCanvasLayer",value:function(t,e,n){return this.docId===t&&this.page===e&&this.layer===n}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.painter.on(t,e,n),this}},{key:"off",value:function(t,e){return this.painter.off(t,e),this}},{key:"one",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.max=1,this.on(t,e,n)}},{key:"scrollTo",value:function(t){this.painter.scrollTop(t)}},{key:"refresh",value:function(){this.painter.refresh()}},{key:"destroy",value:function(){this.painter.destroy(),this.emitter.off(),this.emitter=null,this.config.unwatch(this.painterPathWatcher),this.useWebgl&&this.canvas.removeEventListener&&(this.canvas.removeEventListener("webglcontextlost",this.onWebglContextLost),this.canvas.removeEventListener("webglcontextrestored",this.onWebglContextRestored)),A.remove(t.instances,this),t.activeInstance===this&&(t.activeInstance=void 0)}},{key:"getHistoryData",value:function(){return this.painter.getHistoryData()}},{key:"setHistoryData",value:function(t){this.painter.setHistoryData(t)}},{key:"emitShapeAppend",value:function(e){if(e.shape.isEnd){var n=C(e.docId,e.page,e.layer);t.numberToIdMap[n]?(t.numberToIdMap[n][e.shape.number]=e.shape.id,t.idToNumberMap[n][e.shape.id]=e.shape.number):(t.numberToIdMap[n]=(0,d.default)({},e.shape.number,e.shape.id),t.idToNumberMap[n]=(0,d.default)({},e.shape.id,e.shape.number))}this.user.id!==e.fromId&&this.onServerShapeAppend(e.shape)}},{key:"emitShapeAdd",value:function(e){var n=C(e.docId,e.page,e.layer);if(t.numberToIdMap[n]?(t.numberToIdMap[n][e.shape.number]=e.shape.id,t.idToNumberMap[n][e.shape.id]=e.shape.number):(t.numberToIdMap[n]=(0,d.default)({},e.shape.number,e.shape.id),t.idToNumberMap[n]=(0,d.default)({},e.shape.id,e.shape.number)),this.user.id!==e.fromId)this.onServerShapeAdd([e.shape]);else if(e.shape&&"Text"===e.shape.name){var i=G(n,e.shape.number);i&&i.text!==e.shape.text&&this.onLocalTextChange(n,i)}}},{key:"emitShapeRemove",value:function(e){var n=C(e.docId,e.page,e.layer),i=e.shapeId.length?e.shapeId.split(","):[];if(!i.length)return this.clear(!0),t.numberToIdMap[n]={},void(t.idToNumberMap[n]={});if(t.idToNumberMap[n]){if(this.user.id!==e.fromId){var r=[];A.each(i,(function(e){e&&t.idToNumberMap[n][e]&&r.push(t.idToNumberMap[n][e])})),this.onServerShapeRemove(r)}A.each(i,(function(e){e&&(delete t.numberToIdMap[n][t.idToNumberMap[n][e]],delete t.idToNumberMap[n][e])}))}}},{key:"emitShapeUpdate",value:function(e){var n=e.shapeList,i=e.fromId&&this.user.id===e.fromId,r=C(e.docId,e.page,e.layer);A.each(n,(function(e){t.numberToIdMap[r]?(t.numberToIdMap[r][e.number]=e.id,t.idToNumberMap[r][e.id]=e.number):(t.numberToIdMap[r]=(0,d.default)({},e.number,e.id),t.idToNumberMap[r]=(0,d.default)({},e.id,e.number))})),i||this.onServerShapeUpdate(n)}},{key:"getDevicePixelRatio",value:function(){return u}}],[{key:"getCanvasLayerInstance",value:function(e,n,i){var r=void 0;return A.each(t.instances,(function(t,a){if(t.isCanvasLayer(e,n,i))return r=t,!1})),r}}]),t}();e.default=F,F.instances=[],F.activeInstance=void 0,F.computeLaserPosition=void 0,F.numberToIdMap={},F.idToNumberMap={},F.numberToTextShapePendingMap={},F.laserHistoryPoints=[]},function(t,e,n){window,t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=160)}([function(t,e,n){t.exports=n(163)},function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},function(t,e,n){var i=n(114),r=n(0),a=n(54),o=n(180);function s(){if("function"!=typeof o)return null;var t=new o;return s=function(){return t},t}t.exports=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},o=r&&i;for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)){var l=o?i(t,u):null;l&&(l.get||l.set)?r(n,u,l):n[u]=t[u]}return n.default=t,e&&e.set(t,n),n}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){var i=n(0);function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),i(t,r.key,r)}}t.exports=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}},function(t,e,n){var i=n(0);t.exports=function(t,e,n){return e in t?i(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){"use strict";(function(t){var i=n(1);n(0)(e,"__esModule",{value:!0}),e.SMAA_EDGES=e.PRESET_ULTRA=e.PRESET_HIGH=e.PRESET_MEDIUM=e.PRESET_LOW=e.SMAA=e.FXAA=e.DRAG_CURSOR=e.CURSOR_UNSET=e.CURSOR_AUTO=e.CURSOR_MOVE=e.CURSOR_POINTER=e.DIRECTION=e.ACTIVE_INFO_RECT_COLOR=e.ACTIVE_INFO_RECT_BACKGROUND=e.ACTIVE_INFO_RECT_FONT_TEXTURE_SIZE=e.ACTIVE_INFO_RECT_FONT_SIZE=e.ACTIVE_INFO_RECT_RADIUS=e.ACTIVE_INFO_RECT_PADDING_V=e.ACTIVE_INFO_RECT_PADDING_H=e.ACTIVE_INFO_RECT_MARGIN_V=e.ACTIVE_INFO_RECT_MARGIN_L=e.ACTIVE_INFO_RECT_MARGIN_H=e.ACTIVE_INFO_RECT_HEIGHT=e.ACTIVE_RECT_BOX_LINE_WIDTH=e.ACTIVE_RECT_INNER_BOX_COLOR=e.ACTIVE_RECT_BOX_COLOR=e.SELECTION_BOX_LINE_WIDTH=e.SELECTION_BOX_BACKGROUND=e.SElECTION_BOX_COLOR=e.PAINTER_TYPE_CANVAS_2D=e.PAINTER_TYPE_WEBGL=e.PI2=e.PI=e.EMPTY_STRING=e.EMPTY_ARRAY=e.EMPTY_OBJECT=e.EMPTY_FUNCTION=e.GLOBAL=e.DOCUMENT=e.WINDOW=e.KEYPATH_CURRENT=e.RAW_SLASH=e.RAW_DOT=e.RAW_WILDCARD=e.RAW_FUNCTION=e.RAW_LENGTH=e.RAW_VALUE=e.RAW_THIS=e.RAW_UNDEFINED=e.RAW_NULL=e.RAW_FALSE=e.RAW_TRUE=e.MINUS_ONE=e.UNDEFINED=e.NULL=e.FALSE=e.TRUE=void 0;var r=i(n(222)),a=i(n(54));e.TRUE=!0,e.FALSE=!1,e.NULL=null,e.UNDEFINED=void 0,e.MINUS_ONE=-1,e.RAW_TRUE="true",e.RAW_FALSE="false",e.RAW_NULL="null",e.RAW_UNDEFINED="undefined",e.RAW_THIS="this",e.RAW_VALUE="value",e.RAW_LENGTH="length",e.RAW_FUNCTION="function",e.RAW_WILDCARD="*",e.RAW_DOT=".",e.RAW_SLASH="/",e.KEYPATH_CURRENT="this";var o="undefined"!==("undefined"==typeof window?"undefined":(0,a.default)(window))?window:void 0;e.WINDOW=o;var s="undefined"!==("undefined"==typeof document?"undefined":(0,a.default)(document))?document:void 0;e.DOCUMENT=s;var u="undefined"!==(void 0===t?"undefined":(0,a.default)(t))?t:o;e.GLOBAL=u,e.EMPTY_FUNCTION=function(){};var l=(0,r.default)({});e.EMPTY_OBJECT=l;var c=(0,r.default)([]);e.EMPTY_ARRAY=c,e.EMPTY_STRING="";var h=Math.PI;e.PI=h;var f,d=2*h;e.PI2=d,e.PAINTER_TYPE_WEBGL="painter_webgl",e.PAINTER_TYPE_CANVAS_2D="painter_canvas_2d",e.SElECTION_BOX_COLOR="#ccc",e.SELECTION_BOX_BACKGROUND="rgba(0, 0, 0, 0.2)",e.SELECTION_BOX_LINE_WIDTH=1,e.ACTIVE_RECT_BOX_COLOR="#C3C0B9",e.ACTIVE_RECT_INNER_BOX_COLOR="#E9E9E9",e.ACTIVE_RECT_BOX_LINE_WIDTH=.5,e.ACTIVE_INFO_RECT_HEIGHT=16,e.ACTIVE_INFO_RECT_MARGIN_H=2,e.ACTIVE_INFO_RECT_MARGIN_L=4,e.ACTIVE_INFO_RECT_MARGIN_V=4,e.ACTIVE_INFO_RECT_PADDING_H=3,e.ACTIVE_INFO_RECT_PADDING_V=1,e.ACTIVE_INFO_RECT_RADIUS=2,e.ACTIVE_INFO_RECT_FONT_SIZE=12,e.ACTIVE_INFO_RECT_FONT_TEXTURE_SIZE=30,e.ACTIVE_INFO_RECT_BACKGROUND="rgba(155, 155, 155, 1)",e.ACTIVE_INFO_RECT_COLOR="#fff",e.DIRECTION=f,function(t){t[t.LEFT_TOP=1]="LEFT_TOP",t[t.TOP=2]="TOP",t[t.RIGHT_TOP=3]="RIGHT_TOP",t[t.RIGHT=4]="RIGHT",t[t.RIGHT_BOTTOM=5]="RIGHT_BOTTOM",t[t.BOTTOM=6]="BOTTOM",t[t.LEFT_BOTTOM=7]="LEFT_BOTTOM",t[t.LEFT=8]="LEFT",t[t.ROTATE=9]="ROTATE",t[t.MOVE=10]="MOVE"}(f||(e.DIRECTION=f={})),e.CURSOR_POINTER="pointer",e.CURSOR_MOVE="move",e.CURSOR_AUTO="auto",e.CURSOR_UNSET="unset";var p={};p[f.LEFT_TOP]="nwse-resize",p[f.TOP]="ns-resize",p[f.RIGHT_TOP]="nesw-resize",p[f.RIGHT]="ew-resize",p[f.RIGHT_BOTTOM]="nwse-resize",p[f.BOTTOM]="ns-resize",p[f.LEFT_BOTTOM]="nesw-resize",p[f.LEFT]="ew-resize",p[f.ROTATE]="pointer",p.pointer="pointer",p.move=p[f.MOVE]="move",p.auto="auto",p.unset="";var v,g=p;e.DRAG_CURSOR=g,e.FXAA="fxaa",e.SMAA="smaa",e.PRESET_LOW="LOW",e.PRESET_MEDIUM="MEDIUM",e.PRESET_HIGH="HIGH",e.PRESET_ULTRA="ULTRA",e.SMAA_EDGES=v,function(t){t[t.COLOR=1]="COLOR",t[t.DEPTH=2]="DEPTH",t[t.LUMA=3]="LUMA"}(v||(e.SMAA_EDGES=v={}))}).call(this,n(221))},function(t,e,n){t.exports=n(196)},function(t,e,n){var i=n(204),r=n(133);function a(e){return t.exports=a=r?i:function(t){return t.__proto__||i(t)},a(e)}t.exports=a},function(t,e,n){var i=n(132),r=n(101);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=i(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){var i=n(54),r=n(12);t.exports=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?r(t):e}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.each=l,e.push=function(t,e){f(t,e,c)},e.unshift=function(t,e){f(t,e,h)},e.indexOf=d,e.last=function(t){var e=t.length;if(e>0)return t[e-1]},e.pop=function(t){if(t.length>0)return t.pop()},e.remove=function(t,e,n){var i=0;return l(t,(function(r,a){(n===s.FALSE?r==e:r===e)&&(t.splice(a,1),i++)}),s.TRUE),i},e.has=function(t,e,n){return d(t,e,n)>=0},e.toArray=function(t){return o.array(t)?t:(0,u.default)(s.EMPTY_ARRAY.slice,t)},e.toObject=function(t,e,n){var i={};return l(t,(function(t){i[e?t[e]:t]=n||t})),i},e.join=function(t,e){return t.join(e)},e.falsy=function(t){return!o.array(t)||!t.length},e.concat=function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?(t.reduceRight((function(t,e){return t.unshift(e),t}),e),e.length):t.push.apply(t,(0,a.default)(e))};var a=r(n(33)),o=i(n(20)),s=i(n(6)),u=r(n(43));function l(t,e,n){if(t){var i=t.length;if(i)if(n)for(var r=i-1;r>=0&&e(t[r],r)!==s.FALSE;r--);else for(var a=0;a<i&&e(t[a],a)!==s.FALSE;a++);}}function c(t,e){t[t.length]=e}function h(t,e){t.unshift(e)}function f(t,e,n){o.array(e)?l(e,(function(e){n(t,e)})):n(t,e)}function d(t,e,n){var i=s.MINUS_ONE;return l(t,(function(t,r){if(n===s.FALSE?t==e:t===e)return i=r,s.FALSE})),i}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(9)),l=i(n(10)),c=i(n(8)),h=i(n(5)),f=n(18),d=function(t){(0,u.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,c.default)(t);if(e){var a=(0,c.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}(n);function n(t,i){var r,o,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3?arguments[3]:void 0;return(0,a.default)(this,n),t instanceof f.Vector3?(r=e.call(this,t.toArray()),(0,h.default)((0,s.default)(r),"mouseEvent",void 0),(0,h.default)((0,s.default)(r),"speed",void 0)):(r=e.call(this,[t,i,u]),(0,h.default)((0,s.default)(r),"mouseEvent",void 0),(0,h.default)((0,s.default)(r),"speed",void 0)),r.mouseEvent=c,c&&(r.speed=null!==(o=c.speed)&&void 0!==o?o:0),(0,l.default)(r)}return(0,o.default)(n,[{key:"setSpeed",value:function(t){this.speed=t}},{key:"getSpeed",value:function(){return this.speed||0}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"copy",value:function(){var t=new n(this.x,this.y,this.z);return t.setSpeed(this.speed),t}},{key:"xGlTo2D",value:function(t){return Math.floor(this.x*t)}},{key:"yGlTo2D",value:function(t){return Math.floor(this.y*t)}},{key:"toJson",value:function(t){var e=t.useWebGL?(this.x+1)/2:this.x,n=t.useWebGL?(1-this.y)/2:this.y;return t.totalPage>1&&(n/=t.totalPage),{x:e,y:n}}}]),n}(f.Vector3);e.default=d,(0,h.default)(d,"pointLength",3)},function(t,e){var n=t.exports={version:"2.6.10"};"number"==typeof __e&&(__e=n)},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.ERASER=e.PATH=e.RESIZE=e.SELECTION=e.IMAGE=e.TEXT=e.TRIANGLE=e.ARROW=e.REGULAR_POLYGON=e.POLYGON=e.DOODLE=e.CIRCLE=e.CURVE=e.RECT=e.LINE=e.SHAPE=e.SELECT=void 0,e.SELECT="select",e.SHAPE="shape",e.LINE="line",e.RECT="rect",e.CURVE="curve",e.CIRCLE="circle",e.DOODLE="doodle",e.POLYGON="polygon",e.REGULAR_POLYGON="regular_polygon",e.ARROW="arrow",e.TRIANGLE="triangle",e.TEXT="text",e.IMAGE="image",e.SELECTION="selection",e.RESIZE="resize",e.PATH="path",e.ERASER="eraser"},function(t,e,n){var i=n(19),r=n(14),a=n(38),o=n(39),s=n(36),u=function(t,e,n){var l,c,h,f=t&u.F,d=t&u.G,p=t&u.S,v=t&u.P,g=t&u.B,E=t&u.W,_=d?r:r[e]||(r[e]={}),y=_.prototype,m=d?i:p?i[e]:(i[e]||{}).prototype;for(l in d&&(n=e),n)(c=!f&&m&&void 0!==m[l])&&s(_,l)||(h=c?m[l]:n[l],_[l]=d&&"function"!=typeof m[l]?n[l]:g&&c?a(h,i):E&&m[l]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):v&&"function"==typeof h?a(Function.call,h):h,v&&((_.virtual||(_.virtual={}))[l]=h,t&u.R&&y&&!y[l]&&o(y,l,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){var i=n(114),r=n(226),a=n(229);function o(e,n,s){return"undefined"!=typeof Reflect&&r?t.exports=o=r:t.exports=o=function(t,e,n){var r=a(t,e);if(r){var o=i(r,e);return o.get?o.get.call(n):o.value}},o(e,n,s||e)}t.exports=o},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.Vector4=e.Vector3=void 0;var r=i(n(3)),a=i(n(4)),o=i(n(5)),s=function(){function t(e){(0,r.default)(this,t),(0,o.default)(this,"element",void 0),this.element=new Float32Array(3),e&&(this.element[0]=e[0],this.element[1]=e[1],this.element[2]=e[2])}return(0,a.default)(t,[{key:"normalize",value:function(){var t=this.x,e=this.y,n=this.z,i=this.magnitude;return i?(1===i||(i=1/i,this.x=t*i,this.y=e*i,this.z=n*i),this):(this.x=this.y=this.z=0,this)}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"toPixelUnit",value:function(t){return this.x=this.x*t.getWidth()/2,this.y=this.y*t.getHeight()/2,this}},{key:"toGLUnit",value:function(t){return this.x=2*this.x/t.getWidth(),this.y=2*this.y/t.getHeight(),this}},{key:"magnitude",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"sqrMagnitude",get:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"x",get:function(){return this.element[0]},set:function(t){this.element[0]=t}},{key:"y",get:function(){return this.element[1]},set:function(t){this.element[1]=t}},{key:"z",get:function(){return this.element[2]},set:function(t){this.element[2]=t}}]),t}();e.Vector3=s,e.Vector4=function t(e){(0,r.default)(this,t),(0,o.default)(this,"element",void 0),this.element=new Float32Array(4),e&&(this.element[0]=e[0],this.element[1]=e[1],this.element[2]=e[2],this.element[4]=e[3])}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.func=function(t){return(0,s.default)(t)===u.RAW_FUNCTION},e.array=function(t){return(0,o.default)(t)},e.object=function(t){return t!==u.NULL&&"object"===(0,s.default)(t)},e.string=l,e.number=c,e.boolean=function(t){return"boolean"==typeof t},e.numeric=function(t){return c(t)||l(t)&&!isNaN((0,a.default)(t))&&isFinite(t)},e.integer=h,e.odd=function(t){return h(t)&&1==(1&t)};var a=r(n(217)),o=r(n(102)),s=r(n(54)),u=i(n(6));function l(t){return"string"==typeof t}function c(t){return"number"==typeof t&&!isNaN(t)}function h(t){return(0|t)===t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(90)("wks"),r=n(69),a=n(19).Symbol,o="function"==typeof a;(t.exports=function(t){return i[t]||(i[t]=o&&a[t]||(o?a:r)("Symbol."+t))}).store=i},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a,o=r(n(3)),s=r(n(4)),u=r(n(5)),l=i(n(11)),c=i(n(32)),h=n(18),f=function(){function t(e){var n=this;(0,o.default)(this,t),(0,u.default)(this,"element",void 0),e?(this.element=new Float32Array(16),l.each(e,(function(t,e){n.element[e]=t}))):this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return(0,s.default)(t,null,[{key:"shared",value:function(){return a||(a=new t)}}]),(0,s.default)(t,[{key:"getValue",value:function(t){if(t>=0&&t<=15)return this.element[t];c.error("index out of Matrix4's rang [0 - 15]")}},{key:"setValue",value:function(t,e){t>=0&&t<=15?this.element[t]=e:c.error("index out of Matrix4's rang [0 - 15]")}},{key:"setIdentity",value:function(){return this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this}},{key:"set",value:function(t){var e=this;return l.each(t,(function(t,n){e.element[n]=t})),this}},{key:"multiply",value:function(t){var e,n,i,r,a,o,s,u;if((r=n=this.element)===(i=t.element))for(i=new Float32Array(16),e=0;e<16;e++)i[e]=r[e];for(e=0;e<4;e++)a=n[e],o=n[e+4],s=n[e+8],u=n[e+12],r[e]=a*i[0]+o*i[1]+s*i[2]+u*i[3],r[e+4]=a*i[4]+o*i[5]+s*i[6]+u*i[7],r[e+8]=a*i[8]+o*i[9]+s*i[10]+u*i[11],r[e+12]=a*i[12]+o*i[13]+s*i[14]+u*i[15];return this}},{key:"multiplyVector3",value:function(t){var e=this.element,n=t.element;return new h.Vector3([n[0]*e[0]+n[1]*e[4]+n[2]*e[8]+e[12],n[0]*e[1]+n[1]*e[5]+n[2]*e[9]+e[13],n[0]*e[2]+n[1]*e[6]+n[2]*e[10]+e[14]])}},{key:"multiplyVector4",value:function(t){var e=this.element,n=t.element;return new h.Vector4([n[0]*e[0]+n[1]*e[4]+n[2]*e[8]+n[3]*e[12],n[0]*e[1]+n[1]*e[5]+n[2]*e[9]+n[3]*e[13],n[0]*e[2]+n[1]*e[6]+n[2]*e[10]+n[3]*e[14],n[0]*e[3]+n[1]*e[7]+n[2]*e[11]+n[3]*e[15]])}},{key:"transpose",value:function(){var t,e;return e=(t=this.element)[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setInverseOf",value:function(t){var e,n,i,r,a;if(n=t.element,i=this.element,(r=new Float32Array(16))[0]=n[5]*n[10]*n[15]-n[5]*n[11]*n[14]-n[9]*n[6]*n[15]+n[9]*n[7]*n[14]+n[13]*n[6]*n[11]-n[13]*n[7]*n[10],r[1]=-n[1]*n[10]*n[15]+n[1]*n[11]*n[14]+n[9]*n[2]*n[15]-n[9]*n[3]*n[14]-n[13]*n[2]*n[11]+n[13]*n[3]*n[10],r[2]=n[1]*n[6]*n[15]-n[1]*n[7]*n[14]-n[5]*n[2]*n[15]+n[5]*n[3]*n[14]+n[13]*n[2]*n[7]-n[13]*n[3]*n[6],r[3]=-n[1]*n[6]*n[11]+n[1]*n[7]*n[10]+n[5]*n[2]*n[11]-n[5]*n[3]*n[10]-n[9]*n[2]*n[7]+n[9]*n[3]*n[6],r[4]=-n[4]*n[10]*n[15]+n[4]*n[11]*n[14]+n[8]*n[6]*n[15]-n[8]*n[7]*n[14]-n[12]*n[6]*n[11]+n[12]*n[7]*n[10],r[5]=n[0]*n[10]*n[15]-n[0]*n[11]*n[14]-n[8]*n[2]*n[15]+n[8]*n[3]*n[14]+n[12]*n[2]*n[11]-n[12]*n[3]*n[10],r[6]=-n[0]*n[6]*n[15]+n[0]*n[7]*n[14]+n[4]*n[2]*n[15]-n[4]*n[3]*n[14]-n[12]*n[2]*n[7]+n[12]*n[3]*n[6],r[7]=n[0]*n[6]*n[11]-n[0]*n[7]*n[10]-n[4]*n[2]*n[11]+n[4]*n[3]*n[10]+n[8]*n[2]*n[7]-n[8]*n[3]*n[6],r[8]=n[4]*n[9]*n[15]-n[4]*n[11]*n[13]-n[8]*n[5]*n[15]+n[8]*n[7]*n[13]+n[12]*n[5]*n[11]-n[12]*n[7]*n[9],r[9]=-n[0]*n[9]*n[15]+n[0]*n[11]*n[13]+n[8]*n[1]*n[15]-n[8]*n[3]*n[13]-n[12]*n[1]*n[11]+n[12]*n[3]*n[9],r[10]=n[0]*n[5]*n[15]-n[0]*n[7]*n[13]-n[4]*n[1]*n[15]+n[4]*n[3]*n[13]+n[12]*n[1]*n[7]-n[12]*n[3]*n[5],r[11]=-n[0]*n[5]*n[11]+n[0]*n[7]*n[9]+n[4]*n[1]*n[11]-n[4]*n[3]*n[9]-n[8]*n[1]*n[7]+n[8]*n[3]*n[5],r[12]=-n[4]*n[9]*n[14]+n[4]*n[10]*n[13]+n[8]*n[5]*n[14]-n[8]*n[6]*n[13]-n[12]*n[5]*n[10]+n[12]*n[6]*n[9],r[13]=n[0]*n[9]*n[14]-n[0]*n[10]*n[13]-n[8]*n[1]*n[14]+n[8]*n[2]*n[13]+n[12]*n[1]*n[10]-n[12]*n[2]*n[9],r[14]=-n[0]*n[5]*n[14]+n[0]*n[6]*n[13]+n[4]*n[1]*n[14]-n[4]*n[2]*n[13]-n[12]*n[1]*n[6]+n[12]*n[2]*n[5],r[15]=n[0]*n[5]*n[10]-n[0]*n[6]*n[9]-n[4]*n[1]*n[10]+n[4]*n[2]*n[9]+n[8]*n[1]*n[6]-n[8]*n[2]*n[5],0==(a=n[0]*r[0]+n[1]*r[4]+n[2]*r[8]+n[3]*r[12]))return this;for(a=1/a,e=0;e<16;e++)i[e]=r[e]*a;return this}},{key:"invert",value:function(){return this.setInverseOf(this),this}},{key:"setOrtho",value:function(t,e,n,i,r,a){var o,s,u;return t!==e&&n!==i&&r!==a||c.fatal("null frustum"),o=1/(e-t),s=1/(i-n),u=1/(a-r),this.set([2*o,0,0,0,0,2*s,0,0,0,0,-2*u,0,-(e+t)*o,-(i+n)*s,-(a+r)*u,1]),this}},{key:"ortho",value:function(e,n,i,r,a,o){return this.multiply((new t).setOrtho(e,n,i,r,a,o))}},{key:"setFrustum",value:function(t,e,n,i,r,a){var o,s,u;return t!==e&&n!==i&&r!==a||c.fatal("null frustum"),r<=0&&c.fatal("near <= 0"),a<=0&&c.fatal("far <= 0"),o=1/(e-t),s=1/(i-n),u=1/(a-r),this.set([2*r*o,0,0,0,0,2*r*s,0,0,(e+t)*o,(i+n)*s,-(a+r)*u,-1,0,0,-2*r*a*u,0]),this}},{key:"frustum",value:function(e,n,i,r,a,o){return this.multiply((new t).setOrtho(e,n,i,r,a,o))}},{key:"setPerspective",value:function(t,e,n,i){var r,a,o;return n!==i&&0!==e||c.fatal("null frustum"),n<=0&&c.fatal("near <= 0"),i<=0&&c.fatal("far <= 0"),t=Math.PI*t/180/2,0===(a=Math.sin(t))&&c.fatal("null frustum"),r=1/(i-n),o=Math.cos(t)/a,this.set([o/e,0,0,0,0,o,0,0,0,0,-(i+n)*r,-1,0,0,-2*n*i*r,0]),this}},{key:"perspective",value:function(e,n,i,r){return this.multiply((new t).setPerspective(e,n,i,r))}},{key:"setScale",value:function(t){return this.set([t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1]),this}},{key:"scale",value:function(t){var e=this.element;return e[0]*=t.x,e[1]*=t.x,e[2]*=t.x,e[3]*=t.x,e[4]*=t.y,e[5]*=t.y,e[6]*=t.y,e[7]*=t.y,e[8]*=t.z,e[9]*=t.z,e[10]*=t.z,e[11]*=t.z,this}},{key:"setTranslate",value:function(t){return this.set([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1]),this}},{key:"translate",value:function(t){var e=this.element;return e[12]+=e[0]*t.x+e[4]*t.y+e[8]*t.z,e[13]+=e[1]*t.x+e[5]*t.y+e[9]*t.z,e[14]+=e[2]*t.x+e[6]*t.y+e[10]*t.z,e[15]+=e[3]*t.x+e[7]*t.y+e[11]*t.z,this}},{key:"setRotate",value:function(t,e){var n,i,r,a,o,s,u,l,c,h,f,d,p,v;return t=Math.PI*t/180,n=e.x,i=e.y,r=e.z,a=Math.sin(t),o=Math.cos(t),0!==e.x&&0===e.y&&0===e.z?(e.x<0&&(a=-a),this.set([1,0,0,0,0,o,-a,0,0,a,o,0,0,0,0,1])):0===e.x&&0!==e.y&&0===e.z?(e.y<0&&(a=-a),this.set([o,0,a,0,0,1,0,0,-a,0,o,0,0,0,0,1])):0===e.x&&0===e.y&&0!==e.z?(e.z<0&&(a=-a),this.set([o,-a,0,0,a,o,0,0,0,0,1,0,0,0,0,1])):(1!==(s=e.magnitude)&&(n*=u=1/s,i*=u,r*=u),l=1-o,c=n*i,h=i*r,f=r*n,d=n*a,p=i*a,v=r*a,this.set([n*n*l+o,c*l+v,f*l-p,0,c*l-v,i*i*l+o,h*l+d,0,f*l+p,h*l-d,r*r*l+o,0,0,0,0,1])),this}},{key:"rotate",value:function(e,n){return this.multiply((new t).setRotate(e,n)),this}},{key:"setLookAt",value:function(t,e,n){var i,r,a,o,s,u,l,c,f,d,p;return i=e.x-t.x,r=e.y-t.y,a=e.z-t.z,i*=o=1/Math.sqrt(i*i+r*r+a*a),a*=o,s=(r*=o)*n.z-a*n.y,u=a*n.x-i*n.z,l=i*n.y-r*n.x,f=(u*=c=1/Math.sqrt(s*s+u*u+l*l))*a-(l*=c)*r,d=l*i-(s*=c)*a,p=s*r-u*i,this.set([s,f,-i,0,u,d,-r,0,l,p,-a,0,0,0,0,1]),this.translate(new h.Vector3([-t.x,-t.y,-t.z]))}},{key:"lookAt",value:function(e,n,i){return this.multiply((new t).setLookAt(e,n,i))}},{key:"toArray",value:function(){for(var t=[],e=0;e<16;e++)t[e]=this.element[e];return t}},{key:"copy",value:function(){return(new t).set(this.toArray())}}]),t}();e.default=f},function(t,e,n){var i=n(21);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(33)),o=r(n(3)),s=r(n(4)),u=r(n(5)),l=r(n(13)),c=r(n(26)),h=i(n(20)),f=r(n(23)),d=i(n(11)),p=i(n(27)),v=i(n(15)),g=n(18),E=i(n(6)),_=r(n(140)),y=r(n(49)),m=function(){function t(e){(0,o.default)(this,t),(0,u.default)(this,"name",v.SHAPE),(0,u.default)(this,"id",void 0),(0,u.default)(this,"number",void 0),(0,u.default)(this,"label",""),(0,u.default)(this,"lineWidth",2),(0,u.default)(this,"strokeWidth",1),(0,u.default)(this,"stroke",new c.default(0,0,0,1)),(0,u.default)(this,"fill",new c.default(0,0,0,1)),(0,u.default)(this,"hoverColor",new c.default(255,255,0,1)),(0,u.default)(this,"isFill",!0),(0,u.default)(this,"isStroke",!1),(0,u.default)(this,"angle",0),(0,u.default)(this,"dashSegments",[10,10]),(0,u.default)(this,"dash",!1),(0,u.default)(this,"points",[]),(0,u.default)(this,"glPoints",[]),(0,u.default)(this,"close",!1),(0,u.default)(this,"boundingRect",null),(0,u.default)(this,"selection",null),(0,u.default)(this,"children",[]),(0,u.default)(this,"hover",!1),(0,u.default)(this,"selected",!1),(0,u.default)(this,"verticesCache",[]),e.name&&(this.name=e.name),e.label&&(this.label=e.label),e.lineWidth&&(this.lineWidth=e.lineWidth),e.strokeWidth&&(this.strokeWidth=e.strokeWidth),e.stroke&&(h.string(e.stroke)?this.stroke=new c.default(e.stroke):this.stroke=e.stroke),e.fill&&(h.string(e.fill)?this.fill=new c.default(e.fill):this.fill=e.fill),e.angle&&(this.angle=e.angle),e.points&&(this.points=e.points),h.array(e.dashSegments)&&(this.dashSegments=e.dashSegments),this.id=e.id,this.number=e.number,this.isFill=!!e.isFill,this.isStroke=!!e.isStroke,this.close=!!e.close,this.dash=!!e.dash}return(0,s.default)(t,[{key:"clear",value:function(){return this.points=this.glPoints=[],this}},{key:"appendPoint",value:function(t){return this.points.push(t),this}},{key:"appendPoints",value:function(t){var e=this;return h.array(t)&&d.each(t,(function(t,n){e.points.push(t)})),this}},{key:"prependPoint",value:function(t){return this.points.unshift(t),this}},{key:"removePoint",value:function(t){var e=this.points;return d.each(e,(function(n,i){if(n.x===t.x&&n.y===t.y&&n.z===t.z)return e.splice(i,1),E.FALSE})),this}},{key:"removePointByIndex",value:function(t){return t>=0&&t<this.points.length?(this.points.splice(t,1),E.TRUE):E.FALSE}},{key:"startDrawing",value:function(t){return t.startDrawing(this),this}},{key:"endDrawing",value:function(t){return t.endDrawing(this),this}},{key:"isPointInShape",value:function(t,e,n){if(n){var i=n*e.getUnitLength()/2,r={minX:t.x-i,minY:t.y-i,maxX:t.x+i,maxY:t.y+i};if(this.isBoundRectInShape(r))return this.isPointInPath(t,e,n)}else if(this.boundingRect&&t.x<=this.boundingRect.maxX&&t.x>=this.boundingRect.minX&&t.y<=this.boundingRect.maxY&&t.y>=this.boundingRect.minY)return this.isPointInPath(t,e,n);return!1}},{key:"toJSON",value:function(t,e){var n={name:this.name,number:this.number,label:this.label,lineWidth:this.lineWidth,fillStyle:this.fill.rgbToHex(),fillAlpha:this.fill.a,strokeStyle:this.stroke.rgbToHex(),strokeAlpha:this.stroke.a,dash:this.dash,dashSegments:this.dashSegments,points:void 0,isFill:this.isFill,isStroke:this.isStroke};if(this.id&&(n.id=this.id),this.isFill||(n.fillAlpha=0),this.isStroke||(n.strokeAlpha=0),(!e||!e.points)&&this.points.length){var i=[];d.each(this.points,(function(e){i.push(e.toJson(t))})),n.points=i}return e&&p.extend(n,e),n}},{key:"toVertices",value:function(t,e,n){var i=this,r=[];return e||!this.isHover()||this.isSelected()||(e=this.hoverColor),n?r=n:d.each(this.glPoints,(function(t){var n=e||(i.isFill?i.fill:i.stroke);d.concat(r,[].concat((0,a.default)(t.toArray()),(0,a.default)(n.toArray())))})),d.each(this.children,(function(n){d.concat(r,n.toVertices(t,e))})),e||(this.verticesCache=r),this.isSelected()&&this.selection&&t.isCanvasRender()&&d.concat(r,this.selection.toVertices(t)),r}},{key:"getCacheVertices",value:function(){return this.verticesCache}},{key:"drawGLPath",value:function(t,e){var n=0;return d.each(this.children,(function(i){n+=i.drawGLPath(t,e+n)})),this.isSelected()&&this.selection&&t.isCanvasRender()&&(n+=this.selection.drawGLPath(t,e+n)),n}},{key:"draw2DPath",value:function(t,e){d.each(this.children,(function(n){n.draw2DPath(t,e)})),this.isSelected()&&this.selection&&this.selection.draw2DPath(t)}},{key:"setHoverStatus",value:function(t,e){this.hover=t,e&&(this.hoverColor=e)}},{key:"resize",value:function(t){this.generateWebGLPoints(t)}},{key:"isHover",value:function(){return this.hover}},{key:"addChild",value:function(t){this.children.push(t)}},{key:"addBound",value:function(t){this.selection=t}},{key:"setSelectedStatus",value:function(t,e){this.selected=e}},{key:"isSelected",value:function(){return this.selected}},{key:"boundingRectUnion",value:function(t){this.boundingRect?this.boundingRect=(0,_.default)(this.boundingRect,t):this.boundingRect=p.copy(t)}},{key:"isBoundRectInShape",value:function(t){if(this.boundingRect){var e=Math.max(t.minX,this.boundingRect.minX),n=Math.max(t.minY,this.boundingRect.minY),i=Math.min(t.maxX,this.boundingRect.maxX),r=Math.min(t.maxY,this.boundingRect.maxY);return i-e>=0&&r-n>=0}}},{key:"getOptions",value:function(){return{lineWidth:this.lineWidth,isFill:this.isFill,isStroke:this.isStroke,fill:this.fill,stroke:this.stroke,angle:this.angle,close:this.close,dash:this.dash,dashSegments:this.dashSegments}}},{key:"translate",value:function(t,e){var n=this;d.each(this.glPoints,(function(e,i){n.glPoints[i]=new l.default(t.multiplyVector3(e))})),d.each(this.points,(function(e,i){var r=e.getSpeed();n.points[i]=new l.default(t.multiplyVector3(e)),n.points[i].setSpeed(r)})),d.each(this.children,(function(n){n.translate(t,e)})),this.selection&&this.selection.translate(t,e),this.boundingRect&&(this.boundingRect.minX=this.boundingRect.minX+t.getValue(12),this.boundingRect.maxX=this.boundingRect.maxX+t.getValue(12),this.boundingRect.minY=this.boundingRect.minY+t.getValue(13),this.boundingRect.maxY=this.boundingRect.maxY+t.getValue(13))}},{key:"scale",value:function(t,e,n){var i=this,r=(new f.default).setTranslate(new g.Vector3([-e.x,-e.y,-e.z])),a=(new f.default).setTranslate(new g.Vector3([e.x,e.y,e.z]));this.needReGenerate()||d.each(this.glPoints,(function(e,n){i.glPoints[n]=new l.default(a.multiplyVector3(t.multiplyVector3(r.multiplyVector3(e))))})),d.each(this.points,(function(e,n){var o=e.getSpeed();i.points[n]=new l.default(a.multiplyVector3(t.multiplyVector3(r.multiplyVector3(e)))),i.points[n].setSpeed(o)})),d.each(this.children,(function(i){i.scale(t,e,n)})),this.updateBoundRect(n),this.selection&&(n.PAINTER_TYPE===E.PAINTER_TYPE_WEBGL?(this.selection.points=[new l.default(this.boundingRect.minX,this.boundingRect.maxY),new l.default(this.boundingRect.maxX,this.boundingRect.minY)],this.selection.generateWebGLPoints(n)):n.PAINTER_TYPE===E.PAINTER_TYPE_CANVAS_2D&&(this.selection.points=[new l.default(this.boundingRect.minX,this.boundingRect.minY),new l.default(this.boundingRect.maxX,this.boundingRect.maxY)],this.selection.generateCanvas2DPoints(n)))}},{key:"rotate",value:function(t,e,n,i){var r=this,a=(new f.default).setTranslate(new g.Vector3([-e.x,-e.y,-e.z])),o=(new f.default).setTranslate(new g.Vector3([e.x,e.y,e.z]));d.each(this.glPoints,(function(e,n){r.glPoints[n]=new l.default(o.multiplyVector3(t.multiplyVector3(a.multiplyVector3(e).toPixelUnit(i)).toGLUnit(i)))})),d.each(this.points,(function(e,n){var s=e.getSpeed();r.points[n]=new l.default(o.multiplyVector3(t.multiplyVector3(a.multiplyVector3(e).toPixelUnit(i)).toGLUnit(i))),r.points[n].setSpeed(s)})),d.each(this.children,(function(r){r.rotate(t,e,n,i)})),this.selection&&(this.selection=null),this.updateBoundRect(i),i.PAINTER_TYPE===E.PAINTER_TYPE_WEBGL?this.angle+=-n:i.PAINTER_TYPE===E.PAINTER_TYPE_CANVAS_2D&&(this.angle+=n),this.angle>360?this.angle-=360:this.angle<-360&&(this.angle+=360)}},{key:"updateBoundRect",value:function(t){var e=this;this.boundingRect=null,this.glPoints.length&&this.boundingRectUnion((0,y.default)(this.glPoints)),d.each(this.children,(function(n){n.updateBoundRect(t),n.boundingRect&&e.boundingRectUnion(n.boundingRect)}))}},{key:"generatePointsForce",value:function(t){t.PAINTER_TYPE===E.PAINTER_TYPE_WEBGL?this.generateWebGLPoints(t):t.PAINTER_TYPE===E.PAINTER_TYPE_CANVAS_2D&&this.generateCanvas2DPoints(t)}},{key:"copyPoints",value:function(t){var e=[];return d.each(t||this.points,(function(t){e.push(t.copy())})),e}},{key:"needReGenerate",value:function(){return E.FALSE}}]),t}();e.default=m,(0,u.default)(m,"POINT_VERTICES_LENGTH",7)},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(230)),o=r(n(3)),s=r(n(4)),u=r(n(5)),l=r(n(237)),c=i(n(20)),h=(i(n(32)),/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/),f=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/,d=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if((0,o.default)(this,t),(0,u.default)(this,"r",0),(0,u.default)(this,"g",0),(0,u.default)(this,"b",0),(0,u.default)(this,"a",1),c.number(e))this.r=e/255,this.g=n/255,this.b=i/255,this.a=r;else if(c.string(e))if(h.test(e)){var s=function(t){if(4===t.length){for(var e="#",n=1;n<4;n++)e+=t[n]+t[n];t=e}for(var i=[],r=1;r<7;r+=2)i.push((0,l.default)("0x"+t.slice(r,r+2)));return i}(e),d=(0,a.default)(s,3);this.r=d[0],this.g=d[1],this.b=d[2],this.r/=255,this.g/=255,this.b/=255,this.a=n}else if(f.test(e)){var p=f.exec(e);this.r=+p[1]/255,this.g=+p[2]/255,this.b=+p[3]/255,this.a=+p[4]}}return(0,s.default)(t,[{key:"toArray",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toString",value:function(){return"rgba(".concat(255*this.r,",").concat(255*this.g,",").concat(255*this.b,",").concat(this.a,")")}},{key:"isFalsy",value:function(){return 0===this.a||0===this.a&&0===this.g&&0===this.b}},{key:"getHex",value:function(t){var e=t.toString(16);return e.length<2?"0".concat(e):e}},{key:"rgbToHex",value:function(){return"#".concat(this.getHex(Math.floor(255*this.r))+this.getHex(Math.floor(255*this.g))+this.getHex(Math.floor(255*this.b)))}}]),t}();e.default=d},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.keys=c,e.sort=function(t,e){return c(t).sort(e?f:h)},e.each=d,e.clear=function(t){d(t,(function(e,n){delete t[n]}))},e.extend=p,e.merge=function(t,e){return t&&e?p(p({},t),e):t||e},e.copy=function t(e,n){var i=e;return o.array(e)?n?(i=[],s.each(e,(function(e,r){i[r]=t(e,n)}))):i=e.slice():o.object(e)&&(i={},d(e,(function(e,r){i[r]=n?t(e,n):e}))),i},e.get=function(t,e){var n;return l.each(e,(function(e,i){if(t==u.NULL)return n=u.UNDEFINED,u.FALSE;var r=t[e];i?n=r:t=r})),n},e.set=function(t,e,n,i){l.each(e,(function(e,r){if(r)t[e]=n;else if(t[e])t=t[e];else{if(!i)return u.FALSE;t=t[e]={}}}))},e.has=function(t,e){return t[e]!==u.UNDEFINED},e.falsy=function(t){return!o.object(t)||o.array(t)||!c(t).length};var a=r(n(242)),o=i(n(20)),s=i(n(11)),u=i(n(6)),l=i(n(245));function c(t){return(0,a.default)(t)}function h(t,e){return t.length-e.length}function f(t,e){return e.length-t.length}function d(t,e){for(var n in t)if(e(t[n],n)===u.FALSE)break}function p(t,e){return d(e,(function(e,n){t[n]=e})),t}},function(t,e,n){t.exports=!n(37)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){var i=n(24),r=n(115),a=n(84),o=Object.defineProperty;e.f=n(28)?Object.defineProperty:function(t,e,n){if(i(t),e=a(e,!0),i(n),r)try{return o(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){t.exports=n(195)},function(t,e,n){var i=n(60);function r(t,e,n,r,a,o,s){try{var u=t[o](s),l=u.value}catch(t){return void n(t)}u.done?e(l):i.resolve(l).then(r,a)}t.exports=function(t){return function(){var e=this,n=arguments;return new i((function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,u,"next",t)}function u(t){r(o,i,a,s,u,"throw",t)}s(void 0)}))}}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.debug=function(t,e){E()<=u&&g(e||"painterGL debug",t,_("#999"))},e.info=function(t,e){E()<=l&&g(e||"painterGL info",t,_("#2db7f5"))},e.warn=function(t,e){E()<=c&&g(e||"painterGL warn",t,_("#f90"))},e.error=function(t,e){E()<=h&&g(e||"painterGL error",t,_("#ed4014"))},e.fatal=function(t,e){if(E()<=f)throw new Error("[".concat(e||"painterGL fatal","]: ").concat(t))},e.FATAL=e.ERROR=e.WARN=e.INFO=e.DEBUG=void 0;var a=r(n(54)),o=i(n(6)),s=r(n(241)),u=1;e.DEBUG=u;var l=2;e.INFO=l;var c=3;e.WARN=c;var h=4;e.ERROR=h;var f=5;e.FATAL=f;var d=("undefined"==typeof console?"undefined":(0,a.default)(console))!==o.RAW_UNDEFINED?console:o.NULL,p=/painterGL/.test((0,s.default)(o.EMPTY_FUNCTION))?l:c,v=o.WINDOW&&/edge|msie|trident/i.test(self.navigator.userAgent)?o.EMPTY_STRING:"%c",g=d?v?function(t,e,n){d.log(v+t,n,e)}:function(t,e){d.log(t,e)}:o.EMPTY_FUNCTION;function E(){if(o.GLOBAL){var t=o.GLOBAL.PAINTERGL_LOG_LEVEL;if(t>=u&&t<=f)return t}return p}function _(t){return"background-color:".concat(t,";border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;")}},function(t,e,n){var i=n(207),r=n(210),a=n(137),o=n(216);t.exports=function(t){return i(t)||r(t)||a(t)||o()}},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.add=o,e.minus=function(t,e){return new a.Vector3([t.x-e.x,t.y-e.y,t.z-e.z])},e.scalarProduct=function(t,e){return new a.Vector3([t.x*e,t.y*e,t.z*e])},e.dotProduct=s,e.crossProduct=u,e.rotate=function(t,e,n){return(new r.default).setRotate(e,n).multiplyVector3(t)},e.vertical=function(t,e){return u(t,e).normalize()},e.angleCos=l,e.angle=function(t,e){return Math.acos(l(t,e))},e.extendPoint=function(t,e){return u(o(t,e),new a.Vector3([0,0,1])).normalize()};var r=i(n(23)),a=n(18);function o(t,e){return new a.Vector3([t.x+e.x,t.y+e.y,t.z+e.z])}function s(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function u(t,e){return new a.Vector3([t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x])}function l(t,e){return s(t,e)/(t.magnitude*e.magnitude)}},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t,e){var n=t.x-e.x,i=t.y-e.y,r=t.z-e.z;return Math.sqrt(n*n+i*i+r*r)},e.distance=function(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var i=n(41);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var i=n(29),r=n(53);t.exports=n(28)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(83),r=n(64);t.exports=function(t){return i(r(t))}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(64);t.exports=function(t){return Object(i(t))}},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n){if(r.func(t))return r.array(n)?t.apply(e,n):e!==a.UNDEFINED?t.call(e,n):n!==a.UNDEFINED?t(n):t()};var r=i(n(20)),a=i(n(6))},function(t,e,n){"use strict";var i=n(167)(!0);n(87)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},function(t,e){t.exports={}},function(t,e,n){n(172);for(var i=n(19),r=n(39),a=n(45),o=n(22)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var l=s[u],c=i[l],h=c&&c.prototype;h&&!h[o]&&r(h,o,l),a[l]=a.Array}},function(t,e,n){var i=n(69)("meta"),r=n(21),a=n(36),o=n(29).f,s=0,u=Object.isExtensible||function(){return!0},l=!n(37)((function(){return u(Object.preventExtensions({}))})),c=function(t){o(t,i,{value:{i:"O"+ ++s,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!u(t))return"F";if(!e)return"E";c(t)}return t[i].i},getWeak:function(t,e){if(!a(t,i)){if(!u(t))return!0;if(!e)return!1;c(t)}return t[i].w},onFreeze:function(t){return l&&h.NEED&&u(t)&&!a(t,i)&&c(t),t}}},function(t,e,n){var i=n(38),r=n(120),a=n(121),o=n(24),s=n(68),u=n(99),l={},c={};(e=t.exports=function(t,e,n,h,f){var d,p,v,g,E=f?function(){return t}:u(t),_=i(n,h,e?2:1),y=0;if("function"!=typeof E)throw TypeError(t+" is not iterable!");if(a(E)){for(d=s(t.length);d>y;y++)if((g=e?_(o(p=t[y])[0],p[1]):_(t[y]))===l||g===c)return g}else for(v=E.call(t);!(p=v.next()).done;)if((g=r(v,_,p.value,e))===l||g===c)return g}).BREAK=l,e.RETURN=c},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t){var e={minX:t[0].x,minY:t[0].y,maxX:t[0].x,maxY:t[0].y};return r.each(t,(function(t){t.x<e.minX?e.minX=t.x:t.x>e.maxX&&(e.maxX=t.x),t.y<e.minY?e.minY=t.y:t.y>e.maxY&&(e.maxY=t.y)})),e};var r=i(n(11))},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(9)),s=i(n(10)),u=i(n(8)),l=function(t){(0,o.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}(n);function n(t,i){return(0,a.default)(this,n),e.call(this,t.VERTEX_SHADER,i)}return n}(i(n(155)).default);e.default=l},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(9)),s=i(n(10)),u=i(n(8)),l=function(t){(0,o.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}(n);function n(t,i){return(0,a.default)(this,n),e.call(this,t.FRAGMENT_SHADER,i)}return n}(i(n(155)).default);e.default=l},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(165),r=n(94);function a(e){return t.exports=a="function"==typeof r&&"symbol"==typeof i?function(t){return typeof t}:function(t){return t&&"function"==typeof r&&t.constructor===r&&t!==r.prototype?"symbol":typeof t},a(e)}t.exports=a},function(t,e){t.exports=!0},function(t,e,n){var i=n(24),r=n(169),a=n(91),o=n(89)("IE_PROTO"),s=function(){},u=function(){var t,e=n(85)("iframe"),i=a.length;for(e.style.display="none",n(117).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;i--;)delete u.prototype[a[i]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=i(t),n=new s,s.prototype=null,n[o]=t):n=u(),void 0===e?n:r(n,e)}},function(t,e,n){var i=n(116),r=n(91);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e,n){var i=n(29).f,r=n(36),a=n(22)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,a)&&i(t,a,{configurable:!0,value:e})}},function(t,e,n){var i=n(21);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){t.exports=n(189)},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(33)),s=r(n(3)),u=r(n(4)),l=r(n(12)),c=r(n(17)),h=r(n(9)),f=r(n(10)),d=r(n(8)),p=r(n(5)),v=r(n(25)),g=r(n(13)),E=r(n(23)),_=i(n(11)),y=i(n(34)),m=i(n(15)),T=n(18),A=i(n(6)),R=n(74),S=r(n(246)),x=r(n(75)),P=r(n(247)),O=r(n(49)),I=r(n(248)),w=r(n(77)),b=function(t){(0,h.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.default)(this,n)}}(n);function n(t){var i;return(0,s.default)(this,n),i=e.call(this,t),(0,p.default)((0,l.default)(i),"vertical",void 0),(0,p.default)((0,l.default)(i),"normalize",void 0),(0,p.default)((0,l.default)(i),"startDir",void 0),(0,p.default)((0,l.default)(i),"endDir",void 0),(0,p.default)((0,l.default)(i),"round",void 0),i.name=m.LINE,i.round=t.round,i}return(0,u.default)(n,[{key:"drawing",value:function(t,e){this.validate()?(this.removePointByIndex(1),this.appendPoint(e)):this.appendPoint(e),t.drawing(this)}},{key:"generateWebGLPoints",value:function(t,e,i,r,a){var o=this;if(!this.validate())return this;this.startDir=e,this.endDir=i,this.children=[],this.glPoints=[],this.boundingRect=null,this.vertical=y.vertical(new T.Vector3([this.points[1].x-this.points[0].x,this.points[1].y-this.points[0].y,this.points[1].z-this.points[0].z]),new T.Vector3([0,0,1]));var s=(0,I.default)(this.getNormalize(),this.lineWidth,t.getUnitLength());if(this.dash){var u=(0,P.default)(this.points[0],this.points[1],{entity:this.dashSegments[0]*t.getUnitLength(),dash:this.dashSegments[1]*t.getUnitLength()});if(u.length>1){var l=this.getOptions();_.each(u,(function(e){l.points=e;var i=new n(l);i.generateWebGLPoints(t),o.boundingRectUnion(i.boundingRect),o.children.push(i)}))}else this.glPoints=(0,S.default)(u[0][0],u[0][1],r||s,a||s,this.vertical,this.vertical,t.getWidthHeightRatio()),this.boundingRect=(0,O.default)(this.glPoints)}else if(this.glPoints=(0,S.default)(this.points[0],this.points[1],r||s,a||s,e||this.vertical,i||this.vertical,t.getWidthHeightRatio()),this.boundingRect=(0,O.default)(this.glPoints),this.round&&this.lineWidth>3){var c=this.getOptions();c.isFill=A.TRUE,c.fill=this.stroke,c.isStroke=A.FALSE,c.points=[this.points[0].copy(),this.points[0].copy()],c.points[1].x=c.points[1].x+(r||s)/2;var h=new w.default(c);h.isFirstPointCenter=!0,h.generateWebGLPoints(t),this.boundingRectUnion(h.boundingRect),this.children.push(h),c.points=[this.points[1].copy(),this.points[1].copy()],c.points[1].x=c.points[1].x+(r||s)/2,(h=new w.default(c)).isFirstPointCenter=!0,h.generateWebGLPoints(t),this.boundingRectUnion(h.boundingRect),this.children.push(h)}return this}},{key:"generateCanvas2DPoints",value:function(t){if(!this.validate())return this;this.glPoints=this.copyPoints(),this.boundingRect=(0,O.default)(this.glPoints);var e=this.lineWidth*t.getUnitLength()/2;return Math.abs(this.boundingRect.maxX-this.boundingRect.minX)<e&&(this.boundingRect.minX-=e,this.boundingRect.maxX+=e),Math.abs(this.boundingRect.maxY-this.boundingRect.minY)<e&&(this.boundingRect.minY-=e,this.boundingRect.maxY+=e),this}},{key:"updateGLPoints",value:function(t,e,n){var i,r;if(!this.dash||!this.children.length)return e&&(i=this.glPoints).splice.apply(i,[0,2].concat((0,o.default)((0,x.default)(this.points[0],e,this.lineWidth*t.getUnitLength()/2,t.getWidthHeightRatio())))),n&&(r=this.glPoints).splice.apply(r,[2,2].concat((0,o.default)((0,x.default)(this.points[1],n,this.lineWidth*t.getUnitLength()/2,t.getWidthHeightRatio(),A.TRUE)))),this.boundingRect=(0,O.default)(this.glPoints),this;this.children[this.children.length-1].updateGLPoints(t,e,n)}},{key:"getVertical",value:function(t){return this.vertical||(this.vertical=y.vertical(new T.Vector3([this.points[1].x-this.points[0].x,this.points[1].y-this.points[0].y,this.points[1].z-this.points[0].z]),new T.Vector3([0,0,1]))),this.vertical}},{key:"getNormalize",value:function(){return this.normalize||(this.normalize=new T.Vector3([this.points[1].x-this.points[0].x,this.points[1].y-this.points[0].y,this.points[1].z-this.points[0].z]).normalize()),this.normalize}},{key:"isPointInPath",value:function(t,e,n){return(0,R.isPointInLine)(t,this.points[0],this.points[1],(null!=n?n:this.lineWidth)*e.getUnitLength()*(this.lineWidth<4?3:this.lineWidth>10?1:2),e.getWidthHeightRatio())}},{key:"resize",value:function(t){this.generateWebGLPoints(t,this.startDir,this.endDir)}},{key:"drawGLPath",value:function(t,e){var i=0;return this.glPoints.length&&(t.gl.drawArrays(t.gl.TRIANGLE_FAN,e,this.glPoints.length),i+=this.glPoints.length),i+(0,c.default)((0,d.default)(n.prototype),"drawGLPath",this).call(this,t,e+i)}},{key:"draw2DPath",value:function(t,e){t.setOptions(this,e),t.drawPath(this.glPoints,this),(0,c.default)((0,d.default)(n.prototype),"draw2DPath",this).call(this,t)}},{key:"scale",value:function(t,e,n){var i=this,r=(new E.default).setTranslate(new T.Vector3([-e.x,-e.y,-e.z])),a=(new E.default).setTranslate(new T.Vector3([e.x,e.y,e.z]));_.each(this.points,(function(e,n){i.points[n]=new g.default(a.multiplyVector3(t.multiplyVector3(r.multiplyVector3(e))))})),n.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL?this.generateWebGLPoints(n):n.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D&&this.generateCanvas2DPoints(n),this.selection&&(n.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL?(this.selection.points=[new g.default(this.boundingRect.minX,this.boundingRect.maxY),new g.default(this.boundingRect.maxX,this.boundingRect.minY)],this.selection.generateWebGLPoints(n)):n.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D&&(this.selection.points=[new g.default(this.boundingRect.minX,this.boundingRect.minY),new g.default(this.boundingRect.maxX,this.boundingRect.maxY)],this.selection.generateCanvas2DPoints(n)))}},{key:"dragPoint",value:function(t,e,n){this.points[e]=n,t.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL?this.generateWebGLPoints(t):t.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D&&this.generateCanvas2DPoints(t),this.updateBoundRect(t),this.selection&&(t.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL?(this.selection.points=[new g.default(this.boundingRect.minX,this.boundingRect.maxY),new g.default(this.boundingRect.maxX,this.boundingRect.minY)],this.selection.generateWebGLPoints(t)):t.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D&&(this.selection.points=[new g.default(this.boundingRect.minX,this.boundingRect.minY),new g.default(this.boundingRect.maxX,this.boundingRect.maxY)],this.selection.generateCanvas2DPoints(t)))}},{key:"needReGenerate",value:function(){return this.round}},{key:"validate",value:function(){return 2===this.points.length}}]),n}(v.default);e.default=b},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(17)),l=r(n(9)),c=r(n(10)),h=r(n(8)),f=r(n(25)),d=r(n(13)),p=i(n(11)),v=i(n(15)),g=r(n(79)),E=r(n(105)),_=function(t){(0,l.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.default)(this,n)}}(n);function n(t){var i;return(0,o.default)(this,n),(i=e.call(this,t)).name=v.RECT,i.children=[],i}return(0,s.default)(n,[{key:"drawing",value:function(t,e){this.validate()?(this.removePointByIndex(1),this.appendPoint(e)):this.appendPoint(e),t.drawing(this)}},{key:"generateWebGLPoints",value:function(t){if(!this.validate())return this;this.glPoints=[],this.children=[],this.boundingRect=null;var e=this.points[0].copy(),i=this.points[1].copy(),r=new d.default(i.x,e.y),a=new d.default(e.x,i.y);if(this.isFill){if(e.x<i.x&&e.y>i.y?this.glPoints=[i,r,e,a]:e.x<i.x||e.y>i.y?this.glPoints=[e,r,i,a]:this.glPoints=[i,r,e,a],this.boundingRect={minX:Math.min(e.x,i.x),maxX:Math.max(e.x,i.x),minY:Math.min(e.y,i.y),maxY:Math.max(e.y,i.y)},this.isStroke){var o=this.getOptions();o.lineWidth=.5,o.isFill=!1,o.points=(0,g.default)(this.boundingRect,.25*t.getUnitLength(),t.getWidthHeightRatio());var s=new n(o);s.generateWebGLPoints(t),this.boundingRectUnion(s.boundingRect),this.children.push(s)}}else{var u=this.getOptions();u.close=!0,e.x<i.x&&e.y>i.y?u.points=[i,r,e,a]:e.x<i.x||e.y>i.y?u.points=[e,r,i,a]:u.points=[i,r,e,a];var l=new E.default(u);l.generateWebGLPoints(t),this.boundingRectUnion(l.boundingRect),this.children.push(l)}return this}},{key:"generateCanvas2DPoints",value:function(t){if(!this.validate())return this;this.glPoints=[],this.children=[];var e=this.points[0].copy(),n=this.points[1].copy(),i=new d.default(n.x,e.y),r=new d.default(e.x,n.y);if(this.isFill)e.x<n.x&&e.y>n.y?this.glPoints=[n,i,e,r,n]:e.x<n.x||e.y>n.y?this.glPoints=[e,i,n,r,e]:this.glPoints=[n,i,e,r,n],this.boundingRect={minX:Math.min(e.x,n.x),maxX:Math.max(e.x,n.x),minY:Math.min(e.y,n.y),maxY:Math.max(e.y,n.y)};else{var a=this.getOptions();a.close=!0,e.x<n.x&&e.y>n.y?a.points=[n,i,e,r]:e.x<n.x||e.y>n.y?a.points=[e,i,n,r]:a.points=[n,i,e,r];var o=new E.default(a);o.generateCanvas2DPoints(t),this.boundingRectUnion(o.boundingRect),this.children.push(o)}return this}},{key:"isPointInPath",value:function(t,e,n){if(this.isFill)return!0;var i=!1;return p.each(this.children,(function(r){if(r.isPointInPath(t,e,n))return i=!0,!1})),i}},{key:"drawGLPath",value:function(t,e){var i=0;return this.isFill&&(t.gl.drawArrays(t.gl.TRIANGLE_FAN,e,this.glPoints.length),i+=this.glPoints.length),i+(0,u.default)((0,h.default)(n.prototype),"drawGLPath",this).call(this,t,e+i)}},{key:"draw2DPath",value:function(t,e){t.setOptions(this,e),this.isFill&&t.drawPath(this.glPoints,this),(0,u.default)((0,h.default)(n.prototype),"draw2DPath",this).call(this,t,e)}},{key:"validate",value:function(){return 2===this.points.length}},{key:"toJSON",value:function(t){var e=[];return p.each(this.isFill?this.glPoints.slice(0,4):this.children[0].points.slice(0,4),(function(n){e.push(n.toJson(t))})),e.length?(0,u.default)((0,h.default)(n.prototype),"toJSON",this).call(this,t,{points:e}):(0,u.default)((0,h.default)(n.prototype),"toJSON",this).call(this,t)}}]),n}(f.default);e.default=_},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.HISTORY_RECORD_CHANGE=e.CANVAS_CURSOR_CHANGE=e.IMAGE_LOAD_FAIL=e.SCROLL_TOP_CHANGE=e.LOCAL_SHAPE_DBLCLICK=e.LOCAL_TEXT_BLUR=e.LOCAL_TEXT_CHANGE=e.LOCAL_SHAPE_CLEAR=e.LOCAL_SHAPE_UPDATE=e.LOCAL_SHAPE_REMOVE=e.LOCAL_SHAPE_APPEND=e.LOCAL_SHAPE_ADD=e.TEXT_TEXTURE_DATA=e.TEXT_TEXTURE_DATA_TRIGGER=e.TEXT_DRAWING_END=e.TEXT_DRAWING_START=e.CAMERA_POSITION_CHANGE=e.TASK_BUFFER_CHANGE_TRIGGER=e.MOUSEMOVE_DELAY_CHANGE_TRIGGER=e.DRAG_CURSOR_CHANGE=e.ACTIVE_DRAG_START=e.ACTIVE_ROTATE_START=e.SHAPE_UPDATE=e.SHAPE_REMOVE=e.SHAPE_ADD=e.SHAPE_DELETE=e.SHAPE_DRAWING_END=e.SHAPE_DRAWING=e.SHAPE_DRAWING_START=e.SELECTION_END=e.SELECTION_START=e.SELECTION_RECT_CHANGE=e.ACTIVE_DRAG_BOX_LEAVE=e.ACTIVE_DRAG_BOX_ENTER=e.ACTIVE_RECT_MOVE_END=e.ACTIVE_RECT_MOVE_START=e.ACTIVE_RECT_CHANGE_END=e.ACTIVE_RECT_CHANGE_START=e.ACTIVE_SHAPE_DELETE=e.ACTIVE_SHAPE_CHANGE=e.HOVER_SHAPE_CHANGE=e.SHAPE_LEAVE=e.SHAPE_ENTER=e.CLEAR=e.MOUSE_WHEEL_DOWN=e.MOUSE_WHEEL_UP=e.MOUSE_DBLCLICK=e.MOUSE_UP=e.MOUSE_MOVE=e.MOUSE_DOWN=void 0,e.MOUSE_DOWN="mouse_down",e.MOUSE_MOVE="mouse_move",e.MOUSE_UP="mouse_up",e.MOUSE_DBLCLICK="mouse_dblclick",e.MOUSE_WHEEL_UP="mouse_wheel_up",e.MOUSE_WHEEL_DOWN="mouse_wheel_down",e.CLEAR="clear",e.SHAPE_ENTER="shape_enter",e.SHAPE_LEAVE="shape_leave",e.HOVER_SHAPE_CHANGE="hover_shape_change",e.ACTIVE_SHAPE_CHANGE="active_shape_change",e.ACTIVE_SHAPE_DELETE="active_shape_delete",e.ACTIVE_RECT_CHANGE_START="active_rect_change_start",e.ACTIVE_RECT_CHANGE_END="active_rect_change_end",e.ACTIVE_RECT_MOVE_START="active_rect_move_start",e.ACTIVE_RECT_MOVE_END="active_rect_move_end",e.ACTIVE_DRAG_BOX_ENTER="active_drag_box_enter",e.ACTIVE_DRAG_BOX_LEAVE="active_drag_box_leave",e.SELECTION_RECT_CHANGE="selection_rect_change",e.SELECTION_START="selection_start",e.SELECTION_END="selection_end",e.SHAPE_DRAWING_START="shape_drawing_start",e.SHAPE_DRAWING="shape_drawing",e.SHAPE_DRAWING_END="shape_drawing_end",e.SHAPE_DELETE="shape_delete",e.SHAPE_ADD="shape_add",e.SHAPE_REMOVE="shape_remove",e.SHAPE_UPDATE="shape_update",e.ACTIVE_ROTATE_START="active_rotate_start",e.ACTIVE_DRAG_START="active_drag_start",e.DRAG_CURSOR_CHANGE="drag_cursor_change",e.MOUSEMOVE_DELAY_CHANGE_TRIGGER="mousemove_delay_change_trigger",e.TASK_BUFFER_CHANGE_TRIGGER="task_buffer_change_trigger",e.CAMERA_POSITION_CHANGE="camera_position_change",e.TEXT_DRAWING_START="text_drawing_start",e.TEXT_DRAWING_END="text_drawing_end",e.TEXT_TEXTURE_DATA_TRIGGER="text_texture_data_trigger",e.TEXT_TEXTURE_DATA="text_texture_data",e.LOCAL_SHAPE_ADD="local_shape_add",e.LOCAL_SHAPE_APPEND="local_shape_append",e.LOCAL_SHAPE_REMOVE="local_shape_remove",e.LOCAL_SHAPE_UPDATE="local_shape_update",e.LOCAL_SHAPE_CLEAR="local_shape_clear",e.LOCAL_TEXT_CHANGE="local_text_change",e.LOCAL_TEXT_BLUR="local_text_blur",e.LOCAL_SHAPE_DBLCLICK="lcoal_shape_dblclick",e.SCROLL_TOP_CHANGE="scroll_top_change",e.IMAGE_LOAD_FAIL="image_load_fail",e.CANVAS_CURSOR_CHANGE="canvas_cursor_change",e.HISTORY_RECORD_CHANGE="histtory_record_change"},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var i=n(66),r=n(53),a=n(40),o=n(84),s=n(36),u=n(115),l=Object.getOwnPropertyDescriptor;e.f=n(28)?l:function(t,e){if(t=a(t),e=o(e,!0),u)try{return l(t,e)}catch(t){}if(s(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var i=n(16),r=n(14),a=n(37);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],o={};o[t]=e(n),i(i.S+i.F*a((function(){n(1)})),"Object",o)}},function(t,e,n){var i=n(86),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e){},function(t,e,n){var i=n(39);t.exports=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:i(t,r,e[r]);return t}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(52),r=n(22)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?n:a?i(e):"Object"==(o=i(e))&&"function"==typeof e.callee?"Arguments":o}},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.isPointInLine=a,e.isPointInLines=function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=!1;return r.each(e,(function(r,u){if(u<e.length-1){if(s=a(t,r,e[u+1],n,i))return!1}else o&&(s=a(t,r,e[0],n,i))})),s};var r=i(n(11));function a(t,e,n,i,r){var a=e.x,o=e.y,s=n.x,u=n.y,l=t.x,c=t.y;if(!i)return!1;var h=i/2;if(l>a+h&&l>s+h||l<a-h&&l<s-h||c>o+h&&c>u+h||c<o-h&&c<u-h)return!1;if(a===s)return Math.abs(l-a)<=h;var f=(u-o)/(s-a),d=(a*u-s*o)/(a-s),p=Math.pow(f*l-c+d,2)/(f*f+1),v=Math.atan(f)+Math.PI/2;return p=Math.pow(Math.cos(v)*p,2)+Math.pow(Math.sin(v)*p*r,2),(p=Math.sqrt(p))<=Math.pow(h,2)}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(e=o.scalarProduct(e,n)).y=e.y*i;var s=new a.default(o.add(t,e)),u=new a.default(o.minus(t,e));return r?[u,s]:[s,u]};var a=r(n(13)),o=i(n(34))},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return 0;var n=Math.atan(Math.abs(t.y/t.x));return t.x>0?t.y<0&&(n=2*Math.PI-n):n=t.y>0?Math.PI-n:Math.PI+n,e&&(n=180*n/Math.PI),n}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(33)),s=r(n(3)),u=r(n(4)),l=r(n(12)),c=r(n(17)),h=r(n(9)),f=r(n(10)),d=r(n(8)),p=r(n(5)),v=r(n(61)),g=r(n(25)),E=r(n(13)),_=r(n(23)),y=i(n(11)),m=i(n(15)),T=n(18),A=i(n(6)),R=r(n(35)),S=r(n(249)),x=r(n(79)),P=r(n(250)),O=r(n(76)),I=r(n(251)),w=r(n(141)),b=function(t){(0,h.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.default)(this,n)}}(n);function n(t){var i;return(0,s.default)(this,n),i=e.call(this,t),(0,p.default)((0,l.default)(i),"a",void 0),(0,p.default)((0,l.default)(i),"b",void 0),(0,p.default)((0,l.default)(i),"isFirstPointCenter",void 0),i.name=m.CIRCLE,i.children=[],t.a&&t.b?(i.a=t.a,i.b=t.b):(i.a=0,i.b=0),i}return(0,u.default)(n,[{key:"getCenter",value:function(){return this.isFirstPointCenter?this.points[0].copy():(0,w.default)(this.points[0],this.points[1])}},{key:"drawing",value:function(t,e){this.validate()?(this.removePointByIndex(1),this.appendPoint(e)):this.appendPoint(e),t.drawing(this)}},{key:"computeRadius",value:function(t){if(this.isFirstPointCenter){var e=(0,O.default)(new T.Vector3([this.points[1].x-this.points[0].x,this.points[1].y-this.points[0].y,this.points[1].z-this.points[0].z])),n=(0,R.default)(this.points[0],this.points[1]),i=Math.pow(Math.cos(e)*n,2)+Math.pow(Math.sin(e)*n/t.getWidthHeightRatio(),2);this.a=Math.sqrt(i),this.b=this.a*t.getWidthHeightRatio()}else this.a=Math.abs(this.points[0].x-this.points[1].x)/2,this.b=Math.abs(this.points[0].y-this.points[1].y)/2}},{key:"generateWebGLPoints",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A.TRUE,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.validate())return this;1===this.points.length&&(this.isFirstPointCenter=!0),this.children=[],this.glPoints=[],this.points.length>1&&i&&this.computeRadius(t);var a=this.getCenter();if(this.isFill){var s=(0,S.default)(a,this.a,this.b,Math.max(this.a,this.b)>.5?400:100);if(this.glPoints=[a].concat((0,o.default)(s),[s[0]]),this.boundingRect={minX:a.x-this.a,maxX:a.x+this.a,minY:a.y-this.b,maxY:a.y+this.b},this.isStroke&&this.points[1]){var u=this.getOptions();u.lineWidth=this.strokeWidth,u.isFill=!1,u.points=(0,x.default)({minX:this.points[0].x,minY:this.points[1].y,maxX:this.points[1].x,maxY:this.points[0].y},t.getUnitLength()*this.strokeWidth/2,t.getWidthHeightRatio()),this.isFirstPointCenter&&(u.points[0]=a.copy());var l=new n(u);l.isFirstPointCenter=this.isFirstPointCenter,l.generateWebGLPoints(t),this.boundingRectUnion(l.boundingRect),this.children.push(l)}}else{var c=this.getOptions();if(this.dash)c.dash=A.FALSE,y.each((0,P.default)(a,this.a,this.b,{entity:this.dashSegments[0]*t.getUnitLength(),dash:this.dashSegments[1]*t.getUnitLength()}),(function(n){c.points=n;var i=new v.default(c);i.generateWebGLPoints(t),e.children.push(i)}));else for(var h=(0,S.default)(a,this.a,this.b,Math.max(this.a,this.b)>.3?80:40),f=0;f<h.length;f++){f===h.length-1?c.points=[h[f],h[0]]:c.points=[h[f],h[f+1]];var d=new v.default(c);d.generateWebGLPoints(t),this.children.push(d)}this.boundingRect={minX:a.x-this.a-this.lineWidth*t.getUnitLength(),maxX:a.x+this.a+this.lineWidth*t.getUnitLength(),minY:a.y-(this.b+this.lineWidth*t.getUnitLength()*t.getWidthHeightRatio()),maxY:a.y+(this.b+this.lineWidth*t.getUnitLength()*t.getWidthHeightRatio())}}return r&&this.rotate((new _.default).setRotate(r,new T.Vector3([0,0,-1])),a,r,t),this}},{key:"generateCanvas2DPoints",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.validate())return this;this.points.length>1&&e&&this.computeRadius(t),this.glPoints=[],this.children=[];var n=this.getCenter();if(this.a*t.getWidthHeightRatio()===this.b)this.glPoints.push(new E.default(n.x+this.a,n.y)),this.glPoints.push(n);else{var i=1.35*this.a,r=this.b;this.glPoints=[new E.default(n.x,n.y-r),new E.default(n.x+i,n.y-r),new E.default(n.x+i,n.y+r),new E.default(n.x,n.y+r),new E.default(n.x-i,n.y+r),new E.default(n.x-i,n.y-r)]}return this.updateBoundRect(t),this}},{key:"updateBoundRect",value:function(t){if(t.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL)(0,c.default)((0,d.default)(n.prototype),"updateBoundRect",this).call(this,t);else if(t.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D){var e=this.getCenter();this.isFill||Math.floor(this.a*t.getWidth())===Math.floor(this.b*t.getHeight())?this.boundingRect={minX:e.x-this.a,maxX:e.x+this.a,minY:e.y-this.b,maxY:e.y+this.b}:this.boundingRect={minX:e.x-this.a-this.lineWidth*t.getUnitLength(),maxX:e.x+this.a+this.lineWidth*t.getUnitLength(),minY:e.y-this.b-this.lineWidth*t.getUnitLength()*t.getWidthHeightRatio(),maxY:e.y+this.b+this.lineWidth*t.getUnitLength()*t.getWidthHeightRatio()}}}},{key:"isPointInPath",value:function(t,e,n){var i=this.getCenter();if(this.isFill)return Math.pow(t.x-i.x,2)/(this.a*this.a)+Math.pow(t.y-i.y,2)/(this.b*this.b)<=1;var r=A.FALSE;return e.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL?y.each(this.children,(function(i){if(i.isPointInPath(t,e,n))return r=A.TRUE,A.FALSE})):e.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D&&(r=(0,I.default)(new E.default(Math.floor(t.x*e.getWidth()),Math.floor(t.y*e.getHeight()),t.z),new E.default(Math.floor(i.x*e.getWidth()),Math.floor(i.y*e.getHeight()),i.z),Math.floor(this.a*e.getWidth()),Math.floor(this.b*e.getHeight()),this.lineWidth<4?2*this.lineWidth:this.lineWidth)),r}},{key:"drawGLPath",value:function(t,e){var i=0;return this.isFill&&(t.gl.drawArrays(t.gl.TRIANGLE_FAN,e,this.glPoints.length),i=this.glPoints.length),i+(0,c.default)((0,d.default)(n.prototype),"drawGLPath",this).call(this,t,e+i)}},{key:"draw2DPath",value:function(t,e){t.setOptions(this,e),t.drawOval(this.glPoints,this),(0,c.default)((0,d.default)(n.prototype),"draw2DPath",this).call(this,t,e)}},{key:"scale",value:function(t,e,i){var r=this,a=t.getValue(0),o=t.getValue(5);if(this.a*=a,this.b*=o,this.dash){var s=(new _.default).setTranslate(new T.Vector3([-e.x,-e.y,-e.z])),u=(new _.default).setTranslate(new T.Vector3([e.x,e.y,e.z]));y.each(this.points,(function(e,n){r.points[n]=new E.default(u.multiplyVector3(t.multiplyVector3(s.multiplyVector3(e))))})),i.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL?this.generateWebGLPoints(i,A.FALSE):i.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D&&this.generateCanvas2DPoints(i,A.FALSE),this.updateBoundRect(i),this.selection&&(i.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL?(this.selection.points=[new E.default(this.boundingRect.minX,this.boundingRect.maxY),new E.default(this.boundingRect.maxX,this.boundingRect.minY)],this.selection.generateWebGLPoints(i)):i.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D&&(this.selection.points=[new E.default(this.boundingRect.minX,this.boundingRect.minY),new E.default(this.boundingRect.maxX,this.boundingRect.maxY)],this.selection.generateCanvas2DPoints(i)))}else(0,c.default)((0,d.default)(n.prototype),"scale",this).call(this,t,e,i),i.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D&&this.generateCanvas2DPoints(i,A.FALSE)}},{key:"validate",value:function(){return this.points.length>=1}},{key:"toJSON",value:function(t){var e,i,r=this.getCenter();t.useWebGL?(e=(r.x-this.a+1)/2,i=(1-r.y-this.b)/2):(e=r.x-this.a,i=r.y-this.b),t.totalPage>1&&(i/=t.totalPage);var a=t.useWebGL?this.a:2*this.a,o=t.useWebGL?this.b:2*this.b;return(0,c.default)((0,d.default)(n.prototype),"toJSON",this).call(this,t,{x:e,y:i,width:a,height:o,a:a/2,b:o/2,points:[r.toJson(t)]})}}]),n}(g.default);e.default=b},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return new r.default(t.x+n*Math.cos(e),t.y+i*Math.sin(e))};var r=i(n(13))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n,i){i||(i=new s.Vector3([1,-1,0]));var r=o.scalarProduct(i.normalize(),e);return r.y=r.y*n,[new a.default(o.minus(new s.Vector3([t.minX,t.maxY,0]),r)),new a.default(o.add(new s.Vector3([t.maxX,t.minY,0]),r))]};var a=r(n(13)),o=i(n(34)),s=n(18)},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(33)),s=r(n(3)),u=r(n(4)),l=r(n(12)),c=r(n(17)),h=r(n(9)),f=r(n(10)),d=r(n(8)),p=r(n(5)),v=r(n(26)),g=r(n(25)),E=r(n(13)),_=i(n(20)),y=i(n(15)),m=i(n(6)),T=i(n(11)),A=r(n(144)),R=r(n(81)),S=function(t){(0,h.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.default)(this,n)}}(n);function n(t){var i;return(0,s.default)(this,n),i=e.call(this,t),(0,p.default)((0,l.default)(i),"text",void 0),(0,p.default)((0,l.default)(i),"fontSize",void 0),(0,p.default)((0,l.default)(i),"fontFamily",void 0),(0,p.default)((0,l.default)(i),"fontItalic",void 0),(0,p.default)((0,l.default)(i),"bold",void 0),(0,p.default)((0,l.default)(i),"width",void 0),(0,p.default)((0,l.default)(i),"height",void 0),(0,p.default)((0,l.default)(i),"offsetX",void 0),(0,p.default)((0,l.default)(i),"offsetY",void 0),(0,p.default)((0,l.default)(i),"radius",void 0),(0,p.default)((0,l.default)(i),"background",void 0),(0,p.default)((0,l.default)(i),"imageData",void 0),(0,p.default)((0,l.default)(i),"hoverImageData",void 0),(0,p.default)((0,l.default)(i),"maxWidth",void 0),i.name=y.TEXT,i.fontSize=t.fontSize,i.fontFamily=t.fontFamily,i.fontItalic=t.fontItalic,i.bold=t.bold,i.text=t.text,i.maxWidth=t.maxWidth,i.dash=!1,i.offsetX=i.offsetY=0,i.radius=t.radius||4,i.background=new v.default(m.ACTIVE_INFO_RECT_BACKGROUND),i.width=t.width,i.height=t.height,t.imageData&&(i.imageData=t.imageData),t.hoverImageData&&(i.hoverImageData=t.hoverImageData),i}return(0,u.default)(n,[{key:"drawing",value:function(t,e){}},{key:"endDrawing",value:function(t){if(this.validate())return t.drawing(this),(0,c.default)((0,d.default)(n.prototype),"endDrawing",this).call(this,t)}},{key:"generateWebGLPoints",value:function(t){if(this.validate())return this.isFill&&(this.offsetX=m.ACTIVE_INFO_RECT_PADDING_H,this.offsetY=m.ACTIVE_INFO_RECT_PADDING_V,this.width+=2*m.ACTIVE_INFO_RECT_PADDING_H,this.height+=2*m.ACTIVE_INFO_RECT_PADDING_V),this.boundingRect={minX:this.points[0].x,maxY:this.points[0].y,maxX:this.points[0].x+this.width*t.config.devicePixelRatio*2/t.getWidth(),minY:this.points[0].y-this.height*t.config.devicePixelRatio*2/t.getHeight()},this.glPoints=[this.points[0].copy(),new E.default(this.boundingRect.minX,this.boundingRect.minY),new E.default(this.boundingRect.maxX,this.boundingRect.maxY),new E.default(this.boundingRect.maxX,this.boundingRect.minY)],this}},{key:"generateCanvas2DPoints",value:function(t){return this.validate()?(this.computeTextSize(t),this.boundingRect={minX:this.points[0].x,minY:this.points[0].y,maxX:this.points[0].x+this.width*t.config.devicePixelRatio/t.getWidth(),maxY:this.points[0].y+this.height*t.config.devicePixelRatio/t.getHeight()},this):this}},{key:"isPointInPath",value:function(t,e,n){return!0}},{key:"drawGLPath",value:function(t,e){var i=0;return t.enableTexture(!0),t.bindTextureData(this.imageData),t.gl.blendFuncSeparate(t.gl.SRC_ALPHA,t.gl.ONE_MINUS_SRC_ALPHA,t.gl.ONE,t.gl.ONE_MINUS_SRC_ALPHA),t.gl.drawArrays(t.gl.TRIANGLE_STRIP,e+i,this.glPoints.length),t.resetAlphaFunc(),i+=this.glPoints.length,t.enableTexture(!1),i+(0,c.default)((0,d.default)(n.prototype),"drawGLPath",this).call(this,t,e+i)}},{key:"draw2DPath",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.setOptions(this,e),t.setFont(this,i),t.drawText(this,i),(0,c.default)((0,d.default)(n.prototype),"draw2DPath",this).call(this,t,e)}},{key:"toVertices",value:function(t,e){var i=[].concat((0,o.default)(this.glPoints[0].toArray()),[0,1,0,0],(0,o.default)(this.glPoints[1].toArray()),[0,0,0,0],(0,o.default)(this.glPoints[2].toArray()),[1,1,0,0],(0,o.default)(this.glPoints[3].toArray()),[1,0,0,0]);return(0,c.default)((0,d.default)(n.prototype),"toVertices",this).call(this,t,e,i)}},{key:"validate",value:function(){return _.string(this.text)}},{key:"computeTextSize",value:function(t){var e=this;if(this.text)if(document){var n=(0,A.default)(this.text,this),i=n.width,r=n.height;this.width=i,this.height=r}else if(t.PAINTER_TYPE===m.PAINTER_TYPE_CANVAS_2D){t.setFont(this,!1);var a=this.text.split("\n");this.width=0,T.each(a,(function(n){n&&(e.width=Math.max(e.width,Math.ceil(t.measureText(n).width/t.config.devicePixelRatio)))})),this.height=(0,R.default)(this.fontSize)*a.length}}},{key:"copy",value:function(){return new n({fill:this.fill,stroke:this.stroke,points:this.points,fontSize:this.fontSize,fontFamily:this.fontFamily,fontItalic:this.fontItalic,bold:this.bold,text:this.text,maxWidth:this.maxWidth,isFill:this.isFill,isStroke:this.isStroke})}},{key:"getTextTeure",value:function(){return{label:this.text,width:this.imageData.width,height:this.imageData.height,imageData:this.imageData,hoverImageData:this.hoverImageData}}},{key:"toJSON",value:function(t){var e=this.points[0].toJson(t);return(0,c.default)((0,d.default)(n.prototype),"toJSON",this).call(this,t,{text:this.text,maxWidth:this.maxWidth,fontSize:this.fontSize,fontFamily:this.fontFamily,fontItalic:this.fontItalic,bold:this.bold,x:e.x,y:e.y})}}]),n}(g.default);e.default=S},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t){return t<14?Math.floor(t+t/6)-2:t<20?Math.floor(t+t/6)-1:t<24?Math.floor(t+t/6):t<40?Math.ceil(t+t/6):t<70?Math.ceil(t+t/6)+Math.floor((t-40)/12)+1:Math.ceil(t+t/6)+4}},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(17)),l=i(n(9)),c=i(n(10)),h=i(n(8)),f=i(n(5)),d=function(t){(0,l.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,h.default)(t);if(e){var a=(0,h.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,c.default)(this,n)}}(n);function n(t,i,r){var o;return(0,a.default)(this,n),o=e.call(this,t,i,r),(0,f.default)((0,s.default)(o),"resolutionLocation",void 0),o}return(0,o.default)(n,[{key:"link",value:function(){(0,u.default)((0,h.default)(n.prototype),"link",this).call(this),this.resolutionLocation=this.gl.getUniformLocation(this.program,"resolution")}},{key:"setResolution",value:function(t){this.gl.uniform2fv(this.resolutionLocation,new Float32Array(t))}}]),n}(i(n(278)).default);e.default=d},function(t,e,n){var i=n(52);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){var i=n(21);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(21),r=n(19).document,a=i(r)&&i(r.createElement);t.exports=function(t){return a?r.createElement(t):{}}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){"use strict";var i=n(55),r=n(16),a=n(88),o=n(39),s=n(45),u=n(168),l=n(58),c=n(92),h=n(22)("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,p,v,g,E){u(n,e,p);var _,y,m,T=function(t){if(!f&&t in x)return x[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},A=e+" Iterator",R="values"==v,S=!1,x=t.prototype,P=x[h]||x["@@iterator"]||v&&x[v],O=P||T(v),I=v?R?T("entries"):O:void 0,w="Array"==e&&x.entries||P;if(w&&(m=c(w.call(new t)))!==Object.prototype&&m.next&&(l(m,A,!0),i||"function"==typeof m[h]||o(m,h,d)),R&&P&&"values"!==P.name&&(S=!0,O=function(){return P.call(this)}),i&&!E||!f&&!S&&x[h]||o(x,h,O),s[e]=O,s[A]=d,v)if(_={values:R?O:T("values"),keys:g?O:T("keys"),entries:I},E)for(y in _)y in x||a(x,y,_[y]);else r(r.P+r.F*(f||S),e,_);return _}},function(t,e,n){t.exports=n(39)},function(t,e,n){var i=n(90)("keys"),r=n(69);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(14),r=n(19),a=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(55)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var i=n(36),r=n(42),a=n(89)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},function(t,e,n){e.f=n(22)},function(t,e,n){t.exports=n(174)},function(t,e,n){var i=n(19),r=n(14),a=n(55),o=n(93),s=n(29).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=a?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:o.f(t)})}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(52);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(38),r=n(83),a=n(42),o=n(68),s=n(183);t.exports=function(t,e){var n=1==t,u=2==t,l=3==t,c=4==t,h=6==t,f=5==t||h,d=e||s;return function(e,s,p){for(var v,g,E=a(e),_=r(E),y=i(s,p,3),m=o(_.length),T=0,A=n?d(e,m):u?d(e,0):void 0;m>T;T++)if((f||T in _)&&(g=y(v=_[T],T,E),t))if(n)A[T]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return T;case 2:A.push(v)}else if(c)return!1;return h?-1:l||c?c:A}}},function(t,e,n){var i=n(73),r=n(22)("iterator"),a=n(45);t.exports=n(14).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||a[i(t)]}},function(t,e,n){"use strict";var i=n(41);function r(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)}t.exports.f=function(t){return new r(t)}},function(t,e,n){var i=n(133);function r(e,n){return t.exports=r=i||function(t,e){return t.__proto__=e,t},r(e,n)}t.exports=r},function(t,e,n){t.exports=n(208)},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.camelize=function(t){return l[t]||(l[t]=t.replace(o,(function(t,e){return p(e)}))),l[t]},e.hyphenate=function(t){return c[t]||(c[t]=t.replace(s,(function(t,e){return"-"+v(e)}))),c[t]},e.capitalize=function(t){return h[t]||(h[t]=t.replace(u,p)),h[t]},e.trim=function(t){return g(t)?a.EMPTY_STRING:t.trim()},e.slice=function(t,e,n){return r.number(n)?e===n?a.EMPTY_STRING:t.slice(e,n):t.slice(e)},e.indexOf=f,e.lastIndexOf=d,e.startsWith=function(t,e){return 0===f(t,e)},e.endsWith=function(t,e){var n=t.length-e.length;return n>=0&&d(t,e)===n},e.charAt=function(t,e){return t.charAt(e||0)},e.codeAt=function(t,e){return t.charCodeAt(e||0)},e.upper=p,e.lower=v,e.has=function(t,e){return f(t,e)>=0},e.falsy=g,e.encode=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")};var r=i(n(20)),a=i(n(6)),o=/-([a-z])/gi,s=/\B([A-Z])/g,u=/^[a-z]/,l={},c={},h={};function f(t,e,n){return t.indexOf(e,n!==a.UNDEFINED?n:0)}function d(t,e,n){return t.lastIndexOf(e,n!==a.UNDEFINED?n:t.length)}function p(t){return t.toUpperCase()}function v(t){return t.toLowerCase()}function g(t){return!r.string(t)||!t.length}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(17)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(61)),v=r(n(13)),g=r(n(25)),E=r(n(142)),_=i(n(11)),y=i(n(15)),m=i(n(6)),T=n(74),A=r(n(106)),R=i(n(34)),S=r(n(252)),x=r(n(49)),P=n(18),O=r(n(143)),I=r(n(23)),w=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t){var i;if((0,o.default)(this,n),i=e.call(this,t),(0,d.default)((0,u.default)(i),"children",void 0),i.name=y.PATH,i.close=t.close,i.children=[],i.close&&i.points.length){var r=i.points[0],a=i.points[i.points.length-1];r.x===a.x&&r.y===a.y&&r.z===a.z||i.points.push(r.copy())}return i}return(0,s.default)(n,[{key:"drawing",value:function(t,e){}},{key:"generateWebGLPoints",value:function(t){var e=this;if(!this.validate(t))return this;this.children=[],this.glPoints=[],this.boundingRect=null;var n=this.getOptions();if(this.isFill){var i=(0,S.default)(this.points);i.length?_.each(i,(function(i){n.points=i,n.close=m.FALSE;var r=new E.default(n);r.generateWebGLPoints(t),e.boundingRectUnion(r.boundingRect),e.children.push(r)})):this.boundingRect=(0,x.default)(this.points)}else{for(var r=[],a=0;a<this.points.length-1;a++)if(this.points[a].x!==this.points[a+1].x||this.points[a].y!==this.points[a+1].y||this.points[a].z!==this.points[a+1].z){var o,s,u=void 0,l=void 0,c=this.points[a],h=this.points[a+1],f=(0,O.default)(c,h,t.getWidth(),t.getHeight());s=(o=a===this.points.length-2&&this.close?R.extendPoint(f,(0,O.default)(h,this.points[1],t.getWidth(),t.getHeight())):a===this.points.length-2?null:R.extendPoint(f,(0,O.default)(h,this.points[a+2],t.getWidth(),t.getHeight())))?this.lineWidth*t.getUnitLength()/Math.abs(R.dotProduct(R.vertical(f,new P.Vector3([0,0,1])),o)):this.lineWidth*t.getUnitLength(),r.length>0&&(l=r[r.length-1].endWidth,u=r[r.length-1].endDiv),r.push({points:this.copyPoints([c,h]),startDiv:u,endDiv:o,startWidth:l,endWidth:s})}r.length&&(this.close?(r[0].startWidth=r[r.length-1].endWidth,r[0].startDiv=r[r.length-1].endDiv):(r[0].startWidth=this.lineWidth*t.getUnitLength(),r[0].startDiv=null)),_.each(r,(function(i){n.points=i.points;var r=new p.default(n);r.generateWebGLPoints(t,i.startDiv,i.endDiv,i.startWidth,i.endWidth),e.boundingRectUnion(r.boundingRect),e.children.push(r)}))}return this}},{key:"generateCanvas2DPoints",value:function(t){return this.validate(t)?(this.glPoints=this.copyPoints(),this.boundingRect=(0,x.default)(this.points),this):this}},{key:"isPointInPath",value:function(t,e,n){var i=!1;if(e.PAINTER_TYPE===m.PAINTER_TYPE_WEBGL)_.each(this.children,(function(r){if(r.isPointInPath(t,e,n))return i=m.TRUE,m.FALSE}));else if(e.PAINTER_TYPE===m.PAINTER_TYPE_CANVAS_2D)return this.isFill?(0,A.default)(t,this.glPoints,this.points.length-1):(0,T.isPointInLines)(t,this.glPoints,this.lineWidth*e.getUnitLength()*(this.lineWidth>10?1:2),e.getWidthHeightRatio(),!0);return i}},{key:"scale",value:function(t,e,n){var i=this,r=(new I.default).setTranslate(new P.Vector3([-e.x,-e.y,-e.z])),a=(new I.default).setTranslate(new P.Vector3([e.x,e.y,e.z]));_.each(this.points,(function(e,n){i.points[n]=new v.default(a.multiplyVector3(t.multiplyVector3(r.multiplyVector3(e))))})),n.PAINTER_TYPE===m.PAINTER_TYPE_WEBGL?this.generateWebGLPoints(n):n.PAINTER_TYPE===m.PAINTER_TYPE_CANVAS_2D&&this.generateCanvas2DPoints(n),this.selection&&(n.PAINTER_TYPE===m.PAINTER_TYPE_WEBGL?(this.selection.points=[new v.default(this.boundingRect.minX,this.boundingRect.maxY),new v.default(this.boundingRect.maxX,this.boundingRect.minY)],this.selection.generateWebGLPoints(n)):n.PAINTER_TYPE===m.PAINTER_TYPE_CANVAS_2D&&(this.selection.points=[new v.default(this.boundingRect.minX,this.boundingRect.minY),new v.default(this.boundingRect.maxX,this.boundingRect.maxY)],this.selection.generateCanvas2DPoints(n)))}},{key:"draw2DPath",value:function(t,e){t.setOptions(this,e),t.drawPath(this.glPoints,this),(0,l.default)((0,f.default)(n.prototype),"draw2DPath",this).call(this,t,e)}},{key:"toJSON",value:function(t){var e=this,i=[];return _.each(this.points,(function(n,r){if(e.close&&r===e.points.length-1)return m.TRUE;i.push(n.toJson(t))})),(0,l.default)((0,f.default)(n.prototype),"toJSON",this).call(this,t,{points:i,close:this.close})}},{key:"validate",value:function(t){return this.points.length>=2}}]),n}(g.default);e.default=w},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n){for(var i=0,r=0;r<n;r++){var a=e[r],o=e[(r+1)%n];a.y===o.y||t.y<Math.min(a.y,o.y)||t.y>=Math.max(a.y,o.y)||(a.x===o.x?t.x<a.x&&i++:(t.y-a.y)*(o.x-a.x)/(o.y-a.y)+a.x>t.x&&i++)}return i%2==1}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(33)),s=r(n(3)),u=r(n(4)),l=r(n(12)),c=r(n(17)),h=r(n(9)),f=r(n(10)),d=r(n(8)),p=r(n(5)),v=r(n(62)),g=r(n(25)),E=r(n(13)),_=r(n(23)),y=i(n(11)),m=i(n(15)),T=i(n(6)),A=r(n(79)),R=n(18),S=r(n(35)),x=function(t){(0,h.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.default)(this,n)}}(n);function n(t){var i;return(0,s.default)(this,n),i=e.call(this,t),(0,p.default)((0,l.default)(i),"url",void 0),(0,p.default)((0,l.default)(i),"width",void 0),(0,p.default)((0,l.default)(i),"height",void 0),(0,p.default)((0,l.default)(i),"ratio",void 0),(0,p.default)((0,l.default)(i),"image",void 0),(0,p.default)((0,l.default)(i),"imageData",void 0),(0,p.default)((0,l.default)(i),"rect",void 0),(0,p.default)((0,l.default)(i),"startPoint",void 0),(0,p.default)((0,l.default)(i),"imageWidth",void 0),(0,p.default)((0,l.default)(i),"imageHeight",void 0),i.name=m.IMAGE,i.width=i.height=0,i.width=t.width,i.height=t.height,i.image=t.image,t.imageData?(i.imageData=t.imageData,i.imageWidth=i.imageData.width,i.imageHeight=i.imageData.height):(i.imageWidth=i.image.width,i.imageHeight=i.image.height),i.url=t.url,i}return(0,u.default)(n,[{key:"drawing",value:function(t,e){}},{key:"startDrawing",value:function(t){if(this.validate())return this.startPoint=this.points[0].copy(),t.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL?this.appendPoint(new E.default(this.points[0].x+this.width*t.config.devicePixelRatio/t.getWidth(),this.points[0].y-this.height*t.config.devicePixelRatio/t.getHeight())):t.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D&&this.appendPoint(new E.default(this.points[0].x+this.width*t.config.devicePixelRatio/t.getWidth(),this.points[0].y+this.height*t.config.devicePixelRatio/t.getHeight())),(0,c.default)((0,d.default)(n.prototype),"startDrawing",this).call(this,t),this}},{key:"generateWebGLPoints",value:function(t){if(this.validate()){this.boundingRect={minX:this.points[0].x,maxY:this.points[0].y,maxX:this.points[1].x,minY:this.points[1].y},this.glPoints=[this.points[0].copy(),new E.default(this.boundingRect.minX,this.boundingRect.minY),new E.default(this.boundingRect.maxX,this.boundingRect.maxY),new E.default(this.boundingRect.maxX,this.boundingRect.minY)];var e=this.getOptions();return e.lineWidth=2,e.stroke=t.setting.hoverColor,e.isFill=!1,e.points=(0,A.default)(this.boundingRect,2*t.getUnitLength(),t.getWidthHeightRatio()),this.rect=new v.default(e),this.rect.generateWebGLPoints(t),this}}},{key:"generateCanvas2DPoints",value:function(t){if(!this.validate())return this;this.boundingRect={minX:this.points[0].x,minY:this.points[0].y,maxX:this.points[1].x,maxY:this.points[1].y},this.glPoints=[this.points[0].copy(),new E.default(this.boundingRect.minX,this.boundingRect.maxY),new E.default(this.boundingRect.maxX,this.boundingRect.minY),new E.default(this.boundingRect.maxX,this.boundingRect.maxY)];var e=this.getOptions();return e.lineWidth=3,e.stroke=t.setting.hoverColor,e.isFill=!1,e.points=(0,A.default)(this.boundingRect,2*t.getUnitLength(),t.getWidthHeightRatio()),this.rect=new v.default(e),this.rect.generateCanvas2DPoints(t),this}},{key:"isPointInPath",value:function(t,e){return!0}},{key:"drawGLPath",value:function(t,e){var i=0;return t.enableTexture(T.TRUE),t.bindTextureData(this.imageData),t.gl.blendFunc(t.gl.SRC_ALPHA,t.gl.ONE_MINUS_SRC_ALPHA),t.gl.drawArrays(t.gl.TRIANGLE_STRIP,e+i,4),t.resetAlphaFunc(),i+=4,t.enableTexture(T.FALSE),i+(0,c.default)((0,d.default)(n.prototype),"drawGLPath",this).call(this,t,e+i)}},{key:"draw2DPath",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.drawImage(this,i),(0,c.default)((0,d.default)(n.prototype),"draw2DPath",this).call(this,t,e)}},{key:"toVertices",value:function(t,e){var i=[].concat((0,o.default)(this.glPoints[0].toArray()),[0,1,0,0],(0,o.default)(this.glPoints[1].toArray()),[0,0,0,0],(0,o.default)(this.glPoints[2].toArray()),[1,1,0,0],(0,o.default)(this.glPoints[3].toArray()),[1,0,0,0]);return(0,c.default)((0,d.default)(n.prototype),"toVertices",this).call(this,t,e,i)}},{key:"translate",value:function(t,e){(0,c.default)((0,d.default)(n.prototype),"translate",this).call(this,t,e),this.rect&&this.rect.translate(t,e),this.startPoint=new E.default(t.multiplyVector3(this.startPoint))}},{key:"rotate",value:function(t,e,i,r){var a=this;if(r.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL)(0,c.default)((0,d.default)(n.prototype),"rotate",this).call(this,t,e,i,r);else if(r.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D){var o=(new _.default).setTranslate(new R.Vector3([-e.x,-e.y,-e.z])),s=(new _.default).setTranslate(new R.Vector3([e.x,e.y,e.z]));y.each(this.glPoints,(function(e,n){a.glPoints[n]=new E.default(s.multiplyVector3(t.multiplyVector3(o.multiplyVector3(e).toPixelUnit(r)).toGLUnit(r)))})),this.selection&&(this.selection=null),this.updateBoundRect(r),this.angle+=i,this.angle>360?this.angle-=360:this.angle<-360&&(this.angle+=360)}this.rect&&(this.rect.rotate(t,e,i,r),this.boundingRect=null,this.boundingRectUnion(this.rect.boundingRect))}},{key:"scale",value:function(t,e,i){var r=(0,S.default)(this.glPoints[0],this.glPoints[2]),a=(0,S.default)(this.glPoints[0],this.glPoints[1]);(0,c.default)((0,d.default)(n.prototype),"scale",this).call(this,t,e,i);var o=(0,S.default)(this.glPoints[0],this.glPoints[2])/r,s=(0,S.default)(this.glPoints[0],this.glPoints[1])/a;this.width*=o,this.height*=s,this.points=[],this.children=[],this.selection=null;var u=(new _.default).setTranslate(new R.Vector3([-e.x,-e.y,-e.z])),l=(new _.default).setTranslate(new R.Vector3([e.x,e.y,e.z]));if(this.startPoint=new E.default(l.multiplyVector3(t.multiplyVector3(u.multiplyVector3(this.startPoint)))),this.points=[this.startPoint.copy()],i.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL?(this.appendPoint(new E.default(this.points[0].x+this.width*i.config.devicePixelRatio/i.getWidth(),this.points[0].y-this.height*i.config.devicePixelRatio/i.getHeight())),this.generateWebGLPoints(i)):i.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D&&(this.appendPoint(new E.default(this.points[0].x+this.width*i.config.devicePixelRatio/i.getWidth(),this.points[0].y+this.height*i.config.devicePixelRatio/i.getHeight())),this.generateCanvas2DPoints(i)),this.angle){var h=this.angle<0?this.angle+360:this.angle;this.angle=0,this.rect&&(this.rect.angle=0),i.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D&&(h=-h);var f=(new _.default).setRotate(h,new R.Vector3([0,0,1]));this.rotate(f,new E.default((this.boundingRect.minX+this.boundingRect.maxX)/2,(this.boundingRect.minY+this.boundingRect.maxY)/2,0),-h,i)}this.rect&&(this.selection&&(this.selection=null),this.boundingRect=null,this.boundingRectUnion(this.rect.boundingRect))}},{key:"generatePointsForce",value:function(t){this.validate()&&(this.startPoint=this.points[0].copy(),t.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL?(1===this.points.length&&this.appendPoint(new E.default(this.points[0].x+this.width*t.config.devicePixelRatio/t.getWidth(),this.points[0].y-this.height*t.config.devicePixelRatio/t.getHeight())),this.generateWebGLPoints(t)):t.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D&&(1===this.points.length&&this.appendPoint(new E.default(this.points[0].x+this.width*t.config.devicePixelRatio/t.getWidth(),this.points[0].y+this.height*t.config.devicePixelRatio/t.getHeight())),this.generateCanvas2DPoints(t)))}},{key:"updateBoundRect",value:function(t){t.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL?this.boundingRect={minX:this.points[0].x,maxY:this.points[0].y,maxX:this.points[1].x,minY:this.points[1].y}:t.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D&&(this.boundingRect={minX:this.points[0].x,minY:this.points[0].y,maxX:this.points[1].x,maxY:this.points[1].y})}},{key:"validate",value:function(){return!!this.url}},{key:"toJSON",value:function(t){var e=this.startPoint.toJson(t);return(0,c.default)((0,d.default)(n.prototype),"toJSON",this).call(this,t,{width:this.width,height:this.height,imageWidth:this.imageWidth,imageHeight:this.imageHeight,url:this.url,angle:this.angle<0?this.angle+360:this.angle,x:e.x||0,y:e.y||0})}}]),n}(g.default);e.default=x},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n){var i;function r(r,o){i=setTimeout((function(){n||(0,a.default)(t,r,o),clearTimeout(i),i=null}),e)}return{handler:function(){var s=this,u=o.toArray(arguments);e?i||(n&&(0,a.default)(t,s,u),r(s,u)):(i&&(clearTimeout(i),i=null),(0,a.default)(t,s,u))},update:function(t){e=t},stop:function(){this.timer&&(clearTimeout(i),i=null)}}};var a=r(n(43)),o=i(n(11))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=i(n(6)),l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,a.default)(this,t),(0,s.default)(this,"task",void 0),(0,s.default)(this,"timeout",void 0),(0,s.default)(this,"interval",void 0),(0,s.default)(this,"started",void 0),(0,s.default)(this,"timer",void 0),this.task=e,this.timeout=n,this.interval=i,this.started=u.FALSE}return(0,o.default)(t,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var t=this,e=function e(){!1!==t.task()?t.timer=setTimeout(e,t.interval):t.stop()};null==this.timeout?setTimeout((function(){e()}),0):this.timer=setTimeout(e,this.timeout),this.started=u.TRUE}},{key:"stop",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.started=u.FALSE}},{key:"dispose",value:function(){this.stop(),this.task=this.timeout=this.interval=null}},{key:"updateInterval",value:function(t){this.interval=t}}]),t}();e.default=l},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(9)),l=i(n(10)),c=i(n(8)),h=i(n(5)),f=function(t){(0,u.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,c.default)(t);if(e){var a=(0,c.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}(n);function n(t,i,r,o){var u;return(0,a.default)(this,n),u=e.call(this,t,r,o),(0,h.default)((0,s.default)(u),"imageData",void 0),(0,h.default)((0,s.default)(u),"filter",void 0),(0,h.default)((0,s.default)(u),"format",void 0),u.imageData=i,u.format=u.gl.RGBA,u.filter=u.gl.NEAREST,u}return(0,o.default)(n,[{key:"init",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}},{key:"setFormat",value:function(t){this.format=t}},{key:"setFilter",value:function(t){this.filter=t}},{key:"setImageData",value:function(t){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.format,this.format,this.gl.UNSIGNED_BYTE,t||this.imageData)}},{key:"setHdrImageData",value:function(t){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.FLOAT,t||this.imageData)}},{key:"getImageData",value:function(){return this.imageData}}]),n}(i(n(154)).default);e.default=f},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(17)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(270)),v=i(n(6)),g=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t,i,r){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v.TRUE;return(0,o.default)(this,n),a=e.call(this,t,i,r),(0,d.default)((0,u.default)(a),"enableColor",void 0),(0,d.default)((0,u.default)(a),"aPoint",void 0),(0,d.default)((0,u.default)(a),"aColor",void 0),a.enableColor=s,a}return(0,s.default)(n,[{key:"link",value:function(){(0,l.default)((0,f.default)(n.prototype),"link",this).call(this),this.aPoint=this.gl.getAttribLocation(this.program,"point"),this.aColor=this.gl.getAttribLocation(this.program,"color"),this.enableColor?(this.gl.enableVertexAttribArray(this.aPoint),this.gl.enableVertexAttribArray(this.aColor)):this.gl.enableVertexAttribArray(this.aPoint)}},{key:"bind",value:function(){(0,l.default)((0,f.default)(n.prototype),"bind",this).call(this),this.enableColor?(this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0),this.gl.vertexAttribPointer(this.aColor,4,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT)):this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0)}}]),n}(p.default);e.default=g},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(30)),o=r(n(31)),s=r(n(3)),u=r(n(4)),l=r(n(5)),c=i(n(6)),h=function(){function t(e,n,i){(0,s.default)(this,t),(0,l.default)(this,"gl",void 0),(0,l.default)(this,"width",void 0),(0,l.default)(this,"height",void 0),this.gl=e,this.width=n,this.height=i}var e;return(0,u.default)(t,[{key:"ready",value:(e=(0,o.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",c.TRUE);case 1:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"resize",value:function(t,e){this.width=t,this.height=e}}]),t}();e.default=h},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=r(n(43)),l=i(n(20)),c=i(n(11)),h=i(n(27)),f=i(n(104)),d=(i(n(32)),i(n(6))),p=function(){function t(e){(0,a.default)(this,t),(0,s.default)(this,"ns",void 0),(0,s.default)(this,"listeners",void 0),this.ns=e||d.TRUE,this.listeners={}}return(0,o.default)(t,[{key:"fire",value:function(t,e){var n=this,i=l.string(t)?n.parse(t):t,r=n.listeners[i.type],a=d.TRUE;if(r){r=h.copy(r);var o=[t];e&&o.push(e),c.each(r,(function(t){if(E(i.ns,t,d.TRUE)&&c.has(r,t)){var e=(0,u.default)(t.fn,t.ctx,o);return t.num=t.num?t.num+1:1,t.num===t.max&&n.off(i,t.fn),e===d.FALSE?a=d.FALSE:void 0}}))}return a}},{key:"on",value:function(t,e,n){var i=this.listeners;if(n?n.fn=e:n={fn:e},l.object(n)&&l.func(n.fn)){var r=l.string(t)?this.parse(t):t;n.ns=r.ns,c.push(i[r.type]||(i[r.type]=[]),n)}return this}},{key:"off",value:function(t,e){var n=this.listeners;if(t){var i=l.string(t)?this.parse(t):t,r=i.type,a=i.ns,o=g(e);r?n[r]&&function(t,e){c.each(t,(function(e,n){o(e)&&t.splice(n,1)}),d.TRUE),t.length||delete n[e]}(n[r],r):a&&h.each(n,(function(t,e){c.each(t,(function(e,n){E(a,e)&&t.splice(n,1)}),d.TRUE),t.length||delete n[e]}))}else this.listeners={};return this}},{key:"has",value:function(t,e){var n,i=this.listeners,r=l.string(t)?this.parse(t):t,a=r.type,o=r.ns,s=d.TRUE,u=g(e);return a?i[a]&&(n=i[a],c.each(n,(function(t){if(u(t))return s=d.FALSE}))):o&&h.each(i,(function(t){return c.each(t,(function(t){if(E(o,t))return s=d.FALSE})),s})),!s}},{key:"parse",value:function(t){var e={type:t,ns:d.EMPTY_STRING};if(this.ns){var n=f.indexOf(t,d.RAW_DOT);n>=0&&(e.type=f.slice(t,0,n),e.ns=f.slice(t,n+1))}return e}}]),t}();function v(){return d.TRUE}function g(t){return l.func(t)?function(e){return t===e.fn}:v}function E(t,e,n){var i=e.ns;return i&&t?i===t:n?d.TRUE:d.FALSE}e.default=p},function(t,e,n){t.exports=n(161)},function(t,e,n){t.exports=!n(28)&&!n(37)((function(){return 7!=Object.defineProperty(n(85)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var i=n(36),r=n(40),a=n(170)(!1),o=n(89)("IE_PROTO");t.exports=function(t,e){var n,s=r(t),u=0,l=[];for(n in s)n!=o&&i(s,n)&&l.push(n);for(;e.length>u;)i(s,n=e[u++])&&(~a(l,n)||l.push(n));return l}},function(t,e,n){var i=n(19).document;t.exports=i&&i.documentElement},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var i=n(116),r=n(91).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(24);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var a=t.return;throw void 0!==a&&i(a.call(t)),e}}},function(t,e,n){var i=n(45),r=n(22)("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[r]===t)}},function(t,e,n){"use strict";var i=n(19),r=n(16),a=n(47),o=n(37),s=n(39),u=n(71),l=n(48),c=n(72),h=n(21),f=n(58),d=n(29).f,p=n(98)(0),v=n(28);t.exports=function(t,e,n,g,E,_){var y=i[t],m=y,T=E?"set":"add",A=m&&m.prototype,R={};return v&&"function"==typeof m&&(_||A.forEach&&!o((function(){(new m).entries().next()})))?(m=e((function(e,n){c(e,m,t,"_c"),e._c=new y,null!=n&&l(n,E,e[T],e)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(t){var e="add"==t||"set"==t;t in A&&(!_||"clear"!=t)&&s(m.prototype,t,(function(n,i){if(c(this,m,t),!e&&_&&!h(n))return"get"==t&&void 0;var r=this._c[t](0===n?0:n,i);return e?this:r}))})),_||d(m.prototype,"size",{get:function(){return this._c.size}})):(m=g.getConstructor(e,t,E,T),u(m.prototype,n),a.NEED=!0),f(m,t),R[t]=m,r(r.G+r.W+r.F,R),_||g.setStrong(m,t,E),m}},function(t,e,n){"use strict";var i=n(16);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var i=n(16),r=n(41),a=n(38),o=n(48);t.exports=function(t){i(i.S,t,{from:function(t){var e,n,i,s,u=arguments[1];return r(this),(e=void 0!==u)&&r(u),null==t?new this:(n=[],e?(i=0,s=a(u,arguments[2],2),o(t,!1,(function(t){n.push(s(t,i++))}))):o(t,!1,n.push,n),new this(n))}})}},function(t,e,n){var i=n(24),r=n(41),a=n(22)("species");t.exports=function(t,e){var n,o=i(t).constructor;return void 0===o||null==(n=i(o)[a])?e:r(n)}},function(t,e,n){var i,r,a,o=n(38),s=n(127),u=n(117),l=n(85),c=n(19),h=c.process,f=c.setImmediate,d=c.clearImmediate,p=c.MessageChannel,v=c.Dispatch,g=0,E={},_=function(){var t=+this;if(E.hasOwnProperty(t)){var e=E[t];delete E[t],e()}},y=function(t){_.call(t.data)};f&&d||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return E[++g]=function(){s("function"==typeof t?t:Function(t),e)},i(g),g},d=function(t){delete E[t]},"process"==n(52)(h)?i=function(t){h.nextTick(o(_,t,1))}:v&&v.now?i=function(t){v.now(o(_,t,1))}:p?(a=(r=new p).port2,r.port1.onmessage=y,i=o(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(i=function(t){c.postMessage(t+"","*")},c.addEventListener("message",y,!1)):i="onreadystatechange"in l("script")?function(t){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),_.call(t)}}:function(t){setTimeout(o(_,t,1),0)}),t.exports={set:f,clear:d}},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var i=n(24),r=n(21),a=n(100);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=a.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var i=n(19),r=n(14),a=n(29),o=n(28),s=n(22)("species");t.exports=function(t){var e="function"==typeof r[t]?r[t]:i[t];o&&e&&!e[s]&&a.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(22)("iterator"),r=!1;try{var a=[7][i]();a.return=function(){r=!0},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var a=[7],o=a[i]();o.next=function(){return{done:n=!0}},a[i]=function(){return o},t(a)}catch(t){}return n}},function(t,e,n){t.exports=n(199)},function(t,e,n){t.exports=n(201)},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}},function(t,e,n){t.exports=n(211)},function(t,e,n){t.exports=n(214)},function(t,e,n){var i=n(135),r=n(134);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?i(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e,n){var i=n(16),r=n(64),a=n(37),o=n(103),s="["+o+"]",u=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),c=function(t,e,n){var r={},s=a((function(){return!!o[t]()||"​"!="​"[t]()})),u=r[t]=s?e(h):o[t];n&&(r[n]=u),i(i.P+i.F*s,"String",r)},h=c.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(l,"")),t};t.exports=c},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(30)),o=r(n(31)),s=r(n(3)),u=r(n(4)),l=r(n(5)),c=i(n(11)),h=r(n(225)),f=i(n(6)),d=i(n(15)),p=r(n(259)),v=r(n(265)),g=r(n(158)),E=r(n(305)),_=i(n(27)),y=i(n(20)),m=r(n(13)),T=r(n(26)),A=function(){function t(e,n,i,r,a){(0,s.default)(this,t),(0,l.default)(this,"controller",void 0),(0,l.default)(this,"painter",void 0),(0,l.default)(this,"emitter",void 0),(0,l.default)(this,"setting",void 0),(0,l.default)(this,"config",void 0),(0,l.default)(this,"width",void 0),(0,l.default)(this,"height",void 0),(0,l.default)(this,"taskBuffer",void 0),(0,l.default)(this,"canPaint",void 0),(0,l.default)(this,"canWheel",void 0),(0,l.default)(this,"isReady",void 0),this.config=a,this.width=n,this.height=i,this.taskBuffer=new E.default(10),this.setting=new h.default(this.config),this.emitter=r,this.config.useWebGL?this.painter=new v.default(e,this.width,this.height,this.setting,this.emitter,this.config):this.painter=new g.default(e,this.width,this.height,this.setting,this.emitter,this.config),this.controller=new p.default(this.painter,this.emitter,this.setting),this.canPaint=f.TRUE,this.isReady=f.FALSE}var e;return(0,u.default)(t,[{key:"ready",value:(e=(0,o.default)(a.default.mark((function t(e,n,i){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.painter.ready(i);case 2:this.canPaint=e,this.canWheel=n,this.isReady=f.TRUE;case 5:case"end":return t.stop()}}),t,this)}))),function(t,n,i){return e.apply(this,arguments)})},{key:"mouseDownHandler",value:function(t,e){this.canPaint&&(this.setting.bufferControl()?this.taskBuffer.append({fn:this.controller.mouseDownHandler,ctx:this.controller,args:[t,e]}):(this.taskBuffer.flush(),this.controller.mouseDownHandler(t,e)))}},{key:"mouseMoveHandler",value:function(t,e){this.canPaint?this.setting.bufferControl()?this.taskBuffer.append({fn:this.controller.mouseMoveHandler,ctx:this.controller,args:[t,e]}):this.controller.mouseMoveHandler(t,e):this.controller.isMouseUp()||(this.setting.bufferControl()?this.taskBuffer.append({fn:this.controller.mouseUpHandler,ctx:this.controller,args:[t,e,f.TRUE]}):this.controller.mouseUpHandler(t,e,f.TRUE))}},{key:"mouseUpHandler",value:function(t,e){this.canPaint&&(this.setting.bufferControl()?this.taskBuffer.append({fn:this.controller.mouseUpHandler,ctx:this.controller,args:[t,e]}):this.controller.mouseUpHandler(t,e))}},{key:"onMouseWheel",value:function(t,e){this.canWheel&&this.controller.onMouseWheel(t,e)}},{key:"dblclickHandler",value:function(t,e){this.canPaint&&this.controller.onDblclick(t,e)}},{key:"setPainterShape",value:function(t){this.setting.activeShape=t,this.painter.PAINTER_TYPE===f.PAINTER_TYPE_WEBGL&&t===d.SELECT?this.painter.resetViewShapes():t!==d.SELECT&&this.controller.removeResize(),this.setting.isDoodle()&&this.config.enableDoodleCursor&&this.config.useWebGL?this.painter.switchCursor(f.TRUE):this.config.useWebGL&&this.painter.switchCursor(f.FALSE)}},{key:"resize",value:function(t,e){this.painter.resize(t,e),this.width=t,this.height=e}},{key:"viewport",value:function(t,e){this.painter.viewport(t,e)}},{key:"hasPrev",value:function(){return this.painter.hasPrev()}},{key:"hasNext",value:function(){return this.painter.hasNext()}},{key:"prev",value:function(){this.painter.prev()}},{key:"next",value:function(){this.painter.next()}},{key:"clear",value:function(t){this.controller.clear(t)}},{key:"formatPoint",value:function(t){if(y.array(t.points)){var e=[];c.each(t.points,(function(n,i){var r,a=new m.default(n.x,n.y,n.z);t.speeds?a.setSpeed(null!==(r=t.speeds[i])&&void 0!==r?r:0):a.setSpeed(-1),e.push(a)})),t.points=e}y.string(t.fillStyle)&&(t.fill=new T.default(t.fillStyle,t.fillAlpha)),y.string(t.strokeStyle)&&(t.stroke=new T.default(t.strokeStyle,t.strokeAlpha))}},{key:"addShape",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.formatPoint(e),n?this.controller.appendShape(t,e):i?this.controller.replaceShape(t,e):this.controller.addShape(t,e)}},{key:"addShapes",value:function(t){var e=this;c.each(t,(function(t){e.formatPoint(t)})),this.controller.addShapes(t)}},{key:"updateShapes",value:function(t){var e=this;c.each(t,(function(t){e.formatPoint(t)})),this.controller.updateShapes(t)}},{key:"removeShapes",value:function(t){this.controller.removeShapes(t)}},{key:"deleteSelectedShapes",value:function(){this.controller.deleteSelectedShapes()}},{key:"scrollTop",value:function(t){this.controller.scrollTopTo(t)}},{key:"updateShapeSetting",value:function(t){var e=this;_.each(t,(function(t,n){e.setting[n]=t}))}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,e,n),this}},{key:"off",value:function(t,e){return this.emitter.off(t,e),this}},{key:"fire",value:function(t,e){this.emitter.fire(t,e)}},{key:"has",value:function(t,e){return this.emitter.has(t,e)}},{key:"addLabelTexture",value:function(t,e){this.controller.addLabelTexture(t,e)}},{key:"setCanPaint",value:function(t){this.canPaint=t,!t&&this.controller.isMouseUp()&&this.controller.clearState()}},{key:"refresh",value:function(){this.isReady&&(this.painter.PAINTER_TYPE===f.PAINTER_TYPE_WEBGL&&this.painter.resizeView(),this.painter.redrawShapes())}},{key:"destroy",value:function(){this.painter&&this.painter.destroy(),this.controller.destroy(),this.emitter.off(),this.isReady=f.FALSE}},{key:"initCursor",value:function(t){this.config.useWebGL&&this.painter.initCursor(t)}},{key:"moveCursor",value:function(t,e){this.config.useWebGL&&this.painter.moveCursor(t,e)}}]),t}();e.default=A},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t,e){var n={minX:t.minX,minY:t.minY,maxX:t.maxX,maxY:t.maxY};return n.minX=Math.min(t.minX,e.minX),n.minY=Math.min(t.minY,e.minY),n.maxX=Math.max(t.maxX,e.maxX),n.maxY=Math.max(t.maxY,e.maxY),n}},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e){return new r.default((t.x+e.x)/2,(t.y+e.y)/2,(t.z+e.z)/2)};var r=i(n(13))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(9)),l=r(n(10)),c=r(n(8)),h=r(n(25)),f=r(n(13)),d=i(n(11)),p=i(n(15)),v=r(n(106)),g=r(n(49)),E=function(t){(0,u.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,c.default)(t);if(e){var r=(0,c.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}(n);function n(t){var i;return(0,o.default)(this,n),(i=e.call(this,t)).name=p.TRIANGLE,i.isFill=!0,i}return(0,s.default)(n,[{key:"drawing",value:function(t,e){}},{key:"generateWebGLPoints",value:function(t){if(this.validate())return this.glPoints=this.copyPoints(),this.boundingRect=(0,g.default)(this.glPoints),this}},{key:"generateCanvas2DPoints",value:function(t){return this.validate()?(this.glPoints=this.copyPoints(),this.boundingRect=(0,g.default)(this.glPoints),this):this}},{key:"isPointInPath",value:function(t,e,n){return(0,v.default)(t,this.glPoints,this.close?this.glPoints.length-1:this.glPoints.length)}},{key:"drawGLPath",value:function(t,e){return t.gl.drawArrays(t.gl.TRIANGLE_FAN,e,this.glPoints.length),this.glPoints.length}},{key:"draw2DPath",value:function(t,e){t.setOptions(this,e),t.drawPath(this.glPoints,this)}},{key:"translate",value:function(t,e){var n=this;d.each(this.glPoints,(function(e,i){n.glPoints[i]=new f.default(t.multiplyVector3(e))})),d.each(this.children,(function(n){n.translate(t,e)})),this.boundingRect&&(this.boundingRect.minX=this.boundingRect.minX+t.getValue(12),this.boundingRect.maxX=this.boundingRect.maxX+t.getValue(12),this.boundingRect.minY=this.boundingRect.minY+t.getValue(13),this.boundingRect.maxY=this.boundingRect.maxY+t.getValue(13))}},{key:"validate",value:function(){return this.points.length>=3}}]),n}(h.default);e.default=E},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new i.Vector3([(e.x-t.x)*n,(e.y-t.y)*r,e.z-t.z]).normalize()};var i=n(18)},function(t,e,n){"use strict";var i=n(1),r=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e){var n=e.fontSize,i=e.fontFamily,r=e.bold,l=e.fontItalic,c=document.body,h=(0,s.default)(n);(a=document.createElement("p")).style.cssText="\n      position: absolute;\n      visibility: hidden;\n      font: ".concat(r?"bold":""," ").concat(n,"px ").concat(i,";\n      line-height: ").concat(h,"px;\n      font-style: ").concat(l?"italic":"initial",";\n      max-width: ").concat(e.maxWidth?e.maxWidth+"px":"auto",";\n      word-break: break-all;\n    "),t=o.encode((t||"W")+""),a.innerHTML=t.replace(/ /g,"&nbsp;").replace(/\n/g,"<br>").replace(/(<br>)$/g,"<br>W"),c.appendChild(a);var f=a,d=f.offsetWidth,p=f.offsetHeight;c.removeChild(a),a=null;var v=d+2*u,g=p+2*u,E=Math.round(p/h)*h+4*u;return l&&(v+=n<60?2:n<70?6:10),{width:v,height:Math.max(g,E)}};var a,o=r(n(104)),s=i(n(81)),u=1},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n,i,o){if(1===r.dotProduct(e,i))return a.FALSE;var s=r.minus(n,t),u=r.crossProduct(e,i),l=r.crossProduct(s,i),c=r.dotProduct(s,u);if(c>=1e-5||c<=-1e-5)return a.FALSE;var h=r.dotProduct(l,u)/u.sqrMagnitude,f=r.add(t,r.scalarProduct(e,h));return o.x=f.x,o.y=f.y,o.z=f.z,a.TRUE};var r=i(n(34)),a=i(n(6))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(33)),s=r(n(3)),u=r(n(4)),l=r(n(12)),c=r(n(17)),h=r(n(9)),f=r(n(10)),d=r(n(8)),p=r(n(5)),v=r(n(25)),g=r(n(13)),E=i(n(11)),_=i(n(34)),y=i(n(255)),m=i(n(15)),T=n(18),A=i(n(6)),R=r(n(35)),S=r(n(75)),x=r(n(49)),P=n(74),O=r(n(23)),I=i(n(20)),w=r(n(77)),b=r(n(76)),D=function(t){(0,h.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.default)(this,n)}}(n);function n(t){var i;return(0,s.default)(this,n),i=e.call(this,t),(0,p.default)((0,l.default)(i),"startNormalize",void 0),(0,p.default)((0,l.default)(i),"endNormalize",void 0),(0,p.default)((0,l.default)(i),"curvePoints",void 0),(0,p.default)((0,l.default)(i),"curvePointsDiv",void 0),(0,p.default)((0,l.default)(i),"isFirst",void 0),(0,p.default)((0,l.default)(i),"isLast",void 0),(0,p.default)((0,l.default)(i),"hasEnd",void 0),(0,p.default)((0,l.default)(i),"firstWidth",void 0),(0,p.default)((0,l.default)(i),"lastWidth",void 0),i.name=m.CURVE,i.children=[],i.curvePointsDiv=[],i.isLast=!0,i.hasEnd=!0,i}return(0,u.default)(n,[{key:"drawing",value:function(t,e){this.validate()||this.appendPoint(e),t.drawing(this)}},{key:"generateWebGLPoints",value:function(t,e){if(!this.validate())return this;if(this.children=[],this.glPoints=[],this.boundingRect=null,this.isFirst=!e,2===this.points.length){var n,i,r=this.startNormalize=this.endNormalize=new T.Vector3([(this.points[1].x-this.points[0].x)*t.getWidth(),(this.points[1].y-this.points[0].y)*t.getHeight(),this.points[1].z-this.points[0].z]).normalize();n=_.crossProduct(r,new T.Vector3([0,0,1]));var a=this.lineWidth;e?(i=_.extendPoint(e,r),this.firstWidth=this.getLineWidth(t,this.points[0].getSpeed(),a,i),E.concat(this.glPoints,(0,S.default)(this.points[0],i,this.firstWidth,t.getWidthHeightRatio()))):(this.firstWidth=this.getLineWidth(t,this.points[0].getSpeed(),a,i),E.concat(this.glPoints,(0,S.default)(this.points[0],n,this.firstWidth,t.getWidthHeightRatio()))),this.lastWidth=this.getLineWidth(t,this.points[1].getSpeed(),a,i),E.concat(this.glPoints,(0,S.default)(this.points[1],n,this.lastWidth,t.getWidthHeightRatio())),this.boundingRect=(0,x.default)(this.glPoints),this.curvePoints=this.copyPoints(),this.curvePointsDiv=[i,n]}else{for(var o=4,s=0,u=0;u<this.points.length-1;u++)s+=(0,R.default)(this.points[u],this.points[u+1]);s>100*t.config.devicePixelRatio*t.getUnitLength()?o=20:s>50*t.config.devicePixelRatio*t.getUnitLength()?o=16:s>10*t.config.devicePixelRatio*t.getUnitLength()&&(o=8);var l=[];if(3===this.points.length)l=y.create3DBezier(this.points[0],new g.default((this.points[0].x+this.points[1].x)/2,(this.points[0].y+this.points[1].y)/2,(this.points[0].z+this.points[1].z)/2),new g.default((this.points[1].x+this.points[2].x)/2,(this.points[1].y+this.points[2].y)/2,(this.points[1].z+this.points[2].z)/2),this.points[2],o);else if(4===this.points.length){var c=new g.default((this.points[1].x+this.points[2].x)/2,(this.points[1].y+this.points[2].y)/2,(this.points[1].z+this.points[2].z)/2);l=y.create3DBezier(this.points[0],new g.default((this.points[0].x+c.x)/2,(this.points[0].y+c.y)/2,(this.points[0].z+c.z)/2),new g.default((c.x+this.points[3].x)/2,(c.y+this.points[3].y)/2,(c.z+this.points[3].z)/2),this.points[3],o)}if(!l.length)return;this.curvePoints=l;var h,f,d,p,v=this.lineWidth;if(e){var m=l[0],P=l[1];h=_.extendPoint(e,new T.Vector3([P.x-m.x,P.y-m.y,P.z-m.z]))}for(var O=0;O<l.length-1;O++){var I=l[O],b=l[O+1],D=void 0;O+2<l.length&&(D=l[O+2]),d=new T.Vector3([(b.x-I.x)*t.getWidth(),(b.y-I.y)*t.getHeight(),b.z-I.z]).normalize(),D?(p=new T.Vector3([(D.x-b.x)*t.getWidth(),(D.y-b.y)*t.getHeight(),D.z-b.z]).normalize(),f=_.extendPoint(d,p)):f=null;var C=h||_.crossProduct(d,new T.Vector3([0,0,1]));this.lastWidth=this.getLineWidth(t,this.computeSpeedLiner(O,l.length-1),v,C),E.concat(this.glPoints,(0,S.default)(I,C,this.lastWidth,t.getWidthHeightRatio())),this.curvePointsDiv.push(C),0===O?(this.startNormalize=d,this.firstWidth=this.lastWidth):O===l.length-2&&(this.endNormalize=d,this.lastWidth=this.getLineWidth(t,this.computeSpeedLiner(O,l.length-1),v,_.crossProduct(d,new T.Vector3([0,0,1]))),E.concat(this.glPoints,(0,S.default)(b,_.crossProduct(d,new T.Vector3([0,0,1])),this.lastWidth,t.getWidthHeightRatio())),this.curvePointsDiv.push(_.crossProduct(d,new T.Vector3([0,0,1])))),h=f}this.boundingRect=(0,x.default)(this.glPoints)}if(this.lineWidth>=3){var L=this.getOptions();if(L.isFill=A.TRUE,L.fill=this.stroke,L.isStroke=A.FALSE,!e&&this.hasEnd){L.points=[this.points[0].copy(),this.points[0].copy()],L.points[1].x=L.points[1].x+this.firstWidth;var N=new w.default(L);N.isFirstPointCenter=!0,N.generateWebGLPoints(t),this.boundingRectUnion(N.boundingRect),this.children.push(N)}if(this.hasEnd){L.points=[this.points[this.points.length-1].copy(),this.points[this.points.length-1].copy()],L.points[1].x=L.points[1].x+this.lastWidth;var M=new w.default(L);M.isFirstPointCenter=!0,M.generateWebGLPoints(t),this.boundingRectUnion(M.boundingRect),this.children.push(M)}}return this}},{key:"generateCanvas2DPoints",value:function(t){if(!this.validate())return this;if(this.children=[],this.glPoints=[],this.boundingRect=null,2===this.points.length)this.curvePoints=this.copyPoints();else{for(var e=4,n=0,i=0;i<this.points.length-1;i++)n+=(0,R.default)(this.points[i],this.points[i+1]);n>100*t.config.devicePixelRatio*t.getUnitLength()?e=20:n>50*t.config.devicePixelRatio*t.getUnitLength()?e=16:n>10*t.config.devicePixelRatio*t.getUnitLength()&&(e=8);var r=[];if(3===this.points.length)r=y.create2DBezier(this.points[0],this.points[1],this.points[2],e);else if(4===this.points.length){var a=new g.default((this.points[1].x+this.points[2].x)/2,(this.points[1].y+this.points[2].y)/2,(this.points[1].z+this.points[2].z)/2);r=y.create3DBezier(this.points[0],new g.default((this.points[0].x+a.x)/2,(this.points[0].y+a.y)/2,(this.points[0].z+a.z)/2),new g.default((a.x+this.points[3].x)/2,(a.y+this.points[3].y)/2,(a.z+this.points[3].z)/2),this.points[3],e)}this.curvePoints=r}return this.boundingRect=(0,x.default)(this.curvePoints),this}},{key:"resize",value:function(t){var e=this;if(t.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL&&(this.glPoints=[],this.children=[],E.each(this.curvePoints,(function(n,i){if(e.curvePointsDiv[i]){var r;r=2==e.points.length?e.points[i].getSpeed():e.computeSpeedLiner(i,e.curvePoints.length-1);var a=e.getLineWidth(t,r,e.lineWidth,e.curvePointsDiv[i]);E.concat(e.glPoints,(0,S.default)(n,e.curvePointsDiv[i],a,t.getWidthHeightRatio())),0===i&&(e.firstWidth=a),e.lastWidth=a}})),this.lineWidth>=3&&this.hasEnd)){var n=this.getOptions();if(n.isFill=A.TRUE,n.fill=this.stroke,n.isStroke=A.FALSE,this.isFirst){n.points=[this.points[0].copy(),this.points[0].copy()],n.points[1].x=n.points[1].x+this.firstWidth;var i=new w.default(n);i.isFirstPointCenter=!0,i.generateWebGLPoints(t),this.boundingRectUnion(i.boundingRect),this.children.push(i)}if(this.isLast){n.points=[this.points[this.points.length-1].copy(),this.points[this.points.length-1].copy()],n.points[1].x=n.points[1].x+this.lastWidth;var r=new w.default(n);r.isFirstPointCenter=!0,r.generateWebGLPoints(t),this.boundingRectUnion(r.boundingRect),this.children.push(r)}}}},{key:"computeSpeedLiner",value:function(t,e){var n,i=Math.abs(this.points[0].getSpeed()-this.points[2].getSpeed())/2,r=(this.points[0].getSpeed()+this.points[2].getSpeed())/2;if(r<0)return-1;var a,o=Math.PI/e;return a=this.points[0].getSpeed()>this.points[2].getSpeed()?t:e-t,n=i*Math.cos(o*a)+r,I.number(n)?n:0}},{key:"getBrushTipBySpeed",value:function(t,e,n){return e<0||this.isFirst&&this.lineWidth<=3?n:(.2+1*(1-e))*n}},{key:"getLineWidth",value:function(t,e,n,i){if(t.config.enableBrushTip&&(n=this.getBrushTipBySpeed(t,e,n)),t.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL){var r=Math.PI-(0,b.default)(i),a=n*Math.sin(r)*t.getUnitLength(),o=n*Math.cos(r)*t.getUnitLength();return Math.sqrt(a*a+o*o)/2}return n}},{key:"isPointInPath",value:function(t,e,n){for(var i=A.FALSE,r=0;r<this.curvePoints.length-1;r++)if((0,P.isPointInLine)(t,this.curvePoints[r],this.curvePoints[r+1],(null!=n?n:this.lineWidth)*e.getUnitLength()*(this.lineWidth<4?3:this.lineWidth>10?1:2),e.getWidthHeightRatio()))return A.TRUE;return i}},{key:"drawGLPath",value:function(t,e){var i=0;return this.glPoints.length&&(t.gl.drawArrays(t.gl.TRIANGLE_STRIP,e,this.glPoints.length),i+=this.glPoints.length),i+(0,c.default)((0,d.default)(n.prototype),"drawGLPath",this).call(this,t,e+i)}},{key:"draw2DPath",value:function(t,e){t.setOptions(this,e),t.drawBezier(this.points,this),(0,c.default)((0,d.default)(n.prototype),"draw2DPath",this).call(this,t,e)}},{key:"updateEnds",value:function(t,e,n){var i;this.glPoints.splice(-2,2,t,e),this.curvePointsDiv.splice(-1,1,n);var r=this.isFill?this.fill:this.stroke,a=[];E.concat(a,[].concat((0,o.default)(t.toArray()),(0,o.default)(r.toArray()))),E.concat(a,[].concat((0,o.default)(e.toArray()),(0,o.default)(r.toArray()))),(i=this.verticesCache).splice.apply(i,[-14,14].concat(a))}},{key:"translate",value:function(t,e){var i=this;E.each(this.curvePoints,(function(e,n){i.curvePoints[n]=new g.default(t.multiplyVector3(e))})),(0,c.default)((0,d.default)(n.prototype),"translate",this).call(this,t,e)}},{key:"scale",value:function(t,e,i){var r=this,a=(new O.default).setTranslate(new T.Vector3([-e.x,-e.y,-e.z])),o=(new O.default).setTranslate(new T.Vector3([e.x,e.y,e.z]));E.each(this.curvePoints,(function(e,n){r.curvePoints[n]=new g.default(o.multiplyVector3(t.multiplyVector3(a.multiplyVector3(e))))})),(0,c.default)((0,d.default)(n.prototype),"scale",this).call(this,t,e,i),i.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL&&this.resize(i)}},{key:"rotate",value:function(t,e,i,r){var a=this,o=(new O.default).setTranslate(new T.Vector3([-e.x,-e.y,-e.z])),s=(new O.default).setTranslate(new T.Vector3([e.x,e.y,e.z]));E.each(this.curvePoints,(function(e,n){a.curvePoints[n]=new g.default(s.multiplyVector3(t.multiplyVector3(o.multiplyVector3(e).toPixelUnit(r)).toGLUnit(r)))})),(0,c.default)((0,d.default)(n.prototype),"rotate",this).call(this,t,e,i,r)}},{key:"updateBoundRect",value:function(t){t.PAINTER_TYPE===A.PAINTER_TYPE_WEBGL?(0,c.default)((0,d.default)(n.prototype),"updateBoundRect",this).call(this,t):t.PAINTER_TYPE===A.PAINTER_TYPE_CANVAS_2D&&(this.boundingRect=null,this.boundingRectUnion((0,x.default)(this.curvePoints)))}},{key:"validate",value:function(){return this.points.length>=2&&this.points.length<=4}}]),n}(v.default);e.default=D},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t){var e=Math.pow(10,9),n=Math.pow(10,10)-1;return"".concat(t,"_").concat(e+Math.floor(Math.random()*(n-e)))}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(17)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(61)),v=r(n(25)),g=r(n(13)),E=r(n(142)),_=i(n(11)),y=i(n(34)),m=i(n(15)),T=i(n(6)),A=n(74),R=r(n(106)),S=r(n(145)),x=r(n(49)),P=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t){var i;return(0,o.default)(this,n),i=e.call(this,t),(0,d.default)((0,u.default)(i),"children",void 0),(0,d.default)((0,u.default)(i),"sides",void 0),(0,d.default)((0,u.default)(i),"a",void 0),(0,d.default)((0,u.default)(i),"b",void 0),i.name=m.POLYGON,i.children=[],i.sides=t.sides||3,i.close=i.close||i.isFill,i}return(0,s.default)(n,[{key:"drawing",value:function(t,e){}},{key:"generateWebGLPoints",value:function(t){if(!this.validate(t))return this;this.children=[],this.glPoints=[],this.boundingRect=null;var e=this.getOptions();if(this.isFill){e.points=this.copyPoints();var n=new E.default(e);n.generateWebGLPoints(t),this.boundingRectUnion(n.boundingRect),this.children.push(n)}else{for(var i=0;i<this.points.length-1;i++)if(this.points[i].x!==this.points[i+1].x||this.points[i].y!==this.points[i+1].y){e.points=this.copyPoints([this.points[i],this.points[i+1]]);var r=new p.default(e);r.generateWebGLPoints(t),this.boundingRectUnion(r.boundingRect),this.children.push(r)}if(e.lineWidth>=4&&!this.dash){var a=[];e.fill=this.stroke;for(var o=0;o<this.children.length;o++){var s=this.children[o],u=this.children[(o+1)%this.children.length],l=new g.default(0,0,0);if((0,S.default)(s.glPoints[0],s.getNormalize(),u.glPoints[0],u.getNormalize(),l)){e.points=[s.points[1].copy(),s.glPoints[3].copy(),l,u.glPoints[0].copy()];var c=new E.default(e);c.generateWebGLPoints(t),this.boundingRectUnion(c.boundingRect),a.push(c)}}_.concat(this.children,a)}}return this}},{key:"generateCanvas2DPoints",value:function(t){return this.validate(t)?(this.glPoints=this.copyPoints(),this.boundingRect=(0,x.default)(this.points),this):this}},{key:"getExtendPoint",value:function(t,e,n,i){var r=t.points[1],a=(T.PI-y.angle(t.getNormalize(),e.getNormalize()))/2,o=n/2*i.getUnitLength(),s=Math.tan(a)*o;return new g.default(y.add(y.add(r,y.scalarProduct(t.getVertical(i),o)),y.scalarProduct(t.getNormalize(),s)))}},{key:"isPointInPath",value:function(t,e,n){var i=!1;if(e.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL)_.each(this.children,(function(r){if(r.isPointInPath(t,e,n))return i=T.TRUE,T.FALSE}));else if(e.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D){if(this.glPoints.length)return this.isFill?(0,R.default)(t,this.glPoints,this.sides):(0,A.isPointInLines)(t,this.glPoints,(null!=n?n:this.lineWidth)*e.getUnitLength()*(this.lineWidth>10?1:2),e.getWidthHeightRatio(),!0);_.each(this.children,(function(r){if(r.isPointInPath(t,e,n))return i=T.TRUE,T.FALSE}))}return i}},{key:"draw2DPath",value:function(t,e){t.setOptions(this,e),t.drawPath(this.glPoints,this),(0,l.default)((0,f.default)(n.prototype),"draw2DPath",this).call(this,t,e)}},{key:"translate",value:function(t,e){this.isFill&&e.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL?(_.each(this.children,(function(n){n.translate(t,e)})),this.selection&&this.selection.translate(t,e),this.boundingRect&&(this.boundingRect.minX=this.boundingRect.minX+t.getValue(12),this.boundingRect.maxX=this.boundingRect.maxX+t.getValue(12),this.boundingRect.minY=this.boundingRect.minY+t.getValue(13),this.boundingRect.maxY=this.boundingRect.maxY+t.getValue(13))):(0,l.default)((0,f.default)(n.prototype),"translate",this).call(this,t,e)}},{key:"validate",value:function(t){return t.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL?this.points.length>3:t.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D?this.points.length>=3:void 0}}]),n}(v.default);e.default=P},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(30)),o=r(n(31)),s=r(n(3)),u=r(n(4)),l=r(n(5)),c=i(n(63)),h=i(n(11)),f=i(n(6)),d=i(n(15)),p=function(){function t(e,n,i,r,a,o){(0,s.default)(this,t),(0,l.default)(this,"unitLength",1),(0,l.default)(this,"widthHeightRatio",1),(0,l.default)(this,"shapeSet",void 0),(0,l.default)(this,"hoverShape",void 0),(0,l.default)(this,"width",void 0),(0,l.default)(this,"height",void 0),(0,l.default)(this,"setting",void 0),(0,l.default)(this,"emitter",void 0),(0,l.default)(this,"canvas",void 0),(0,l.default)(this,"PAINTER_TYPE",null),(0,l.default)(this,"config",void 0),this.canvas=e,this.setting=r,this.emitter=a,this.width=n,this.height=i,this.config=o}var e;return(0,u.default)(t,[{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"hasPrev",value:function(){return this.shapeSet.hasPrev()}},{key:"hasNext",value:function(){return this.shapeSet.hasNext()}},{key:"prev",value:function(){this.shapeSet.prev()&&this.drawViewShapes()}},{key:"next",value:function(){this.shapeSet.next()&&this.drawViewShapes()}},{key:"getUnitLength",value:function(){return this.unitLength}},{key:"getWidthHeightRatio",value:function(){return this.widthHeightRatio}},{key:"startDrawing",value:function(t){}},{key:"endDrawing",value:function(t){this.addShape(t)}},{key:"clearShapes",value:function(){this.clear(),this.shapeSet.clear()}},{key:"getActiveShape",value:function(t,e){return this.shapeSet.getActiveShape(t,e)}},{key:"getSelectShapes",value:function(t){return this.shapeSet.getSelectShapes(t)}},{key:"setHoverShape",value:function(t){this.hoverShape&&(this.hoverShape.setHoverStatus(!1),this.emitter.fire(c.SHAPE_LEAVE,{shape:this.hoverShape,select:this.hoverShape.isSelected()})),t&&(t.setHoverStatus(!0),this.hoverShape=t,this.emitter.fire(c.SHAPE_ENTER,{shape:this.hoverShape,select:this.hoverShape.isSelected()}))}},{key:"addShape",value:function(t){t.boundingRect&&(this.shapeSet.addShape(t),this.emitter.fire(c.SHAPE_ADD,{shapes:[t]}))}},{key:"addShapes",value:function(t){var e=this,n=[];h.each(t,(function(t){t.boundingRect&&(e.shapeSet.addShape(t),n.push(t))})),this.emitter.fire(c.SHAPE_ADD,{shapes:n})}},{key:"removeShape",value:function(t){this.shapeSet.removeShape(t)&&this.emitter.fire(c.SHAPE_REMOVE,{shapes:[t]})}},{key:"removeShapes",value:function(t){this.shapeSet.removeShapes(t),this.emitter.fire(c.SHAPE_REMOVE,{shapes:t})}},{key:"resize",value:function(t,e){this.width===t&&this.height===e||(this.viewport(t,e),this.drawViewShapes())}},{key:"getShape",value:function(t){return this.shapeSet.getShape(t)}},{key:"ready",value:(e=(0,o.default)(a.default.mark((function t(e){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",f.TRUE);case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"getViewShapeCount",value:function(){return this.shapeSet.getViewShapeCount()}},{key:"canActiveHover",value:function(){return!(this.hoverShape.isFill||this.hoverShape.name===d.IMAGE||this.hoverShape.name===d.TEXT||this.hoverShape.name===d.ARROW)}}]),t}();e.default=p},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=i(n(20)),l=i(n(11)),c=i(n(6)),h=r(n(266)),f=function(){function t(e,n,i){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;(0,a.default)(this,t),(0,s.default)(this,"pageShapesMap",void 0),(0,s.default)(this,"viewShapes",void 0),(0,s.default)(this,"idIndexMap",void 0),(0,s.default)(this,"pointer",void 0),(0,s.default)(this,"viewTop",void 0),(0,s.default)(this,"startY",void 0),(0,s.default)(this,"heightPerPage",void 0),(0,s.default)(this,"viewBuffer",void 0),(0,s.default)(this,"painter",void 0),(0,s.default)(this,"refreshFlag",[]),this.startY=n,this.painter=e,this.viewTop=u,this.heightPerPage=i,this.pointer=0,this.idIndexMap={},this.pageShapesMap={},this.viewShapes=[],l.each(o,(function(t){r.addShape(t)})),this.painter.PAINTER_TYPE===c.PAINTER_TYPE_WEBGL&&(this.viewBuffer=new h.default(o));for(var f=0;f<this.painter.config.totalPage;f++)this.refreshFlag[f]=c.FALSE}return(0,o.default)(t,[{key:"deletePageShape",value:function(t,e){var n=this;l.each(this.pageShapesMap[t],(function(i,r){if(i.number===e.number)return n.pageShapesMap[t].splice(r,1),c.FALSE}),c.TRUE)}},{key:"addShape",value:function(t){var e=this,n=this.getPage(t.boundingRect.maxY);if(this.pageShapesMap[n]||(this.pageShapesMap[n]=[]),!this.idIndexMap[t.number]){if(this.idIndexMap[t.number]={viewIndex:-1,pageIndex:-1,page:n},this.canViewShape(t)){if(this.pointer<this.viewShapes.length){var i=this.viewShapes.splice(this.pointer,this.viewShapes.length-this.pointer);l.each(i,(function(t){var n=e.getPage(t.boundingRect.maxY);e.deletePageShape(n,t),delete e.idIndexMap[t.number]})),this.painter.PAINTER_TYPE===c.PAINTER_TYPE_WEBGL&&this.viewBuffer.removeShapes(i)}this.idIndexMap[t.number].viewIndex=this.pointer,this.viewShapes.push(t),this.pointer++,this.painter.PAINTER_TYPE===c.PAINTER_TYPE_WEBGL&&this.viewBuffer.appendShape(t)}this.idIndexMap[t.number].pageIndex=this.pageShapesMap[n].length,this.pageShapesMap[n].push(t)}}},{key:"findShapeByNumber",value:function(t,e){var n;return l.each(t,(function(t){if(t.number===e)return n=t,c.FALSE})),n}},{key:"removeShape",value:function(t){if(u.string(t)&&(t=this.getShape(t)),!t)return c.FALSE;var e=t.number,n=c.FALSE;if(!this.idIndexMap[e])return c.FALSE;var i=this.idIndexMap[e].page;if(this.idIndexMap[e].viewIndex>-1){for(var r=this.idIndexMap[e].viewIndex+1;r<this.viewShapes.length;r++)this.idIndexMap[this.viewShapes[r].number].viewIndex--;this.viewShapes.splice(this.idIndexMap[e].viewIndex,1),this.pointer--,this.painter.PAINTER_TYPE===c.PAINTER_TYPE_WEBGL&&this.viewBuffer.removeShape(t)}if(this.idIndexMap[e].pageIndex>-1){for(var a=this.idIndexMap[e].pageIndex+1;a<this.pageShapesMap[i].length;a++)this.idIndexMap[this.pageShapesMap[i][a].number].pageIndex--;this.pageShapesMap[i].splice(this.idIndexMap[e].pageIndex,1),n=c.TRUE}return delete this.idIndexMap[e],n}},{key:"removeShapes",value:function(t){var e=this;if(t.length<this.viewShapes.length/2)l.each(t,(function(t){e.removeShape(t)}));else{var n=[];l.each(t,(function(t){var i=u.string(t)?t:t.number;if(!e.idIndexMap[i])return c.TRUE;var r=e.idIndexMap[i].page,a=e.idIndexMap[i].pageIndex,o=e.idIndexMap[i].viewIndex;n[r]=!0,e.viewShapes.splice(o,1,null),e.pageShapesMap[r].splice(a,1,null),delete e.idIndexMap[i]}));var i=[],r=0;l.each(this.viewShapes,(function(t){t&&(i.push(t),e.idIndexMap[t.number].viewIndex=r,r++)})),this.viewShapes=i,this.pointer=this.viewShapes.length,l.each(n,(function(t,n){t&&(i=[],r=0,l.each(e.pageShapesMap[n],(function(t){t&&(i.push(t),e.idIndexMap[t.number].pageIndex=r,r++)})),e.pageShapesMap[n]=i)})),this.viewBuffer&&(this.viewBuffer.clear(),l.each(this.viewShapes,(function(t){e.viewBuffer.appendShape(t)})))}}},{key:"updateShapes",value:function(t){var e=this;l.each(t,(function(t){if(!e.idIndexMap[t.number])return c.TRUE;var n=e.getPage(t.boundingRect.maxY);if(!u.number(n))return c.TRUE;var i=e.idIndexMap[t.number].page;if(i!==n){for(var r=e.idIndexMap[t.number].pageIndex+1;r<e.pageShapesMap[i].length;r++)e.idIndexMap[e.pageShapesMap[i][r].number].pageIndex--;e.pageShapesMap[i].splice(e.idIndexMap[t.number].pageIndex,1),n>i?(l.each(e.pageShapesMap[n],(function(t){e.idIndexMap[t.number].pageIndex++})),e.pageShapesMap[n]||(e.pageShapesMap[n]=[]),e.pageShapesMap[n].unshift(t),e.idIndexMap[t.number].pageIndex=0,e.idIndexMap[t.number].page=n):(e.idIndexMap[t.number].pageIndex=e.pageShapesMap[n].length,e.idIndexMap[t.number].page=n,e.pageShapesMap[n]||(e.pageShapesMap[n]=[]),e.pageShapesMap[n].push(t))}u.array(e.pageShapesMap[n])&&u.number(e.idIndexMap[t.number].pageIndex)&&(e.pageShapesMap[n][e.idIndexMap[t.number].pageIndex]=t),e.canViewShape(t)&&u.number(e.idIndexMap[t.number].viewIndex)&&(e.viewShapes[e.idIndexMap[t.number].viewIndex]=t)})),this.viewBuffer&&this.refreshBuffer()}},{key:"canViewShape",value:function(t,e){return e||(e=this.viewTop),this.painter.PAINTER_TYPE===c.PAINTER_TYPE_WEBGL?t.isBoundRectInShape({minX:-1,maxX:1,minY:e-this.heightPerPage,maxY:e}):this.painter.PAINTER_TYPE===c.PAINTER_TYPE_CANVAS_2D?t.isBoundRectInShape({minX:0,maxX:1,minY:0,maxY:1}):void 0}},{key:"getPage",value:function(t){return t>this.startY?0:Math.floor(Math.abs((t-this.startY)/this.heightPerPage))}},{key:"hasPrev",value:function(){return this.pointer>0}},{key:"hasNext",value:function(){return this.pointer<this.viewShapes.length}},{key:"prev",value:function(){return this.hasPrev()?(this.pointer--,this.viewBuffer&&this.viewBuffer.removeShape(this.viewShapes[this.pointer]),c.TRUE):c.FALSE}},{key:"next",value:function(){return this.hasNext()?(this.viewBuffer&&this.viewBuffer.appendShape(this.viewShapes[this.pointer]),this.pointer++,c.TRUE):c.FALSE}},{key:"getViewBuffer",value:function(){var t=this,e=[];return l.each(this.viewShapes,(function(n,i){i<t.pointer&&l.concat(e,n.toVertices(t.painter))})),new Float32Array(e)}},{key:"getPageBuffer",value:function(t){var e=this,n=[];return l.each(this.pageShapesMap[t],(function(t){l.concat(n,t.toVertices(e.painter))})),new Float32Array(n)}},{key:"getVertexBuffer",value:function(t){return t?this.viewBuffer.getBuffer():this.getViewBuffer()}},{key:"updateViewTop",value:function(t){var e=this;if(this.viewTop===t)return c.FALSE;var n=[];l.each(this.viewShapes,(function(t){e.idIndexMap[t.number].viewIndex=-1}));var i=this.getPage(t),r=this.pageShapesMap[i]||[];return this.refreshFlag[i]&&this.pageShapesMap[i]&&(this.resizeShapes(this.pageShapesMap[i],this.painter),this.refreshFlag[i]=c.FALSE),i>0&&(r=(this.pageShapesMap[i-1]||[]).concat(r),this.refreshFlag[i-1]&&this.pageShapesMap[i-1]&&(this.resizeShapes(this.pageShapesMap[i-1],this.painter),this.refreshFlag[i-1]=c.FALSE)),r=r.concat(this.pageShapesMap[i+1]||[]),this.refreshFlag[i+1]&&this.pageShapesMap[i+1]&&(this.resizeShapes(this.pageShapesMap[i+1],this.painter),this.refreshFlag[i+1]=c.FALSE),l.each(r,(function(i){e.canViewShape(i,t)&&n.push(i)})),this.viewBuffer&&(this.viewBuffer.clear(),l.each(n,(function(t){e.viewBuffer.appendShape(t)}))),this.viewShapes=n,l.each(this.viewShapes,(function(t,n){e.idIndexMap[t.number].viewIndex=n})),this.pointer=this.viewShapes.length,this.viewTop=t,c.TRUE}},{key:"clear",value:function(){this.pointer=0,this.idIndexMap={},this.pageShapesMap={},this.viewShapes=[],this.viewBuffer&&this.viewBuffer.clear()}},{key:"getActiveShape",value:function(t,e){var n,i=this;return l.each(this.viewShapes,(function(r,a){if(a<i.pointer&&r.isPointInShape(t,i.painter,e))return n=r,!1}),!0),n}},{key:"getSelectShapes",value:function(t){var e=this,n=[];return l.each(this.viewShapes,(function(i,r){r<e.pointer&&i.isBoundRectInShape(t)&&n.push(i)}),!0),n}},{key:"getViewShapes",value:function(){return this.viewShapes.slice(0,this.pointer)}},{key:"getPageShapes",value:function(t){return this.pageShapesMap[t]}},{key:"hasViewShape",value:function(){return this.pointer>0}},{key:"resizeShapes",value:function(t,e){var n=this;l.each(t,(function(t){t.resize(e),t.toVertices(n.painter)}))}},{key:"resize",value:function(){var t=this;this.resizeShapes(this.viewShapes,this.painter),this.viewBuffer.clear(),l.each(this.viewShapes,(function(e){t.viewBuffer.appendShape(e)}))}},{key:"getShape",value:function(t){if(this.idIndexMap[t]){var e=this.idIndexMap[t].page,n=this.pageShapesMap[e];return this.findShapeByNumber(n,t)}}},{key:"getViewShapeCount",value:function(){return this.pointer}},{key:"refreshBuffer",value:function(){var t=this;this.viewBuffer&&(this.viewBuffer.clear(),l.each(this.viewShapes,(function(e){e.toVertices(t.painter),t.viewBuffer.appendShape(e)})))}},{key:"destroy",value:function(){this.clear(),this.viewBuffer&&this.viewBuffer.destroy()}}]),t}();e.default=f},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t){for(var e,n=0,i=arguments.length,r=new Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];for(var o=0,s=r;o<s.length;o++)n+=(e=s[o]).length;for(var u=new t(n),l=0,c=0,h=r;c<h.length;c++)e=h[c],u.set(e,l),l+=e.length;return u}},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(9)),u=i(n(10)),l=i(n(8)),c=function(t){(0,s.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,l.default)(t);if(e){var a=(0,l.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,u.default)(this,n)}}(n);function n(t,i,r,o){return(0,a.default)(this,n),e.call(this,t,i,r,o)}return(0,o.default)(n,[{key:"copyToTexture",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.useMultisample&&(this.gl.bindFramebuffer(this.gl.READ_FRAMEBUFFER,t||this.renderbuffer),this.gl.bindFramebuffer(this.gl.DRAW_FRAMEBUFFER,e||this.framebuffer),this.gl.clearBufferfv(this.gl.COLOR,0,[0,0,0,0]),this.gl.blitFramebuffer(n,i,this.width,this.height,r,a,this.width,this.height,this.gl.COLOR_BUFFER_BIT,this.gl.LINEAR))}}]),n}(i(n(153)).default);e.default=c},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=r(n(26)),l=(i(n(32)),r(n(267))),c=function(){function t(e,n,i,r){(0,a.default)(this,t),(0,s.default)(this,"gl",void 0),(0,s.default)(this,"width",void 0),(0,s.default)(this,"height",void 0),(0,s.default)(this,"framebuffer",void 0),(0,s.default)(this,"renderbuffer",void 0),(0,s.default)(this,"texture",void 0),(0,s.default)(this,"colorBuffer",void 0),(0,s.default)(this,"useMultisample",void 0),this.gl=e,this.width=n,this.height=i,this.useMultisample=r,this.init()}return(0,o.default)(t,[{key:"init",value:function(){this.framebuffer=this.gl.createFramebuffer(),this.colorBuffer=this.gl.createRenderbuffer(),this.texture=new l.default(this.gl,this.width,this.height,this.useMultisample),this.texture.bind(),this.texture.init(),this.useMultisample?(this.renderbuffer=this.gl.createFramebuffer(),this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.colorBuffer),this.gl.renderbufferStorageMultisample(this.gl.RENDERBUFFER,4,this.gl.RGBA8,this.width,this.height),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.renderbuffer),this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.RENDERBUFFER,this.colorBuffer),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.texture.getTexture(),0)):(this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.colorBuffer),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_COMPONENT16,this.width,this.height),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.texture.getTexture(),0),this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,this.colorBuffer)),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}},{key:"toVertices",value:function(){return[-1,1,0,0,1,0,0,-1,-1,0,0,0,0,0,1,1,0,1,1,0,0,1,-1,0,1,0,0,0]}},{key:"length",value:function(){return 4}},{key:"viewport",value:function(){this.gl.viewport(0,0,this.width,this.height)}},{key:"destroy",value:function(){this.framebuffer&&(this.gl.deleteFramebuffer(this.framebuffer),this.framebuffer=null),this.renderbuffer&&(this.gl.deleteFramebuffer(this.renderbuffer),this.renderbuffer=null),this.colorBuffer&&(this.gl.deleteRenderbuffer(this.colorBuffer),this.colorBuffer=null),this.texture&&this.texture.destroy()}},{key:"getTexture",value:function(){return this.texture}},{key:"getFrameBuffer",value:function(){return this.useMultisample?this.renderbuffer:this.framebuffer}},{key:"getResolution",value:function(){return[1/this.width,1/this.height]}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"bind",value:function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.getFrameBuffer())}},{key:"clear",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"resize",value:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.destroy(),this.init())}},{key:"getPointColor",value:function(t,e){var n=new Uint8Array(4);return this.gl.readPixels(t,e,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),new u.default(n[0],n[1],n[2],n[3])}}]),t}();e.default=c},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=i(n(20)),l=function(){function t(e,n,i){(0,a.default)(this,t),(0,s.default)(this,"gl",void 0),(0,s.default)(this,"width",void 0),(0,s.default)(this,"height",void 0),(0,s.default)(this,"texture",void 0),this.gl=e,this.width=n,this.height=i,this.texture=this.gl.createTexture()}return(0,o.default)(t,[{key:"getTexture",value:function(){return this.texture}},{key:"bind",value:function(t){u.number(t)&&this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}},{key:"destroy",value:function(){this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null)}}]),t}();e.default=l},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=(i(n(32)),i(n(6))),l=function(){function t(e,n){(0,a.default)(this,t),(0,s.default)(this,"type",void 0),(0,s.default)(this,"_shader",void 0),(0,s.default)(this,"_source",void 0),(0,s.default)(this,"compiled",void 0),this.type=e,this._shader=null,this._source=n,this.compiled=u.FALSE}return(0,o.default)(t,[{key:"compile",value:function(t){this.compiled||(this._shader=t.createShader(this.type),t.shaderSource(this._shader,this._source),t.compileShader(this._shader),this.compiled=u.TRUE)}},{key:"stop",value:function(t){t.deleteShader(this._shader),this._shader=null}},{key:"shader",get:function(){return this._shader}}]),t}();e.default=l},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(17)),l=i(n(9)),c=i(n(10)),h=i(n(8)),f=i(n(5)),d=i(n(111)),p=i(n(50)),v=i(n(51)),g=i(n(274)),E=i(n(275)),_=function(t){(0,l.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,h.default)(t);if(e){var a=(0,h.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,c.default)(this,n)}}(n);function n(t){var i;return(0,a.default)(this,n),i=e.call(this,t,new p.default(t,g.default),new v.default(t,E.default)),(0,f.default)((0,s.default)(i),"samplerLocation",void 0),i}return(0,o.default)(n,[{key:"link",value:function(){(0,u.default)((0,h.default)(n.prototype),"link",this).call(this),this.samplerLocation=this.gl.getUniformLocation(this.program,"u_Sampler")}},{key:"bindTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.uniform1i(this.samplerLocation,t)}}]),n}(d.default);e.default=_},function(t,e,n){t.exports=n(285)},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(17)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(149)),v=r(n(80)),g=r(n(26)),E=r(n(107)),_=i(n(11)),y=r(n(150)),m=i(n(32)),T=i(n(27)),A=i(n(6)),R=r(n(81)),S=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t,i,r,a,s,l){var c,h,f=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return(0,o.default)(this,n),h=e.call(this,t,i,r,a,s,l),(0,d.default)((0,u.default)(h),"enableCache",void 0),(0,d.default)((0,u.default)(h),"cacheImageData",void 0),(0,d.default)((0,u.default)(h),"ctx",void 0),(0,d.default)((0,u.default)(h),"PAINTER_TYPE",A.PAINTER_TYPE_CANVAS_2D),h.shapeSet=new y.default((0,u.default)(h),0,h.getHeight(),[],0),h.ctx=null!==(c=h.config.cacheCanvasContext)&&void 0!==c?c:t.getContext("2d"),h.ctx||m.fatal("不支持 canvas 功能"),!f&&h.setting.options.enableColorBufferCache&&(h.enableCache=!0),h.viewport(h.getWidth(),h.getHeight()),h}return(0,s.default)(n,[{key:"save",value:function(){var t=this.canvas,e=t.width,n=t.height;e&&n&&(this.config.saveCanvasCache?this.config.saveCanvasCache(this.canvas,this.ctx):this.cacheImageData=this.ctx.getImageData(0,0,e,n))}},{key:"restore",value:function(){var t=this.canvas,e=t.width,n=t.height;e&&n&&(this.config.restoreCanvasCache?this.config.restoreCanvasCache(this.canvas,this.ctx):this.cacheImageData&&this.ctx.putImageData(this.cacheImageData,0,0))}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.cacheImageData=null}},{key:"viewport",value:function(t,e){var n=t*this.config.devicePixelRatio,i=e*this.config.devicePixelRatio;this.width=n,this.height=i,this.canvas.width=n,this.canvas.height=i,this.unitLength=1/t,this.widthHeightRatio=t/e}},{key:"resize",value:function(t,e){this.viewport(t,e),this.clear(),this.drawViewShapes()}},{key:"setOptions",value:function(t,e){var n=T.extend(t.getOptions(),e||{});this.ctx.lineWidth=n.lineWidth*this.config.devicePixelRatio,t.dash?this.ctx.setLineDash(n.dashSegments):this.ctx.setLineDash([]),!t.isHover()||t.isSelected()||t instanceof v.default?(this.ctx.strokeStyle=n.stroke.toString(),this.ctx.fillStyle=n.fill.toString()):(this.ctx.strokeStyle=t.hoverColor.toString(),this.ctx.fillStyle=t.hoverColor.toString())}},{key:"setFont",value:function(t,e){var n=[];t.fontItalic&&n.push("italic"),t.bold&&n.push("bold"),n.push("".concat(t.fontSize*this.config.devicePixelRatio,"px"),t.fontFamily),this.ctx.fillStyle=t.stroke.toString(),this.ctx.font=n.join(" ")}},{key:"drawPath",value:function(t,e){var n=this;t.length&&(this.ctx.beginPath(),this.ctx.moveTo(t[0].xGlTo2D(this.canvas.width),t[0].yGlTo2D(this.canvas.height)),_.each(t.slice(1),(function(t,e){n.ctx.lineTo(t.xGlTo2D(n.canvas.width),t.yGlTo2D(n.canvas.height))})),e.close&&this.ctx.closePath(),e.isFill&&this.ctx.fill(),e.isStroke&&this.ctx.stroke())}},{key:"drawTipBezierLine",value:function(t,e){var n=this;t.length&&_.each(t,(function(i,r){r<t.length-1&&(e&&(n.ctx.lineWidth=e(r)*n.config.devicePixelRatio,console.log(n.ctx.lineWidth)),n.ctx.beginPath(),n.ctx.moveTo(i.xGlTo2D(n.canvas.width),i.yGlTo2D(n.canvas.height)),n.ctx.lineTo(t[r].xGlTo2D(n.canvas.width),t[r].yGlTo2D(n.canvas.height)),n.ctx.stroke())}))}},{key:"drawOval",value:function(t,e){this.ctx.beginPath(),2===t.length?(this.ctx.moveTo(t[0].xGlTo2D(this.canvas.width),t[0].yGlTo2D(this.canvas.height)),this.ctx.arc(t[1].xGlTo2D(this.canvas.width),t[1].yGlTo2D(this.canvas.height),Math.floor(e.a*this.canvas.width),0,A.PI2,A.TRUE)):(this.bezierCurveTo(t[0],t[1],t[2],t[3]),this.bezierCurveTo(t[3],t[4],t[5],t[0])),e.isStroke&&this.ctx.stroke(),e.isFill&&this.ctx.fill()}},{key:"drawBezier",value:function(t,e){2===t.length?this.drawPath(t,e):(this.ctx.beginPath(),3===t.length?this.bezierCurveTo(t[0],t[1],t[1],t[2]):this.bezierCurveTo(t[0],t[1],t[2],t[3]),this.ctx.stroke())}},{key:"drawRoundRect",value:function(t,e,n,i,r){r=2*(r=2*r>n?n/2:r)>i?i/2:r,this.ctx.beginPath(),this.ctx.moveTo(t+r,e),this.ctx.arcTo(t+n,e,t+n,e+i,r),this.ctx.arcTo(t+n,e+i,t,e+i,r),this.ctx.arcTo(t,e+i,t,e,r),this.ctx.arcTo(t,e,t+n,e,r),this.ctx.closePath(),this.ctx.fill()}},{key:"drawText",value:function(t,e){var n,i,r=this,a=this.config.devicePixelRatio,o=(0,R.default)(t.fontSize)*a,s=t.fontSize*a;if(e?n=i=0:(n=t.points[0].xGlTo2D(this.canvas.width),i=t.points[0].yGlTo2D(this.canvas.height)),t.isFill){var u=this.ctx.fillStyle;this.ctx.fillStyle=t.background.toString(),this.drawRoundRect(n,i,(t.width||this.measureText(t.text).width)*a,(t.height||o)*a,t.radius),this.ctx.fillStyle=u}if(t&&t.text){var l=0,c=0,h=0;_.each(t.text.split("\n"),(function(e){if(e){c=0;for(var u=0;u<e.length;u++)(h+=r.measureText(e[u]).width)>t.maxWidth*r.config.devicePixelRatio&&(r.ctx.fillText(e.substring(c,u),n+t.offsetX*a,i+t.offsetY*a+s+o*l),++l,c=u,h=r.measureText(e[u]).width),u===e.length-1&&(r.ctx.fillText(e.substring(c,u+1),n+t.offsetX*a,i+t.offsetY*a+s+o*l),++l,h=0)}else r.ctx.fillText(e,n+t.offsetX*a,i+t.offsetY*a+s+o*l),++l}))}}},{key:"drawImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A.FALSE,n=this.config.devicePixelRatio;if(e)this.ctx.drawImage(t.image,0,0,t.width*n,t.height*n);else{var i=0,r=0;t.angle&&(i=Math.floor((t.points[1].xGlTo2D(this.canvas.width)+t.points[0].xGlTo2D(this.canvas.width))/2),r=Math.floor((t.points[1].yGlTo2D(this.canvas.height)+t.points[0].yGlTo2D(this.canvas.height))/2),this.ctx.translate(i,r),this.ctx.rotate(t.angle*A.PI/180)),this.ctx.drawImage(t.image,t.points[0].xGlTo2D(this.canvas.width)-i,t.points[0].yGlTo2D(this.canvas.height)-r,t.points[1].xGlTo2D(this.canvas.width)-t.points[0].xGlTo2D(this.canvas.width),t.points[1].yGlTo2D(this.canvas.height)-t.points[0].yGlTo2D(this.canvas.height)),t.angle&&(this.ctx.rotate(-t.angle*A.PI/180),this.ctx.translate(-i,-r))}}},{key:"bezierCurveTo",value:function(t,e,n,i){this.ctx.moveTo(t.xGlTo2D(this.canvas.width),t.yGlTo2D(this.canvas.height)),this.ctx.bezierCurveTo(e.xGlTo2D(this.canvas.width),e.yGlTo2D(this.canvas.height),n.xGlTo2D(this.canvas.width),n.yGlTo2D(this.canvas.height),i.xGlTo2D(this.canvas.width),i.yGlTo2D(this.canvas.height))}},{key:"drawViewShapes",value:function(){var t=this;this.clear(),_.each(this.shapeSet.getViewShapes(),(function(e){e.draw2DPath(t)})),(this.enableCache||this.config.saveCanvasCache)&&this.save()}},{key:"redrawShapes",value:function(){this.drawViewShapes()}},{key:"drawing",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t;n&&r.generateCanvas2DPoints(this),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),!this.enableCache&&!this.config.restoreCanvasCache||i?_.each(this.shapeSet.getViewShapes(),(function(t){t.draw2DPath(e)})):this.restore(),r.draw2DPath(this)}},{key:"endDrawing",value:function(t){(0,l.default)((0,f.default)(n.prototype),"endDrawing",this).call(this,t),this.enableCache&&this.save()}},{key:"hoverState",value:function(t,e){var n=this;if(t){if(t.isSelected())return}else{if(!this.hoverShape)return;this.hoverShape=null}this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.enableCache?this.restore():_.each(this.shapeSet.getViewShapes(),(function(t,e){t.draw2DPath(n)})),t&&this.canActiveHover()&&t.draw2DPath(this,{fill:this.setting.hoverColor,stroke:this.setting.hoverColor}),e&&e.draw2DPath(this)}},{key:"getActiveShape",value:function(t,e){if(!(!this.shapeSet.hasViewShape()||t.x<0||t.x>1||t.y<0||t.y>1))return(0,l.default)((0,f.default)(n.prototype),"getActiveShape",this).call(this,t,e)}},{key:"getImageData",value:function(t){return this.clear(),t instanceof E.default?(this.viewport(t.width,t.height),t.draw2DPath(this,null,A.TRUE)):t instanceof v.default&&(t.generateCanvas2DPoints(this),this.viewport(t.width,t.height),t.draw2DPath(this,null,A.TRUE)),this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)}},{key:"putImageData",value:function(t){this.ctx.putImageData(t.imageData,0,0)}},{key:"measureText",value:function(t){return this.ctx.measureText(t)}},{key:"getPointColor",value:function(t){var e=this.ctx.getImageData(t.xGlTo2D(this.canvas.width),t.yGlTo2D(this.canvas.height),1,1);return e.data?new g.default(e.data[0],e.data[1],e.data[2],e.data[3]):new g.default(0,0,0,0)}},{key:"updateShape",value:function(t){this.shapeSet.updateShapes(t)}},{key:"destroy",value:function(){this.shapeSet&&this.shapeSet.destroy()}},{key:"getColorBuffer",value:function(t,e){return t||(t=this.canvas.width),e||(e=this.canvas.height),this.ctx.getImageData(0,0,t,e)}}]),n}(p.default);e.default=S},function(t,e,n){t.exports=n(310)},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a,o=r(n(60)),s=r(n(30)),u=r(n(31)),l=r(n(3)),c=r(n(4)),h=r(n(5)),f=r(n(13)),d=i(n(11)),p=i(n(15)),v=r(n(139)),g=r(n(306)),E=r(n(309)),_=r(n(314)),y=i(n(63)),m=i(n(6)),T=i(n(20)),A=n(315),R=r(n(158)),S=r(n(81)),x=r(n(80)),P=i(n(27)),O=n(316),I=r(n(107)),w=r(n(26)),b=r(n(113)),D=r(n(317)),C=r(n(144)),L=i(n(318)),N=r(n(147)),M=r(n(319)),k=void 0,U=function(){function t(e){var n,i,r,a,o=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];(0,l.default)(this,t),(0,h.default)(this,"canvasElement",void 0),(0,h.default)(this,"cmu",void 0),(0,h.default)(this,"canvas",void 0),(0,h.default)(this,"namespace",void 0),(0,h.default)(this,"texturePainter",void 0),(0,h.default)(this,"queue",void 0),(0,h.default)(this,"labelMap",void 0),(0,h.default)(this,"emitter",void 0),(0,h.default)(this,"activeTextNumber",void 0),(0,h.default)(this,"readyed",void 0),(0,h.default)(this,"config",void 0),(0,h.default)(this,"history",void 0),(0,h.default)(this,"plugins",void 0),this.canvasElement=e,this.config=P.extend({},(0,A.getOptions)()),this.config=P.extend(this.config,s),this.labelMap={},this.plugins=u,this.emitter=new b.default,this.history=new L.default({onRecordChange:function(t){o.emitter.fire(y.HISTORY_RECORD_CHANGE,{record:t})}}),s.canUseWorker?(this.cmu=new g.default(e,null!==(n=e.offsetWidth)&&void 0!==n?n:300,null!==(i=e.offsetHeight)&&void 0!==i?i:150,this.emitter,this.config),this.cmu.setOptions(P.copy(s))):this.cmu=new v.default(e,null!==(r=e.offsetWidth)&&void 0!==r?r:300,null!==(a=e.offsetHeight)&&void 0!==a?a:150,this.emitter,this.config),this.config.customCanvasEvent||(this.canvas=new E.default(e,s.container,this.emitter,this.config)),this.queue=new O.AsyncQueue,this.namespace=".paintergl",this.readyed=m.FALSE}var e,n,i,r,M,U,G;return(0,c.default)(t,[{key:"ready",value:(G=(0,u.default)(s.default.mark((function t(e,n){var i,r,o,l,c,h=this;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.config.useWebGL){t.next=10;break}if(this.texturePainter=new R.default(null!==(i=this.config.cacheCanvas)&&void 0!==i?i:document.createElement("canvas"),null!==(r=this.canvasElement.offsetWidth)&&void 0!==r?r:300,null!==(o=this.canvasElement.offsetHeight)&&void 0!==o?o:150,null,null,this.config,!0),this.labelMap[this.config.shapeLabel]=this.getLabelTexture(this.config.shapeLabel),this.config.shapeLabel&&this.cmu.addLabelTexture(this.config.shapeLabel,this.labelMap[this.config.shapeLabel]),!this.config.enableDoodleCursor){t.next=10;break}return t.next=7,this.formatShapeInterface(p.IMAGE,{url:this.config.cursor.url||_.default});case 7:l=t.sent,c=l.imageData,this.cmu.initCursor(c);case 10:return t.next=12,this.cmu.ready(e,n,this.config.useWebGL&&("function"==typeof ImageData?new ImageData(4,4):this.texturePainter.getColorBuffer(4,4)));case 12:this.canvas&&this.canvas.updateOffset(),this.cmu.on(y.TEXT_DRAWING_START+this.namespace,function(){var t=(0,u.default)(s.default.mark((function t(e,n){var i;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=2;break}return t.abrupt("return");case 2:if(i=new x.default(P.extend({points:[new f.default(h.config.useWebGL?n.eventData.glX:n.eventData.x,h.config.useWebGL?n.eventData.glY:n.eventData.y,0,n.eventData)]},n.options)),!h.config.createTextarea){t.next=9;break}return t.next=6,h.config.createTextarea(i);case 6:i=t.sent,t.next=12;break;case 9:return t.next=11,h.createTextarea(i);case 11:i=t.sent;case 12:if(i.text){t.next=14;break}return t.abrupt("return");case 14:h.config.useWebGL&&(i.imageData=h.texturePainter.getImageData(i)),h.cmu.addShape(p.TEXT,P.extend(i.getOptions(),{number:i.number,width:i.width,height:i.height,imageData:i.imageData,points:i.points,text:i.text,maxWidth:i.maxWidth}),m.FALSE);case 16:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()).on(y.MOUSE_DOWN+this.namespace,this.cmu.mouseDownHandler,{ctx:this.cmu}).on(y.MOUSE_MOVE+this.namespace,this.cmu.mouseMoveHandler,{ctx:this.cmu}).on(y.MOUSE_UP+this.namespace,this.cmu.mouseUpHandler,{ctx:this.cmu}).on(y.MOUSE_DBLCLICK+this.namespace,this.cmu.dblclickHandler,{ctx:this.cmu}).on(y.MOUSE_WHEEL_UP+this.namespace,this.cmu.onMouseWheel,{ctx:this.cmu}).on(y.MOUSE_WHEEL_DOWN+this.namespace,this.cmu.onMouseWheel,{ctx:this.cmu}).on(y.CLEAR+this.namespace,(function(){h.cmu.clear(m.FALSE)}),{ctx:this}).on(y.ACTIVE_SHAPE_DELETE+this.namespace,(function(){a||h.cmu.deleteSelectedShapes()}),{ctx:this}).on(y.LOCAL_SHAPE_DBLCLICK+this.namespace,function(){var t=(0,u.default)(s.default.mark((function t(e,n){var i,r,a,o,u,l;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=n.shape).name!==p.TEXT){t.next=28;break}return h.activeTextNumber=i.number,(r=n.eventData).x=i.points[0].x,r.y=i.points[0].y,r.pageX=Math.floor(r.x*h.cmu.width+r.canvasOffsetX-r.containerScrollX),r.pageY=Math.floor(r.y*h.cmu.height*(h.config.useWebGL?h.config.totalPage:1)+r.canvasOffsetY-r.containerScrollY),t.next=10,h.formatShapeInterface(p.TEXT,i);case 10:if((a=t.sent).points=[new f.default(a.points[0].x,a.points[0].y,0,r)],T.string(a.strokeStyle)&&(a.stroke=new w.default(a.strokeStyle,null!==(o=a.strokeAlpha)&&void 0!==o?o:1)),T.string(a.fillStyle)&&(a.fill=new w.default(a.fillStyle,null!==(u=a.fillAlpha)&&void 0!==u?u:1)),l=new x.default(a),!h.config.createTextarea){t.next=21;break}return t.next=18,h.config.createTextarea(l);case 18:l=t.sent,t.next=24;break;case 21:return t.next=23,h.createTextarea(l);case 23:l=t.sent;case 24:if(l.text){t.next=26;break}return t.abrupt("return");case 26:h.config.useWebGL&&(l.imageData=h.texturePainter.getImageData(l)),h.cmu.addShape(p.TEXT,P.extend(l.getOptions(),{number:l.number,id:l.id,label:l.label,width:l.width,height:l.height,imageData:l.imageData,points:l.points,text:l.text,maxWidth:l.maxWidth,fontSize:l.fontSize,fontFamily:l.fontFamily,fontItalic:l.fontItalic,bold:l.bold}),m.FALSE);case 28:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()).on(y.LOCAL_SHAPE_ADD+this.namespace,(function(t,e){e.ignoreHistroy||h.history.add([e.shape])})).on(y.LOCAL_SHAPE_REMOVE+this.namespace,(function(t,e){e.ignoreHistroy||h.history.remove(e.shapes)})).on(y.LOCAL_SHAPE_UPDATE+this.namespace,(function(t,e){e.ignoreHistroy||h.history.update(e.shapes)})).on(y.LOCAL_TEXT_BLUR+this.namespace,(function(t,e){h.history.hasCurrentShape(e.text)?h.history.update([e.text]):h.history.add([e.text])})),this.plugins.length&&d.each(this.plugins,(function(t){t.apply(h)})),this.readyed=m.TRUE;case 16:case"end":return t.stop()}}),t,this)}))),function(t,e){return G.apply(this,arguments)})},{key:"setCanPaint",value:function(t){this.cmu.setCanPaint(t),!t&&a&&a.blur()}},{key:"setPainterShape",value:function(t){this.cmu.setPainterShape(t),this.canvas&&(t===p.SELECT?this.canvas.updateDelay(60):this.canvas.updateDelay(0))}},{key:"resize",value:(U=(0,u.default)(s.default.mark((function t(e,n){var i=this;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.readyed){t.next=2;break}return t.abrupt("return",new Error("painter not ready"));case 2:return t.next=4,this.cmu.resize(e,n);case 4:setTimeout((function(){i.canvas&&i.canvas.updateOffset()}));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return U.apply(this,arguments)})},{key:"viewport",value:(M=(0,u.default)(s.default.mark((function t(e,n){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.readyed){t.next=2;break}return t.abrupt("return",new Error("painter not ready"));case 2:return t.next=4,this.cmu.viewport(e,n);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return M.apply(this,arguments)})},{key:"reverseAction",value:function(t,e){var n=this;t===L.ACTION.ADD?(this.addShapes(e.map((function(t){return{type:t.name,shape:t}})),!0),d.each(e,(function(t){n.emitter.fire(y.LOCAL_SHAPE_ADD,{shape:t,ignoreHistroy:!0})}))):t===L.ACTION.REMOVE?(this.removeShapes(e.map((function(t){return t.number})),!0),this.emitter.fire(y.LOCAL_SHAPE_REMOVE,{shapes:e,ignoreHistroy:!0})):t===L.ACTION.UPDATE&&(this.updateShapes(e,!0),this.emitter.fire(y.LOCAL_SHAPE_UPDATE,{shapes:e,ignoreHistroy:!0}))}},{key:"hasPrev",value:function(){return this.history.hasPrev()}},{key:"hasNext",value:function(){return this.history.hasNext()}},{key:"prev",value:function(){var t=this.history.prev();t&&this.reverseAction(t.action,t.shapes)}},{key:"next",value:function(){var t=this.history.next();t&&this.reverseAction(t.action,t.shapes)}},{key:"clear",value:function(t){this.cmu.clear(t),this.history.clear()}},{key:"formatShapeInterface",value:(r=(0,u.default)(s.default.mark((function t(e,n){var i=this;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new o.default((function(t,r){var a=P.extend({},n);if(T.array(a.points)){var o=[];d.each(a.points,(function(t){i.config.useWebGL?o.push({x:2*t.x-1,y:1-t.y*(i.config.totalPage>1?2*i.config.totalPage:2),z:t.z||0}):o.push({x:t.x,y:t.y,z:t.z||0})})),a.points=o}if(i.config.useWebGL&&(a.label&&!i.labelMap[a.label]&&(i.labelMap[a.label]=i.getLabelTexture(a.label),i.cmu.addLabelTexture(a.label,i.labelMap[a.label])),a.a&&(a.a*=2),a.b&&(a.b*=2),e===p.TEXT)){var s;T.string(a.text)||(a.text=""),P.extend(a,i.getTextSize(a.text,a));var u=new x.default(P.extend({points:[new f.default(-1,1,0)],stroke:new w.default(a.strokeStyle,null!==(s=a.strokeAlpha)&&void 0!==s?s:1)},a));u.imageData=i.texturePainter.getImageData(u),P.extend(a,{width:u.width,height:u.height,imageData:u.imageData})}if(e===p.IMAGE){var l=document.createElement("img"),c=i.queue.push((function(){var e=a.maxWidth,n=a.maxHeight;if(!a.width&&!a.height){var r=(0,D.default)(l.width,l.height,e||l.width,n||l.height),o=r.width,s=r.height;a.width=o,a.height=s}if(i.config.useWebGL){var u=new I.default({url:a.url,width:l.width,height:l.height,image:l});if(createImageBitmap)return void createImageBitmap(l,{resizeQuality:"low",premultiplyAlpha:"premultiply",imageOrientation:"flipY"}).then((function(e){a.imageData=e,t(a)}));a.imageData=i.texturePainter.getImageData(u)}else a.image=l;t(a)}));l.onload=function(){i.queue.success(c)},l.onerror=function(){l.loadCount>3&&(r(a),i.emitter.fire(y.IMAGE_LOAD_FAIL,{image:a})),l.src="",setTimeout((function(){l.src=a.url,l.loadCount++}))},l.crossOrigin="anonymous",l.src=a.url,l.loadCount=0}else t(a)})));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})},{key:"addShape",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.readyed&&(e.name=t,e.number||(e.number=(0,N.default)(this.config.shapeIdPrefix)),this.formatShapeInterface(t,e).then((function(a){n.cmu.addShape(t,a,i,r),n.history.add([e])})))}},{key:"updateShapes",value:(i=(0,u.default)(s.default.mark((function t(e){var n,i,r,o=this,u=arguments;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=u.length>1&&void 0!==u[1]&&u[1],e=e.filter((function(t){if(a&&o.activeTextNumber===t.number){a.value=t.text,"function"==typeof a.updateValueCallback&&a.updateValueCallback(m.FALSE);var e=a.bindShape;if(e){var n=t.points[0],i=n.x,r=n.y,s=e.points[0].mouseEvent,u=Math.floor(i*o.cmu.width+s.canvasOffsetX-s.containerScrollX),l=Math.floor(r*o.cmu.height*(o.config.useWebGL?o.config.totalPage:1)+s.canvasOffsetY-s.containerScrollY);o.config.useWebGL&&(i=2*i-1,r=1-r*(o.config.totalPage>1?2*o.config.totalPage:2)),e.points[0].x=i,e.points[0].y=r,s.pageX=u,s.pageY=l,a.style.maxWidth="".concat(t.maxWidth,"px"),a.style.transform="translate(".concat(u-1,"px, ").concat(l+1,"px)")}return!1}return!0})),i=[],r=0;case 4:if(!(r<e.length)){t.next=11;break}return t.next=7,this.formatShapeInterface(e[r].name,e[r]);case 7:i[r]=t.sent;case 8:r++,t.next=4;break;case 11:this.cmu.updateShapes(i),n||this.history.update(e);case 13:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"addShapes",value:(n=(0,u.default)(s.default.mark((function t(e){var n,i,r,a=this,o=arguments;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=o.length>1&&void 0!==o[1]&&o[1],d.each(e,(function(t){t.shape.name=t.type,t.shape.number||(t.shape.number=(0,N.default)(a.config.shapeIdPrefix))})),i=[],r=0;case 4:if(!(r<e.length)){t.next=13;break}return t.t0=i,t.next=8,this.formatShapeInterface(e[r].type,e[r].shape);case 8:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 10:r++,t.next=4;break;case 13:this.cmu.addShapes(i),n||this.history.addCurrentShapes(e.map((function(t){return t.shape})));case 15:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"removeShapes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e||(d.has(t,this.activeTextNumber)&&a&&("function"==typeof a.removeCallback&&a.removeCallback(),a=null),this.history.removeByNumber(t)),this.cmu.removeShapes(t)}},{key:"deleteSelectedShapes",value:function(){this.cmu.deleteSelectedShapes()}},{key:"scrollTop",value:function(t){this.readyed&&this.cmu.scrollTop(t)}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.cmu.on(t,e,n),this}},{key:"off",value:function(t,e){return this.cmu.off(t,e),this}},{key:"one",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.max=1,this.on(t,e,n)}},{key:"updateShapeSetting",value:function(t){this.cmu.updateShapeSetting(t),this.canvas&&t.lineWidth&&this.canvas.setLineWidth(t.lineWidth)}},{key:"refresh",value:function(){this.cmu.refresh()}},{key:"destroy",value:function(){this.canvas&&(this.canvas.destroy(),this.canvas=null),this.cmu.destroy(),this.cmu=null,this.texturePainter&&(this.texturePainter.destroy(),this.texturePainter=null),this.emitter=null,this.labelMap=null,this.queue=null,this.config=null,this.canvasElement=null,this.readyed=!1}},{key:"createTextarea",value:(e=(0,u.default)(s.default.mark((function t(e){var n=this;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new o.default((function(t,i){var r=e.fontSize,o=e.fontFamily,s=e.fontItalic,u=e.bold,l=e.stroke,c=document.body,h=n.getTextSize(e.text,e),f=h.width,d=h.height,p=n.config.devicePixelRatio,v=n.cmu.width*p,g=n.cmu.height*p,E=e.points[0].mouseEvent;k&&(clearTimeout(k),k=null),(a=document.createElement("textarea")).className=n.config.textareaClass,a.spellcheck=!1,a.bindShape=e;var _=0,T=n.canvas&&n.canvas.getCanvasOffset().y||0,A=E.pageY+1,R=d;A<T&&(d-=_=T-A,A=T);var x=e.maxWidth||Math.floor((1-e.points[0].mouseEvent.x)*n.cmu.width),P=Math.floor((1-e.points[0].mouseEvent.y)*n.cmu.height);if(n.config.container){var O=n.canvasElement.offsetHeight;O>n.config.container.offsetHeight&&(O=n.config.container.offsetHeight),P=O-A+T}var I=e.text?f:r,w=d||(0,S.default)(r),b=E.pageX-1;e.text||(b-=I/2,A-=w/2,n.config.useWebGL?(e.points[0].x-=I/n.cmu.width,e.points[0].y+=w/n.cmu.height):(e.points[0].x-=I/2/n.cmu.width,e.points[0].y-=w/2/n.cmu.height));var D="\n        position: absolute;\n        left: 0;\n        top: 0;\n        transform: translate(".concat(b,"px, ").concat(A,"px);\n        color: ").concat(l.toString(),";\n        caret-color: ").concat(l.toString(),";\n        background-color: ").concat("rgba(0,0,0,0)",";\n        font: ").concat(r,"px ").concat(o,";\n        line-height: ").concat((0,S.default)(r),"px;\n        border: ").concat(1,"px dashed ").concat(l.toString(),";\n        box-sizing: content-box;\n        outline: none;\n        resize: none;\n        padding: 0;\n        overflow-y: ").concat(n.config.enableScrollTextarea&&R>Math.min(P,d)?"auto":"hidden",";\n        width: ").concat(I,"px;\n        height: ").concat(w,"px;\n        max-width: ").concat(x,"px;\n        max-height: ").concat(P,"px;\n        wrap: physical;\n        word-break: break-all;\n      ");s&&(D+="font-style: italic;"),u&&(D+="font-weight: bold;"),e.text&&(a.value=e.text),a.style.cssText=D,c.appendChild(a),setTimeout((function(){a.focus(),a.scrollTop=_}));var C=!1,L=function(t){e.text!==a.value&&(e.text=a.value,e.maxWidth||(e.maxWidth=x),t&&n.emitter.fire(y.LOCAL_TEXT_CHANGE,{text:e.toJSON(n.config),textarea:a,width:v+2,height:g+2}))},N=a.updateValueCallback=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.TRUE,i=n.getTextSize(a.value,e),r=i.width,o=i.height;e.fontItalic&&(e.fontSize<60?r+=2:e.fontSize<70?r+=4:r+=6),a.style.width=r+"px",a.style.height=o-_+"px",e.width=r,e.height=o,C||L(t)},M=function(){C=!0},U=function(){C=!1,L(m.TRUE)},G=a.removeCallback=function(){a.removeEventListener("input",N),a.removeEventListener("compositionstart",M),a.removeEventListener("compositionend",U),a.removeEventListener("blur",F),c.removeChild(a)},F=function(){G(),k=setTimeout((function(){a=null,k=null}),500),t(e),n.emitter.fire(y.LOCAL_TEXT_BLUR,{text:e.toJSON(n.config)})};a.addEventListener("input",N),a.addEventListener("compositionstart",M),a.addEventListener("compositionend",U),a.addEventListener("blur",F)})));case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"getTextSize",value:function(t,e){return document?(0,C.default)(t||"W",e):this.texturePainter?(this.texturePainter.setFont(e,!0),{width:Math.ceil(this.texturePainter.measureText(e.text).width/this.config.devicePixelRatio),height:(0,S.default)(e.fontSize)}):{width:0,height:0}}},{key:"getLabelTexture",value:function(t){var e={isFill:m.TRUE,fontSize:m.ACTIVE_INFO_RECT_FONT_TEXTURE_SIZE,stroke:new w.default(m.ACTIVE_INFO_RECT_COLOR),text:t,radius:m.ACTIVE_INFO_RECT_RADIUS,fontFamily:"sans-serif",background:new w.default(m.ACTIVE_INFO_RECT_BACKGROUND),points:[new f.default(0,0,0)],width:0,height:0};P.extend(e,this.getTextSize(t,e));var n=new x.default(e);e.fontSize=m.ACTIVE_INFO_RECT_FONT_SIZE;var i=this.getTextSize(t,e),r=i.width,a=i.height;return{label:n.text,width:r,height:a,imageData:this.texturePainter.getImageData(n)}}},{key:"getHistoryData",value:function(){return this.history.getData()}},{key:"setHistoryData",value:function(t){this.history.setData(t)}}]),t}();e.default=U,(0,h.default)(U,"shapeType",p),(0,h.default)(U,"Point",f.default),(0,h.default)(U,"Event",y),(0,h.default)(U,"Color",w.default),(0,h.default)(U,"Plugins",{ClassHandwritingBoardPlugin:M.default})},function(t,e,n){n(162);var i=n(14).Object;t.exports=function(t,e){return i.getOwnPropertyDescriptor(t,e)}},function(t,e,n){var i=n(40),r=n(65).f;n(67)("getOwnPropertyDescriptor",(function(){return function(t,e){return r(i(t),e)}}))},function(t,e,n){n(164);var i=n(14).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){var i=n(16);i(i.S+i.F*!n(28),"Object",{defineProperty:n(29).f})},function(t,e,n){t.exports=n(166)},function(t,e,n){n(44),n(46),t.exports=n(93).f("iterator")},function(t,e,n){var i=n(86),r=n(64);t.exports=function(t){return function(e,n){var a,o,s=String(r(e)),u=i(n),l=s.length;return u<0||u>=l?t?"":void 0:(a=s.charCodeAt(u))<55296||a>56319||u+1===l||(o=s.charCodeAt(u+1))<56320||o>57343?t?s.charAt(u):a:t?s.slice(u,u+2):o-56320+(a-55296<<10)+65536}}},function(t,e,n){"use strict";var i=n(56),r=n(53),a=n(58),o={};n(39)(o,n(22)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(o,{next:r(1,n)}),a(t,e+" Iterator")}},function(t,e,n){var i=n(29),r=n(24),a=n(57);t.exports=n(28)?Object.defineProperties:function(t,e){r(t);for(var n,o=a(e),s=o.length,u=0;s>u;)i.f(t,n=o[u++],e[n]);return t}},function(t,e,n){var i=n(40),r=n(68),a=n(171);t.exports=function(t){return function(e,n,o){var s,u=i(e),l=r(u.length),c=a(o,l);if(t&&n!=n){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((t||c in u)&&u[c]===n)return t||c||0;return!t&&-1}}},function(t,e,n){var i=n(86),r=Math.max,a=Math.min;t.exports=function(t,e){return(t=i(t))<0?r(t+e,0):a(t,e)}},function(t,e,n){"use strict";var i=n(173),r=n(118),a=n(45),o=n(40);t.exports=n(87)(Array,"Array",(function(t,e){this._t=o(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},function(t,e){t.exports=function(){}},function(t,e,n){n(175),n(70),n(178),n(179),t.exports=n(14).Symbol},function(t,e,n){"use strict";var i=n(19),r=n(36),a=n(28),o=n(16),s=n(88),u=n(47).KEY,l=n(37),c=n(90),h=n(58),f=n(69),d=n(22),p=n(93),v=n(95),g=n(176),E=n(97),_=n(24),y=n(21),m=n(42),T=n(40),A=n(84),R=n(53),S=n(56),x=n(177),P=n(65),O=n(96),I=n(29),w=n(57),b=P.f,D=I.f,C=x.f,L=i.Symbol,N=i.JSON,M=N&&N.stringify,k=d("_hidden"),U=d("toPrimitive"),G={}.propertyIsEnumerable,F=c("symbol-registry"),V=c("symbols"),H=c("op-symbols"),W=Object.prototype,B="function"==typeof L&&!!O.f,Y=i.QObject,j=!Y||!Y.prototype||!Y.prototype.findChild,z=a&&l((function(){return 7!=S(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=b(W,e);i&&delete W[e],D(t,e,n),i&&t!==W&&D(W,e,i)}:D,X=function(t){var e=V[t]=S(L.prototype);return e._k=t,e},q=B&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},K=function(t,e,n){return t===W&&K(H,e,n),_(t),e=A(e,!0),_(n),r(V,e)?(n.enumerable?(r(t,k)&&t[k][e]&&(t[k][e]=!1),n=S(n,{enumerable:R(0,!1)})):(r(t,k)||D(t,k,R(1,{})),t[k][e]=!0),z(t,e,n)):D(t,e,n)},J=function(t,e){_(t);for(var n,i=g(e=T(e)),r=0,a=i.length;a>r;)K(t,n=i[r++],e[n]);return t},Q=function(t){var e=G.call(this,t=A(t,!0));return!(this===W&&r(V,t)&&!r(H,t))&&(!(e||!r(this,t)||!r(V,t)||r(this,k)&&this[k][t])||e)},Z=function(t,e){if(t=T(t),e=A(e,!0),t!==W||!r(V,e)||r(H,e)){var n=b(t,e);return!n||!r(V,e)||r(t,k)&&t[k][e]||(n.enumerable=!0),n}},$=function(t){for(var e,n=C(T(t)),i=[],a=0;n.length>a;)r(V,e=n[a++])||e==k||e==u||i.push(e);return i},tt=function(t){for(var e,n=t===W,i=C(n?H:T(t)),a=[],o=0;i.length>o;)!r(V,e=i[o++])||n&&!r(W,e)||a.push(V[e]);return a};B||(s((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===W&&e.call(H,n),r(this,k)&&r(this[k],t)&&(this[k][t]=!1),z(this,t,R(1,n))};return a&&j&&z(W,t,{configurable:!0,set:e}),X(t)}).prototype,"toString",(function(){return this._k})),P.f=Z,I.f=K,n(119).f=x.f=$,n(66).f=Q,O.f=tt,a&&!n(55)&&s(W,"propertyIsEnumerable",Q,!0),p.f=function(t){return X(d(t))}),o(o.G+o.W+o.F*!B,{Symbol:L});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)d(et[nt++]);for(var it=w(d.store),rt=0;it.length>rt;)v(it[rt++]);o(o.S+o.F*!B,"Symbol",{for:function(t){return r(F,t+="")?F[t]:F[t]=L(t)},keyFor:function(t){if(!q(t))throw TypeError(t+" is not a symbol!");for(var e in F)if(F[e]===t)return e},useSetter:function(){j=!0},useSimple:function(){j=!1}}),o(o.S+o.F*!B,"Object",{create:function(t,e){return void 0===e?S(t):J(S(t),e)},defineProperty:K,defineProperties:J,getOwnPropertyDescriptor:Z,getOwnPropertyNames:$,getOwnPropertySymbols:tt});var at=l((function(){O.f(1)}));o(o.S+o.F*at,"Object",{getOwnPropertySymbols:function(t){return O.f(m(t))}}),N&&o(o.S+o.F*(!B||l((function(){var t=L();return"[null]"!=M([t])||"{}"!=M({a:t})||"{}"!=M(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(y(e)||void 0!==t)&&!q(t))return E(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!q(e))return e}),i[1]=e,M.apply(N,i)}}),L.prototype[U]||n(39)(L.prototype,U,L.prototype.valueOf),h(L,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var i=n(57),r=n(96),a=n(66);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var o,s=n(t),u=a.f,l=0;s.length>l;)u.call(t,o=s[l++])&&e.push(o);return e}},function(t,e,n){var i=n(40),r=n(119).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return o&&"[object Window]"==a.call(t)?function(t){try{return r(t)}catch(t){return o.slice()}}(t):r(i(t))}},function(t,e,n){n(95)("asyncIterator")},function(t,e,n){n(95)("observable")},function(t,e,n){t.exports=n(181)},function(t,e,n){n(70),n(46),n(182),n(187),n(188),t.exports=n(14).WeakMap},function(t,e,n){"use strict";var i,r=n(19),a=n(98)(0),o=n(88),s=n(47),u=n(185),l=n(186),c=n(21),h=n(59),f=n(59),d=!r.ActiveXObject&&"ActiveXObject"in r,p=s.getWeak,v=Object.isExtensible,g=l.ufstore,E=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},_={get:function(t){if(c(t)){var e=p(t);return!0===e?g(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(h(this,"WeakMap"),t,e)}},y=t.exports=n(122)("WeakMap",E,_,l,!0,!0);f&&d&&(u((i=l.getConstructor(E,"WeakMap")).prototype,_),s.NEED=!0,a(["delete","has","get","set"],(function(t){var e=y.prototype,n=e[t];o(e,t,(function(e,r){if(c(e)&&!v(e)){this._f||(this._f=new i);var a=this._f[t](e,r);return"set"==t?this:a}return n.call(this,e,r)}))})))},function(t,e,n){var i=n(184);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){var i=n(21),r=n(97),a=n(22)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var i=n(28),r=n(57),a=n(96),o=n(66),s=n(42),u=n(83),l=Object.assign;t.exports=!l||n(37)((function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach((function(t){e[t]=t})),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=i}))?function(t,e){for(var n=s(t),l=arguments.length,c=1,h=a.f,f=o.f;l>c;)for(var d,p=u(arguments[c++]),v=h?r(p).concat(h(p)):r(p),g=v.length,E=0;g>E;)d=v[E++],i&&!f.call(p,d)||(n[d]=p[d]);return n}:l},function(t,e,n){"use strict";var i=n(71),r=n(47).getWeak,a=n(24),o=n(21),s=n(72),u=n(48),l=n(98),c=n(36),h=n(59),f=l(5),d=l(6),p=0,v=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},E=function(t,e){return f(t.a,(function(t){return t[0]===e}))};g.prototype={get:function(t){var e=E(this,t);if(e)return e[1]},has:function(t){return!!E(this,t)},set:function(t,e){var n=E(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,a){var l=t((function(t,i){s(t,l,e,"_i"),t._t=e,t._i=p++,t._l=void 0,null!=i&&u(i,n,t[a],t)}));return i(l.prototype,{delete:function(t){if(!o(t))return!1;var n=r(t);return!0===n?v(h(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!o(t))return!1;var n=r(t);return!0===n?v(h(this,e)).has(t):n&&c(n,this._i)}}),l},def:function(t,e,n){var i=r(a(e),!0);return!0===i?v(t).set(e,n):i[t._i]=n,t},ufstore:v}},function(t,e,n){n(123)("WeakMap")},function(t,e,n){n(124)("WeakMap")},function(t,e,n){n(70),n(44),n(46),n(190),n(193),n(194),t.exports=n(14).Promise},function(t,e,n){"use strict";var i,r,a,o,s=n(55),u=n(19),l=n(38),c=n(73),h=n(16),f=n(21),d=n(41),p=n(72),v=n(48),g=n(125),E=n(126).set,_=n(191)(),y=n(100),m=n(128),T=n(192),A=n(129),R=u.TypeError,S=u.process,x=S&&S.versions,P=x&&x.v8||"",O=u.Promise,I="process"==c(S),w=function(){},b=r=y.f,D=!!function(){try{var t=O.resolve(1),e=(t.constructor={})[n(22)("species")]=function(t){t(w,w)};return(I||"function"==typeof PromiseRejectionEvent)&&t.then(w)instanceof e&&0!==P.indexOf("6.6")&&-1===T.indexOf("Chrome/66")}catch(t){}}(),C=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;_((function(){for(var i=t._v,r=1==t._s,a=0,o=function(e){var n,a,o,s=r?e.ok:e.fail,u=e.resolve,l=e.reject,c=e.domain;try{s?(r||(2==t._h&&k(t),t._h=1),!0===s?n=i:(c&&c.enter(),n=s(i),c&&(c.exit(),o=!0)),n===e.promise?l(R("Promise-chain cycle")):(a=C(n))?a.call(n,u,l):u(n)):l(i)}catch(t){c&&!o&&c.exit(),l(t)}};n.length>a;)o(n[a++]);t._c=[],t._n=!1,e&&!t._h&&N(t)}))}},N=function(t){E.call(u,(function(){var e,n,i,r=t._v,a=M(t);if(a&&(e=m((function(){I?S.emit("unhandledRejection",r,t):(n=u.onunhandledrejection)?n({promise:t,reason:r}):(i=u.console)&&i.error&&i.error("Unhandled promise rejection",r)})),t._h=I||M(t)?2:1),t._a=void 0,a&&e.e)throw e.v}))},M=function(t){return 1!==t._h&&0===(t._a||t._c).length},k=function(t){E.call(u,(function(){var e;I?S.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})}))},U=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},G=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw R("Promise can't be resolved itself");(e=C(t))?_((function(){var i={_w:n,_d:!1};try{e.call(t,l(G,i,1),l(U,i,1))}catch(t){U.call(i,t)}})):(n._v=t,n._s=1,L(n,!1))}catch(t){U.call({_w:n,_d:!1},t)}}};D||(O=function(t){p(this,O,"Promise","_h"),d(t),i.call(this);try{t(l(G,this,1),l(U,this,1))}catch(t){U.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(71)(O.prototype,{then:function(t,e){var n=b(g(this,O));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=I?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),a=function(){var t=new i;this.promise=t,this.resolve=l(G,t,1),this.reject=l(U,t,1)},y.f=b=function(t){return t===O||t===o?new a(t):r(t)}),h(h.G+h.W+h.F*!D,{Promise:O}),n(58)(O,"Promise"),n(130)("Promise"),o=n(14).Promise,h(h.S+h.F*!D,"Promise",{reject:function(t){var e=b(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!D),"Promise",{resolve:function(t){return A(s&&this===o?O:this,t)}}),h(h.S+h.F*!(D&&n(131)((function(t){O.all(t).catch(w)}))),"Promise",{all:function(t){var e=this,n=b(e),i=n.resolve,r=n.reject,a=m((function(){var n=[],a=0,o=1;v(t,!1,(function(t){var s=a++,u=!1;n.push(void 0),o++,e.resolve(t).then((function(t){u||(u=!0,n[s]=t,--o||i(n))}),r)})),--o||i(n)}));return a.e&&r(a.v),n.promise},race:function(t){var e=this,n=b(e),i=n.reject,r=m((function(){v(t,!1,(function(t){e.resolve(t).then(n.resolve,i)}))}));return r.e&&i(r.v),n.promise}})},function(t,e,n){var i=n(19),r=n(126).set,a=i.MutationObserver||i.WebKitMutationObserver,o=i.process,s=i.Promise,u="process"==n(52)(o);t.exports=function(){var t,e,n,l=function(){var i,r;for(u&&(i=o.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(u)n=function(){o.nextTick(l)};else if(!a||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(l)}}else n=function(){r.call(i,l)};else{var h=!0,f=document.createTextNode("");new a(l).observe(f,{characterData:!0}),n=function(){f.data=h=!h}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},function(t,e,n){var i=n(19).navigator;t.exports=i&&i.userAgent||""},function(t,e,n){"use strict";var i=n(16),r=n(14),a=n(19),o=n(125),s=n(129);i(i.P+i.R,"Promise",{finally:function(t){var e=o(this,r.Promise||a.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then((function(){return n}))}:t,n?function(n){return s(e,t()).then((function(){throw n}))}:t)}})},function(t,e,n){"use strict";var i=n(16),r=n(100),a=n(128);i(i.S,"Promise",{try:function(t){var e=r.f(this),n=a(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var i=function(t){"use strict";var e,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function u(t,e,n,i){var r=e&&e.prototype instanceof v?e:v,a=Object.create(r.prototype),o=new O(i||[]);return a._invoke=function(t,e,n){var i=c;return function(r,a){if(i===f)throw new Error("Generator is already running");if(i===d){if("throw"===r)throw a;return w()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=S(o,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===c)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var u=l(t,e,n);if("normal"===u.type){if(i=n.done?d:h,u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=d,n.method="throw",n.arg=u.arg)}}}(t,n,o),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var c="suspendedStart",h="suspendedYield",f="executing",d="completed",p={};function v(){}function g(){}function E(){}var _={};_[a]=function(){return this};var y=Object.getPrototypeOf,m=y&&y(y(I([])));m&&m!==n&&i.call(m,a)&&(_=m);var T=E.prototype=v.prototype=Object.create(_);function A(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function R(t,e){var n;this._invoke=function(r,a){function o(){return new e((function(n,o){!function n(r,a,o,s){var u=l(t[r],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return n("throw",t,o,s)}))}s(u.arg)}(r,a,n,o)}))}return n=n?n.then(o,o):o()}}function S(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=l(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,p;var a=r.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function I(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:w}}function w(){return{value:e,done:!0}}return g.prototype=T.constructor=E,E.constructor=g,E[s]=g.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(T),t},t.awrap=function(t){return{__await:t}},A(R.prototype),R.prototype[o]=function(){return this},t.AsyncIterator=R,t.async=function(e,n,i,r,a){void 0===a&&(a=Promise);var o=new R(u(e,n,i,r),a);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},A(T),T[s]="Generator",T[a]=function(){return this},T.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=I,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var u=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;P(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:I(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),p}},t}(t.exports);try{regeneratorRuntime=i}catch(t){Function("r","regeneratorRuntime = r")(i)}},function(t,e,n){n(197),t.exports=n(14).Reflect.construct},function(t,e,n){var i=n(16),r=n(56),a=n(41),o=n(24),s=n(21),u=n(37),l=n(198),c=(n(19).Reflect||{}).construct,h=u((function(){function t(){}return!(c((function(){}),[],t)instanceof t)})),f=!u((function(){c((function(){}))}));i(i.S+i.F*(h||f),"Reflect",{construct:function(t,e){a(t),o(e);var n=arguments.length<3?t:a(arguments[2]);if(f&&!h)return c(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(l.apply(t,i))}var u=n.prototype,d=r(s(u)?u:Object.prototype),p=Function.apply.call(t,d,e);return s(p)?p:d}})},function(t,e,n){"use strict";var i=n(41),r=n(21),a=n(127),o=[].slice,s={},u=function(t,e,n){if(!(e in s)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";s[e]=Function("F,a","return new F("+i.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=i(this),n=o.call(arguments,1),s=function(){var i=n.concat(o.call(arguments));return this instanceof s?u(e,i.length,i):a(e,i,t)};return r(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e,n){n(200);var i=n(14).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){var i=n(16);i(i.S,"Object",{create:n(56)})},function(t,e,n){n(202),t.exports=n(14).Object.setPrototypeOf},function(t,e,n){var i=n(16);i(i.S,"Object",{setPrototypeOf:n(203).set})},function(t,e,n){var i=n(21),r=n(24),a=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=n(38)(Function.call,n(65).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return a(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:a}},function(t,e,n){t.exports=n(205)},function(t,e,n){n(206),t.exports=n(14).Object.getPrototypeOf},function(t,e,n){var i=n(42),r=n(92);n(67)("getPrototypeOf",(function(){return function(t){return r(i(t))}}))},function(t,e,n){var i=n(102),r=n(134);t.exports=function(t){if(i(t))return r(t)}},function(t,e,n){n(209),t.exports=n(14).Array.isArray},function(t,e,n){var i=n(16);i(i.S,"Array",{isArray:n(97)})},function(t,e,n){var i=n(135),r=n(136),a=n(94);t.exports=function(t){if(void 0!==a&&r(Object(t)))return i(t)}},function(t,e,n){n(44),n(212),t.exports=n(14).Array.from},function(t,e,n){"use strict";var i=n(38),r=n(16),a=n(42),o=n(120),s=n(121),u=n(68),l=n(213),c=n(99);r(r.S+r.F*!n(131)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,h,f=a(t),d="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,g=void 0!==v,E=0,_=c(f);if(g&&(v=i(v,p>2?arguments[2]:void 0,2)),null==_||d==Array&&s(_))for(n=new d(e=u(f.length));e>E;E++)l(n,E,g?v(f[E],E):f[E]);else for(h=_.call(f),n=new d;!(r=h.next()).done;E++)l(n,E,g?o(h,v,[r.value,E],!0):r.value);return n.length=E,n}})},function(t,e,n){"use strict";var i=n(29),r=n(53);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){n(46),n(44),t.exports=n(215)},function(t,e,n){var i=n(73),r=n(22)("iterator"),a=n(45);t.exports=n(14).isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||a.hasOwnProperty(i(e))}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){t.exports=n(218)},function(t,e,n){n(219),t.exports=n(14).parseFloat},function(t,e,n){var i=n(16),r=n(220);i(i.G+i.F*(parseFloat!=r),{parseFloat:r})},function(t,e,n){var i=n(19).parseFloat,r=n(138).trim;t.exports=1/i(n(103)+"-0")!=-1/0?function(t){var e=r(String(t),3),n=i(e);return 0===n&&"-"==e.charAt(0)?-0:n}:i},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){t.exports=n(223)},function(t,e,n){n(224),t.exports=n(14).Object.freeze},function(t,e,n){var i=n(21),r=n(47).onFreeze;n(67)("freeze",(function(t){return function(e){return t&&i(e)?t(r(e)):e}}))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=i(n(20)),l=r(n(61)),c=r(n(62)),h=r(n(80)),f=r(n(254)),d=r(n(26)),p=r(n(107)),v=r(n(146)),g=r(n(77)),E=r(n(256)),_=r(n(147)),y=i(n(27)),m=i(n(15)),T=r(n(257)),A=r(n(105)),R=r(n(148)),S=function(){function t(e){(0,a.default)(this,t),(0,s.default)(this,"_fill",new d.default(0,0,0,1)),(0,s.default)(this,"_stroke",new d.default(0,0,0,1)),(0,s.default)(this,"_lineWidth",1),(0,s.default)(this,"_shapeType",m.LINE),(0,s.default)(this,"_hoverColor",new d.default(255,255,0,1)),(0,s.default)(this,"_isFill",!0),(0,s.default)(this,"_isStroke",!1),(0,s.default)(this,"_dash",void 0),(0,s.default)(this,"_dashSegments",[10,10]),(0,s.default)(this,"_sides",3),(0,s.default)(this,"_double",!1),(0,s.default)(this,"_text",""),(0,s.default)(this,"_fontSize",12),(0,s.default)(this,"_fontFamily","sans-serif"),(0,s.default)(this,"_fontItalic",!1),(0,s.default)(this,"_bold",!1),(0,s.default)(this,"_caretColor",this._fill),(0,s.default)(this,"_label",""),(0,s.default)(this,"_strokeWidth",void 0),(0,s.default)(this,"_enableBrushTip",void 0),(0,s.default)(this,"options",void 0),this.options=e,this._label=e.shapeLabel||"",this.hoverColor=e.hoverColor,this._enableBrushTip=e.enableBrushTip}return(0,o.default)(t,[{key:"setConfig",value:function(t){y.each(t,(function(t,e){this[e]=t}))}},{key:"isSelecting",value:function(){return this._shapeType===m.SELECT}},{key:"isDelete",value:function(){return this._shapeType===m.ERASER}},{key:"isDoodle",value:function(){return this._shapeType===m.DOODLE}},{key:"isText",value:function(){return this._shapeType===m.TEXT}},{key:"hasAppend",value:function(){return this.isDoodle()}},{key:"isShapeHasAppend",value:function(t){return t===m.DOODLE}},{key:"bufferControl",value:function(){return!1}},{key:"getOptions",value:function(){return{number:(0,_.default)(this.options.shapeIdPrefix),label:this._label,fill:this._fill,stroke:this._stroke,lineWidth:this._lineWidth,isFill:this._isFill,isStroke:this._isStroke,dash:this._dash,dashSegments:this._dashSegments,sides:this._sides,double:this._double,fontFamily:this._fontFamily,fontItalic:this._fontItalic,fontSize:this._fontSize,bold:this._bold,cursorColor:this._caretColor,text:this._text,strokeWidth:this._strokeWidth}}},{key:"createShape",value:function(t,e){switch(t=y.extend(this.getOptions(),t),e||this._shapeType){case m.LINE:return t.round=!0,new l.default(t);case m.RECT:return new c.default(t);case m.CURVE:return new v.default(t);case m.DOODLE:return new E.default(t);case m.CIRCLE:return new g.default(t);case m.REGULAR_POLYGON:return new T.default(t);case m.ARROW:return new f.default(t);case m.TEXT:return new h.default(t);case m.IMAGE:return new p.default(t);case m.POLYGON:return new R.default(t);case m.PATH:return new A.default(t)}}},{key:"fillColor",get:function(){return this._fill},set:function(t){u.string(t)&&(t=new d.default(t)),this._fill=t}},{key:"strokeColor",get:function(){return this._stroke},set:function(t){u.string(t)&&(t=new d.default(t)),this._stroke=t}},{key:"lineWidth",get:function(){return this._lineWidth},set:function(t){this._lineWidth=t}},{key:"activeShape",get:function(){return this._shapeType},set:function(t){this._shapeType=t}},{key:"hoverColor",get:function(){return this._hoverColor},set:function(t){u.string(t)&&(t=new d.default(t)),this._hoverColor=t}},{key:"isFill",get:function(){return this._isFill},set:function(t){this._isFill=t}},{key:"isStroke",get:function(){return this._isStroke},set:function(t){this._isStroke=t}},{key:"dashSegments",get:function(){return this._dashSegments},set:function(t){this._dashSegments=t}},{key:"dash",get:function(){return this._dash},set:function(t){this._dash=t}},{key:"sides",get:function(){return this._sides},set:function(t){this._sides=t}},{key:"double",get:function(){return this._double},set:function(t){this._double=t}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this._fontFamily=t}},{key:"fontItalic",get:function(){return this._fontItalic},set:function(t){this._fontItalic=t}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize=t}},{key:"bold",get:function(){return this._bold},set:function(t){this._bold=t}},{key:"caretColor",get:function(){return this._caretColor},set:function(t){u.string(t)&&(t=new d.default(t)),this._caretColor=t}},{key:"text",get:function(){return this._text},set:function(t){this._text=t}},{key:"label",get:function(){return this._label},set:function(t){this._label=t}},{key:"strokeWidth",get:function(){return this._strokeWidth},set:function(t){this._strokeWidth=t}},{key:"enableBrushTip",get:function(){return this._enableBrushTip},set:function(t){this._enableBrushTip=t,this.options.enableBrushTip=t}}]),t}();e.default=S},function(t,e,n){t.exports=n(227)},function(t,e,n){n(228),t.exports=n(14).Reflect.get},function(t,e,n){var i=n(65),r=n(92),a=n(36),o=n(16),s=n(21),u=n(24);o(o.S,"Reflect",{get:function t(e,n){var o,l,c=arguments.length<3?e:arguments[2];return u(e)===c?e[n]:(o=i.f(e,n))?a(o,"value")?o.value:void 0!==o.get?o.get.call(c):void 0:s(l=r(e))?t(l,n,c):void 0}})},function(t,e,n){var i=n(8);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t}},function(t,e,n){var i=n(231),r=n(232),a=n(137),o=n(236);t.exports=function(t,e){return i(t)||r(t,e)||a(t,e)||o()}},function(t,e,n){var i=n(102);t.exports=function(t){if(i(t))return t}},function(t,e,n){var i=n(233),r=n(136),a=n(94);t.exports=function(t,e){if(void 0!==a&&r(Object(t))){var n=[],o=!0,s=!1,u=void 0;try{for(var l,c=i(t);!(o=(l=c.next()).done)&&(n.push(l.value),!e||n.length!==e);o=!0);}catch(t){s=!0,u=t}finally{try{o||null==c.return||c.return()}finally{if(s)throw u}}return n}}},function(t,e,n){t.exports=n(234)},function(t,e,n){n(46),n(44),t.exports=n(235)},function(t,e,n){var i=n(24),r=n(99);t.exports=n(14).getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){t.exports=n(238)},function(t,e,n){n(239),t.exports=n(14).parseInt},function(t,e,n){var i=n(16),r=n(240);i(i.G+i.F*(parseInt!=r),{parseInt:r})},function(t,e,n){var i=n(19).parseInt,r=n(138).trim,a=n(103),o=/^[-+]?0[xX]/;t.exports=8!==i(a+"08")||22!==i(a+"0x16")?function(t,e){var n=r(String(t),3);return i(n,e>>>0||(o.test(n)?16:10))}:i},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e){return t!=r.NULL&&t.toString?t.toString():e!==r.UNDEFINED?e:r.EMPTY_STRING};var r=i(n(6))},function(t,e,n){t.exports=n(243)},function(t,e,n){n(244),t.exports=n(14).Object.keys},function(t,e,n){var i=n(42),r=n(57);n(67)("keys",(function(){return function(t){return r(i(t))}}))},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.match=function(t,e){return t===e?e.length:(e+=a.RAW_DOT,r.startsWith(t,e)?e.length:a.MINUS_ONE)},e.each=function(t,e){for(var n=l.hasOwnProperty(t)?l[t]:l[t]=t.split(a.RAW_DOT),i=0,r=n.length-1;i<=r&&e(n[i],i===r)!==a.FALSE;i++);},e.join=function(t,e){return t&&e?t+a.RAW_DOT+e:t||e},e.isFuzzy=function(t){return r.has(t,a.RAW_WILDCARD)},e.matchFuzzy=function(t,e){var n=c[e];if(!n){var i=e.replace(o,"\\.").replace(s,"(\\w+)").replace(u,"([.\\w]+?)");n=c[e]=new RegExp("^".concat(i,"$"))}var r=t.match(n);if(r)return r[1]};var r=i(n(104)),a=i(n(6)),o=/\./g,s=/\*/g,u=/\*\*/g,l={},c={}},function(t,e,n){"use strict";var i=n(1),r=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n,i,r,u,l){var c=(0,s.default)(t,r,n/2,l);return a.concat(c,(0,s.default)(e,u,i/2,l,o.TRUE)),c};var a=r(n(11)),o=r(n(6)),s=i(n(75))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n){var i=[],r=(0,u.default)(t,e);if(r<n.entity+n.dash)return i.push([t,e]),i;for(var l=new s.Vector3([e.x-t.x,e.y-t.y,e.z-t.z]).normalize(),c=Math.floor(r/(n.dash+n.entity)),h=t,f=o.scalarProduct(l,n.entity),d=o.scalarProduct(l,n.dash+n.entity),p=0;p<c;p++)i.push([h,new a.default(o.add(h,f))]),h=new a.default(o.add(h,d));return i.push([h,e]),i};var a=r(n(13)),o=i(n(34)),s=n(18),u=r(n(35))},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n){var i=Math.PI/2-(0,r.default)(t),a=e*Math.sin(i)*n,o=e*Math.cos(i)*n;return Math.sqrt(a*a+o*o)};var r=i(n(76))},function(t,e,n){"use strict";var i=n(1),r=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,r=[],s=a.PI2/i,u=0,l=u+a.PI2;do{r.push((0,o.default)(t,u,e,n)),u+=s}while(u<l);return r};var a=r(n(6)),o=i(n(78))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n,i){var r=[];if(e===n)for(var l=2*o.PI*e,c=Math.ceil(l/(i.dash+i.entity)),h=0,f=i.dash/e,d=i.entity/e,p=0;p<c;p++)r.push([(0,u.default)(t,h,e,n),(0,u.default)(t,h+d,e,n)]),h+=f+d;else for(var v,g=0,E=.35*o.PI/180,_=new a.default(t.x+e,t.y),y=0,m=o.TRUE,T=_;g<=o.PI2;)g+=E,v=(0,u.default)(t,g,e,n),(y+=(0,s.default)(_,v))>=i.entity&&m?(r.push([T.copy(),v.copy()]),m=o.FALSE,y=0):y>=i.dash&&!m&&(m=o.TRUE,y=0,T=v),_=v;return r};var a=r(n(13)),o=i(n(6)),s=r(n(35)),u=r(n(78))},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n,i,o){var s=Math.atan2(t.y-e.y,t.x-e.x),u=e.x+n*Math.cos(s),l=e.y+i*Math.sin(s),c=(0,a.default)(t,e),h=(0,a.default)(new r.default(u,l),e);return Math.abs(c-h)<=o};var r=i(n(13)),a=i(n(35))},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t){var e=[];r.each(t,(function(t){r.concat(e,t.toArray())}));for(var n=a(e,null,3),i=[],o=n.length/3,s=0;s<o;s++)i.push([t[n[3*s]].copy(),t[n[3*s+1]].copy(),t[n[3*s+2]].copy()]);return i};var r=i(n(11)),a=n(253)},function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i,s,u,l,c,d,p,g=e&&e.length,E=g?e[0]*n:t.length,_=r(t,0,E,n,!0),y=[];if(!_||_.next===_.prev)return y;if(g&&(_=function(t,e,n,i){var o,s,u,l=[];for(o=0,s=e.length;o<s;o++)(u=r(t,e[o]*i,o<s-1?e[o+1]*i:t.length,i,!1))===u.next&&(u.steiner=!0),l.push(v(u));for(l.sort(h),o=0;o<l.length;o++)f(l[o],n),n=a(n,n.next);return n}(t,e,_,n)),t.length>80*n){i=u=t[0],s=l=t[1];for(var m=n;m<E;m+=n)(c=t[m])<i&&(i=c),(d=t[m+1])<s&&(s=d),c>u&&(u=c),d>l&&(l=d);p=0!==(p=Math.max(u-i,l-s))?1/p:0}return o(_,y,n,i,s,p),y}function r(t,e,n,i,r){var a,o;if(r===I(t,e,n,i)>0)for(a=e;a<n;a+=i)o=x(a,t[a],t[a+1],o);else for(a=n-i;a>=e;a-=i)o=x(a,t[a],t[a+1],o);return o&&y(o,o.next)&&(P(o),o=o.next),o}function a(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==_(i.prev,i,i.next))i=i.next;else{if(P(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function o(t,e,n,i,r,h,f){if(t){!f&&h&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=p(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,a,o,s,u,l=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,i=n,s=0,e=0;e<l&&(s++,i=i.nextZ);e++);for(u=l;s>0||u>0&&i;)0!==s&&(0===u||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,u--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;n=i}a.nextZ=null,l*=2}while(o>1)}(r)}(t,i,r,h);for(var d,v,g=t;t.prev!==t.next;)if(d=t.prev,v=t.next,h?u(t,i,r,h):s(t))e.push(d.i/n),e.push(t.i/n),e.push(v.i/n),P(t),t=v.next,g=v.next;else if((t=v)===g){f?1===f?o(t=l(a(t),e,n),e,n,i,r,h,2):2===f&&c(t,e,n,i,r,h):o(a(t),e,n,i,r,h,1);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(_(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(g(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&_(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(t,e,n,i){var r=t.prev,a=t,o=t.next;if(_(r,a,o)>=0)return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,u=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,l=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,c=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,h=p(s,u,e,n,i),f=p(l,c,e,n,i),d=t.prevZ,v=t.nextZ;d&&d.z>=h&&v&&v.z<=f;){if(d!==t.prev&&d!==t.next&&g(r.x,r.y,a.x,a.y,o.x,o.y,d.x,d.y)&&_(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,v!==t.prev&&v!==t.next&&g(r.x,r.y,a.x,a.y,o.x,o.y,v.x,v.y)&&_(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&g(r.x,r.y,a.x,a.y,o.x,o.y,d.x,d.y)&&_(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=f;){if(v!==t.prev&&v!==t.next&&g(r.x,r.y,a.x,a.y,o.x,o.y,v.x,v.y)&&_(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function l(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!y(r,o)&&m(r,i,i.next,o)&&R(r,o)&&R(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),P(i),P(i.next),i=t=o),i=i.next}while(i!==t);return a(i)}function c(t,e,n,i,r,s){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&E(u,l)){var c=S(u,l);return u=a(u,u.next),c=a(c,c.next),o(u,e,n,i,r,s),void o(c,e,n,i,r,s)}l=l.next}u=u.next}while(u!==t)}function h(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var n,i=e,r=t.x,a=t.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o){if(o=s,s===r){if(a===i.y)return i;if(a===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n;var u,l=n,c=n.x,h=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&g(a<h?r:o,a,c,h,a<h?o:r,a,i.x,i.y)&&(u=Math.abs(a-i.y)/(r-i.x),R(i,t)&&(u<f||u===f&&(i.x>n.x||i.x===n.x&&d(n,i)))&&(n=i,f=u)),i=i.next}while(i!==l);return n}(t,e)){var n=S(e,t);a(e,e.next),a(n,n.next)}}function d(t,e){return _(t.prev,t,e.prev)<0&&_(e.next,t,t.next)<0}function p(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,i,r,a,o,s){return(r-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(i-s)-(n-o)*(e-s)>=0&&(n-o)*(a-s)-(r-o)*(i-s)>=0}function E(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&m(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(R(t,e)&&R(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(_(t.prev,t,e.prev)||_(t,e.prev,e))||y(t,e)&&_(t.prev,t,t.next)>0&&_(e.prev,e,e.next)>0)}function _(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function m(t,e,n,i){var r=A(_(t,e,n)),a=A(_(t,e,i)),o=A(_(n,i,t)),s=A(_(n,i,e));return r!==a&&o!==s||!(0!==r||!T(t,n,e))||!(0!==a||!T(t,i,e))||!(0!==o||!T(n,t,i))||!(0!==s||!T(n,e,i))}function T(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function R(t,e){return _(t.prev,t,t.next)<0?_(t,e,t.next)>=0&&_(t,t.prev,e)>=0:_(t,e,t.prev)<0||_(t,t.next,e)<0}function S(t,e){var n=new O(t.i,t.x,t.y),i=new O(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function x(t,e,n,i){var r=new O(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function P(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,e,n,i){for(var r=0,a=e,o=n-i;a<n;a+=i)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}t.exports=i,t.exports.default=i,i.deviation=function(t,e,n,i){var r=e&&e.length,a=r?e[0]*n:t.length,o=Math.abs(I(t,0,a,n));if(r)for(var s=0,u=e.length;s<u;s++){var l=e[s]*n,c=s<u-1?e[s+1]*n:t.length;o-=Math.abs(I(t,l,c,n))}var h=0;for(s=0;s<i.length;s+=3){var f=i[s]*n,d=i[s+1]*n,p=i[s+2]*n;h+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var a=0;a<t[r].length;a++)for(var o=0;o<e;o++)n.vertices.push(t[r][a][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(17)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(25)),v=r(n(13)),g=i(n(11)),E=i(n(15)),_=i(n(34)),y=n(18),m=i(n(6)),T=r(n(35)),A=r(n(78)),R=r(n(145)),S=r(n(143)),x=r(n(105)),P=r(n(75)),O=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t){var i;return(0,o.default)(this,n),i=e.call(this,t),(0,d.default)((0,u.default)(i),"double",void 0),i.name=E.ARROW,i.children=[],i.double=t.double||!1,i.isFill=m.TRUE,i.isStroke=m.FALSE,i.close=m.TRUE,i}return(0,s.default)(n,[{key:"drawing",value:function(t,e){this.validate()?(this.removePointByIndex(1),this.appendPoint(e)):this.appendPoint(e),t.drawing(this)}},{key:"generateWebGLPoints",value:function(t){if(!this.validate())return this;this.children=[],this.glPoints=[],this.boundingRect=null;var e=this.getOptions();e.points=this.generatePath(t);var n=new x.default(e);return n.generateWebGLPoints(t),this.boundingRectUnion(n.boundingRect),this.children.push(n),this}},{key:"generateCanvas2DPoints",value:function(t){if(!this.validate())return this;this.children=[],this.glPoints=[],this.boundingRect=null;var e=this.getOptions();e.points=this.generatePath(t);var n=new x.default(e);return n.generateCanvas2DPoints(t),this.boundingRectUnion(n.boundingRect),this.children.push(n),this}},{key:"generatePath",value:function(t){var e,n=(0,S.default)(this.points[0],this.points[1]),i=_.vertical(n,new y.Vector3([0,0,1]));e=this.lineWidth<20?2:1;var r=this.lineWidth*t.getUnitLength()*e,a=(0,T.default)(this.points[1],this.points[0]);2*r>a&&(r=a/2);var o=(0,P.default)(this.points[0],i,this.lineWidth*t.getUnitLength()/2,t.getWidthHeightRatio()),s=[],u=this.createTriangle(this.points[0],this.points[1],r,r*t.getWidthHeightRatio(),t),l=new v.default(0,0,0),c=new v.default(0,0,0);if((0,R.default)(u[0],(0,S.default)(u[0],u[1]),o[0],n,l),(0,R.default)(u[0],(0,S.default)(u[0],u[3]),o[1],n,c),s.push(u[2],u[1],l),this.double){var h=this.createTriangle(this.points[1],this.points[0],r,r*t.getWidthHeightRatio(),t),f=new v.default(0,0,0),d=new v.default(0,0,0);(0,R.default)(h[0],(0,S.default)(h[0],h[3]),o[0],n,f),(0,R.default)(h[0],(0,S.default)(h[0],h[1]),o[1],n,d),s.push(f,h[3],h[2],h[1],d)}else s.push(o[0],o[1]);return s.push(c,u[3]),s}},{key:"dragPoint",value:function(t,e,n){this.points[e]=n,t.PAINTER_TYPE===m.PAINTER_TYPE_WEBGL?this.generateWebGLPoints(t):t.PAINTER_TYPE===m.PAINTER_TYPE_CANVAS_2D&&this.generateCanvas2DPoints(t),this.updateBoundRect(t),this.selection&&(t.PAINTER_TYPE===m.PAINTER_TYPE_WEBGL?(this.selection.points=[new v.default(this.boundingRect.minX,this.boundingRect.maxY),new v.default(this.boundingRect.maxX,this.boundingRect.minY)],this.selection.generateWebGLPoints(t)):t.PAINTER_TYPE===m.PAINTER_TYPE_CANVAS_2D&&(this.selection.points=[new v.default(this.boundingRect.minX,this.boundingRect.minY),new v.default(this.boundingRect.maxX,this.boundingRect.maxY)],this.selection.generateCanvas2DPoints(t)))}},{key:"createTriangle",value:function(t,e,n,i,r){var a=new y.Vector3([e.x-t.x,e.y-t.y,e.z-t.z]).normalize();this.getOptions().fill=this.stroke;var o=new v.default(_.minus(e,_.scalarProduct(a,n/2))),s=Math.atan2(e.y-t.y,(e.x-t.x)*r.getWidthHeightRatio()),u=Math.pow(2,.5);return[o,(0,A.default)(o,s+2*m.PI2/3,n*u,i*u),(0,A.default)(o,s,n*u,i*u),(0,A.default)(o,s-2*m.PI2/3,n*u,i*u)]}},{key:"isPointInPath",value:function(t,e,n){var i=!1;return g.each(this.children,(function(r){if(r.isPointInPath(t,e,n))return i=!0,!1})),i}},{key:"toJSON",value:function(t){var e=this.children[0].toJSON(t);return(0,l.default)((0,f.default)(n.prototype),"toJSON",this).call(this,t,{points:e.points,fillStyle:e.fillStyle,fillAlpha:e.fillAlpha,strokeStyle:e.strokeStyle,strokeAlpha:e.strokeAlpha})}},{key:"validate",value:function(){return 2===this.points.length}}]),n}(p.default);e.default=O},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.create2DBezier=function(t,e,n){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,r=(arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)/(i-1),a=[],s=0;s<i;s++)a.push(o(t,e,n,s,r));return a},e.create3DBezier=function(t,e,n,i){for(var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,a=(arguments.length>5&&void 0!==arguments[5]?arguments[5]:1)/(r-1),o=[],s=0;s<r;s++)o.push(u(t,e,n,i,s,a));return o};var r=i(n(13));function a(t,e,n,i){return t*Math.pow(1-i,2)+2*e*i*(1-i)+n*Math.pow(i,2)}function o(t,e,n,i,o){return new r.default(a(t.x,e.x,n.x,i*o),a(t.y,e.y,n.y,i*o),a(t.z,e.z,n.z,i*o))}function s(t,e,n,i,r){return t*Math.pow(1-r,3)+3*e*r*Math.pow(1-r,2)+3*n*Math.pow(r,2)*(1-r)+i*Math.pow(r,3)}function u(t,e,n,i,a,o){return new r.default(s(t.x,e.x,n.x,i.x,a*o),s(t.y,e.y,n.y,i.y,a*o),s(t.z,e.z,n.z,i.z,a*o))}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(33)),s=r(n(3)),u=r(n(4)),l=r(n(12)),c=r(n(17)),h=r(n(9)),f=r(n(10)),d=r(n(8)),p=r(n(5)),v=r(n(146)),g=r(n(25)),E=r(n(13)),_=i(n(11)),y=i(n(15)),m=n(18),T=i(n(6)),A=r(n(35)),R=r(n(23)),S=function(t){(0,h.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.default)(this,n)}}(n);function n(t){var i;return(0,s.default)(this,n),t.name=y.DOODLE,i=e.call(this,t),(0,p.default)((0,l.default)(i),"currentCurve",void 0),(0,p.default)((0,l.default)(i),"pointer",void 0),(0,p.default)((0,l.default)(i),"endNormalize",void 0),(0,p.default)((0,l.default)(i),"vertices",void 0),(0,p.default)((0,l.default)(i),"drawCurves",void 0),(0,p.default)((0,l.default)(i),"flush",void 0),(0,p.default)((0,l.default)(i),"silent",void 0),(0,p.default)((0,l.default)(i),"speeds",void 0),i.pointer=0,i.vertices=[],i.drawCurves=[],i.silent=i.isStroke&&i.stroke.a<1||i.isFill&&i.fill.a<1,i}return(0,u.default)(n,[{key:"startDrawing",value:function(t){return this.flush=T.FALSE,(0,c.default)((0,d.default)(n.prototype),"startDrawing",this).call(this,t)}},{key:"drawing",value:function(t,e){if(t.config.maxDoodlePointsCount>this.points.length){if(this.silent&&this.points.length){if((0,A.default)(e,this.points[this.points.length-1])<8*t.getUnitLength())return}else if(!this.silent&&(0,A.default)(e,this.points[this.points.length-1])>10*t.getUnitLength()){var n=this.points[this.points.length-1];if(this.appendPoint(new E.default((e.x+n.x)/2,(e.y+n.y)/2,(e.z+n.z)/2,e.mouseEvent)),t.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL&&this.points.length%2==0)return;t.drawing(this)}if(this.appendPoint(e),t.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL&&this.points.length%2==0)return;t.drawing(this)}}},{key:"endDrawing",value:function(t){if(this.validate()){if(this.flush=T.TRUE,t.PAINTER_TYPE!==T.PAINTER_TYPE_WEBGL||this.silent?t.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D&&this.currentCurve&&(this.children.push(this.currentCurve),t.drawing(this,T.FALSE,T.FALSE)):t.drawing(this),this.currentCurve&&(this.boundingRectUnion(this.currentCurve.boundingRect),this.currentCurve=null),t.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D){var e=this.lineWidth*t.getUnitLength()/2;Math.abs(this.boundingRect.maxX-this.boundingRect.minX)<e&&(this.boundingRect.minX-=e,this.boundingRect.maxX+=e),Math.abs(this.boundingRect.maxY-this.boundingRect.minY)<e&&(this.boundingRect.minY-=e,this.boundingRect.maxY+=e)}return(0,c.default)((0,d.default)(n.prototype),"endDrawing",this).call(this,t)}}},{key:"drawToOffscreen",value:function(t,e){e.bindView(e.offscreenView),e.bufferVertices(new Float32Array(t.getCacheVertices())),t.drawGLPath(e,0),e.offscreenView.copyToTexture(),e.bindView()}},{key:"generateWebGLPoints",value:function(t){if(!this.validate())return this;var e=this.getOptions();if(e.points=this.copyPoints(this.points.slice(this.pointer,this.pointer+3)),e.points.length<2)return this;var n=new v.default(e);n.hasEnd=!this.silent;var i=this.children[this.children.length-1];if(n.generateWebGLPoints(t,this.endNormalize),i&&this.currentCurve===i){this.children.pop();var r=this.currentCurve.getCacheVertices();this.vertices.splice(this.vertices.length-r.length,r.length)}return this.children.push(n),3===e.points.length?((i=this.children[this.children.length-2])&&(i.updateEnds(n.glPoints[0].copy(),n.glPoints[1].copy(),n.curvePointsDiv[0]),this.silent||(i.children.pop(),i.isLast=!1)),this.endNormalize=n.endNormalize,this.currentCurve=null,this.boundingRectUnion(n.boundingRect),this.pointer+=2,this.silent||(_.push(this.drawCurves,n),this.drawCurves.length>2&&this.drawToOffscreen(this.drawCurves.shift(),t))):this.currentCurve=n,_.concat(this.vertices,n.toVertices(t)),this}},{key:"generateCanvas2DPoints",value:function(t){if(!this.validate())return this;var e=this.getOptions();if(e.points=this.copyPoints(this.points.slice(3*this.children.length)),4===e.points.length){var n=new v.default(e);n.generateCanvas2DPoints(t),this.boundingRectUnion(n.boundingRect),this.children.push(n),this.currentCurve=null}else if(e.points.length>1){var i=new v.default(e);i.generateCanvas2DPoints(t),this.currentCurve=i}return this}},{key:"resize",value:function(t){_.each(this.children,(function(e){e.resize(t)}))}},{key:"isPointInPath",value:function(t,e,n){var i=T.FALSE;return _.each(this.children,(function(r){if(r.isPointInPath(t,e,n))return i=T.TRUE,T.FALSE})),i}},{key:"generateAllPoints",value:function(t){if(this.children=[],this.validate()){var e=this.getOptions();if(this.silent&&this.points.length){for(var n=[this.points[0]],i=0;i<this.points.length-1;i++)(0,A.default)(this.points[i],n[n.length-1])>=8*t.getUnitLength()&&n.push(this.points[i]);n.push(this.points[this.points.length-1]),this.points=n}if(t.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL){for(var r,a=Math.floor((this.points.length-1)/2),o=0;o<a;o++){e.points=this.copyPoints(this.points.slice(2*this.children.length,2*this.children.length+3));var s=new v.default(e);s.hasEnd=(o===a-1&&2*a==this.points.length-1||!r)&&!this.silent,s.generateWebGLPoints(t,r),this.boundingRectUnion(s.boundingRect);var u=this.children[this.children.length-1];u&&!this.silent&&(u.updateEnds(s.glPoints[0].copy(),s.glPoints[1].copy(),s.curvePointsDiv[0]),u.isLast=!1),this.children.push(s),r=s.endNormalize}if(2*this.children.length<this.points.length-1){e.points=this.copyPoints(this.points.slice(2*this.children.length));var l=new v.default(e);l.hasEnd=!this.silent,l.generateWebGLPoints(t,r),this.boundingRectUnion(l.boundingRect);var c=this.children[this.children.length-1];c&&!this.silent&&(c.updateEnds(l.glPoints[0].copy(),l.glPoints[1].copy(),l.curvePointsDiv[0]),c.isLast=!1),this.children.push(l)}}else if(t.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D){for(var h=Math.floor((this.points.length-1)/3),f=0;f<h;f++){e.points=this.copyPoints(this.points.slice(3*this.children.length,3*this.children.length+4));var d=new v.default(e);d.generateCanvas2DPoints(t),this.boundingRectUnion(d.boundingRect),this.children.push(d)}if(3*this.children.length<this.points.length-1){e.points=this.copyPoints(this.points.slice(3*this.children.length));var p=new v.default(e);p.generateCanvas2DPoints(t),this.boundingRectUnion(p.boundingRect),this.children.push(p)}var g=this.lineWidth*t.getUnitLength()/2;Math.abs(this.boundingRect.maxX-this.boundingRect.minX)<g&&(this.boundingRect.minX-=g,this.boundingRect.maxX+=g),Math.abs(this.boundingRect.maxY-this.boundingRect.minY)<g&&(this.boundingRect.minY-=g,this.boundingRect.maxY+=g)}}}},{key:"generatePointsForce",value:function(t){this.generateAllPoints(t),this.flush=T.TRUE}},{key:"toVertices",value:function(t,e){var n=this,i=[];return this.flush?(e||!this.isHover()||this.isSelected()||(e=this.hoverColor),_.each(this.glPoints,(function(t){var r=e||(n.isFill?n.fill:n.stroke);_.concat(i,[].concat((0,o.default)(t.toArray()),(0,o.default)(r.toArray())))})),_.each(this.children,(function(n){_.concat(i,n.toVertices(t,e))})),e||(this.verticesCache=i)):(this.silent?i=this.vertices:_.each(this.drawCurves,(function(t){_.concat(i,t.getCacheVertices())})),this.verticesCache=this.vertices),this.isSelected()&&this.selection&&t.isCanvasRender()&&_.concat(i,this.selection.toVertices(t)),i}},{key:"drawGLPath",value:function(t,e){if(this.flush||this.silent)return(0,c.default)((0,d.default)(n.prototype),"drawGLPath",this).call(this,t,e);var i=0;return _.each(this.drawCurves,(function(n){i+=n.drawGLPath(t,e+i)})),i}},{key:"draw2DPath",value:function(t,e){var i=t.ctx.lineJoin,r=t.ctx.lineCap;t.ctx.lineJoin=this.silent?"miter":"round",t.ctx.lineCap=this.silent?"butt":"round",(0,c.default)((0,d.default)(n.prototype),"draw2DPath",this).call(this,t,e),t.ctx.lineJoin=i,t.ctx.lineCap=r}},{key:"scale",value:function(t,e,n){var i=this;this.glPoints=[];var r=(new R.default).setTranslate(new m.Vector3([-e.x,-e.y,-e.z])),a=(new R.default).setTranslate(new m.Vector3([e.x,e.y,e.z]));_.each(this.points,(function(e,n){var o=i.points[n].getSpeed();i.points[n]=new E.default(a.multiplyVector3(t.multiplyVector3(r.multiplyVector3(e)))),i.points[n].setSpeed(o)})),this.generateAllPoints(n),this.updateBoundRect(n),this.selection&&(n.PAINTER_TYPE===T.PAINTER_TYPE_WEBGL?(this.selection.points=[new E.default(this.boundingRect.minX,this.boundingRect.maxY),new E.default(this.boundingRect.maxX,this.boundingRect.minY)],this.selection.generateWebGLPoints(n)):n.PAINTER_TYPE===T.PAINTER_TYPE_CANVAS_2D&&(this.selection.points=[new E.default(this.boundingRect.minX,this.boundingRect.minY),new E.default(this.boundingRect.maxX,this.boundingRect.maxY)],this.selection.generateCanvas2DPoints(n)))}},{key:"needReGenerate",value:function(){return T.TRUE}},{key:"validate",value:function(){return this.points.length>1}},{key:"toJSON",value:function(t){if(t.enableBrushTip){var e=[];return _.each(this.points,(function(t){e.push(t.getSpeed())})),(0,c.default)((0,d.default)(n.prototype),"toJSON",this).call(this,t,{speeds:e})}return(0,c.default)((0,d.default)(n.prototype),"toJSON",this).call(this,t)}}]),n}(g.default);e.default=S},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(17)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(13)),v=r(n(148)),g=r(n(23)),E=i(n(15)),_=i(n(11)),y=i(n(6)),m=r(n(35)),T=r(n(258)),A=n(18),R=r(n(141)),S=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t){var i;return(0,o.default)(this,n),i=e.call(this,t),(0,d.default)((0,u.default)(i),"plygonPoints",void 0),i.name=E.REGULAR_POLYGON,i}return(0,s.default)(n,[{key:"drawing",value:function(t,e){this.validate()?(this.removePointByIndex(1),this.appendPoint(e)):this.appendPoint(e),this.a=this.b=(0,m.default)(this.points[0],this.points[1]),t.drawing(this)}},{key:"computeRadius",value:function(t){this.a=Math.abs(this.points[0].x-this.points[1].x)/2,this.b=Math.abs(this.points[0].y-this.points[1].y)/2}},{key:"generateWebGLPoints",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.FALSE;if(!this.validate())return this;this.children=[],this.glPoints=[],this.boundingRect=null;var n=this.getOptions();n.sides=this.sides,e?(n.points=this.copyPoints(this.plygonPoints),this.updateBoundRect(t)):(this.computeRadius(t),n.points=(0,T.default)((0,R.default)(this.points[0],this.points[1]),y.PI/2,this.a,this.b*t.getWidthHeightRatio(),this.sides),this.plygonPoints=this.copyPoints(n.points)),!this.isFill&&this.a<this.lineWidth*t.getUnitLength()&&(n.isFill=y.TRUE,n.fill=this.stroke);var i=new v.default(n);return i.generateWebGLPoints(t),this.boundingRectUnion(i.boundingRect),this.children.push(i),this}},{key:"generateCanvas2DPoints",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.FALSE;if(!this.validate())return this;this.children=[],this.glPoints=[];var n=this.getOptions();n.sides=this.sides,n.close=y.TRUE,e?(n.points=this.copyPoints(this.plygonPoints),this.updateBoundRect(t)):(this.computeRadius(t),n.points=(0,T.default)((0,R.default)(this.points[0],this.points[1]),-y.PI/2,this.a,this.b*t.getWidthHeightRatio(),this.sides),n.points.pop(),this.plygonPoints=this.copyPoints(n.points));var i=new v.default(n);return i.generateCanvas2DPoints(t),this.boundingRect={minX:i.boundingRect.minX,minY:i.boundingRect.minY,maxX:i.boundingRect.maxX,maxY:i.boundingRect.maxY},this.children.push(i),this}},{key:"scale",value:function(t,e,i){var r=this,a=t.getValue(0),o=t.getValue(5);this.a*=a,this.b*=o,(0,l.default)((0,f.default)(n.prototype),"scale",this).call(this,t,e,i);var s=(new g.default).setTranslate(new A.Vector3([-e.x,-e.y,-e.z])),u=(new g.default).setTranslate(new A.Vector3([e.x,e.y,e.z]));_.each(this.plygonPoints,(function(e,n){r.plygonPoints[n]=new p.default(u.multiplyVector3(t.multiplyVector3(s.multiplyVector3(e))))}))}},{key:"dragPoint",value:function(t,e,n){this.plygonPoints[e]=n,0===e&&t.PAINTER_TYPE===y.PAINTER_TYPE_WEBGL&&(this.plygonPoints[this.plygonPoints.length-1]=n),t.PAINTER_TYPE===y.PAINTER_TYPE_WEBGL?this.generateWebGLPoints(t,y.TRUE):t.PAINTER_TYPE===y.PAINTER_TYPE_CANVAS_2D&&this.generateCanvas2DPoints(t,y.TRUE),this.selection&&(t.PAINTER_TYPE===y.PAINTER_TYPE_WEBGL?(this.selection.points=[new p.default(this.boundingRect.minX,this.boundingRect.maxY),new p.default(this.boundingRect.maxX,this.boundingRect.minY)],this.selection.generateWebGLPoints(t)):t.PAINTER_TYPE===y.PAINTER_TYPE_CANVAS_2D&&(this.selection.points=[new p.default(this.boundingRect.minX,this.boundingRect.minY),new p.default(this.boundingRect.maxX,this.boundingRect.maxY)],this.selection.generateCanvas2DPoints(t)))}},{key:"translate",value:function(t,e){var i=this;_.each(this.plygonPoints,(function(e,n){i.plygonPoints[n]=new p.default(t.multiplyVector3(e))})),(0,l.default)((0,f.default)(n.prototype),"translate",this).call(this,t,e)}},{key:"rotate",value:function(t,e,i,r){var a=this,o=(new g.default).setTranslate(new A.Vector3([-e.x,-e.y,-e.z])),s=(new g.default).setTranslate(new A.Vector3([e.x,e.y,e.z]));_.each(this.plygonPoints,(function(e,n){a.plygonPoints[n]=new p.default(s.multiplyVector3(t.multiplyVector3(o.multiplyVector3(e).toPixelUnit(r)).toGLUnit(r)))})),(0,l.default)((0,f.default)(n.prototype),"rotate",this).call(this,t,e,i,r)}},{key:"resize",value:function(t){this.generateWebGLPoints(t,y.TRUE)}},{key:"generatePointsForce",value:function(t){this.plygonPoints=this.points,this.points=[],t.PAINTER_TYPE===y.PAINTER_TYPE_WEBGL?this.generateWebGLPoints(t,!0):t.PAINTER_TYPE===y.PAINTER_TYPE_CANVAS_2D&&this.generateCanvas2DPoints(t,!0)}},{key:"validate",value:function(){var t;return 2===this.points.length||(null===(t=this.plygonPoints)||void 0===t?void 0:t.length)>=this.sides}},{key:"toJSON",value:function(t){var e=[];return this.plygonPoints.length&&_.each(this.plygonPoints,(function(n){e.push(n.toJson(t))})),e.length?(0,l.default)((0,f.default)(n.prototype),"toJSON",this).call(this,t,{points:e}):(0,l.default)((0,f.default)(n.prototype),"toJSON",this).call(this,t)}}]),n}(v.default);e.default=S},function(t,e,n){"use strict";var i=n(1),r=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n,i,r){var s=[],u=a.PI2/r,l=e,c=l+a.PI2;do{s.push((0,o.default)(t,l,n,i)),l+=u}while(l<c);var h=s[0],f=s[s.length-1];return h.x===f.x&&h.y===f.y&&h.z===f.z||s.push(h.copy()),s};var a=r(n(6)),o=i(n(78))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=r(n(62)),l=r(n(26)),c=r(n(13)),h=r(n(260)),f=i(n(27)),d=i(n(11)),p=r(n(261)),v=i(n(6)),g=r(n(108)),E=r(n(140)),_=r(n(262)),y=i(n(63)),m=r(n(264)),T=r(n(109)),A=r(n(23)),R=i(n(15)),S=n(18),x=i(n(32)),P=function(){function t(e,n,i){var r=this;(0,a.default)(this,t),(0,s.default)(this,"painter",void 0),(0,s.default)(this,"emitter",void 0),(0,s.default)(this,"setting",void 0),(0,s.default)(this,"drawingShape",void 0),(0,s.default)(this,"moving",void 0),(0,s.default)(this,"saved",void 0),(0,s.default)(this,"hoverState",void 0),(0,s.default)(this,"selectState",void 0),(0,s.default)(this,"resize",void 0),(0,s.default)(this,"selection",void 0),(0,s.default)(this,"selectedShapes",void 0),(0,s.default)(this,"status",0),(0,s.default)(this,"dragIn",v.FALSE),(0,s.default)(this,"direction",void 0),(0,s.default)(this,"hoverShape",void 0),(0,s.default)(this,"scrollTop",0),(0,s.default)(this,"resetView",void 0),(0,s.default)(this,"updateCameraThrotting",void 0),(0,s.default)(this,"namespace",void 0),(0,s.default)(this,"labelMap",void 0),(0,s.default)(this,"shapeAdder",void 0),(0,s.default)(this,"timer",void 0),(0,s.default)(this,"appendPointer",void 0),(0,s.default)(this,"appendIndex",void 0),(0,s.default)(this,"translateTimer",void 0),(0,s.default)(this,"config",void 0),this.painter=e,this.emitter=n,this.setting=i,this.config=this.setting.options,this.shapeAdder=new m.default(e,i),this.timer=new T.default(this.appendHandler.bind(this),null,this.config.shapeAppendInterval),this.selectedShapes=[],this.labelMap={},this.namespace=".paintergl_controller",this.hoverState=(0,p.default)((function(t,e){0===r.status&&(r.hoverShape=t.getActiveShape(e),t.setHoverShape(r.hoverShape),t.hoverState(r.hoverShape,r.resize))}),20),this.selectState=(0,g.default)((function(t){r.selection&&r.selection.boundingRect&&(r.removeSelectedShapes(v.FALSE),r.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL&&r.painter.resetViewShapes(),r.addSelectedShapes(t.getSelectShapes(r.selection.boundingRect)))}),200).handler,this.resetView=(0,p.default)((function(){r.painter.resetViewShapes()}),500),this.updateCameraThrotting=(0,g.default)(this.updateCamera,20,v.TRUE).handler}return(0,o.default)(t,[{key:"isMouseUp",value:function(){return 0===this.status}},{key:"updateCamera",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.FALSE;if(this.config.totalPage>1){var n=this.config.totalPage-1,i=0,r=e?t:this.scrollTop+t;if(r>n?r=n:r<i&&(r=i),this.scrollTop===r)return;this.scrollTop=Math.floor(100*r)/100,this.resize&&(this.removeSelectedShapes(),this.resize=null),this.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL&&(this.painter.getViewShapeCount()>500?(this.painter.updateCamera(-2*this.scrollTop),this.resetView()):(this.painter.updateCamera(-2*this.scrollTop,v.TRUE),this.painter.resetViewShapes()),this.emitter.fire(y.SCROLL_TOP_CHANGE,{scrollTop:this.scrollTop}))}}},{key:"createPoint",value:function(t){var e=this.setting.options.useWebGL?t.glX:t.x,n=this.setting.options.useWebGL?t.glY:t.y;return this.setting.options.useWebGL?(e<-1?e=-1:e>1&&(e=1),n>1?n=1:n<-2*this.config.totalPage+1&&(n=-2*this.config.totalPage+1)):(e<0?e=0:e>1&&(e=1),n<0?n=0:n>1&&(n=1)),new c.default(e,n,0,t)}},{key:"startSelecting",value:function(t){var e=this.setting.getOptions();e.isFill=v.TRUE,e.dash=v.FALSE,e.lineWidth=v.SELECTION_BOX_LINE_WIDTH,e.stroke=new l.default(v.SElECTION_BOX_COLOR),e.fill=new l.default(v.SELECTION_BOX_BACKGROUND),e.points=[t],this.selection=new u.default(e),this.selection.startDrawing(this.painter),this.emitter.fire(y.SELECTION_START,{x:t.x,y:t.y}),this.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL&&this.painter.resetViewShapes(),this.status=2}},{key:"startTranslating",value:function(t){var e=this,n=this.painter.getActiveShape(t);this.translateTimer&&(clearTimeout(this.translateTimer),this.translateTimer=null),this.translateTimer=setTimeout((function(){e.resize.startTranslate(t,e.painter),e.emitter.fire(y.ACTIVE_RECT_MOVE_START,{x:t.x,y:t.y}),e.status=4}),1===this.resize.getTargets().length&&n&&n.name===R.TEXT?200:0)}},{key:"startDragging",value:function(t,e){this.direction=e,this.direction===v.DIRECTION.ROTATE?this.emitter.fire(y.ACTIVE_ROTATE_START):v.DRAG_CURSOR[this.direction]&&this.emitter.fire(y.DRAG_CURSOR_CHANGE,{cursor:v.DRAG_CURSOR[this.direction]}),this.resize.startDrag(t,this.painter),this.status=3}},{key:"startEraserring",value:function(t){var e=this.painter.getActiveShape(t,this.config.eraserSensitivity);e&&(this.removeShapes([e.number]),this.emitter.fire(y.LOCAL_SHAPE_REMOVE,{shapes:[e.toJSON(this.config)]})),this.status=5}},{key:"startDrawing",value:function(t){if(this.appendPointer=0,this.appendIndex=0,this.setting.isText()){var e=this.setting.getOptions();e.fill=e.fill.toString(),e.stroke=e.stroke.toString(),e.cursorColor=e.cursorColor.toString(),this.emitter.fire(y.TEXT_DRAWING_START,{options:e,eventData:t.mouseEvent})}else{var n=this.setting.createShape({points:[t]});n?(this.drawingShape=n,this.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL&&this.painter.resetViewShapes(),this.drawingShape.startDrawing(this.painter),this.emitter.fire(y.SHAPE_DRAWING_START,{shape:this.drawingShape,x:t.x,y:t.y}),this.status=1,this.setting.isShapeHasAppend(this.drawingShape.name)?this.timer.start():this.timer.stop()):x.warn("the shpae of ".concat(this.setting.activeShape," is not defined"))}}},{key:"drawing",value:function(t){this.drawingShape.drawing(this.painter,t),this.emitter.fire(y.SHAPE_DRAWING,{shape:this.drawingShape,x:t.x,y:t.y})}},{key:"selecting",value:function(t){this.selection.drawing(this.painter,t),this.selectState(this.painter),this.emitter.fire(y.SELECTION_RECT_CHANGE,{x:t.x,y:t.y})}},{key:"dragging",value:function(t){this.resize.dragging(t,this.painter),this.painter.drawing(this.resize,this.resize.needGenerate(),v.TRUE)}},{key:"translating",value:function(t){this.resize.translating(t,this.painter),this.painter.drawing(this.resize,v.FALSE,v.TRUE)}},{key:"eraserring",value:function(t){var e=this.painter.getActiveShape(t,this.config.eraserSensitivity);e&&(this.removeShapes([e.number]),this.emitter.fire(y.LOCAL_SHAPE_REMOVE,{shapes:[e.toJSON(this.config)]}))}},{key:"endDrawing",value:function(t){if(this.moving){if(this.emitter.fire(y.SHAPE_DRAWING_END,{shape:this.drawingShape,x:t.x,y:t.y}),this.drawingShape.endDrawing(this.painter),this.timer.isStarted()&&this.timer.stop(),this.setting.isShapeHasAppend(this.drawingShape.name)){var e=this.drawingShape.toJSON(this.config);e.ended=!0,e.points=e.points.slice(this.appendPointer),e.speeds&&(e.speeds=e.speeds.slice(this.appendPointer)),this.emitter.fire(y.LOCAL_SHAPE_APPEND,{shape:e,index:this.appendIndex})}this.emitter.fire(y.LOCAL_SHAPE_ADD,{shape:this.drawingShape.toJSON(this.config),hasAppend:this.appendPointer>0})}else if(this.drawingShape&&this.setting.isDoodle()){var n=f.extend({},t.mouseEvent);this.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL?(n.glX+=this.painter.getUnitLength(),n.glY-=this.painter.getUnitLength()):this.painter.PAINTER_TYPE===v.PAINTER_TYPE_CANVAS_2D&&(n.x+=this.painter.getUnitLength(),n.y+=this.painter.getUnitLength());var i=this.createPoint(n);this.moving++,this.drawing(i),this.endDrawing(i)}this.drawingShape=null}},{key:"endDragging",value:function(t){var e=this,n=this.resize.endDrag(t,this.painter);if(this.direction===v.DIRECTION.ROTATE?this.emitter.fire(y.DRAG_CURSOR_CHANGE,{cursor:v.DRAG_CURSOR[v.DIRECTION.ROTATE]}):this.direction&&this.emitter.fire(y.DRAG_CURSOR_CHANGE,{cursor:v.DRAG_CURSOR[v.CURSOR_POINTER]}),this.moving&&this.emitter.fire(y.LOCAL_SHAPE_UPDATE,{shapes:this.selectedShapes.map((function(t){return t.toJSON(e.config)}))}),n){var i=this.resize.getTargets()[0];this.createResize(i.boundingRect,[i],this.resize.getTextures()),this.painter.drawing(this.resize,v.TRUE,v.FALSE)}this.direction=0}},{key:"endTranslating",value:function(t){var e=this;this.emitter.fire(y.ACTIVE_RECT_MOVE_END,{x:t.x,y:t.y}),this.resize.endTranslate(t,this.painter),this.moving&&this.emitter.fire(y.LOCAL_SHAPE_UPDATE,{shapes:this.selectedShapes.map((function(t){return t.toJSON(e.config)}))})}},{key:"endSelecting",value:function(t){var e=v.FALSE;if(this.resize&&(this.removeSelectedShapes(),this.resize=null,e=!0),this.selection&&(this.selection=null,this.moving&&(this.addResizeBySelectedShapes(),this.emitter.fire(y.SELECTION_END,{x:t.x,y:t.y}),e=v.TRUE)),!this.moving){this.removeSelectedShapes();var n=this.painter.getActiveShape(t);n&&(this.addSelectedShapes([n]),this.createResize(n.boundingRect,[n],[this.labelMap[n.label]]),e=v.TRUE)}this.resize?(this.painter.drawing(this.resize,v.TRUE,v.TRUE),this.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL&&this.painter.drawViewToOffscreen()):e&&this.painter.drawViewShapes()}},{key:"endEraserring",value:function(t){}},{key:"updateSelectState",value:function(t){this.resize&&(this.direction=this.resize.getPointInDragRect(t,this.painter))?(this.emitter.fire(y.ACTIVE_DRAG_BOX_ENTER,{direction:this.direction}),this.dragIn=v.TRUE):this.resize&&this.resize.isPointInShape(t,this.painter)?(this.emitter.fire(y.CANVAS_CURSOR_CHANGE,{cursor:v.CURSOR_MOVE}),this.dragIn=v.FALSE):(this.emitter.fire(y.CANVAS_CURSOR_CHANGE,{cursor:v.CURSOR_UNSET}),this.hoverState(this.painter,t),this.dragIn&&this.emitter.fire(y.ACTIVE_DRAG_BOX_LEAVE),this.dragIn=v.FALSE)}},{key:"mouseDownHandler",value:function(t,e){if(e.inCanvas){var n=new c.default(this.setting.options.useWebGL?e.glX:e.x,this.setting.options.useWebGL?e.glY:e.y,0,e);if(this.resize&&this.dragIn)this.direction||(this.direction=this.resize.getPointInDragRect(n,this.painter)),this.direction&&this.startDragging(n,this.direction);else if(this.setting.isSelecting()){var i=this.painter.getActiveShape(n);if(this.resize&&(this.resize.hasShape(i)||this.resize.isPointInShape(n,this.painter))||(i?(this.removeSelectedShapes(),this.addSelectedShapes([i]),this.createResize(i.boundingRect,[i],[this.labelMap[i.label]]),this.painter.drawing(this.resize,v.TRUE,v.TRUE)):this.resize&&(this.removeSelectedShapes(),this.resize=null,this.painter.drawViewShapes())),this.resize){var r=this.resize.getPointInDragRect(n,this.painter);r?this.startDragging(n,r):this.resize.isPointInShape(n,this.painter)?this.startTranslating(n):this.startSelecting(n)}else this.startSelecting(n)}else this.setting.isDelete()?this.startEraserring(n):this.drawingShape||this.startDrawing(n);this.moving=0}}},{key:"mouseMoveHandler",value:function(t,e){try{if(1===this.status)this.moving++,this.drawing(this.createPoint(e));else if(2===this.status)this.moving++,this.selecting(new c.default(this.setting.options.useWebGL?e.glX:e.x,this.setting.options.useWebGL?e.glY:e.y,0,e));else if(3===this.status)this.moving++,this.dragging(new c.default(this.setting.options.useWebGL?e.glX:e.x,this.setting.options.useWebGL?e.glY:e.y,0,e));else if(4===this.status)this.moving++,this.translating(this.createPoint(e));else if(5===this.status)this.moving++,this.eraserring(new c.default(this.setting.options.useWebGL?e.glX:e.x,this.setting.options.useWebGL?e.glY:e.y,0,e));else if(this.setting.isSelecting()&&!e.touch){var n=new c.default(this.setting.options.useWebGL?e.glX:e.x,this.setting.options.useWebGL?e.glY:e.y,0,e);this.updateSelectState(n)}}catch(t){this.status=0,this.drawingShape=null,x.error(t)}}},{key:"mouseUpHandler",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new c.default(this.setting.options.useWebGL?e.glX:e.x,this.setting.options.useWebGL?e.glY:e.y,0,e);1===this.status?this.endDrawing(i):3===this.status?this.endDragging(i):4===this.status?this.endTranslating(i):5===this.status?this.endEraserring(i):2!==this.status||n||this.endSelecting(i),this.translateTimer&&(clearTimeout(this.translateTimer),this.translateTimer=null),n&&this.clearState(),this.status=0}},{key:"onMouseWheel",value:function(t,e){if(0===this.status){var n=.01*-e.speed;Math.abs(n)>2&&(n=n>0?2:-2),n>.3&&(n=.3),n<-.3&&(n=-.3),this.updateCameraThrotting(n)}}},{key:"onDblclick",value:function(t,e){if(this.setting.isSelecting()){this.translateTimer&&(clearTimeout(this.translateTimer),this.translateTimer=null);var n=new c.default(this.setting.options.useWebGL?e.glX:e.x,this.setting.options.useWebGL?e.glY:e.y,0,e),i=this.painter.getActiveShape(n);i&&i.name===R.TEXT&&(this.removeSelectedShapes(),this.resize=null,i.name===R.TEXT?this.removeShapes([i.number]):this.painter.drawViewShapes(),this.status=0,this.emitter.fire(y.LOCAL_SHAPE_DBLCLICK,{shape:i.toJSON(this.config),eventData:e}))}}},{key:"appendHandler",value:function(){if(this.drawingShape&&this.setting.isShapeHasAppend(this.drawingShape.name)){var t=this.drawingShape.toJSON(this.config);t.points=t.points.slice(this.appendPointer),t.speeds&&(t.speeds=t.speeds.slice(this.appendPointer)),t.points.length&&(this.emitter.fire(y.LOCAL_SHAPE_APPEND,{shape:t,index:this.appendIndex}),this.appendPointer+=t.points.length,this.appendIndex++)}}},{key:"createResize",value:function(t,e,n){var i=this.setting.getOptions();i.isFill=v.FALSE,i.isStroke=v.FALSE,i.lineWidth=v.ACTIVE_RECT_BOX_LINE_WIDTH,this.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL?i.points=[new c.default(t.minX,t.maxY),new c.default(t.maxX,t.minY)]:this.painter.PAINTER_TYPE===v.PAINTER_TYPE_CANVAS_2D&&(i.points=[new c.default(t.minX,t.minY),new c.default(t.maxX,t.maxY)]),this.resize=new h.default(i,e,n),this.resize.boundingRect=f.extend({},t)}},{key:"addResizeBySelectedShapes",value:function(){var t=this;if(this.selectedShapes.length){var e=this.selectedShapes[0].boundingRect,n={};d.each(this.selectedShapes,(function(t,i){i>0&&(e=(0,E.default)(e,t.boundingRect)),n[t.label]=!0})),this.createResize(e,this.selectedShapes,f.keys(n).slice(0,5).map((function(e){return t.labelMap[e]})))}}},{key:"removeSelectedShapes",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v.TRUE;d.each(this.selectedShapes,(function(e){e.setSelectedStatus(t.painter,v.FALSE),t.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL&&e.toVertices(t.painter)})),this.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL&&this.painter.updateShape(this.selectedShapes),this.selectedShapes=[],e&&this.emitter.fire(y.ACTIVE_SHAPE_CHANGE,{shapes:this.selectedShapes})}},{key:"addSelectedShapes",value:function(t){var e=this;d.each(t,(function(t){if(t.setSelectedStatus(e.painter,v.TRUE),!t.selection){var n=(0,_.default)(t,e.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL);e.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL?n.generateWebGLPoints(e.painter):e.painter.PAINTER_TYPE===v.PAINTER_TYPE_CANVAS_2D&&n.generateCanvas2DPoints(e.painter),t.addBound(n)}})),this.selectedShapes=this.selectedShapes.concat(t),this.emitter.fire(y.ACTIVE_SHAPE_CHANGE,{shapes:this.selectedShapes})}},{key:"updateSelectedShape",value:function(t){var e=this;this.selectedShapes&&d.each(this.selectedShapes,(function(n,i){if(n.number===t.number)return e.selectedShapes[i]=t,v.FALSE}))}},{key:"removeResize",value:function(){this.resize&&(this.removeSelectedShapes(),this.resize=null,this.painter.drawViewShapes())}},{key:"destroy",value:function(){this.emitter.off(this.namespace)}},{key:"addShape",value:function(t,e){if(e.trigger){var n=this.setting.createShape(e,t);n.startDrawing(this.painter),n.generatePointsForce(this.painter),this.painter.drawing(n,v.FALSE),n.endDrawing(this.painter),this.emitter.fire(y.LOCAL_SHAPE_ADD,{shape:n.toJSON(this.config)})}else this.shapeAdder.addShape(t,e)}},{key:"addShapes",value:function(t){var e=this,n=[];d.each(t,(function(t){var i=t.angle;t.angle=0,e.config.useWebGL||(i=-i);var r=e.setting.createShape(t,t.name);if(r.generatePointsForce(e.painter),i){var a=(new A.default).setRotate(i,new S.Vector3([0,0,1]));r.rotate(a,new c.default((r.boundingRect.minX+r.boundingRect.maxX)/2,(r.boundingRect.minY+r.boundingRect.maxY)/2,0),-i,e.painter)}e.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL&&r.toVertices(e.painter),n.push(r)})),this.painter.addShapes(n),this.painter.redrawShapes()}},{key:"appendShape",value:function(t,e){this.shapeAdder.appendShape(t,e)}},{key:"replaceShape",value:function(t,e){this.shapeAdder.replaceShape(t,e)}},{key:"removeShapes",value:function(t){this.removeResize(),this.painter.removeShapes(t),this.shapeAdder.removeShapes(t),this.painter.redrawShapes()}},{key:"updateShapes",value:function(t){var e=this;this.shapeAdder.flush();var n=[];d.each(t,(function(t){var i=t.angle;t.angle=0,e.config.useWebGL||(i=-i);var r=e.painter.getShape(t.number);if(r){var a=e.setting.createShape(t,t.name);if(a.generatePointsForce(e.painter),i){var o=(new A.default).setRotate(i,new S.Vector3([0,0,1]));a.rotate(o,new c.default((a.boundingRect.minX+a.boundingRect.maxX)/2,(a.boundingRect.minY+a.boundingRect.maxY)/2,0),-i,e.painter)}a.number=r.number,e.updateSelectedShape(a),n.push(a)}})),this.painter.updateShape(n),this.painter.redrawShapes(),this.resize&&(this.addResizeBySelectedShapes(),this.painter.drawing(this.resize,v.TRUE,v.FALSE))}},{key:"deleteSelectedShapes",value:function(){var t=this;this.selectedShapes.length&&(this.painter.removeShapes(this.selectedShapes),this.resize=null,this.painter.drawViewShapes(),this.painter.PAINTER_TYPE===v.PAINTER_TYPE_WEBGL&&this.painter.drawViewToOffscreen(),this.emitter.fire(y.LOCAL_SHAPE_REMOVE,{shapes:this.selectedShapes.map((function(e){return e.toJSON(t.config)}))}),this.selectedShapes=[],this.emitter.fire(y.ACTIVE_SHAPE_CHANGE,{shapes:this.selectedShapes.map((function(e){return e.toJSON(t.config)}))}))}},{key:"addLabelTexture",value:function(t,e){this.labelMap[t]=e}},{key:"scrollTopTo",value:function(t){this.updateCamera(t,v.TRUE)}},{key:"clear",value:function(t){this.shapeAdder.clear(),this.painter.clearShapes(),this.resize=null,t||this.emitter.fire(y.LOCAL_SHAPE_CLEAR)}},{key:"clearState",value:function(){(this.selection||this.resize)&&(this.removeSelectedShapes(),this.selection=null,this.resize&&(this.removeSelectedShapes(),this.resize=null),this.painter.drawViewShapes())}}]),t}();e.default=P},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(33)),s=r(n(3)),u=r(n(4)),l=r(n(12)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(62)),v=r(n(61)),g=r(n(25)),E=r(n(13)),_=r(n(26)),y=r(n(77)),m=r(n(23)),T=i(n(11)),A=i(n(34)),R=i(n(15)),S=n(18),x=i(n(6)),P=r(n(79)),O=r(n(76)),I=r(n(80)),w=i(n(27)),b={1:x.DIRECTION.LEFT_TOP,2:x.DIRECTION.TOP,3:x.DIRECTION.RIGHT_TOP,4:x.DIRECTION.RIGHT,5:x.DIRECTION.RIGHT_BOTTOM,6:x.DIRECTION.BOTTOM,7:x.DIRECTION.LEFT_BOTTOM,8:x.DIRECTION.LEFT,10:x.DIRECTION.ROTATE},D=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t,i,r){var a;return(0,s.default)(this,n),a=e.call(this,t),(0,d.default)((0,l.default)(a),"targets",void 0),(0,d.default)((0,l.default)(a),"boundingRect",void 0),(0,d.default)((0,l.default)(a),"startPoint",void 0),(0,d.default)((0,l.default)(a),"lastPoint",void 0),(0,d.default)((0,l.default)(a),"dragDirection",void 0),(0,d.default)((0,l.default)(a),"dragPointIndex",void 0),(0,d.default)((0,l.default)(a),"matrix4",void 0),(0,d.default)((0,l.default)(a),"directionPoints",void 0),(0,d.default)((0,l.default)(a),"status",void 0),(0,d.default)((0,l.default)(a),"textures",void 0),a.name=R.RESIZE,a.children=[],a.targets=i,a.textures=r,a.stroke=new _.default(x.ACTIVE_RECT_BOX_COLOR),a.matrix4=new m.default,a.dash=x.FALSE,a.status=0,a}return(0,u.default)(n,[{key:"drawing",value:function(t,e){}},{key:"generateWebGLPoints",value:function(t){var e=this;if(!this.validate())return this;this.glPoints=[],this.children=[];var n=this.getOptions();n.points=this.copyPoints();var i=new p.default(n);i.generateWebGLPoints(t),this.children.push(i);var r=i.points[0],a=i.points[1],o=new E.default(a.x,r.y),s=new E.default(r.x,a.y);if(1===this.targets.length&&this.targets[0].name===R.REGULAR_POLYGON?(this.directionPoints=this.targets[0].plygonPoints.slice(),this.directionPoints.pop()):1!==this.targets.length||this.targets[0].name!==R.LINE&&this.targets[0].name!==R.ARROW?1===this.targets.length&&this.targets[0].name===R.TEXT?this.directionPoints=[]:this.directionPoints=[r,new E.default((r.x+o.x)/2,(r.y+o.y)/2,(r.z+o.z)/2),o,new E.default((o.x+a.x)/2,(o.y+a.y)/2,(o.z+a.z)/2),a,new E.default((a.x+s.x)/2,(a.y+s.y)/2,(a.z+s.z)/2),s,new E.default((s.x+r.x)/2,(s.y+r.y)/2,(s.z+r.z)/2)]:this.directionPoints=this.targets[0].points,n.isFill=x.TRUE,n.isStroke=x.TRUE,n.fill=new _.default(x.ACTIVE_RECT_INNER_BOX_COLOR),T.each(this.directionPoints,(function(i){n.points=(0,P.default)({minX:i.x,minY:i.y,maxX:i.x,maxY:i.y},6*t.getUnitLength(),t.getWidthHeightRatio(),new S.Vector3([1,-1,0]));var r=new p.default(n);r.generateWebGLPoints(t),e.children.push(r)})),1===this.targets.length&&this.targets[0].name!==R.CIRCLE&&this.targets[0].name!==R.TEXT){this.targets[0].name===R.REGULAR_POLYGON||this.targets[0].name===R.LINE||this.targets[0].name===R.ARROW?n.points=[new E.default((r.x+o.x)/2,r.y),new E.default((r.x+o.x)/2,r.y+14*t.getUnitLength()*t.getWidthHeightRatio())]:n.points=[new E.default(this.directionPoints[1].x,this.children[2].points[0].y),new E.default(this.directionPoints[1].x,this.children[2].points[0].y+14*t.getUnitLength()*t.getWidthHeightRatio())],n.lineWidth=3*x.ACTIVE_RECT_BOX_LINE_WIDTH;var u=new v.default(n);u.generateWebGLPoints(t),this.children.push(u),this.targets[0].name===R.REGULAR_POLYGON||this.targets[0].name===R.LINE||this.targets[0].name===R.ARROW?n.points=[new E.default((r.x+o.x)/2,r.y+19*t.getUnitLength()*t.getWidthHeightRatio()),new E.default((r.x+o.x)/2,r.y+14*t.getUnitLength()*t.getWidthHeightRatio())]:n.points=[new E.default(this.directionPoints[1].x,this.children[2].points[0].y+19*t.getUnitLength()*t.getWidthHeightRatio()),new E.default(this.directionPoints[1].x,this.children[2].points[0].y+14*t.getUnitLength()*t.getWidthHeightRatio())],n.strokeWidth=1;var l=new y.default(n);l.isFirstPointCenter=!0,l.generateWebGLPoints(t),this.children.push(l)}var c=0;return T.each(this.textures,(function(i){if(i){n.points=[new E.default(e.points[0].x+(x.ACTIVE_INFO_RECT_MARGIN_H+c)*t.getUnitLength(),e.points[0].y+(x.ACTIVE_INFO_RECT_HEIGHT+x.ACTIVE_INFO_RECT_MARGIN_V)*t.getUnitLength()*t.getWidthHeightRatio())],n.isFill=x.TRUE,n.fontSize=x.ACTIVE_INFO_RECT_FONT_SIZE,n.stroke=new _.default(x.ACTIVE_INFO_RECT_COLOR),n.text=i.label,n.radius=x.ACTIVE_INFO_RECT_RADIUS,n.fontFamily=t.setting.fontFamily,n.width=i.width,n.height=i.height,n.imageData=i.imageData;var r=new I.default(n);r.generateWebGLPoints(t),e.children.push(r),c+=i.width+x.ACTIVE_INFO_RECT_MARGIN_L*t.config.devicePixelRatio}})),this}},{key:"generateCanvas2DPoints",value:function(t){var e=this;if(!this.validate())return this;this.glPoints=[],this.children=[];var n=this.getOptions();n.points=this.copyPoints(),n.isStroke=x.TRUE;var i=new p.default(n);i.generateCanvas2DPoints(t),this.children.push(i);var r=i.points[0],a=i.points[1],o=new E.default(a.x,r.y),s=new E.default(r.x,a.y);if(1===this.targets.length&&this.targets[0].name===R.REGULAR_POLYGON?this.directionPoints=this.targets[0].plygonPoints.slice():1!==this.targets.length||this.targets[0].name!==R.LINE&&this.targets[0].name!==R.ARROW?1===this.targets.length&&this.targets[0].name===R.TEXT?this.directionPoints=[]:this.directionPoints=[a,new E.default((r.x+o.x)/2,(r.y+o.y)/2,(r.z+o.z)/2),s,new E.default((o.x+a.x)/2,(o.y+a.y)/2,(o.z+a.z)/2),r,new E.default((a.x+s.x)/2,(a.y+s.y)/2,(a.z+s.z)/2),o,new E.default((s.x+r.x)/2,(s.y+r.y)/2,(s.z+r.z)/2)]:this.directionPoints=this.targets[0].points,n.isFill=x.TRUE,n.isStroke=x.TRUE,n.fill=new _.default(x.ACTIVE_RECT_INNER_BOX_COLOR),T.each(this.directionPoints,(function(i){n.points=(0,P.default)({minX:i.x,minY:i.y,maxX:i.x,maxY:i.y},6*t.getUnitLength(),t.getWidthHeightRatio(),new S.Vector3([1,-1,0]));var r=new p.default(n);r.generateCanvas2DPoints(t),e.children.push(r)})),1===this.targets.length&&this.targets[0].name!==R.CIRCLE&&this.targets[0].name!==R.TEXT){this.targets[0].name===R.REGULAR_POLYGON||this.targets[0].name===R.LINE||this.targets[0].name===R.ARROW?n.points=[new E.default((r.x+o.x)/2,r.y),new E.default((r.x+o.x)/2,r.y-15*t.getUnitLength()*t.getWidthHeightRatio())]:n.points=[new E.default(this.directionPoints[1].x,this.children[2].points[0].y-8*t.getUnitLength()*t.getWidthHeightRatio()),new E.default(this.directionPoints[1].x,this.children[2].points[0].y-25*t.getUnitLength()*t.getWidthHeightRatio())],n.lineWidth=4*x.ACTIVE_RECT_BOX_LINE_WIDTH;var u=new v.default(n);u.generateCanvas2DPoints(t),this.children.push(u),this.targets[0].name===R.REGULAR_POLYGON||this.targets[0].name===R.LINE||this.targets[0].name===R.ARROW?n.points=[new E.default((r.x+o.x)/2,r.y-20*t.getUnitLength()*t.getWidthHeightRatio()),new E.default((r.x+o.x)/2,r.y-15*t.getUnitLength()*t.getWidthHeightRatio())]:n.points=[new E.default(this.directionPoints[1].x,this.children[2].points[0].y-30*t.getUnitLength()*t.getWidthHeightRatio()),new E.default(this.directionPoints[1].x,this.children[2].points[0].y-25*t.getUnitLength()*t.getWidthHeightRatio())];var l=new y.default(n);l.isFirstPointCenter=!0,l.generateCanvas2DPoints(t),this.children.push(l)}var c={};T.each(this.targets,(function(t,e){c[t.label]=!0}));var h=0;return T.each(w.keys(c).slice(0,5),(function(i){if(i){n.points=[new E.default(e.points[0].x+(x.ACTIVE_INFO_RECT_MARGIN_H+h)*t.getUnitLength(),e.points[0].y-(x.ACTIVE_INFO_RECT_HEIGHT+x.ACTIVE_INFO_RECT_MARGIN_V)*t.getUnitLength()*t.getWidthHeightRatio())],n.isFill=x.TRUE,n.fontSize=x.ACTIVE_INFO_RECT_FONT_SIZE,n.stroke=new _.default(x.ACTIVE_INFO_RECT_COLOR),n.text=i,n.radius=x.ACTIVE_INFO_RECT_RADIUS,n.fontFamily=t.setting.fontFamily;var r=new I.default(n);r.computeTextSize(t),r.generateCanvas2DPoints(t),e.children.push(r),h+=r.width+x.ACTIVE_INFO_RECT_MARGIN_L*t.config.devicePixelRatio}})),this}},{key:"isPointInPath",value:function(t,e,n){return x.TRUE}},{key:"getPointInDragRect",value:function(t,e){for(var n=0,i=1;i<this.children.length;i++)if(this.children[i].name!==R.TEXT&&this.children[i].isPointInShape(t,e)){1!==this.targets.length||this.targets[0].name!==R.REGULAR_POLYGON&&this.targets[0].name!==R.LINE&&this.targets[0].name!==R.ARROW?n=b[i]:i===this.children.length-2?n=b[10]:(this.dragPointIndex=i-1,n=x.DIRECTION.MOVE);break}return n}},{key:"scaleByPoint",value:function(t,e){var n=this;if(1===this.targets.length&&this.targets[0].name===R.TEXT)return x.FALSE;if(1===this.targets.length&&(this.targets[0].name===R.REGULAR_POLYGON||this.targets[0].name===R.LINE||this.targets[0].name===R.ARROW))return this.targets[0].dragPoint(e,this.dragPointIndex,t),this.update(this.targets[0].boundingRect,e),x.FALSE;var i,r,a=Math.abs(this.points[0].x-this.points[1].x),s=Math.abs(this.points[0].y-this.points[1].y);switch(this.dragDirection){case x.DIRECTION.LEFT_TOP:e.PAINTER_TYPE===x.PAINTER_TYPE_WEBGL?(i=1-(t.x-this.lastPoint.x)/a,r=1+(t.y-this.lastPoint.y)/s):e.PAINTER_TYPE===x.PAINTER_TYPE_CANVAS_2D&&(i=1+(t.x-this.lastPoint.x)/a,r=1+(t.y-this.lastPoint.y)/s);break;case x.DIRECTION.TOP:e.PAINTER_TYPE===x.PAINTER_TYPE_WEBGL?(i=1,r=1+(t.y-this.lastPoint.y)/s):e.PAINTER_TYPE===x.PAINTER_TYPE_CANVAS_2D&&(i=1,r=1-(t.y-this.lastPoint.y)/s);break;case x.DIRECTION.RIGHT_TOP:e.PAINTER_TYPE===x.PAINTER_TYPE_WEBGL?(i=1+(t.x-this.lastPoint.x)/a,r=1+(t.y-this.lastPoint.y)/s):e.PAINTER_TYPE===x.PAINTER_TYPE_CANVAS_2D&&(i=1-(t.x-this.lastPoint.x)/a,r=1+(t.y-this.lastPoint.y)/s);break;case x.DIRECTION.RIGHT:i=1+(t.x-this.lastPoint.x)/a,r=1;break;case x.DIRECTION.RIGHT_BOTTOM:e.PAINTER_TYPE===x.PAINTER_TYPE_WEBGL?(i=1+(t.x-this.lastPoint.x)/a,r=1-(t.y-this.lastPoint.y)/s):e.PAINTER_TYPE===x.PAINTER_TYPE_CANVAS_2D&&(i=1-(t.x-this.lastPoint.x)/a,r=1-(t.y-this.lastPoint.y)/s);break;case x.DIRECTION.BOTTOM:e.PAINTER_TYPE===x.PAINTER_TYPE_WEBGL?(i=1,r=1-(t.y-this.lastPoint.y)/s):e.PAINTER_TYPE===x.PAINTER_TYPE_CANVAS_2D&&(i=1,r=1+(t.y-this.lastPoint.y)/s);break;case x.DIRECTION.LEFT_BOTTOM:e.PAINTER_TYPE===x.PAINTER_TYPE_WEBGL?(i=1-(t.x-this.lastPoint.x)/a,r=1-(t.y-this.lastPoint.y)/s):e.PAINTER_TYPE===x.PAINTER_TYPE_CANVAS_2D&&(i=1+(t.x-this.lastPoint.x)/a,r=1-(t.y-this.lastPoint.y)/s);break;case x.DIRECTION.LEFT:i=1-(t.x-this.lastPoint.x)/a,r=1}return!i||!r||i<.001||r<.001?x.FALSE:(this.matrix4.setScale(new S.Vector3([i,r,1])),this.targets.length>1?(this.boundingRect=null,T.each((0,o.default)(this.targets),(function(t){t.name!==R.TEXT&&t.scale(n.matrix4,n.directionPoints[(n.dragDirection-1+4)%8],e),n.boundingRectUnion(t.boundingRect)})),this.update(this.boundingRect,e)):(this.targets[0].name!==R.TEXT&&this.targets[0].scale(this.matrix4,this.directionPoints[(this.dragDirection-1+4)%8],e),this.boundingRect=w.extend({},this.targets[0].boundingRect),this.update(this.boundingRect,e)),x.TRUE)}},{key:"update",value:function(t,e){e.PAINTER_TYPE===x.PAINTER_TYPE_WEBGL?(this.points=[new E.default(t.minX,t.maxY),new E.default(t.maxX,t.minY)],this.generateWebGLPoints(e)):e.PAINTER_TYPE===x.PAINTER_TYPE_CANVAS_2D&&(this.points=[new E.default(t.minX,t.minY),new E.default(t.maxX,t.maxY)],this.generateCanvas2DPoints(e))}},{key:"rotateByPoint",value:function(t,e){var n=this,i=(this.points[0].x+this.points[1].x)/2,r=(this.points[0].y+this.points[1].y)/2,a=new S.Vector3([this.lastPoint.x-i,this.lastPoint.y-r,0]),s=new S.Vector3([t.x-i,t.y-r,0]),u=-1,l=(0,O.default)(a),c=(0,O.default)(s);(c>l||l<x.PI/2&&c>x.PI)&&(u=1);var h=new E.default(i,r,0);return T.each([].concat((0,o.default)(this.targets),[this]),(function(t){var i=A.angle(a,s);i=Math.floor(180*i/x.PI),n.matrix4.setRotate(i,new S.Vector3([0,0,-u])),t.rotate(n.matrix4,h,i*u,e)})),x.TRUE}},{key:"startDrag",value:function(t,e){this.startPoint=this.lastPoint=t,this.dragDirection=this.getPointInDragRect(t,e),this.status=this.dragDirection===x.DIRECTION.ROTATE?3:2}},{key:"dragging",value:function(t,e){(this.dragDirection===x.DIRECTION.ROTATE?this.rotateByPoint(t,e):this.scaleByPoint(t,e))&&(this.lastPoint=t)}},{key:"endDrag",value:function(t,e){return e.PAINTER_TYPE===x.PAINTER_TYPE_WEBGL?(e.updateShape(this.targets),e.drawViewToOffscreen()):e.PAINTER_TYPE===x.PAINTER_TYPE_CANVAS_2D&&(e.drawViewShapes(),e.drawing(this,x.FALSE,x.TRUE)),this.status=0,this.dragDirection===x.DIRECTION.ROTATE&&1===this.targets.length}},{key:"startTranslate",value:function(t,e){this.startPoint=this.lastPoint=t,this.status=1}},{key:"translating",value:function(t,e){var n=this;this.matrix4.setTranslate(new S.Vector3([t.x-this.lastPoint.x,t.y-this.lastPoint.y,t.z-this.lastPoint.z])),T.each([].concat((0,o.default)(this.targets),[this]),(function(t){t.translate(n.matrix4,e)})),this.lastPoint=t}},{key:"endTranslate",value:function(t,e){e.PAINTER_TYPE===x.PAINTER_TYPE_WEBGL?(e.updateShape(this.targets),e.drawViewToOffscreen()):e.PAINTER_TYPE===x.PAINTER_TYPE_CANVAS_2D&&(e.drawViewShapes(),e.drawing(this,x.FALSE,x.TRUE)),this.status=0}},{key:"hasShape",value:function(t){var e=x.FALSE;return T.each(this.targets,(function(n){if(n===t)return e=x.TRUE,x.FALSE})),e}},{key:"needGenerate",value:function(){return this.targets[0].needReGenerate()&&2===this.status}},{key:"validate",value:function(){return this.points.length>=2}},{key:"getTargets",value:function(){return this.targets}},{key:"getTextures",value:function(){return this.textures}}]),n}(g.default);e.default=D},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n){var i,r;return function(){r=o.toArray(arguments),i?(clearTimeout(i),i=setTimeout((function(){i=s.UNDEFINED,n||(0,a.default)(t,s.UNDEFINED,r)}),e)):(n&&(0,a.default)(t,s.UNDEFINED,r),i=setTimeout((function(){i=s.UNDEFINED,n||(0,a.default)(t,s.UNDEFINED,r)}),e))}};var a=r(n(43)),o=i(n(11)),s=i(n(6))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=function(t,e){var n=t.getOptions();n.isFill=u.FALSE,n.lineWidth=u.ACTIVE_RECT_BOX_LINE_WIDTH,n.stroke=new a.default(u.ACTIVE_RECT_BOX_COLOR);var i=t.boundingRect;return n.points=e?[new o.default(i.minX,i.maxY),new o.default(i.maxX,i.minY)]:[new o.default(i.minX,i.minY),new o.default(i.maxX,i.maxY)],new s.default(n,t)};var a=r(n(26)),o=r(n(13)),s=r(n(263)),u=i(n(6))},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(9)),c=r(n(10)),h=r(n(8)),f=r(n(5)),d=r(n(62)),p=r(n(26)),v=r(n(25)),g=i(n(15)),E=i(n(6)),_=function(t){(0,l.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.default)(this,n)}}(n);function n(t,i){var r;return(0,o.default)(this,n),r=e.call(this,t),(0,f.default)((0,u.default)(r),"target",void 0),r.name=g.SELECTION,r.children=[],r.target=i,r.dash=E.FALSE,r}return(0,s.default)(n,[{key:"drawing",value:function(t,e){}},{key:"generateWebGLPoints",value:function(t){if(!this.validate())return this;this.glPoints=[],this.children=[];var e=this.getOptions();e.isFill=E.FALSE,e.lineWidth=E.ACTIVE_RECT_BOX_LINE_WIDTH,e.stroke=new p.default(E.ACTIVE_RECT_BOX_COLOR),e.points=this.copyPoints();var n=new d.default(e);return n.generateWebGLPoints(t),this.children.push(n),this}},{key:"generateCanvas2DPoints",value:function(t){if(!this.validate())return this;this.glPoints=[],this.children=[];var e=this.getOptions();e.isFill=E.FALSE,e.lineWidth=E.ACTIVE_RECT_BOX_LINE_WIDTH,e.stroke=new p.default(E.ACTIVE_RECT_BOX_COLOR),e.points=this.copyPoints();var n=new d.default(e);return n.generateCanvas2DPoints(t),this.children.push(n),this}},{key:"isPointInPath",value:function(t,e,n){return!1}},{key:"validate",value:function(){return this.points.length>=2}}]),n}(v.default);e.default=_},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=i(n(15)),l=r(n(13)),c=i(n(11)),h=i(n(6)),f=r(n(23)),d=n(18),p=function(){function t(e,n){(0,a.default)(this,t),(0,s.default)(this,"queue",void 0),(0,s.default)(this,"painter",void 0),(0,s.default)(this,"setting",void 0),(0,s.default)(this,"appendingShapes",void 0),(0,s.default)(this,"appendMinCount",void 0),(0,s.default)(this,"fistAppendLength",void 0),(0,s.default)(this,"moreAppendLength",void 0),this.painter=e,this.setting=n,this.appendingShapes={},this.queue=[],this.painter.PAINTER_TYPE===h.PAINTER_TYPE_WEBGL?(this.appendMinCount=3,this.fistAppendLength=3,this.moreAppendLength=2):this.painter.PAINTER_TYPE===h.PAINTER_TYPE_CANVAS_2D&&(this.appendMinCount=4,this.fistAppendLength=4,this.moreAppendLength=3)}return(0,o.default)(t,[{key:"addShape",value:function(t,e){var n;try{if(t===u.DOODLE){var i=e.points;e.points=[],n=this.setting.createShape(e,t),this.appendingShapes[n.number]?this.appendingShapes[n.number].hasMore=!1:(this.appendingShapes[n.number]={shape:n,points:i,hasMore:!1},n.startDrawing(this.painter)),this.queue.push(n)}else{var r=this.setting.createShape(e,t);r.startDrawing(this.painter),this.queue.push(r)}}catch(t){n===this.queue[0]&&this.queue.shift()}1===this.queue.length&&this.run()}},{key:"appendShape",value:function(t,e){var n=e.points;e.points=[];var i=this.setting.createShape(e,t);this.appendingShapes[i.number]?(c.concat(this.appendingShapes[i.number].points,n),this.appendingShapes[i.number].hasMore=!e.ended):(this.appendingShapes[i.number]={shape:i,points:n,hasMore:!e.ended},i.startDrawing(this.painter)),this.queue.push(i),1===this.queue.length&&this.run()}},{key:"replaceShape",value:function(t,e){if(this.appendingShapes[e.number]){for(var n=this.queue.length-1;n>=0;n--)this.queue[n].number===e.number&&this.queue.splice(n,1);delete this.appendingShapes[e.number]}this.addShape(t,e)}},{key:"removeShapes",value:function(t){var e=this;this.queue.length&&c.each(t,(function(t){for(var n=e.queue.length-1;n>=0;n--)e.queue[n].number===t&&e.queue.splice(n,1);e.appendingShapes[t]&&delete e.appendingShapes[t]}))}},{key:"process",value:function(){var t=this.queue[0];try{if(t.name===u.DOODLE){var e=this.appendingShapes[t.number];e?0!==e.points.length||e.hasMore?e.points.length>=this.appendMinCount||!e.hasMore?e.shape.silent?e.shape.drawing(this.painter,e.points.shift()):(e.shape.appendPoints(e.points.splice(0,e.shape.points.length?this.moreAppendLength:this.fistAppendLength)),this.painter.drawing(e.shape)):this.queue.shift():(e.shape.endDrawing(this.painter),delete this.appendingShapes[e.shape.number],this.queue.shift()):this.queue.shift()}else{if(this.painter.drawing(t),this.painter.PAINTER_TYPE===h.PAINTER_TYPE_WEBGL&&t.angle){var n=Math.floor(180*t.angle/h.PI),i=(new f.default).setRotate(n,new d.Vector3([0,0,1]));t.rotate(i,new l.default(t.boundingRect.minX+t.boundingRect.maxX/2,t.boundingRect.minY+t.boundingRect.maxY/2,0),-n,this.painter),this.painter.drawing(t,h.FALSE)}t.endDrawing(this.painter),this.queue.shift()}}catch(e){t===this.queue[0]&&this.queue.shift()}}},{key:"run",value:function(){var t=this;this.queue.length&&(this.process(),setTimeout((function(){t.run()})))}},{key:"clear",value:function(){this.queue=[],this.appendingShapes={}}},{key:"flush",value:function(){for(;this.queue.length;)this.process()}}]),t}();e.default=p},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(30)),s=r(n(31)),u=r(n(3)),l=r(n(4)),c=r(n(12)),h=r(n(17)),f=r(n(9)),d=r(n(10)),p=r(n(8)),v=r(n(5)),g=r(n(149)),E=i(n(20)),_=r(n(26)),y=r(n(23)),m=i(n(11)),T=r(n(150)),A=i(n(32)),R=i(n(27)),S=i(n(6)),x=r(n(152)),P=r(n(268)),O=r(n(151)),I=n(18),w=r(n(303)),b=r(n(304)),D=function(t){(0,f.default)(i,t);var e,n=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,p.default)(t);if(e){var r=(0,p.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,d.default)(this,n)}}(i);function i(t,e,r,a,o,s){var l;return(0,u.default)(this,i),l=n.call(this,t,e*s.devicePixelRatio,r*s.devicePixelRatio,a,o,s),(0,v.default)((0,c.default)(l),"cameraY",0),(0,v.default)((0,c.default)(l),"inCanvasFrame",S.TRUE),(0,v.default)((0,c.default)(l),"offscreenView",void 0),(0,v.default)((0,c.default)(l),"pageViewMap",{}),(0,v.default)((0,c.default)(l),"hasNewShapes",S.FALSE),(0,v.default)((0,c.default)(l),"programController",void 0),(0,v.default)((0,c.default)(l),"VAO",void 0),(0,v.default)((0,c.default)(l),"cursor",void 0),(0,v.default)((0,c.default)(l),"enableCursor",void 0),(0,v.default)((0,c.default)(l),"gl",void 0),(0,v.default)((0,c.default)(l),"PAINTER_TYPE",S.PAINTER_TYPE_WEBGL),l}return(0,l.default)(i,[{key:"ready",value:(e=(0,s.default)(o.default.mark((function t(e){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.shapeSet=new T.default(this,1,2,[],1),this.config.canUseWebGL2?(this.gl=this.canvas.getContext("webgl2",{alpha:!0,antialias:!0,preserveDrawingBuffer:this.config.preserveDrawingBuffer}),this.gl||(this.gl=this.canvas.getContext("experimental-webgl2"))):(this.gl=this.canvas.getContext("webgl",{alpha:!0,antialias:!0,preserveDrawingBuffer:this.config.preserveDrawingBuffer}),this.gl||(this.gl=this.canvas.getContext("experimental-webgl"))),this.gl||A.fatal("不支持 webgl 功能"),this.VAO=this.gl.createBuffer(),this.VAO||A.fatal("顶点缓冲区创建失败"),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,1),this.gl.enable(this.gl.BLEND),this.resetAlphaFunc(),this.gl.clearColor(0,0,0,0),this.gl.clearDepth(1),this.viewport(this.getWidth(),this.getHeight()),this.clear(),this.offscreenView=new x.default(this.gl,this.getWidth(),this.getHeight(),this.config.canUseWebGL2),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.VAO),this.programController=new P.default(this.gl,this.config),t.prev=15,t.next=18,this.programController.run(this.getWidth(),this.getHeight());case 18:t.next=24;break;case 20:return t.prev=20,t.t0=t.catch(15),A.error(t.t0),t.abrupt("return",S.FALSE);case 24:return this.programController.loadTexure(null!=e?e:new ImageData(4,4)),this.bindView(this.offscreenView),this.clear(),this.bindView(),t.abrupt("return",S.TRUE);case 29:case"end":return t.stop()}}),t,this,[[15,20]])}))),function(t){return e.apply(this,arguments)})},{key:"bind",value:function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}},{key:"getVertices",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S.TRUE;return this.shapeSet.getVertexBuffer(t)}},{key:"bufferVertices",value:function(t){this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW)}},{key:"drawCurrentShapes",value:function(){var t=this,e=0;return m.each(this.shapeSet.getViewShapes(),(function(n){e+=n.drawGLPath(t,e)})),e}},{key:"drawViewToTarget",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.gl.blendFuncSeparate(this.gl.ONE,this.gl.ZERO,this.gl.ONE,this.gl.ZERO),this.programController.drawViewToTarget(t,e),this.resetAlphaFunc(),t.length()}},{key:"copyViewToTarget",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.gl.blendFuncSeparate(this.gl.ONE,this.gl.ZERO,this.gl.ONE,this.gl.ZERO),this.programController.copyViewToTarget(t,e),this.resetAlphaFunc(),t.length()}},{key:"bindView",value:function(t){t?(t.bind(),t.viewport(),this.inCanvasFrame=S.FALSE):(this.bind(),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.inCanvasFrame=S.TRUE)}},{key:"resetAlphaFunc",value:function(){this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}},{key:"clear",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"clearOffscreenView",value:function(){this.bindView(this.offscreenView),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.offscreenView.copyToTexture(),this.bindView()}},{key:"viewport",value:function(t,e){var n=t*this.config.devicePixelRatio,i=e*this.config.devicePixelRatio;this.width=n,this.height=i,this.canvas.width=n,this.canvas.height=i,this.gl.viewport(0,0,n,i),this.offscreenView&&this.offscreenView.resize(this.getWidth(),this.getHeight()),this.unitLength=(2+(this.config.devicePixelRatio>1?0:.2))/t,this.widthHeightRatio=t/e}},{key:"prev",value:function(){this.shapeSet.prev()&&(this.shapeSet.updateViewTop(this.cameraY+1),this.redrawShapes())}},{key:"next",value:function(){this.shapeSet.next()&&(this.shapeSet.updateViewTop(this.cameraY+1),this.redrawShapes())}},{key:"drawViewShapes",value:function(){this.clear(),this.bufferVertices(this.getVertices()),this.drawCurrentShapes()}},{key:"redrawShapes",value:function(){this.drawViewToOffscreen(),this.bufferVertices(new Float32Array(this.offscreenView.toVertices())),this.drawViewToTarget(this.offscreenView)}},{key:"drawViewToOffscreen",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S.FALSE;this.bindView(this.offscreenView),this.clear(),t&&this.shapeSet.refreshBuffer(),this.drawViewShapes(),this.offscreenView.copyToTexture(),this.bindView(),this.hasNewShapes=S.TRUE}},{key:"drawing",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t;if(e&&i.generateWebGLPoints(this),this.config.preserveDrawingBuffer&&this.clear(),n)this.bufferVertices((0,O.default)(Float32Array,this.getVertices(S.FALSE),new Float32Array(i.toVertices(this)))),i.drawGLPath(this,this.drawCurrentShapes());else{var r=i.toVertices(this).slice(0);m.concat(this.offscreenView.toVertices(),r,!0),this.enableCursor&&m.concat(r,this.cursor.toVertices(this)),this.bufferVertices(new Float32Array(r));var a=0;a+=this.drawViewToTarget(this.offscreenView,a),a+=i.drawGLPath(this,a),this.enableCursor&&this.cursor.drawGLPath(this,a)}this.hasNewShapes=S.TRUE}},{key:"endDrawing",value:function(t){(0,h.default)((0,p.default)(i.prototype),"endDrawing",this).call(this,t),this.bindView(this.offscreenView),this.bufferVertices(new Float32Array(t.toVertices(this))),t.drawGLPath(this,0),this.offscreenView.copyToTexture(),this.bindView()}},{key:"hoverState",value:function(t,e){if(!t){if(!this.hoverShape)return;this.hoverShape=null}var n=this.offscreenView.toVertices();this.hoverShape&&this.canActiveHover()&&m.concat(n,this.hoverShape.toVertices(this)),e&&m.concat(n,e.toVertices(this)),this.clear(),this.bufferVertices(new Float32Array(n));var i=this.drawViewToTarget(this.offscreenView);this.hoverShape&&this.canActiveHover()&&(i+=this.hoverShape.drawGLPath(this,i)),e&&e.drawGLPath(this,i)}},{key:"getActiveShape",value:function(t,e){if(!(!this.shapeSet.hasViewShape()||t.x<-1||t.x>1||t.y<this.cameraY-1||t.y>this.cameraY+1))return(0,h.default)((0,p.default)(i.prototype),"getActiveShape",this).call(this,t,e)}},{key:"clearShapes",value:function(){(0,h.default)((0,p.default)(i.prototype),"clearShapes",this).call(this),this.clearOffscreenView(),R.each(this.pageViewMap,(function(t,e){t.destroy()})),this.pageViewMap={}}},{key:"resize",value:function(t,e){this.getWidth(),this.getHeight(),this.viewport(t,e),this.programController.resize(this.getWidth(),this.getHeight()),this.resizeView(),this.programController.bindPainter(),this.redrawShapes()}},{key:"computeTextureData",value:function(t){}},{key:"bindTextureData",value:function(t){this.programController.loadTexure(t)}},{key:"enableTexture",value:function(t){this.programController.enableTexture(t)}},{key:"updateCamera",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S.FALSE;this.hasNewShapes&&this.savePageTexture(),this.cameraY=t,this.programController.setViewMatrix((new y.default).setLookAt(new I.Vector3([0,t,1]),new I.Vector3([0,t,-1]),new I.Vector3([0,1,0]))),e||this.putPageTexture()}},{key:"isCanvasRender",value:function(){return this.inCanvasFrame}},{key:"updateShape",value:function(t){var e=this.inCanvasFrame;this.inCanvasFrame=S.FALSE,this.shapeSet.updateShapes(t),this.inCanvasFrame=e}},{key:"getPointColor",value:function(t){this.bufferVertices(new Float32Array(this.offscreenView.toVertices())),this.drawViewToTarget(this.offscreenView);var e=new Uint8Array(4);return this.gl.readPixels(Math.floor((t.x+1)*this.canvas.width/2),Math.floor((1-t.y)*this.canvas.height/2),1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),new _.default(e[0],e[1],e[2],e[3])}},{key:"savePageTexture",value:function(){if(E.odd(this.cameraY+1)){var t=Math.floor(Math.abs(this.cameraY/2)),e=this.pageViewMap[t]||(this.pageViewMap[t]=new w.default(this.gl,this.canvas.width,this.canvas.height,t,this.config.canUseWebGL2));this.bindView(e),this.clear(),this.bufferVertices(new Float32Array(this.offscreenView.toVertices())),this.copyViewToTarget(this.offscreenView),e.copyToTexture()}else{var n=Math.floor(Math.abs(this.cameraY/2)),i=this.pageViewMap[n]||(this.pageViewMap[n]=new w.default(this.gl,this.canvas.width,this.canvas.height,n,this.config.canUseWebGL2)),r=this.pageViewMap[n+1]||(this.pageViewMap[n+1]=new w.default(this.gl,this.canvas.width,this.canvas.height,n+1,this.config.canUseWebGL2)),a=i.toSaveVertices(this.cameraY,S.TRUE).concat(r.toSaveVertices(this.cameraY,S.FALSE));this.bufferVertices(new Float32Array(a));var o=0;this.gl.blendFunc(this.gl.ONE,this.gl.ZERO),this.bindView(i),o+=this.copyViewToTarget(this.offscreenView,o),i.copyToTexture(),this.bindView(r),o+=this.copyViewToTarget(this.offscreenView,o),r.copyToTexture(),this.resetAlphaFunc()}this.hasNewShapes=S.FALSE}},{key:"putPageTexture",value:function(){if(this.clearOffscreenView(),this.bindView(this.offscreenView),E.odd(this.cameraY+1)){var t=Math.floor(Math.abs(this.cameraY/2)),e=this.pageViewMap[t];e&&(this.bufferVertices(new Float32Array(e.toVertices())),this.copyViewToTarget(e))}else{var n=Math.floor(Math.abs(this.cameraY/2)),i=this.pageViewMap[n],r=this.pageViewMap[n+1],a=[];i&&(a=a.concat(i.toDrawVertices(this.cameraY,S.TRUE))),r&&(a=a.concat(r.toDrawVertices(this.cameraY,S.FALSE))),this.bufferVertices(new Float32Array(a));var o=0;i&&(o+=this.copyViewToTarget(i,o)),r&&(o+=this.copyViewToTarget(r,o))}this.offscreenView.copyToTexture(),this.bindView(),this.clear(),this.bufferVertices(new Float32Array(this.offscreenView.toVertices())),this.drawViewToTarget(this.offscreenView)}},{key:"resizeView",value:function(){var t=this;if(this.config.totalPage>1){var e=this.getWidth(),n=this.getHeight(),i=new x.default(this.gl,e,n,this.config.canUseWebGL2);R.each(this.pageViewMap,(function(r){t.bindView(i),t.clear(),t.bufferVertices(new Float32Array(r.toVertices())),t.drawViewToTarget(r),i.copyToTexture(),r.resize(e,n),t.bindView(r),t.clear(),t.bufferVertices(new Float32Array(i.toVertices())),t.drawViewToTarget(i),r.copyToTexture()}))}this.shapeSet.resize()}},{key:"resetViewShapes",value:function(){this.shapeSet.updateViewTop(this.cameraY+1)&&(this.redrawShapes(),this.hasNewShapes=S.TRUE)}},{key:"initCursor",value:function(t){this.cursor=new b.default(this.gl,this.config.cursor.width,this.config.cursor.height,t,this.config.cursor.offsetX,this.config.cursor.offsetY)}},{key:"updateCursor",value:function(t,e){this.cursor&&this.cursor.updatePointer(t,e)}},{key:"moveCursor",value:function(t,e){if(this.cursor&&this.enableCursor){this.cursor.updatePointer(t,e);var n=this.cursor.toVertices(this);m.concat(this.offscreenView.toVertices(),n,!0),this.bufferVertices(new Float32Array(n)),this.cursor.drawGLPath(this,this.drawViewToTarget(this.offscreenView))}}},{key:"switchCursor",value:function(t){this.enableCursor=t}},{key:"destroy",value:function(){this.shapeSet&&this.shapeSet.destroy(),this.offscreenView&&this.offscreenView.destroy(),this.programController&&this.programController.destroy(),R.each(this.pageViewMap,(function(t){t.destroy()}))}}]),i}(g.default);e.default=D},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(33)),o=r(n(3)),s=r(n(4)),u=r(n(5)),l=i(n(11)),c=i(n(27)),h=i(n(6)),f=r(n(151)),d=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,o.default)(this,t),(0,u.default)(this,"vertices",void 0),(0,u.default)(this,"buffer",void 0),(0,u.default)(this,"indexMap",void 0),(0,u.default)(this,"index",void 0),this.index=0,this.indexMap={},this.vertices=[],l.each(n,(function(t){e.addVertices(t)})),this.buffer=new Float32Array(this.vertices)}return(0,s.default)(t,[{key:"updateIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.TRUE;c.each(this.indexMap,(function(i,r){i.offset>=t&&(n?i.offset-=e:i.offset+=e)}))}},{key:"addVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.TRUE,n=t.getCacheVertices();return e?(this.indexMap[t.number]={offset:this.index,length:n.length},n.length<1e4?l.concat(this.vertices,n):this.vertices=this.vertices.concat(n)):(l.concat(n,this.vertices),this.updateIndex(0,n.length,h.FALSE),this.indexMap[t.number]={offset:0,length:n.length}),this.index+=n.length,n}},{key:"removeVertices",value:function(t){var e=this.indexMap[t.number];e&&(this.vertices.splice(e.offset,e.length),this.index-=e.length,delete this.indexMap[t.number],this.updateIndex(e.offset,e.length,h.TRUE))}},{key:"appendShape",value:function(t){this.buffer=(0,f.default)(Float32Array,this.buffer,new Float32Array(this.addVertices(t,h.TRUE)))}},{key:"prependShape",value:function(t){this.buffer=(0,f.default)(Float32Array,new Float32Array(this.addVertices(t,h.FALSE)),this.buffer)}},{key:"removeShape",value:function(t){this.removeVertices(t),this.buffer=new Float32Array(this.vertices)}},{key:"removeShapes",value:function(t){var e=this;l.each(t,(function(t){e.removeVertices(t)})),this.buffer=new Float32Array(this.vertices)}},{key:"updateShape",value:function(t,e){if(this.indexMap[t.number]){var n,i=this.indexMap[t.number],r=i.offset,o=i.length,s=e.length-o;(n=this.vertices).splice.apply(n,[r,o].concat((0,a.default)(e))),0!==s&&(c.each(this.indexMap,(function(t,e){t.offset>r&&(t.offset+=s)})),this.indexMap[t.number].length+=s)}}},{key:"updateBuffer",value:function(){this.buffer=new Float32Array(this.vertices)}},{key:"clear",value:function(){this.index=0,this.indexMap={},this.vertices=[],this.buffer=new Float32Array(this.vertices)}},{key:"getBuffer",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer=null}}]),t}();e.default=d},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(9)),c=r(n(10)),h=r(n(8)),f=r(n(5)),d=r(n(154)),p=i(n(6)),v=function(t){(0,l.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,h.default)(t);if(e){var r=(0,h.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.default)(this,n)}}(n);function n(t,i,r){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p.FALSE;return(0,o.default)(this,n),a=e.call(this,t,i,r),(0,f.default)((0,u.default)(a),"useMultisample",void 0),a.useMultisample=s,a}return(0,s.default)(n,[{key:"init",value:function(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.useMultisample?(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR)):(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE))}}]),n}(d.default);e.default=v},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(30)),o=r(n(31)),s=r(n(3)),u=r(n(4)),l=r(n(5)),c=r(n(23)),h=i(n(6)),f=r(n(110)),d=r(n(269)),p=r(n(273)),v=r(n(276)),g=r(n(281)),E=function(){function t(e,n){(0,s.default)(this,t),(0,l.default)(this,"gl",void 0),(0,l.default)(this,"texture",void 0),(0,l.default)(this,"_paintProgram",void 0),(0,l.default)(this,"_postRender",void 0),(0,l.default)(this,"_copyRender",void 0),(0,l.default)(this,"config",void 0),this.gl=e,this._paintProgram=null,this.config=n}var e;return(0,u.default)(t,[{key:"run",value:(e=(0,o.default)(a.default.mark((function t(e,n){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._paintProgram=new d.default(this.gl),this._paintProgram.link(),this._copyRender=new p.default(this.gl,e,n),t.next=5,this._copyRender.ready();case 5:if(this.config.canUseWebGL2||!this.config.aa?this._postRender=this._copyRender:this.config.aa===h.FXAA?this._postRender=new v.default(this.gl,e,n):this.config.aa===h.SMAA&&(this._postRender=new g.default(this.gl,e/this.config.devicePixelRatio,n/this.config.devicePixelRatio,h.FALSE)),!this._postRender){t.next=15;break}return t.prev=7,t.next=10,this._postRender.ready();case 10:t.next=15;break;case 12:throw t.prev=12,t.t0=t.catch(7),t.t0;case 15:this._paintProgram.bind(),this.initPainterTexture(),this._paintProgram.setRatio(e/n),this._paintProgram.setProjMatrix((new c.default).setOrtho(-e/n,e/n,-1,1,1,-1)),this._paintProgram.setViewMatrix();case 20:case"end":return t.stop()}}),t,this,[[7,12]])}))),function(t,n){return e.apply(this,arguments)})},{key:"setProjMatrix",value:function(t){this._paintProgram.setProjMatrix(t)}},{key:"setViewMatrix",value:function(t){this._paintProgram.setViewMatrix(t)}},{key:"stop",value:function(){return this._paintProgram.stop(),this._paintProgram=null,this._postRender.destroy(),this._postRender=null,this}},{key:"initPainterTexture",value:function(){return this.texture=new f.default(this.gl),this.texture.bind(0),this.texture.init(),this._paintProgram.bindTexture(0),this._paintProgram.enableTexture(h.FALSE),this}},{key:"loadTexure",value:function(t){this.texture.bind(0),this.texture.setImageData(t)}},{key:"enableTexture",value:function(t){this._paintProgram.enableTexture(t)}},{key:"bindPainter",value:function(){this._paintProgram.bind(),this.texture.bind(0),this._paintProgram.bindTexture(0),this.enableTexture(h.FALSE)}},{key:"drawViewToTarget",value:function(t,e){this._postRender.render(t,e),this.bindPainter()}},{key:"copyViewToTarget",value:function(t,e){this._copyRender.render(t,e),this.bindPainter()}},{key:"resize",value:function(t,e){this._postRender&&(this._copyRender instanceof g.default?this._postRender.resize(t/this.config.devicePixelRatio,e/this.config.devicePixelRatio):this._postRender.resize(t,e)),this._paintProgram.setRatio(t/e),this._paintProgram.setProjMatrix((new c.default).setOrtho(-t/e,t/e,-1,1,1,-1))}},{key:"destroy",value:function(){this._paintProgram.stop(),this._copyRender.destroy(),this._postRender&&this._postRender!==this._copyRender&&this._postRender.destroy()}},{key:"paintProgram",get:function(){return this._paintProgram.program}}]),t}();e.default=E},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(17)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(111)),v=r(n(23)),g=n(18),E=r(n(50)),_=i(n(6)),y=r(n(51)),m=r(n(271)),T=r(n(272)),A=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t){var i;return(0,o.default)(this,n),i=e.call(this,t,new E.default(t,m.default),new y.default(t,T.default)),(0,d.default)((0,u.default)(i),"projMatrix",void 0),(0,d.default)((0,u.default)(i),"viewMatrix",void 0),(0,d.default)((0,u.default)(i),"projMatrixLocation",void 0),(0,d.default)((0,u.default)(i),"viewMatrixLocation",void 0),(0,d.default)((0,u.default)(i),"samplerLocation",void 0),(0,d.default)((0,u.default)(i),"enableTextureLocation",void 0),(0,d.default)((0,u.default)(i),"ratioLocation",void 0),i}return(0,s.default)(n,[{key:"link",value:function(){(0,l.default)((0,f.default)(n.prototype),"link",this).call(this),this.projMatrixLocation=this.gl.getUniformLocation(this.program,"projMatrix"),this.viewMatrixLocation=this.gl.getUniformLocation(this.program,"viewMatrix"),this.samplerLocation=this.gl.getUniformLocation(this.program,"u_Sampler"),this.enableTextureLocation=this.gl.getUniformLocation(this.program,"enableTexture"),this.ratioLocation=this.gl.getUniformLocation(this.program,"ratio")}},{key:"setProjMatrix",value:function(t){return t?this.projMatrix=t:(this.projMatrix=new v.default,this.projMatrix.setOrtho(-1,1,-1,1,1,-1)),this.gl.uniformMatrix4fv(this.projMatrixLocation,_.FALSE,this.projMatrix.element),this}},{key:"setViewMatrix",value:function(t){return t?this.viewMatrix=t:(this.viewMatrix=new v.default,this.viewMatrix.setLookAt(new g.Vector3([0,0,1]),new g.Vector3([0,0,-1]),new g.Vector3([0,1,0]))),this.gl.uniformMatrix4fv(this.viewMatrixLocation,_.FALSE,this.viewMatrix.element),this}},{key:"bindTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.uniform1i(this.samplerLocation,t)}},{key:"enableTexture",value:function(t){this.gl.uniform1i(this.enableTextureLocation,t?1:0)}},{key:"setRatio",value:function(t){this.gl.uniform1f(this.ratioLocation,t)}}]),n}(p.default);e.default=A},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=(i(n(32)),function(){function t(e,n,i){(0,a.default)(this,t),(0,s.default)(this,"gl",void 0),(0,s.default)(this,"_program",void 0),(0,s.default)(this,"vertexShader",void 0),(0,s.default)(this,"fragmentShader",void 0),this.gl=e,this.vertexShader=n,this.fragmentShader=i,this.vertexShader&&this.vertexShader.compile(e),this.fragmentShader&&this.fragmentShader.compile(e)}return(0,o.default)(t,[{key:"link",value:function(){this._program=this.gl.createProgram(),this.gl.attachShader(this._program,this.vertexShader.shader),this.gl.attachShader(this._program,this.fragmentShader.shader),this.gl.linkProgram(this._program)}},{key:"stop",value:function(){this.vertexShader.stop(this.gl),this.fragmentShader.stop(this.gl),this.gl.deleteProgram(this._program),this.vertexShader=null,this.fragmentShader=null,this._program=null}},{key:"bind",value:function(){this.gl.useProgram(this._program)}},{key:"program",get:function(){return this._program}}]),t}());e.default=u},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 point;\nattribute vec4 color;\nvarying vec4 v_color;\n\nuniform mat4 projMatrix;\nuniform mat4 viewMatrix;\nuniform float ratio;\nuniform bool enableTexture;\n\nvoid main(void){\n  vec3 p = vec3(ratio * point.x, point.y, point.z);\n  gl_Position = projMatrix * viewMatrix * vec4(p, 1.0);\n  v_color = color;\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 v_color;\nuniform sampler2D u_Sampler;\nuniform bool enableTexture;\n\nvoid main(void){\n  if (enableTexture) {\n    gl_FragColor = texture2D(u_Sampler, v_color.xy);\n  }\n  else {\n    gl_FragColor = v_color;\n  }\n}\n"},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(9)),l=i(n(10)),c=i(n(8)),h=i(n(5)),f=i(n(112)),d=i(n(156)),p=function(t){(0,u.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,c.default)(t);if(e){var a=(0,c.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}(n);function n(t,i,r){var o;return(0,a.default)(this,n),o=e.call(this,t,i,r),(0,h.default)((0,s.default)(o),"program",void 0),o.program=new d.default(o.gl),o.program.link(),o}return(0,o.default)(n,[{key:"render",value:function(t,e){this.program.bind(),t.getTexture().bind(0),this.program.bindTexture(0),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,e,t.length())}},{key:"destroy",value:function(){this.program.stop()}}]),n}(f.default);e.default=p},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 point;\nattribute vec4 color;\nvarying vec4 v_color;\n\nvoid main(void){\n  gl_Position = vec4(point, 1.0);\n  v_color = color;\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 v_color;\nuniform sampler2D u_Sampler;\n\nvoid main () {\n  gl_FragColor = texture2D(u_Sampler, v_color.xy);\n}\n"},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(9)),l=i(n(10)),c=i(n(8)),h=i(n(5)),f=i(n(112)),d=i(n(277)),p=function(t){(0,u.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,c.default)(t);if(e){var a=(0,c.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}(n);function n(t,i,r){var o;return(0,a.default)(this,n),o=e.call(this,t,i,r),(0,h.default)((0,s.default)(o),"program",void 0),o.program=new d.default(o.gl),o.program.link(),o}return(0,o.default)(n,[{key:"render",value:function(t,e){this.program.bind(),this.program.setResolution([1/this.width,1/this.height]),t.getTexture().bind(0),this.program.bindTexture(0),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,e,t.length())}},{key:"destroy",value:function(){this.program.stop()}}]),n}(f.default);e.default=p},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(9)),s=i(n(10)),u=i(n(8)),l=i(n(82)),c=i(n(50)),h=i(n(51)),f=i(n(279)),d=i(n(280)),p=function(t){(0,o.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}(n);function n(t){return(0,a.default)(this,n),e.call(this,t,new c.default(t,f.default),new h.default(t,d.default))}return n}(l.default);e.default=p},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(17)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(111)),v=i(n(6)),g=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t,i,r){var a;return(0,o.default)(this,n),a=e.call(this,t,i,r,v.FALSE),(0,d.default)((0,u.default)(a),"samplerLocation",void 0),a}return(0,s.default)(n,[{key:"link",value:function(){(0,l.default)((0,f.default)(n.prototype),"link",this).call(this),this.samplerLocation=this.gl.getUniformLocation(this.program,"u_Sampler")}},{key:"bindTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.uniform1i(this.samplerLocation,t)}}]),n}(p.default);e.default=g},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\n#define GLSLIFY 1\nattribute vec3 point;\nattribute vec4 color;\n\nvoid main() {\n  gl_Position = vec4(point, 1.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default='precision highp float;\n#define GLSLIFY 1\n\nuniform vec2 resolution;\nuniform sampler2D u_Sampler;\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n  #define FXAA_REDUCE_MIN   (1.0 / 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n  #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n  #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent \n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex,\nvec2 fragCoord, vec2 resolution,\nvec2 v_rgbNW, vec2 v_rgbNE, \nvec2 v_rgbSW, vec2 v_rgbSE, \nvec2 v_rgbM\n) {\n  vec4 color;\n  mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n  // 分别获取5个纹素\n  vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n  vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n  vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n  vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n  vec4 texColor = texture2D(tex, v_rgbM);\n  vec3 rgbM  = texColor.xyz;\n\n  // 计算各自亮度和最小最大亮度\n  vec3 luma = vec3(0.2126, 0.7152, 0.0722);\n  float lumaNW = dot(rgbNW, luma);\n  float lumaNE = dot(rgbNE, luma);\n  float lumaSW = dot(rgbSW, luma);\n  float lumaSE = dot(rgbSE, luma);\n  float lumaM  = dot(rgbM,  luma);\n  float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n  float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n  \n  mediump vec2 dir;\n  dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n  dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n  \n  float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) / 4.0 * FXAA_REDUCE_MUL, FXAA_REDUCE_MIN);\n  \n  float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n  dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX), max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) * inverseVP;\n\n  vec4 A = texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5));\n  vec4 Aop = texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5));\n  if (A.a == 0.0)\n    A = mix(A, Aop, 0.25);\n  else if (Aop.a == 0.0)\n    Aop = mix(Aop, A, 0.25);\n\n  vec4 B = texture2D(tex, fragCoord * inverseVP + dir * -0.5);\n  vec4 Bop = texture2D(tex, fragCoord * inverseVP + dir * 0.5);\n  if (B.a == 0.0)\n    B = mix(B, Bop, 0.25);\n  else if (Bop.a == 0.0) {\n    Bop = mix(Bop, B, 0.25);\n  }\n\n  vec4 rgbA = 0.5 * (A + Aop);\n  vec4 rgbB = rgbA * 0.5 + 0.25 * (B + Bop);\n\n  float lumaB = dot(rgbB.xyz, luma);\n  if ((lumaB < lumaMin) || (lumaB > lumaMax))\n    color = rgbA;\n  else\n    color = rgbB;\n  return color;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n\t\t\tout vec2 v_rgbNW, out vec2 v_rgbNE,\n\t\t\tout vec2 v_rgbSW, out vec2 v_rgbSE,\n\t\t\tout vec2 v_rgbM) {\n\tvec2 inverseVP = 1.0 / resolution.xy;\n\tv_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n\tv_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n\tv_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n\tv_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n\tv_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvec4 apply(sampler2D tex, vec2 fragCoord, vec2 resolution) {\n\tmediump vec2 v_rgbNW;\n\tmediump vec2 v_rgbNE;\n\tmediump vec2 v_rgbSW;\n\tmediump vec2 v_rgbSE;\n\tmediump vec2 v_rgbM;\n\n\t//compute the texture coords\n\ttexcoords(fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\t\n\t//compute FXAA\n\treturn fxaa(tex, fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n\nvoid main() {\n  vec2 iResolution = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n  // vec2 uv = vec2(gl_FragCoord.xy / iResolution.xy);\n\n  //can also use gl_FragCoord.xy\n  // vec2 fragCoord = uv * iResolution;\n\n  gl_FragColor = apply(u_Sampler, gl_FragCoord.xy, iResolution);\n}\n\n'},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(30)),s=r(n(31)),u=r(n(3)),l=r(n(4)),c=r(n(12)),h=r(n(9)),f=r(n(10)),d=r(n(8)),p=r(n(5)),v=r(n(112)),g=r(n(153)),E=r(n(156)),_=i(n(6)),y=n(282),m=r(n(293)),T=r(n(296)),A=n(299),R=r(n(300)),S=function(t){(0,h.default)(i,t);var e,n=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,d.default)(t);if(e){var r=(0,d.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,f.default)(this,n)}}(i);function i(t,e,r,a){var o;return(0,u.default)(this,i),o=n.call(this,t,e,r),(0,p.default)((0,c.default)(o),"smaaFrame",void 0),(0,p.default)((0,c.default)(o),"edgesFrame",void 0),(0,p.default)((0,c.default)(o),"weightsFrame",void 0),(0,p.default)((0,c.default)(o),"searchTexture",void 0),(0,p.default)((0,c.default)(o),"areaTexture",void 0),(0,p.default)((0,c.default)(o),"copyProgram",void 0),(0,p.default)((0,c.default)(o),"edgesProgram",void 0),(0,p.default)((0,c.default)(o),"weightsProgram",void 0),(0,p.default)((0,c.default)(o),"blendProgram",void 0),o.smaaFrame=new g.default(t,o.width,o.height,a),o.edgesFrame=new g.default(t,o.width,o.height,a),o.weightsFrame=new g.default(t,o.width,o.height,a),o.copyProgram=new E.default(o.gl),o.edgesProgram=new m.default(o.gl,.3),o.weightsProgram=new R.default(o.gl,_.PRESET_HIGH),o.blendProgram=new T.default(o.gl),o}return(0,l.default)(i,[{key:"ready",value:(e=(0,s.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,y.loadImageTexture)(this.gl,A.areaTexture);case 2:return this.areaTexture=t.sent,this.areaTexture.bind(),this.areaTexture.setFormat(this.gl.RGB),this.areaTexture.setFilter(this.gl.LINEAR),this.areaTexture.init(),this.areaTexture.setImageData(),t.next=10,(0,y.loadImageTexture)(this.gl,A.searchTexture);case 10:return this.searchTexture=t.sent,this.searchTexture.bind(),this.searchTexture.setFilter(this.gl.NEAREST),this.searchTexture.init(),this.searchTexture.setImageData(),this.copyProgram.link(),this.edgesProgram.link(),this.weightsProgram.link(),this.blendProgram.link(),t.abrupt("return",_.TRUE);case 20:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"bind",value:function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}},{key:"render",value:function(t,e){this.smaaFrame.bind(),this.smaaFrame.clear(),this.copyProgram.bind(),this.copyProgram.bindTexture(0),t.getTexture().bind(0),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,e,t.length()),this.edgesFrame.bind(),this.edgesFrame.clear(),this.edgesProgram.bind(),this.edgesProgram.bindTexture(0),this.edgesProgram.setResolution([1/this.width,1/this.height]),this.smaaFrame.getTexture().bind(0),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,e,t.length()),this.weightsFrame.bind(),this.weightsFrame.bind(),this.weightsProgram.bind(),this.weightsProgram.bindEdgesTexture(0),this.weightsProgram.bindSearchTexture(1),this.weightsProgram.bindAreaTexture(2),this.weightsProgram.setResolution([1/this.width,1/this.height]),this.edgesFrame.getTexture().bind(0),this.searchTexture.bind(1),this.areaTexture.bind(2),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,e,t.length()),this.bind(),this.blendProgram.bind(),this.blendProgram.bindSMAATexture(0),this.blendProgram.bindWeightsTexture(1),this.blendProgram.setResolution([1/this.width,1/this.height]),this.smaaFrame.getTexture().bind(0),this.weightsFrame.getTexture().bind(1),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,e,t.length())}},{key:"resize",value:function(t,e){this.width=t,this.height=e,this.smaaFrame.resize(t,e),this.edgesFrame.resize(t,e),this.weightsFrame.resize(t,e)}},{key:"destroy",value:function(){this.copyProgram.stop(),this.edgesProgram.stop(),this.weightsProgram.stop(),this.blendProgram.stop(),this.edgesFrame.destroy(),this.weightsFrame.destroy(),this.smaaFrame.destroy(),this.areaTexture.destroy(),this.searchTexture.destroy()}}]),i}(v.default);e.default=S},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.loadImageTexture=function(t,e){return l.apply(this,arguments)},e.loadHdrImageTexture=function(t,e){return c.apply(this,arguments)};var r=i(n(30)),a=i(n(31)),o=n(283),s=i(n(110)),u=n(284);function l(){return(l=(0,a.default)(r.default.mark((function t(e,n){var i,a,o,l;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.AsyncPreloader.shared(),t.next=3,i.loadImage({src:n});case 3:return a=t.sent,t.next=6,createImageBitmap(a);case 6:return o=t.sent,l=new s.default(e,o,a.width,a.height),t.abrupt("return",l);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function c(){return(c=(0,a.default)(r.default.mark((function t(e,n){var i,a,l,c;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.AsyncPreloader.shared(),t.next=3,i.loadArrayBuffer({src:n});case 3:return a=t.sent,l=(0,o.parseHdr)(a),(c=new s.default(e,l.data,l.width,l.height)).bind(),c.init(),c.setHdrImageData(),t.abrupt("return",c);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.parseHdr=function(t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var e=0,n=t.length;function i(){var i="";do{var r=t[e];if(10==r){++e;break}i+=String.fromCharCode(r)}while(++e<n);return i}for(var c=0,h=0,f=1,d=!1,p=0;p<20;p++){var v=i(),g=void 0;if(g=v.match(a));else if(g=v.match(u))d=!0;else if(g=v.match(s))f=Number(g[1]);else if(g=v.match(o));else if(g=v.match(l)){h=Number(g[1]),c=Number(g[2]);break}}d||r.fatal("File is not run length encoded!");var E=new Uint8Array(c*h*4);!function(t,e,n,i,a,o){var s,u,l,c=new Array(4),h=null,f=new Array(2),d=t.length;function p(e){var n=0;do{e[n++]=t[i]}while(++i<d&&n<e.length);return n}function v(e,n,r){var a=0;do{e[n+a++]=t[i]}while(++i<d&&a<r);return a}function g(t,e,n,i){var a=4*i,o=v(e,n,a);o<a&&r.fatal("Error reading raw pixels: got ".concat(o," bytes, expected ").concat(a))}for(;o>0;){if(p(c)<c.length&&r.fatal("Error reading bytes: expected ".concat(c.length)),2!==c[0]||2!==c[1]||0!=(128&c[2]))return e[n++]=c[0],e[n++]=c[1],e[n++]=c[2],e[n++]=c[3],void g(0,e,n,a*o-1);((255&c[2])<<8|255&c[3])!==a&&r.fatal("Wrong scanline width ".concat((255&c[2])<<8|255&c[3],", expected ").concat(a)),null==h&&(h=new Array(4*a)),s=0;for(var E=0;E<4;E++)for(u=(E+1)*a;s<u;)if(p(f)<f.length&&r.fatal("Error reading 2-byte buffer"),(255&f[0])>128)for((0==(l=(255&f[0])-128)||l>u-s)&&r.fatal("Bad scanline data");l-- >0;)h[s++]=f[1];else(0==(l=255&f[0])||l>u-s)&&r.fatal("Bad scanline data"),h[s++]=f[1],--l>0&&(v(h,s,l)<l&&r.fatal("Error reading non-run data"),s+=l);for(var _=0;_<a;_++)e[n+0]=h[_],e[n+1]=h[_+a],e[n+2]=h[_+2*a],e[n+3]=h[_+3*a],n+=4;o--}}(t,E,0,e,c,h);for(var _=new Float32Array(c*h*4),y=0;y<E.length;y+=4){var m=E[y+0]/255,T=E[y+1]/255,A=E[y+2]/255,R=E[y+3],S=Math.pow(2,R-128);m*=S,T*=S,A*=S;var x=y;_[x+0]=m,_[x+1]=T,_[x+2]=A,_[x+3]=1}return{width:c,height:h,exposure:f,gamma:1,data:_}};var r=i(n(32)),a="#\\?RADIANCE",o="#.*",s="EXPOSURE=\\s*([0-9]*[.][0-9]*)",u="FORMAT=32-bit_rle_rgbe",l="-Y ([0-9]+) \\+X ([0-9]+)"},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.AsyncPreloader=void 0;var r,a=i(n(60)),o=i(n(30)),s=i(n(31)),u=i(n(157)),l=i(n(3)),c=i(n(4)),h=i(n(5)),f=function(){function t(){(0,l.default)(this,t),(0,h.default)(this,"items",new u.default),(0,h.default)(this,"defaultBodyMethod","blob")}var e,n;return(0,c.default)(t,[{key:"loadArrayBuffer",value:(n=(0,s.default)(o.default.mark((function e(n){var i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchItem(n);case 2:return i=e.sent,e.next=5,i.arrayBuffer();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),function(t){return n.apply(this,arguments)})},{key:"loadImage",value:(e=(0,s.default)(o.default.mark((function e(n){var i,r,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchItem(n);case 2:return i=e.sent,e.next=5,i[n.body||this.defaultBodyMethod]();case 5:if(r=e.sent,!n.body){e.next=8;break}return e.abrupt("return",r);case 8:return s=new Image,e.next=11,new a.default((function(t,e){s.addEventListener("load",(function e(){s.removeEventListener("load",e),t(s)})),s.addEventListener("error",(function t(){s.removeEventListener("error",t),e(s)})),s.src=URL.createObjectURL(r)}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})}],[{key:"shared",value:function(){return r||(r=new t)}},{key:"fetchItem",value:function(t){return fetch(t.src,t.options||{})}}]),t}();e.AsyncPreloader=f},function(t,e,n){n(70),n(44),n(46),n(286),n(288),n(291),n(292),t.exports=n(14).Map},function(t,e,n){"use strict";var i=n(287),r=n(59);t.exports=n(122)("Map",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=i.getEntry(r(this,"Map"),t);return e&&e.v},set:function(t,e){return i.def(r(this,"Map"),0===t?0:t,e)}},i,!0)},function(t,e,n){"use strict";var i=n(29).f,r=n(56),a=n(71),o=n(38),s=n(72),u=n(48),l=n(87),c=n(118),h=n(130),f=n(28),d=n(47).fastKey,p=n(59),v=f?"_s":"size",g=function(t,e){var n,i=d(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,l){var c=t((function(t,i){s(t,c,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[v]=0,null!=i&&u(i,n,t[l],t)}));return a(c.prototype,{clear:function(){for(var t=p(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),i=g(n,t);if(i){var r=i.n,a=i.p;delete n._i[i.i],i.r=!0,a&&(a.n=r),r&&(r.p=a),n._f==i&&(n._f=r),n._l==i&&(n._l=a),n[v]--}return!!i},forEach:function(t){p(this,e);for(var n,i=o(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(p(this,e),t)}}),f&&i(c.prototype,"size",{get:function(){return p(this,e)[v]}}),c},def:function(t,e,n){var i,r,a=g(t,e);return a?a.v=n:(t._l=a={i:r=d(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=a),i&&(i.n=a),t[v]++,"F"!==r&&(t._i[r]=a)),t},getEntry:g,setStrong:function(t,e,n){l(t,e,(function(t,n){this._t=p(t,e),this._k=n,this._l=void 0}),(function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?c(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,c(1))}),n?"entries":"values",!n,!0),h(e)}}},function(t,e,n){var i=n(16);i(i.P+i.R,"Map",{toJSON:n(289)("Map")})},function(t,e,n){var i=n(73),r=n(290);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return r(this)}}},function(t,e,n){var i=n(48);t.exports=function(t,e){var n=[];return i(t,!1,n.push,n,e),n}},function(t,e,n){n(123)("Map")},function(t,e,n){n(124)("Map")},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(17)),l=i(n(9)),c=i(n(10)),h=i(n(8)),f=i(n(5)),d=i(n(82)),p=i(n(50)),v=i(n(51)),g=i(n(294)),E=i(n(295)),_=function(t){(0,l.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,h.default)(t);if(e){var a=(0,h.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,c.default)(this,n)}}(n);function n(t,i){var r;return(0,a.default)(this,n),r=e.call(this,t,null,null),(0,f.default)((0,s.default)(r),"threshold",void 0),r.threshold=i,r}return(0,o.default)(n,[{key:"link",value:function(){this.vertexShader=new p.default(this.gl,g.default),this.fragmentShader=new v.default(this.gl,"#define SMAA_THRESHOLD ".concat(this.threshold," \n\n      ").concat(E.default,"\n    ")),this.vertexShader.compile(this.gl),this.fragmentShader.compile(this.gl),(0,u.default)((0,h.default)(n.prototype),"link",this).call(this)}}]),n}(d.default);e.default=_},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 point;\nattribute vec4 color;\n\nvarying vec2 vUv;\nvarying vec4 vOffset[3];\n\nuniform vec2 resolution;\n\nvoid SMAAEdgeDetectionVS(vec2 texcoord) {\n\tvOffset[0] = texcoord.xyxy + resolution.xyxy * vec4(-1.0, 0.0, 0.0, 1.0);\n\tvOffset[1] = texcoord.xyxy + resolution.xyxy * vec4(1.0, 0.0, 0.0, -1.0);\n\tvOffset[2] = texcoord.xyxy + resolution.xyxy * vec4(-2.0, 0.0, 0.0, 2.0);\n}\nvoid main() {\n\tvUv = color.xy;\n\tSMAAEdgeDetectionVS(vUv);\n\tgl_Position = vec4(point, 1.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default="/**\n * Color Edge Detection\n *\n * IMPORTANT NOTICE: color edge detection requires gamma-corrected colors, and\n * thus 'u_Sampler' should be a non-sRGB texture.\n */\n\nprecision highp float;\n#define GLSLIFY 1\n\n#ifndef SMAA_THRESHOLD\n#define SMAA_THRESHOLD 0.1\n#endif\n\nuniform sampler2D u_Sampler;\nvarying vec2 vUv;\nvarying vec4 vOffset[3];\n\nvec4 SMAAColorEdgeDetectionPS(vec2 texcoord, vec4 offset[3], sampler2D colorTex) {\n\tvec2 threshold = vec2(SMAA_THRESHOLD, SMAA_THRESHOLD);\n\tvec4 delta;\n\tvec3 C = texture2D(colorTex, texcoord).rgb;\n\tvec3 Cleft = texture2D(colorTex, offset[0].xy).rgb;\n\tvec3 t = abs(C - Cleft);\n  \n\tdelta.x = max(max(t.r, t.g ), t.b);\n\n\tvec3 Ctop = texture2D(colorTex, offset[0].zw).rgb;\n\tt = abs(C - Ctop);\n\tdelta.y = max(max(t.r, t.g), t.b);\n\n\tvec2 edges = step(threshold, delta.xy);\n\tif (dot(edges, vec2(1.0, 1.0 )) == 0.0) {\n    discard;\n  }\n\tvec3 Cright = texture2D(colorTex, offset[1].xy).rgb;\n\tt = abs(C - Cright);\n\tdelta.z = max(max(t.r, t.g), t.b);\n\n\tvec3 Cbottom = texture2D(colorTex, offset[1].zw).rgb;\n\tt = abs(C - Cbottom);\n\tdelta.w = max(max(t.r, t.g), t.b);\n\n\tfloat maxDelta = max(max(max(delta.x, delta.y), delta.z), delta.w);\n\tvec3 Cleftleft = texture2D(colorTex, offset[2].xy).rgb;\n\tt = abs(C - Cleftleft);\n\tdelta.z = max(max(t.r, t.g), t.b);\n\n\tvec3 Ctoptop = texture2D(colorTex, offset[2].zw).rgb;\n\tt = abs(C - Ctoptop);\n\tdelta.w = max(max(t.r, t.g), t.b);\n\tmaxDelta = max(max(maxDelta, delta.z), delta.w);\n\tedges.xy *= step(0.5 * maxDelta, delta.xy);\n\n\treturn vec4(edges, 0.0, 0.0);\n}\nvoid main() {\n\tgl_FragColor = SMAAColorEdgeDetectionPS(vUv, vOffset, u_Sampler);\n}\n"},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(17)),l=i(n(9)),c=i(n(10)),h=i(n(8)),f=i(n(5)),d=i(n(82)),p=i(n(50)),v=i(n(51)),g=i(n(297)),E=i(n(298)),_=function(t){(0,l.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,h.default)(t);if(e){var a=(0,h.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,c.default)(this,n)}}(n);function n(t){var i;return(0,a.default)(this,n),i=e.call(this,t,new p.default(t,g.default),new v.default(t,E.default)),(0,f.default)((0,s.default)(i),"smaaTexLocation",void 0),(0,f.default)((0,s.default)(i),"weightsTexLocation",void 0),i}return(0,o.default)(n,[{key:"link",value:function(){(0,u.default)((0,h.default)(n.prototype),"link",this).call(this),this.smaaTexLocation=this.gl.getUniformLocation(this.program,"colorTex"),this.weightsTexLocation=this.gl.getUniformLocation(this.program,"blendTex")}},{key:"bindSMAATexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.uniform1i(this.smaaTexLocation,t)}},{key:"bindWeightsTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.gl.uniform1i(this.weightsTexLocation,t)}}]),n}(d.default);e.default=_},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 point;\nattribute vec4 color;\n\nuniform vec2 resolution;\nvarying vec2 vUv;\nvarying vec4 vOffset[2];\n\nvoid SMAANeighborhoodBlendingVS(vec2 texcoord) {\n\tvOffset[0] = texcoord.xyxy + resolution.xyxy * vec4(-1.0, 0.0, 0.0, 1.0);\n\tvOffset[1] = texcoord.xyxy + resolution.xyxy * vec4(1.0, 0.0, 0.0, -1.0);\n}\n\nvoid main() {\n\tvUv = color.xy;\n\tSMAANeighborhoodBlendingVS(vUv);\n\tgl_Position = vec4(point, 1.0);\n}\n"},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D blendTex;\nuniform sampler2D colorTex;\nuniform vec2 resolution;\nvarying vec2 vUv;\nvarying vec4 vOffset[2];\nvec4 SMAANeighborhoodBlendingPS(vec2 texcoord, vec4 offset[2], sampler2D colorTex, sampler2D blendTex) {\n\tvec4 a;\n\ta.xz = texture2D( blendTex, texcoord ).xz;\n\ta.y = texture2D( blendTex, offset[1].zw ).g;\n\ta.w = texture2D( blendTex, offset[1].xy ).a;\n\tif (dot(a, vec4(1.0, 1.0, 1.0, 1.0)) < 1e-5) {\n\t\treturn texture2D(colorTex, texcoord, 0.0);\n\t}\n  else {\n\t\tvec2 offset;\n\t\toffset.x = a.a > a.b ? a.a : -a.b;\n\t\toffset.y = a.g > a.r ? -a.g : a.r;\n\t\tif (abs(offset.x) > abs(offset.y)) {\n\t\t\toffset.y = 0.0;\n\t\t}\n    else {\n\t\t\toffset.x = 0.0;\n\t\t}\n\t\tvec4 C = texture2D(colorTex, texcoord, 0.0);\n\t\ttexcoord += sign(offset) * resolution;\n\t\tvec4 Cop = texture2D(colorTex, texcoord, 0.0);\n\t\tfloat s = abs(offset.x) > abs(offset.y) ? abs(offset.x) : abs(offset.y);\n\t\tC.xyz = pow(C.xyz, vec3(2.2));\n\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));\n\t\tif (C.a == 0.0) {\n\t\t\tC = mix(C, Cop, 0.0125);\n\t\t}\n\t\telse if (Cop.a == 0.0) {\n\t\t\tCop = mix(Cop, C, 0.0125);\n\t\t}\n\t\tvec4 mixed = mix(C, Cop, s);\n\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));\n\t\treturn mixed;\n\t}\n}\nvoid main() {\n\tgl_FragColor = SMAANeighborhoodBlendingPS(vUv, vOffset, colorTex, blendTex);\n}\n"},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.searchTexture=e.areaTexture=void 0,e.areaTexture="data:image/png;base64,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",e.searchTexture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(7)),o=r(n(3)),s=r(n(4)),u=r(n(12)),l=r(n(17)),c=r(n(9)),h=r(n(10)),f=r(n(8)),d=r(n(5)),p=r(n(82)),v=r(n(50)),g=i(n(6)),E=r(n(51)),_=r(n(301)),y=r(n(302)),m=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!a.default)return!1;if(a.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,a.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,f.default)(t);if(e){var r=(0,f.default)(this).constructor;n=(0,a.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,h.default)(this,n)}}(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.PRESET_ULTRA;return(0,o.default)(this,n),i=e.call(this,t,new v.default(t,"#define SMAA_PRESET_".concat(r," \n ").concat(_.default)),new E.default(t,"#define SMAA_PRESET_".concat(r," \n ").concat(y.default))),(0,d.default)((0,u.default)(i),"edgesTexLocation",void 0),(0,d.default)((0,u.default)(i),"areaTexLocation",void 0),(0,d.default)((0,u.default)(i),"searchTexLocation",void 0),(0,d.default)((0,u.default)(i),"edgesTextureUnit",void 0),(0,d.default)((0,u.default)(i),"areaTextureUnit",void 0),(0,d.default)((0,u.default)(i),"searchTexUnit",void 0),i}return(0,s.default)(n,[{key:"link",value:function(){(0,l.default)((0,f.default)(n.prototype),"link",this).call(this),this.edgesTexLocation=this.gl.getUniformLocation(this.program,"edgesTex"),this.areaTexLocation=this.gl.getUniformLocation(this.program,"areaTex"),this.searchTexLocation=this.gl.getUniformLocation(this.program,"searchTex")}},{key:"bindEdgesTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.edgesTextureUnit=t,this.gl.uniform1i(this.edgesTexLocation,t)}},{key:"bindAreaTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.areaTextureUnit=t,this.gl.uniform1i(this.areaTexLocation,t)}},{key:"bindSearchTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.searchTexUnit=t,this.gl.uniform1i(this.searchTexLocation,t)}}]),n}(p.default);e.default=m},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\n#define GLSLIFY 1\n\n#if defined(SMAA_PRESET_LOW)\n#define SMAA_MAX_SEARCH_STEPS 4\n#elif defined(SMAA_PRESET_MEDIUM)\n#define SMAA_MAX_SEARCH_STEPS 8\n#elif defined(SMAA_PRESET_HIGH)\n#define SMAA_MAX_SEARCH_STEPS 16\n#elif defined(SMAA_PRESET_ULTRA)\n#define SMAA_MAX_SEARCH_STEPS 32\n#endif\n\n#ifndef SMAA_MAX_SEARCH_STEPS\n#define SMAA_MAX_SEARCH_STEPS 8\n#endif\n\nattribute vec3 point;\nattribute vec4 color;\n\nuniform vec2 resolution;\n\nvarying vec2 vUv;\nvarying vec4 vOffset[3];\nvarying vec2 vPixcoord;\n\nvoid SMAABlendingWeightCalculationVS(vec2 texcoord) {\n\tvPixcoord = texcoord / resolution;\n\tvOffset[0] = texcoord.xyxy + resolution.xyxy * vec4(-0.25, 0.125, 1.25, 0.125);\n\tvOffset[1] = texcoord.xyxy + resolution.xyxy * vec4(-0.125, 0.25, -0.125, -1.25);\n\tvOffset[2] = vec4(vOffset[0].xz, vOffset[1].yw) + vec4(-2.0, 2.0, -2.0, 2.0) * resolution.xxyy * float(SMAA_MAX_SEARCH_STEPS);\n}\nvoid main() {\n\tvUv = color.xy;\n\tSMAABlendingWeightCalculationVS(vUv);\n\tgl_Position = vec4(point, 1.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\nprecision highp int;\n#define GLSLIFY 1\n\n// Presets\n#if defined(SMAA_PRESET_LOW)\n#define SMAA_MAX_SEARCH_STEPS 4\n#elif defined(SMAA_PRESET_MEDIUM)\n#define SMAA_MAX_SEARCH_STEPS 8\n#elif defined(SMAA_PRESET_HIGH)\n#define SMAA_MAX_SEARCH_STEPS 16\n#elif defined(SMAA_PRESET_ULTRA)\n#define SMAA_MAX_SEARCH_STEPS 32\n#endif\n\n// Defaults\n#ifndef SMAA_MAX_SEARCH_STEPS\n#define SMAA_MAX_SEARCH_STEPS 8\n#endif\n\n// Non-Configurable Defines\n#define SMAA_AREATEX_MAX_DISTANCE 16\n#define SMAA_AREATEX_PIXEL_SIZE (1.0 / vec2(160.0, 560.0))\n#define SMAA_AREATEX_SUBTEX_SIZE (1.0 / 7.0)\n\n#define SMAASampleLevelZeroOffset(tex, coord, offset) texture2D(tex, coord + float(offset) * resolution, 0.0)\n\nuniform sampler2D edgesTex;\nuniform sampler2D areaTex;\nuniform sampler2D searchTex;\n\nuniform vec2 resolution;\nvarying vec2 vUv;\nvarying vec4 vOffset[3];\nvarying vec2 vPixcoord;\n\n#if __VERSION__ == 100\nvec2 round( vec2 x ) {\n\treturn sign( x ) * floor( abs( x ) + 0.5 );\n}\n#endif\n\nfloat SMAASearchLength(sampler2D searchTex, vec2 e, float bias, float scale) {\n\te.r = bias + e.r * scale;\n\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;\n}\n\nfloat SMAASearchXLeft(sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end) {\n\tvec2 e = vec2( 0.0, 1.0 );\n\tfor (int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++) {\n\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;\n\t\tif (!(texcoord.x > end && e.g > 0.8281 && e.r == 0.0)) {\n      break;\n    }\n\t}\n\ttexcoord.x += 0.25 * resolution.x;\n\ttexcoord.x += resolution.x;\n\ttexcoord.x += 2.0 * resolution.x;\n\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n\n\treturn texcoord.x;\n}\n\nfloat SMAASearchXRight(sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end) {\n\tvec2 e = vec2( 0.0, 1.0 );\n\tfor (int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++) {\n\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;\n\t\tif (!(texcoord.x < end && e.g > 0.8281 && e.r == 0.0)) {\n      break;\n    }\n\t}\n\ttexcoord.x -= 0.25 * resolution.x;\n\ttexcoord.x -= resolution.x;\n\ttexcoord.x -= 2.0 * resolution.x;\n\ttexcoord.x += resolution.x * SMAASearchLength(searchTex, e, 0.5, 0.5);\n\n\treturn texcoord.x;\n}\n\nfloat SMAASearchYUp(sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end) {\n\tvec2 e = vec2( 1.0, 0.0 );\n\tfor (int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++) {\n\t\te = texture2D(edgesTex, texcoord, 0.0).rg;\n\t\ttexcoord += vec2(0.0, 2.0) * resolution;\n\t\tif (!(texcoord.y > end && e.r > 0.8281 && e.g == 0.0)) {\n      break;\n    }\n\t}\n\ttexcoord.y -= 0.25 * resolution.y;\n\ttexcoord.y -= resolution.y;\n\ttexcoord.y -= 2.0 * resolution.y;\n\ttexcoord.y += resolution.y * SMAASearchLength(searchTex, e.gr, 0.0, 0.5);\n\n\treturn texcoord.y;\n}\n\nfloat SMAASearchYDown(sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end) {\n\tvec2 e = vec2( 1.0, 0.0 );\n\tfor (int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++) {\n\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution;\n\t\tif (!(texcoord.y < end && e.r > 0.8281 && e.g == 0.0)) {\n      break;\n    }\n\t}\n\ttexcoord.y += 0.25 * resolution.y;\n\ttexcoord.y += resolution.y;\n\ttexcoord.y += 2.0 * resolution.y;\n\ttexcoord.y -= resolution.y * SMAASearchLength(searchTex, e.gr, 0.5, 0.5);\n\n\treturn texcoord.y;\n}\n\nvec2 SMAAArea(sampler2D areaTex, vec2 dist, float e1, float e2, float offset) {\n\tvec2 texcoord = float(SMAA_AREATEX_MAX_DISTANCE) * round(4.0 * vec2(e1, e2)) + dist;\n\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + (0.5 * SMAA_AREATEX_PIXEL_SIZE);\n\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;\n\treturn texture2D(areaTex, texcoord, 0.0).rg;\n}\n\nvec4 SMAABlendingWeightCalculationPS(vec2 texcoord, vec2 pixcoord, vec4 offset[3], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices) {\n\tvec4 weights = vec4(0.0, 0.0, 0.0, 0.0);\n\tvec2 e = texture2D(edgesTex, texcoord).rg;\n\tif (e.g > 0.0) {\n\t\tvec2 d;\n\t\tvec2 coords;\n\t\tcoords.x = SMAASearchXLeft(edgesTex, searchTex, offset[0].xy, offset[2].x);\n\t\tcoords.y = offset[1].y;\n\t\td.x = coords.x;\n\t\tfloat e1 = texture2D(edgesTex, coords, 0.0).r;\n\t\tcoords.x = SMAASearchXRight(edgesTex, searchTex, offset[0].zw, offset[2].y);\n\t\td.y = coords.x;\n\t\td = d / resolution.x - pixcoord.x;\n\t\tvec2 sqrt_d = sqrt(abs(d));\n\t\tcoords.y -= 1.0 * resolution.y;\n\t\tfloat e2 = SMAASampleLevelZeroOffset(edgesTex, coords, ivec2(1, 0)).r;\n\t\tweights.rg = SMAAArea(areaTex, sqrt_d, e1, e2, float(subsampleIndices.y));\n\t}\n\tif (e.r > 0.0) {\n\t\tvec2 d;\n\t\tvec2 coords;\n\t\tcoords.y = SMAASearchYUp(edgesTex, searchTex, offset[1].xy, offset[2].z);\n\t\tcoords.x = offset[0].x;\n\t\td.x = coords.y;\n\t\tfloat e1 = texture2D(edgesTex, coords, 0.0).g;\n\t\tcoords.y = SMAASearchYDown(edgesTex, searchTex, offset[1].zw, offset[2].w);\n\t\td.y = coords.y;\n\t\td = d / resolution.y - pixcoord.y;\n\t\tvec2 sqrt_d = sqrt(abs(d));\n\t\tcoords.y -= 1.0 * resolution.y;\n\t\tfloat e2 = SMAASampleLevelZeroOffset(edgesTex, coords, ivec2(0, 1)).g;\n\t\tweights.ba = SMAAArea(areaTex, sqrt_d, e1, e2, float(subsampleIndices.x));\n\t}\n\treturn weights;\n}\nvoid main() {\n\tgl_FragColor = SMAABlendingWeightCalculationPS(vUv, vPixcoord, vOffset, edgesTex, areaTex, searchTex, ivec4(0.0));\n}\n"},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(9)),l=i(n(10)),c=i(n(8)),h=i(n(5)),f=function(t){(0,u.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,c.default)(t);if(e){var a=(0,c.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}(n);function n(t,i,r,o,u){var l;return(0,a.default)(this,n),l=e.call(this,t,i,r,u),(0,h.default)((0,s.default)(l),"page",void 0),l.page=o,l}return(0,o.default)(n,[{key:"getPage",value:function(){return this.page}},{key:"toDrawVertices",value:function(t,e){var n=1-2*this.page;if(e){var i=t+1-(n-2);return[-1,1,0,0,i/2,0,0,-1,1-i,0,0,0,0,0,1,1,0,1,i/2,0,0,1,1-i,0,1,0,0,0]}var r=n-(t-1);return[-1,-1+r,0,0,1,0,0,-1,-1,0,0,1-r/2,0,0,1,-1+r,0,1,1,0,0,1,-1,0,1,1-r/2,0,0]}},{key:"toSaveVertices",value:function(t,e){var n=1-2*this.page;if(e){var i=t+1-(n-2);return[-1,-1+i,0,0,1,0,0,-1,-1,0,0,1-i/2,0,0,1,-1+i,0,1,1,0,0,1,-1,0,1,1-i/2,0,0]}var r=n-(t-1);return[-1,1,0,0,r/2,0,0,-1,1-r,0,0,0,0,0,1,1,0,1,r/2,0,0,1,1-r,0,1,0,0,0]}}]),n}(i(n(152)).default);e.default=f},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(3)),o=r(n(4)),s=r(n(5)),u=r(n(110)),l=i(n(6)),c=function(){function t(e,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;(0,a.default)(this,t),(0,s.default)(this,"width",void 0),(0,s.default)(this,"height",void 0),(0,s.default)(this,"imageData",void 0),(0,s.default)(this,"offsetX",void 0),(0,s.default)(this,"offsetY",void 0),(0,s.default)(this,"texture",void 0),(0,s.default)(this,"x",void 0),(0,s.default)(this,"y",void 0),(0,s.default)(this,"devicePixelRatio",void 0),this.width=2*n,this.height=2*i,this.imageData=r,this.offsetX=2*o,this.offsetY=2*l,this.devicePixelRatio=c,this.texture=new u.default(e,r,n,i),this.texture.bind(),this.texture.setFormat(e.RGB),this.texture.setFilter(e.LINEAR),this.texture.init(),this.texture.setImageData(),this.x=this.y=-2}return(0,o.default)(t,[{key:"updatePointer",value:function(t,e){this.x=t,this.y=e}},{key:"toVertices",value:function(t){var e=this.x+this.offsetX*this.devicePixelRatio/t.getWidth(),n=this.y-this.offsetY*this.devicePixelRatio/t.getHeight(),i=e+this.width*this.devicePixelRatio/t.getWidth(),r=n-this.height*this.devicePixelRatio/t.getHeight();return[e,n,0,0,1,0,0,e,r,0,0,0,0,0,i,n,0,1,1,0,0,i,r,0,1,0,0,0]}},{key:"drawGLPath",value:function(t,e){return t.enableTexture(l.TRUE),t.bindTextureData(this.imageData),t.gl.blendFunc(t.gl.SRC_ALPHA,t.gl.ONE_MINUS_SRC_ALPHA),t.gl.drawArrays(t.gl.TRIANGLE_STRIP,e,4),t.resetAlphaFunc(),t.enableTexture(l.FALSE),4}}]),t}();e.default=c},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a,o=r(n(3)),s=r(n(4)),u=r(n(5)),l=r(n(109)),c=i(n(11)),h=r(n(43)),f=i(n(6)),d=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,o.default)(this,t),(0,u.default)(this,"tasks",void 0),(0,u.default)(this,"outSpeed",void 0),(0,u.default)(this,"timer",void 0),this.tasks=[],this.outSpeed=n,this.timer=new l.default((function(){return e.execute()}),null,this.outSpeed)}return(0,s.default)(t,null,[{key:"shared",value:function(){return a||(a=new t)}}]),(0,s.default)(t,[{key:"append",value:function(t){this.tasks.push(t),this.timer.isStarted()||this.timer.start()}},{key:"execute",value:function(){var t=this.tasks.shift();return t&&(0,h.default)(t.fn,t.ctx,t.args),!!this.tasks.length}},{key:"flush",value:function(){this.timer.isStarted()&&this.timer.stop(),this.tasks.length&&c.each(this.tasks,(function(t){(0,h.default)(t.fn,t.ctx,t.args)}),f.TRUE)}},{key:"update",value:function(t){this.outSpeed=t,this.timer.updateInterval(t)}},{key:"destroy",value:function(){this.timer&&this.timer.isStarted()&&this.timer.stop()}}]),t}();e.default=d},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(30)),o=r(n(60)),s=r(n(31)),u=r(n(3)),l=r(n(4)),c=r(n(5)),h=r(n(307)),f=i(n(11)),d=i(n(27)),p=r(n(26)),v=i(n(20)),g=r(n(13)),E=0,_=function(){function t(e,n,i,r,a){(0,u.default)(this,t),(0,c.default)(this,"canvasElement",void 0),(0,c.default)(this,"width",void 0),(0,c.default)(this,"height",void 0),(0,c.default)(this,"worker",void 0),(0,c.default)(this,"emitter",void 0),(0,c.default)(this,"ctx",void 0),(0,c.default)(this,"holder",void 0),(0,c.default)(this,"shareBuffer",void 0),(0,c.default)(this,"eventDataView",void 0),(0,c.default)(this,"config",void 0),this.canvasElement=e,this.width=n,this.height=i,this.canvasElement.width=n,this.canvasElement.height=i,this.config=a,this.worker=(0,h.default)(308),this.emitter=r,this.holder={},this.shareBuffer=new SharedArrayBuffer(9*Float32Array.BYTES_PER_ELEMENT),this.eventDataView=new Float32Array(this.shareBuffer),this.worker.addEventListener("message",this.handleMessage.bind(this))}var e,n,i,r,_;return(0,l.default)(t,[{key:"handleMessage",value:function(t){var e=t.data,n=e.type,i=e.data;switch(n){case"ready":this.holder.ready&&(this.holder.ready.resolve(),delete this.holder.ready);break;case"error":this.holder.ready&&(this.holder.ready.reject(),delete this.holder.ready);break;case"trigger":this.emitter.fire(i.type,i.data);break;case"callback":this.holder[e.uid]&&(this.holder[e.uid].resolve(i),delete this.holder[e.uid])}}},{key:"ready",value:(_=(0,s.default)(a.default.mark((function t(e,n){var i=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new o.default((function(t,r){i.holder.ready={resolve:t,reject:r};var a=i.canvasElement.transferControlToOffscreen();a.width=i.width,a.height=i.height;var o=d.extend({},i.config);o.container&&delete o.container,i.worker.postMessage({type:"ready",data:{canvas:a,width:i.width,height:i.height,devicePixelRatio:i.config.devicePixelRatio,shareBuffer:i.shareBuffer,canPaint:e,canWheel:n,options:o}},[a])})));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return _.apply(this,arguments)})},{key:"setCanPaint",value:function(t){this.worker.postMessage({type:"call",data:{name:"setCanPaint",data:[t]}})}},{key:"setEventData",value:function(t){this.eventDataView[0]=t.x,this.eventDataView[1]=t.y,this.eventDataView[2]=t.realX,this.eventDataView[3]=t.realY,this.eventDataView[4]=t.glX,this.eventDataView[5]=t.glY,this.eventDataView[6]=t.pageX,this.eventDataView[7]=t.pageY,this.eventDataView[8]=t.inCanvas?1:0}},{key:"mouseDownHandler",value:function(t,e){this.setEventData(e),this.worker.postMessage({type:"mouseEvent",data:{event:t}})}},{key:"mouseMoveHandler",value:function(t,e){this.setEventData(e),this.worker.postMessage({type:"mouseEvent",data:{event:t}})}},{key:"mouseUpHandler",value:function(t,e){this.setEventData(e),this.worker.postMessage({type:"mouseEvent",data:{event:t}})}},{key:"dblclickHandler",value:function(t,e){this.worker.postMessage({type:"mouseEvent",data:{event:t,data:e}})}},{key:"onMouseWheel",value:function(t,e){this.worker.postMessage({type:"mouseEvent",data:{event:t,data:e}})}},{key:"setPainterShape",value:function(t){this.worker.postMessage({type:"call",data:{name:"setPainterShape",data:[t]}})}},{key:"resize",value:(r=(0,s.default)(a.default.mark((function t(e,n){var i=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new o.default((function(t,r){i.width=e,i.height=n;var a=E++;i.holder[a]={resolve:t,reject:r},i.worker.postMessage({type:"callback",uid:a,data:{name:"resize",data:[e,n]}})})));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})},{key:"viewport",value:(i=(0,s.default)(a.default.mark((function t(e,n){var i=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new o.default((function(t,r){i.width=e,i.height=n;var a=E++;i.holder[a]={resolve:t,reject:r},i.worker.postMessage({type:"callback",uid:a,data:{name:"viewport",data:[e,n]}})})));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return i.apply(this,arguments)})},{key:"hasPrev",value:(n=(0,s.default)(a.default.mark((function t(){var e=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new o.default((function(t,n){var i=E++;e.holder[i]={resolve:t,reject:n},e.worker.postMessage({type:"callback",uid:i,data:{name:"hasPrev"}})})));case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"hasNext",value:(e=(0,s.default)(a.default.mark((function t(){var e=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new o.default((function(t,n){var i=E++;e.holder[i]={resolve:t,reject:n},e.worker.postMessage({type:"callback",uid:i,data:{name:"hasNext"}})})));case 1:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"prev",value:function(){this.worker.postMessage({type:"call",data:{name:"prev"}})}},{key:"next",value:function(){this.worker.postMessage({type:"call",data:{name:"next"}})}},{key:"clear",value:function(t){this.worker.postMessage({type:"call",data:{name:"clear",data:[t]}})}},{key:"addShape",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.fill instanceof p.default&&(e.fill=e.fill.toString()),e.stroke instanceof p.default&&(e.stroke=e.stroke.toString()),v.array(e.points)&&f.each(e.points,(function(t,n){t instanceof g.default&&(e.points[n]={x:t.x,y:t.y,z:t.z})})),this.worker.postMessage({type:"call",data:{name:"addShape",data:[t,e,n,i]}})}},{key:"addShapes",value:function(t){this.worker.postMessage({type:"call",data:{name:"addShapes",data:[t]}})}},{key:"appendShape",value:function(t,e){e.fill instanceof p.default&&(e.fill=e.fill.toString()),e.stroke instanceof p.default&&(e.stroke=e.stroke.toString()),v.array(e.points)&&f.each(e.points,(function(t,n){t instanceof g.default&&(e.points[n]={x:t.x,y:t.y,z:t.z})})),this.worker.postMessage({type:"call",data:{name:"appendShape",data:[t,e]}})}},{key:"updateShapes",value:function(t){this.worker.postMessage({type:"call",data:{name:"updateShapes",data:[t]}})}},{key:"removeShapes",value:function(t){this.worker.postMessage({type:"call",data:{name:"removeShapes",data:[t]}})}},{key:"deleteSelectedShapes",value:function(){this.worker.postMessage({type:"call",data:{name:"deleteSelectedShapes"}})}},{key:"scrollTop",value:function(t){this.worker.postMessage({type:"call",data:{name:"scrollTop",data:[t]}})}},{key:"updateShapeSetting",value:function(t){this.worker.postMessage({type:"call",data:{name:"updateShapeSetting",data:[t]}})}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.emitter.on(t,e,n);var i=d.copy(n);return delete i.ctx,delete i.fn,this.worker.postMessage({type:"on",data:{event:t,options:i}}),this}},{key:"off",value:function(t,e){return this.emitter.off(t,e),this.emitter.has(t)||this.worker.postMessage({type:"off",data:{event:t}}),this}},{key:"fire",value:function(t,e){this.emitter.fire(t,e)}},{key:"setOptions",value:function(t){delete t.container,this.worker.postMessage({type:"options",data:[t]})}},{key:"addLabelTexture",value:function(t,e){this.worker.postMessage({type:"call",data:{name:"addLabelTexture",data:[t,e]}})}},{key:"initCursor",value:function(t){this.worker.postMessage({type:"call",data:{name:"initCursor",data:[t]}})}},{key:"moveCursor",value:function(t,e){this.worker.postMessage({type:"call",data:{name:"moveCursor",data:[t,e]}})}},{key:"refresh",value:function(){this.worker.postMessage({type:"call",data:{name:"refresh"}})}},{key:"destroy",value:function(){this.worker&&(this.worker.terminate(),this.worker=null),this.emitter.off(),this.emitter=null}}]),t}();e.default=_},function(t,e,n){function i(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n.oe=function(t){throw console.error(t),t};var i=n(n.s=ENTRY_MODULE);return i.default||i}var r="[\\.|\\-|\\+|\\w|/|@]+",a="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+r+").*?\\)";function o(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(t,e,i){var s={};s[i]=[];var u=e.toString(),l=u.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return s;for(var c,h=l[1],f=new RegExp("(\\\\n|\\W)"+o(h)+a,"g");c=f.exec(u);)"dll-reference"!==c[3]&&s[i].push(c[3]);for(f=new RegExp("\\("+o(h)+'\\("(dll-reference\\s('+r+'))"\\)\\)'+a,"g");c=f.exec(u);)t[c[2]]||(s[i].push(c[1]),t[c[2]]=n(c[1]).m),s[c[2]]=s[c[2]]||[],s[c[2]].push(c[4]);for(var d,p=Object.keys(s),v=0;v<p.length;v++)for(var g=0;g<s[p[v]].length;g++)d=s[p[v]][g],isNaN(1*d)||(s[p[v]][g]=1*s[p[v]][g]);return s}function u(t){return Object.keys(t).reduce((function(e,n){return e||t[n].length>0}),!1)}t.exports=function(t,e){e=e||{};var r={main:n.m},a=e.all?{main:Object.keys(r.main)}:function(t,e){for(var n={main:[e]},i={main:[]},r={main:{}};u(n);)for(var a=Object.keys(n),o=0;o<a.length;o++){var l=a[o],c=n[l].pop();if(r[l]=r[l]||{},!r[l][c]&&t[l][c]){r[l][c]=!0,i[l]=i[l]||[],i[l].push(c);for(var h=s(t,t[l][c],l),f=Object.keys(h),d=0;d<f.length;d++)n[f[d]]=n[f[d]]||[],n[f[d]]=n[f[d]].concat(h[f[d]])}}return i}(r,t),o="";Object.keys(a).filter((function(t){return"main"!==t})).forEach((function(t){for(var e=0;a[t][e];)e++;a[t].push(e),r[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",o=o+"var "+t+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a[t].map((function(e){return JSON.stringify(e)+": "+r[t][e].toString()})).join(",")+"});\n"})),o=o+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a.main.map((function(t){return JSON.stringify(t)+": "+r.main[t].toString()})).join(",")+"}))(self);";var l=new window.Blob([o],{type:"text/javascript"});if(e.bare)return l;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),h=new window.Worker(c);return h.objectURL=c,h}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(139)),o=r(n(113)),s=r(n(43)),u=i(n(20)),l=i(n(63));e.default=function(t){var e,n,i;function r(e){t.postMessage(e)}function c(t,e){r({type:"trigger",data:{type:t,data:e}})}function h(){return{x:i[0],y:i[1],realX:i[2],realY:i[3],glX:i[4],glY:i[5],pageX:i[6],pageY:i[7],inCanvas:1===i[8]}}function f(t){n=t.shareBuffer,i=new Float32Array(n),(e=new a.default(t.canvas,t.width,t.height,new o.default,t.options)).ready(t.canPaint,t.canWheel).then((function(){r({type:"ready"})})).catch((function(t){!function(t){r({type:"error",error:t})}(t)}))}t.addEventListener("message",(function(t){var n=t.data,i=n.type,a=n.data;switch(i){case"ready":f(a);break;case"mouseEvent":!function(t,n){switch(t){case l.MOUSE_DOWN:e.mouseDownHandler(l.MOUSE_DOWN,h());break;case l.MOUSE_MOVE:e.mouseMoveHandler(l.MOUSE_MOVE,h());break;case l.MOUSE_UP:e.mouseUpHandler(l.MOUSE_UP,h());break;case l.MOUSE_WHEEL_DOWN:e.onMouseWheel(l.MOUSE_WHEEL_DOWN,n);break;case l.MOUSE_WHEEL_UP:e.onMouseWheel(l.MOUSE_WHEEL_UP,n);break;case l.MOUSE_DBLCLICK:e.dblclickHandler(l.MOUSE_DBLCLICK,n)}}(a.event,a.data);break;case"call":!function(t,n){u.func(e[t])&&(0,s.default)(e[t],e,n)}(a.name,a.data);break;case"callback":!function(t,n,i){u.func(e[t])&&r({type:"callback",uid:i,data:(0,s.default)(e[t],e,n)})}(a.name,a.data,n.uid);break;case"on":!function(t,n){e.has(t,c)||e.on(t,c,n)}(a.event,a.options);break;case"off":!function(t){e.has(t,c)&&e.off(t,c)}(a.event)}}))}},function(t,e,n){"use strict";var i=n(2),r=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(159)),o=r(n(3)),s=r(n(4)),u=r(n(5)),l=r(n(13)),c=i(n(27)),h=i(n(32)),f=r(n(312)),d=i(n(6)),p=r(n(108)),v=r(n(35)),g=i(n(63)),E=r(n(313)),_=i(n(20)),y=function(){function t(e,n,i,r){var s=this;(0,o.default)(this,t),(0,u.default)(this,"namespace",void 0),(0,u.default)(this,"scrollTop",0),(0,u.default)(this,"canvas",void 0),(0,u.default)(this,"disabled",void 0),(0,u.default)(this,"documentEvents",void 0),(0,u.default)(this,"canvasEvents",void 0),(0,u.default)(this,"mousemoveThrotting",void 0),(0,u.default)(this,"mouseWheelHandler",void 0),(0,u.default)(this,"emitter",void 0),(0,u.default)(this,"container",void 0),(0,u.default)(this,"canvasOffset",void 0),(0,u.default)(this,"containerOffset",void 0),(0,u.default)(this,"config",void 0),(0,u.default)(this,"lineWidth",void 0),e.style.touchAction="none",this.namespace=".paintergl_canvas",this.canvas=e,this.emitter=i,this.container=n,this.config=r,this.lineWidth=2,this.canvasOffset={x:0,y:0},this.containerOffset={x:0,y:0};var y=(0,f.default)(document)?null:document;if(y){var T,A,R,S,x,P,O,I,w,b,D=!!window.PointerEvent,C=300*this.config.devicePixelRatio,L=0,N=function(t){var n=t.target;if("CANVAS"===n.tagName&&n===e)O=!0;else{var i=n.className;if("string"==typeof i&&i.indexOf("cursor")>=0){var r=n.getAttribute("canvas-id");O=!r||r===e.id}else O=!1}},M=function(t){var e=t.touches;!function(t){x=t.pageX,P=t.pageY,T=x-s.canvasOffset.x,A=P-s.canvasOffset.y,n&&(T+=n.scrollLeft,A+=n.scrollTop),R=T*s.config.devicePixelRatio,S=A*s.config.devicePixelRatio+Math.floor(s.canvas.height*s.scrollTop)}(e?e[0]:t)},k=function(t,e){(w||O)&&s.fire(t,e)},U=function(t){if(b=0,L=0,N(t),!s.disabled&&!t.button){if(I=!0,w)return void G();O&&(w=!0,s.updateOffset()),M(t),k(g.MOUSE_DOWN,{x:s.xTo2dX(R),y:s.yTo2dY(S),realX:T,realY:A,pageX:x,pageY:P,glX:s.xToGlX(R),glY:s.yToGlY(S),inCanvas:O})}},G=function(){I&&(I=!1,k(g.MOUSE_UP,{x:s.xTo2dX(R),y:s.yTo2dY(S),realX:T,realY:A,pageX:x,pageY:P,glX:s.xToGlX(R),glY:s.yToGlY(S),inCanvas:O}),w&&(w=!1))};this.mousemoveThrotting=(0,p.default)((function(t){if(!s.disabled){var e=R,n=S;N(t),M(t);var i=(0,v.default)(new l.default(e,n),new l.default(R,S)),r=(0,a.default)(),o=0;if(b)if(_.number(t.pressure)&&-1===t.detail)o=1-t.pressure;else{o=i/(s.config.maxSpeed*s.config.devicePixelRatio)/(r-b||1)*1e3;var u=s.getThreshold();Math.abs(o-L)>u&&(o=L+(o>L?u/2:-u/2))}b=r,o>1&&(o=1),o<0&&(o=0),L=o,i>0&&i<C&&k(g.MOUSE_MOVE,{x:s.xTo2dX(R),y:s.yTo2dY(S),realX:T,realY:A,pageX:x,pageY:P,glX:s.xToGlX(R),glY:s.yToGlY(S),inCanvas:!!w||O,drawing:w,speed:o})}}),0,d.TRUE);var F=this.mousemoveThrotting.handler,V={},H=function(t,e){y.addEventListener(t,e),V[t]=e};D?(H("pointerdown",U),H("pointerup",G),H("pointermove",F)):(H("mousedown",U),H("mousemove",F),H("mouseup",G),H("touchstart",U),H("touchmove",F),H("touchend",G)),H("dblclick",(function(t){N(t),s.disabled||t.button||(O&&s.updateOffset(),M(t),k(g.MOUSE_DBLCLICK,{x:s.xTo2dX(R),y:s.yTo2dY(S),realX:T,realY:A,pageX:x,pageY:P,glX:s.xToGlX(R),glY:s.yToGlY(S),inCanvas:O,canvasOffsetX:s.canvasOffset.x,canvasOffsetY:s.canvasOffset.y,containerScrollX:s.container?s.container.scrollLeft:0,containerScrollY:s.config.useWebGL&&s.config.totalPage>1?s.canvas.height*s.scrollTop/s.config.devicePixelRatio:s.container?s.container.scrollTop:0}))})),m&&H("keyup",(function(t){if(!s.disabled){var e=m[t.keyCode];e&&s.fire(e)}})),this.documentEvents=V,this.canvasEvents={},this.config.totalPage>1&&(this.mouseWheelHandler=function(t){var n=(t=t||window.event).target;"CANVAS"===n.tagName&&n===e&&(t.wheelDelta?(t.wheelDelta>0&&s.fire(g.MOUSE_WHEEL_UP,{speed:t.wheelDelta}),t.wheelDelta<0&&s.fire(g.MOUSE_WHEEL_DOWN,{speed:t.wheelDelta})):t.detail&&(t.detail>0&&s.fire(g.MOUSE_WHEEL_UP,{speed:t.detail}),t.detail<0&&s.fire(g.MOUSE_WHEEL_DOWN,{speed:t.detail})),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)}),this.mouseWheelHandler&&(y.mozFullScreen?H("DOMMouseScroll",this.mouseWheelHandler):H("mousewheel",this.mouseWheelHandler)),this.emitter.on(g.ACTIVE_DRAG_BOX_ENTER+this.namespace,(function(t,e){e.direction===d.DIRECTION.ROTATE?s.setCursor("url(".concat(E.default,") 8 8, auto")):s.setCursor(d.DRAG_CURSOR[e.direction])})).on(g.ACTIVE_DRAG_BOX_LEAVE+this.namespace,(function(t,e){s.setCursor(d.DRAG_CURSOR[d.CURSOR_UNSET])})).on(g.ACTIVE_RECT_MOVE_START+this.namespace,(function(t,e){s.setCursor(d.DRAG_CURSOR[d.CURSOR_MOVE])})).on(g.ACTIVE_RECT_MOVE_END+this.namespace,(function(t,e){s.setCursor(d.DRAG_CURSOR[d.CURSOR_UNSET])})).on(g.ACTIVE_ROTATE_START+this.namespace,(function(t,e){s.setCursor("url(".concat(E.default,") 8 8, auto"))})).on(g.DRAG_CURSOR_CHANGE+this.namespace,(function(t,e){s.setCursor(e.cursor)})).on(g.MOUSEMOVE_DELAY_CHANGE_TRIGGER+this.namespace,(function(t,e){s.updateDelay(e.delay)})).on(g.SCROLL_TOP_CHANGE+this.namespace,(function(t,e){s.setScrollTop(e.scrollTop)})).on(g.CANVAS_CURSOR_CHANGE+this.namespace,(function(t,e){c.has(d.DRAG_CURSOR,e.cursor)&&s.setCursor(d.DRAG_CURSOR[e.cursor])}))}else h.fatal("document is null")}return(0,s.default)(t,[{key:"fire",value:function(t,e){this.emitter.fire(t,e)}},{key:"setScrollTop",value:function(t){this.scrollTop=t}},{key:"xToGlX",value:function(t){return 2*t/this.canvas.width-1}},{key:"yToGlY",value:function(t){return 1-2*t/this.canvas.height}},{key:"xTo2dX",value:function(t){return t/this.canvas.width}},{key:"yTo2dY",value:function(t){return t/this.canvas.height}},{key:"setCursor",value:function(t){this.canvas.style.cursor=t}},{key:"updateDelay",value:function(t){this.mousemoveThrotting&&this.mousemoveThrotting.update(t)}},{key:"destroy",value:function(){var t=this.canvas,e=this.documentEvents,n=this.canvasEvents;e&&c.each(e,(function(t,e){document.removeEventListener(e,t)})),n&&c.each(n,(function(e,n){t.removeEventListener(n,e)})),this.namespace&&this.emitter.off(this.namespace)}},{key:"getOffset",value:function(t,e){t&&t.tagName&&(e.x+=t.offsetLeft,e.y+=t.offsetTop,"fixed"!==function(t,e){return window.getComputedStyle(t,null).getPropertyValue("position")}(t)&&this.getOffset(t.offsetParent,e))}},{key:"updateOffset",value:function(){this.canvasOffset.x=this.canvasOffset.y=this.containerOffset.x=this.containerOffset.y=0,this.getOffset(this.canvas,this.canvasOffset),this.container&&this.getOffset(this.container,this.containerOffset)}},{key:"getCanvasOffset",value:function(){return this.canvasOffset}},{key:"getContainerOffset",value:function(){return this.containerOffset}},{key:"getThreshold",value:function(){return this.lineWidth<=2?.5:this.lineWidth<=4?.4:this.lineWidth<=6?.3:.1}},{key:"setLineWidth",value:function(t){this.lineWidth=t}},{key:"dispatchEvent",value:function(t){this.canvas.dispatchEvent(t)}},{key:"dispatchEventByPosition",value:function(t,e,n,i){var r,a,o,s,u=new PointerEvent(t,{pointerId:0,width:1,height:1,pressure:i,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:"",isPrimary:!1,bubbles:!0,cancelable:!0,clientX:Math.floor(e*this.canvas.width/this.config.devicePixelRatio)+this.canvasOffset.x-(null!==(r=null===(a=this.container)||void 0===a?void 0:a.scrollLeft)&&void 0!==r?r:0),clientY:Math.floor(n*this.canvas.height/this.config.devicePixelRatio)+this.canvasOffset.y-(null!==(o=null===(s=this.container)||void 0===s?void 0:s.scrollTop)&&void 0!==o?o:0),detail:-1});this.dispatchEvent(u)}}]),t}();e.default=y;var m={8:g.ACTIVE_SHAPE_DELETE,36:g.CLEAR,46:g.ACTIVE_SHAPE_DELETE}},function(t,e,n){n(311),t.exports=n(14).Date.now},function(t,e,n){var i=n(16);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var i=n(2);n(0)(e,"__esModule",{value:!0}),e.default=function(t){return t===r.UNDEFINED};var r=i(n(6))},function(t,e,n){"use strict";n.r(e),e.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAlBJREFUOBHtU8+LEmEYHl0dQWkvWm25mKWFRO5py+hQEJpQ+j+IB2+xiZc8dFjZBW8qXhaWDTqGx4QCybWBRVyExNolImiXocmKVsLflk7PO+y4syP7D0QfPPO97/M83/u9844yzP+lnIAoivPAMlAFDoAu8Al4CtxVeuVYKwfqHQfi4GrFYvGO3+9nLRYLYzQaGbfbrU2n05eGw+E6PC+BM+qzx3IYNMCzZrNZt9lsAkSRYDKZ2lartSHnOp3udy6X24T3M2A7VkSZQIxTMYPB0KfD0Wh0q9frfQT/CxBGo1GD47gSXUB6NpstgX8LsMo6UgySZvYTnX0lc7Va5ZDXgVvADJmwnwfW8Mp78hvwPF8B90gqonyAXCkUCpt0LhaLbSGnmw1KjxyDjwuCsE1ej8fzAfmerE12KuD1et+RiTpAvjgRVQG0GeC9z+erk38wGJD/mhaPc8BzIA/harlcvmg2m5t6vf4C8ieHmltVj9FoNCNwr4PB4AFp6JbGdFmHx/XxeHw7EonsY+C1Tqdzg2XZP8gr0M6mUqlZfIAAYupcvXiXy7VAZL/fpwtmacjU5at8Pi/NDqT0M6E9mUy+gbYDnEI+tcBvJBIJDoLYbrdpjvclEwILsB8Oh6krqWAgEKiBawCOqUpkEsU54Ifdbv+C8QwR94DTEy+Sm3j1706nk3c4HDxiKuadGFQBtFX8i0qgxUwmU0L+QmWRbl1qtVq73W6X2l+aMigI6A9w6bdQKFShRpBfUchHIYQY8PCIOTmC7x5Alz8+2fXPK38BBNqoYMyC3fIAAAAASUVORK5CYII="},function(t,e,n){"use strict";n.r(e),e.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAphJREFUeAHtmjFOw0AQReMookwPEnRUIA6RGsEN4pY7UHMF6MMJQC6ococgUVFBJLgDTfgTYcmQrNfOX7Mb5Y80cbLeP5l9Gcvr3fR6idlisZjAXTZJLN1eP7WEti0fASR/MQEUQJIAKVcFCiBJgJSrAgWQJEDKVYECSBIg5apAASQJkHJVoACSBEi5KlAASQKkXBUogCQBUq4KFECSACkfkPou5HMEfXYEtnMyERABERABERABERABnkDGhwgXAf8o2kO0EfwCfgI/gJt9wF/gj/BplmVfOMpKAgDXh4/hb3CfWR/rq8dQAwgQQ3gBb2umGZY/wk4eDQB81pZcpb9pdxMiBm6X7SaVV+G3fGsxdu9yxqDz5fDDvOSxLuEod2Ews7vtK/wo0MDfEec4xt15gMFMAg2iGmaOwVxXG/68H+FzKHgW2mJZzCf7sM4wzhu0H647R7WFuYJWoszqkkLvuxUF33Dr+U7mZuXMrl/3pR2es0lyaDsNHbBJvFgA95sk17JPFzG9KcQC6E1sWzrEAvjZASB7Xv53iwXQFgZCWxcxvTnarty9t1f7Dr7dsweEvGoftlZhKzV1VuBk7eygTuw6p4m0i0zq7ZhY5c7JVfsT49THGzw/MNJiAksVELWcFQjiJstaWlAt4f9czjmOTZf0rW+sKViZ9vIY5S78K4PKB0ApN5Uu0WzPy+XjmU28bZ5n0x9tKgGCTAREQAREQAREQARIAknNA20smAva7tm5Y1yFZ7fPIeuuOcV/6dvW45ljyMHX8xzf07g5icehxtkm2FEAyR9FAAWQJEDKVYECSBIg5apAASQJkHJVoACSBEi5KlAASQKkXBUogCQBUq4KFECSAClXBQogSYCUqwIFkCRAyr8BwmkCg4uuRPYAAAAASUVORK5CYII="},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.getOptions=function(){return i};var i={container:null,useWebGL:!0,enableColorBufferCache:!0,shapeIdPrefix:"",shapeLabel:"",totalPage:1,enableBrushTip:!1,maxDoodlePointsCount:1e3,canUseWebGL2:!1,canUseWorker:!1,aa:"fxaa",smaaConfig:{threshold:.1,factor:8},devicePixelRatio:1,shapeAppendInterval:400,hoverColor:"#ffff00",enableDoodleCursor:!1,preserveDrawingBuffer:!1,textareaClass:"webgl-painter-textarea",enableScrollTextarea:!1,eraserSensitivity:5,maxSpeed:4e3,customCanvasEvent:!1}},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.AsyncQueue=void 0;var r=i(n(3)),a=i(n(4)),o=i(n(5)),s=i(n(43)),u=function(){function t(e,n){(0,r.default)(this,t),(0,o.default)(this,"fn",void 0),(0,o.default)(this,"ctx",void 0),(0,o.default)(this,"_success",void 0),this.fn=e,this.ctx=n,this._success=!1}return(0,a.default)(t,[{key:"success",value:function(){this._success=!0}},{key:"isSuccess",value:function(){return this._success}},{key:"run",value:function(){(0,s.default)(this.fn,this.ctx)}}]),t}(),l=function(){function t(){(0,r.default)(this,t),(0,o.default)(this,"queue",void 0),this.queue=[]}return(0,a.default)(t,[{key:"push",value:function(t,e){var n=new u(t,e);return this.queue.push(n),n}},{key:"success",value:function(t){t.success(),this.queue[0]===t&&(t.run(),this.queue.shift(),this.queue.length&&this.queue[0].isSuccess()&&this.success(this.queue[0]))}}]),t}();e.AsyncQueue=l},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n,i){var r=+(t/n).toFixed(6),a=+(e/i).toFixed(6);return r>a?r>1&&(t=n,e=Math.floor(e/r)):a>1&&(t=Math.floor(t/a),e=i),{width:t,height:e}}},function(t,e,n){"use strict";var i=n(1),r=n(2);n(0)(e,"__esModule",{value:!0}),e.default=e.ACTION=void 0;var a,o,s=i(n(3)),u=i(n(4)),l=i(n(5)),c=r(n(11)),h=r(n(27)),f=r(n(15));e.ACTION=o,function(t){t[t.ADD=0]="ADD",t[t.REMOVE=1]="REMOVE",t[t.UPDATE=2]="UPDATE"}(o||(e.ACTION=o={}));var d=(a={},(0,l.default)(a,o.ADD,o.REMOVE),(0,l.default)(a,o.REMOVE,o.ADD),(0,l.default)(a,o.UPDATE,o.UPDATE),a),p=function(){function t(e){(0,s.default)(this,t),(0,l.default)(this,"record",void 0),(0,l.default)(this,"pointer",void 0),(0,l.default)(this,"currentShapes",void 0),(0,l.default)(this,"options",void 0),this.record=[],this.pointer=-1,this.currentShapes={},this.options=e}return(0,u.default)(t,[{key:"push",value:function(t,e){this.record=this.record.slice(0,this.pointer+1),e=e.map((function(t){return(t=h.extend({},t)).name!==f.RECT&&t.name!==f.ARROW||(t.close=!0,t.name=f.PATH),t})),this.record.push({action:t,shapes:e}),this.pointer=this.record.length-1,this.options.onRecordChange&&this.options.onRecordChange(this.record.length)}},{key:"findShape",value:function(t){for(var e,n=this.pointer;n>=0&&(c.each(this.record[n].shapes,(function(n){if(n.number===t)return e=n,!1})),!e);n--);return e}},{key:"reverseAction",value:function(t){var e=this,n=d[t.action],i=t.shapes;if(n===o.UPDATE){var r=[];c.each(i,(function(t){var n=e.findShape(t.number);n&&r.push(n)})),i=r}return{action:n,shapes:i}}},{key:"updateCurrentShape",value:function(t,e){var n=this;c.each(e,(function(e){t===o.ADD||t===o.UPDATE?n.currentShapes[e.number]=e:t===o.REMOVE&&delete n.currentShapes[e.number]}))}},{key:"hasCurrentShape",value:function(t){return!!this.currentShapes[t.number]}},{key:"addCurrentShapes",value:function(t){var e=this;c.each(t,(function(t){delete t.id,e.currentShapes[t.number]=t}))}},{key:"add",value:function(t){var e=this;c.each(t,(function(t){delete t.id,e.currentShapes[t.number]=t})),this.push(o.ADD,t)}},{key:"remove",value:function(t){var e=this;c.each(t,(function(t){delete e.currentShapes[t.number]})),this.push(o.REMOVE,t)}},{key:"removeByNumber",value:function(t){var e=this,n=[];c.each(t,(function(t){e.currentShapes[t]&&n.push(e.currentShapes[t])})),this.remove(n)}},{key:"update",value:function(t){var e=this;c.each(t,(function(t){e.currentShapes[t.number]=t})),this.push(o.UPDATE,t)}},{key:"clear",value:function(){this.currentShapes={},this.pointer=-1,this.record.length&&(this.record=[],this.options.onRecordChange&&this.options.onRecordChange(this.record.length))}},{key:"hasNext",value:function(){return this.pointer<this.record.length-1}},{key:"hasPrev",value:function(){return this.pointer>=0}},{key:"next",value:function(){if(this.hasNext()){var t=this.record[++this.pointer];return this.updateCurrentShape(t.action,t.shapes),t}}},{key:"prev",value:function(){if(this.hasPrev()){var t=this.reverseAction(this.record[this.pointer--]);return this.updateCurrentShape(t.action,t.shapes),t}}},{key:"destroy",value:function(){this.record=null,this.currentShapes=null}},{key:"getData",value:function(){return{record:h.copy(this.record,!0),pointer:this.pointer,currentShapes:h.copy(this.currentShapes,!0)}}},{key:"setData",value:function(t){this.record=t.record,this.pointer=t.pointer,this.currentShapes=t.currentShapes,this.options.onRecordChange&&this.options.onRecordChange(this.record.length)}}]),t}();e.default=p},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r,a,o,s=i(n(7)),u=i(n(30)),l=i(n(60)),c=i(n(31)),h=i(n(3)),f=i(n(4)),d=i(n(12)),p=i(n(9)),v=i(n(10)),g=i(n(8)),E=i(n(5)),_=i(n(320)),y=i(n(108)),m=i(n(321)),T=i(n(109)),A=i(n(326));function R(t){var e=function(){if("undefined"==typeof Reflect||!s.default)return!1;if(s.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,s.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,g.default)(t);if(e){var r=(0,g.default)(this).constructor;n=(0,s.default)(i,arguments,r)}else n=i.apply(this,arguments);return(0,v.default)(this,n)}}!function(t){t[t.DEVICE_NOT_FOUND=-1]="DEVICE_NOT_FOUND",t[t.DEVICE_OPEN_FAIL=-2]="DEVICE_OPEN_FAIL",t[t.DEVICE_CANNOT_CONNECTED=-3]="DEVICE_CANNOT_CONNECTED",t[t.DEVICE_UNAUTHORIZED=-4]="DEVICE_UNAUTHORIZED",t[t.DEVICE_NOT_SUPPORTED=-5]="DEVICE_NOT_SUPPORTED"}(r||(r={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.DISCONNECTED=0]="DISCONNECTED",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.CONNECT_FAILED=3]="CONNECT_FAILED",t[t.UNIT=4]="UNIT"}(a||(a={})),function(t){t[t.HOVER=0]="HOVER",t[t.DOWN=1]="DOWN",t[t.MOVE=2]="MOVE",t[t.UP=3]="UP",t[t.LEAVE=4]="LEAVE"}(o||(o={}));var S=function(t){(0,p.default)(v,t);var e,n,i,s=R(v);function v(){var t;return(0,h.default)(this,v),t=s.call(this),(0,E.default)((0,d.default)(t),"canvas",void 0),(0,E.default)((0,d.default)(t),"server",void 0),(0,E.default)((0,d.default)(t),"applyed",void 0),(0,E.default)((0,d.default)(t),"penStatus",void 0),(0,E.default)((0,d.default)(t),"connectStatus",void 0),(0,E.default)((0,d.default)(t),"connected",void 0),(0,E.default)((0,d.default)(t),"touched",void 0),(0,E.default)((0,d.default)(t),"whiteCharacteristic",void 0),(0,E.default)((0,d.default)(t),"dispatchEventThrottling",void 0),(0,E.default)((0,d.default)(t),"snumber",void 0),(0,E.default)((0,d.default)(t),"connectTimer",void 0),(0,E.default)((0,d.default)(t),"bufferLeft",void 0),(0,E.default)((0,d.default)(t),"buffer",void 0),(0,E.default)((0,d.default)(t),"boardType",void 0),(0,E.default)((0,d.default)(t),"boardWidth",void 0),(0,E.default)((0,d.default)(t),"boardHight",void 0),(0,E.default)((0,d.default)(t),"boardMaxPress",void 0),t.applyed=!1,t.connected=!1,t.touched=!1,t.penStatus=o.LEAVE,t.connectStatus=a.DISCONNECTED,t.dispatchEventThrottling=(0,y.default)((function(e){t.dispatchEvent(e)}),20,!0),t.bufferLeft=0,t.buffer=new Uint8Array(new ArrayBuffer(1024)),t.boardWidth=21e3,t.boardHight=14800,t.boardMaxPress=8192,t}return(0,f.default)(v,[{key:"changeConnectStatus",value:function(t){this.connectStatus=t}},{key:"dispatchEvent",value:function(t){this.fire("event",t),this.applyed&&this.canvas&&(t.status===o.DOWN?this.canvas.dispatchEventByPosition("pointerdown",t.x,t.y,t.pressure):t.status===o.MOVE||t.status===o.HOVER?this.canvas.dispatchEventByPosition("pointermove",t.x,t.y,t.pressure):t.status===o.UP&&this.canvas.dispatchEventByPosition("pointerup",t.x,t.y,t.pressure))}},{key:"connectService",value:(i=(0,c.default)(u.default.mark((function t(){var e,n,i,a=this;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.server){t.next=39;break}return t.prev=1,t.next=4,this.server.getPrimaryService("0000fff0-0000-1000-8000-00805f9b34fb");case 4:e=t.sent,t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(1),new m.default(r.DEVICE_UNAUTHORIZED,"device not authorized");case 10:return t.prev=10,t.next=13,e.getCharacteristic("0000fff2-0000-1000-8000-00805f9b34fb");case 13:this.whiteCharacteristic=t.sent,t.next=19;break;case 16:throw t.prev=16,t.t1=t.catch(10),new m.default(r.DEVICE_NOT_SUPPORTED,"device not support");case 19:return t.prev=19,t.next=22,e.getCharacteristic("0000fff1-0000-1000-8000-00805f9b34fb");case 22:n=t.sent,t.next=28;break;case 25:throw t.prev=25,t.t2=t.catch(19),new m.default(r.DEVICE_NOT_SUPPORTED,"device not support");case 28:return n.addEventListener("characteristicvaluechanged",(function(t){a.parserData(new Uint8Array(t.target.value.buffer))})),n.startNotifications(),this.bufferLeft=0,this.connectTimer&&this.connectTimer.dispose(),t.next=34,l.default.race([new A.default(15),new l.default((function(t,e){var n=0;a.connectTimer=new T.default((function(){a.snumber?(a.connectTimer.stop(),t(0)):n%10==0&&a.whiteCharacteristic.writeValue(new Uint8Array([254,254,2,0,0,0,0])),n++}),0,100),a.connectTimer.start()}))]);case 34:if(i=t.sent,this.connectTimer.dispose(),this.connectTimer=null,!(i>0)){t.next=39;break}throw new m.default(r.DEVICE_OPEN_FAIL,"连接超时");case 39:case"end":return t.stop()}}),t,this,[[1,7],[10,16],[19,25]])}))),function(){return i.apply(this,arguments)})},{key:"connect",value:(n=(0,c.default)(u.default.mark((function t(){var e,n,i=this;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.connectStatus!==a.CONNECTING){t.next=2;break}throw new m.default(r.DEVICE_CANNOT_CONNECTED,"正在连接");case 2:if(e={filters:[{namePrefix:"XJ"},{namePrefix:"ZX"}],optionalServices:["0000fff0-0000-1000-8000-00805f9b34fb"]},navigator.bluetooth){t.next=5;break}throw new Error("No Web Bluetooth support.");case 5:return t.prev=5,t.next=8,navigator.bluetooth.requestDevice(e);case 8:n=t.sent,t.next=14;break;case 11:throw t.prev=11,t.t0=t.catch(5),new m.default(r.DEVICE_NOT_FOUND,"device not found");case 14:return n.ongattserverdisconnected=function(){i.fire("disconnect"),i.changeConnectStatus(a.DISCONNECTED)},this.changeConnectStatus(a.CONNECTING),t.prev=16,t.next=19,n.gatt.connect();case 19:this.server=t.sent,t.next=26;break;case 22:throw t.prev=22,t.t1=t.catch(16),this.changeConnectStatus(a.CONNECT_FAILED),new m.default(r.DEVICE_OPEN_FAIL,"device open fail");case 26:return t.prev=26,t.next=29,this.connectService();case 29:this.connected=!0,this.changeConnectStatus(a.CONNECTED),t.next=37;break;case 33:throw t.prev=33,t.t2=t.catch(26),this.changeConnectStatus(a.CONNECT_FAILED),t.t2;case 37:case"end":return t.stop()}}),t,this,[[5,11],[16,22],[26,33]])}))),function(){return n.apply(this,arguments)})},{key:"disconnect",value:function(){this.server&&this.connected&&(this.server.disconnect(),this.connected=!1,this.changeConnectStatus(a.UNIT))}},{key:"reconnect",value:(e=(0,c.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.server||this.connected){t.next=24;break}return t.prev=1,t.next=4,this.server.connect();case 4:this.server=t.sent,t.next=11;break;case 7:throw t.prev=7,t.t0=t.catch(1),this.changeConnectStatus(a.CONNECT_FAILED),new m.default(r.DEVICE_OPEN_FAIL,"device open fail");case 11:return t.prev=11,t.next=14,this.connectService();case 14:this.connected=!0,this.changeConnectStatus(a.CONNECTED),t.next=22;break;case 18:throw t.prev=18,t.t1=t.catch(11),this.changeConnectStatus(a.CONNECT_FAILED),t.t1;case 22:t.next=27;break;case 24:if(this.server){t.next=27;break}return t.next=27,this.connect();case 27:case"end":return t.stop()}}),t,this,[[1,7],[11,18]])}))),function(){return e.apply(this,arguments)})},{key:"isPacketStart",value:function(t,e){var n=this.byteToNumber(t,e),i=this.byteToNumber(e,t);return 65021==n||65022==i}},{key:"parserData",value:function(t){if(this.applyed&&t&&t instanceof Uint8Array){var e=t.length+this.bufferLeft;e>1024&&(this.bufferLeft=0);var n=0,i=0;for(this.buffer.set(t,this.bufferLeft);n+10<=e;){var r=!1,a=this.byteToNumberBig(this.buffer[n],this.buffer[n+1]);if(65022===a){if(n+10===e?r=!0:n+12<=e&&(65278!==this.byteToNumber(this.buffer[n+10],this.buffer[n+11])&&65022!==this.byteToNumberBig(this.buffer[n+10],this.buffer[n+11])||(r=!0)),r){var s=255&this.buffer[n+2],u=255&this.buffer[n+3];if(1===s){var l=255&this.buffer[n+4],c=255&this.buffer[n+5];l>0&&1===u&&this.fire("btnindexclick",{index:l}),c>0&&1===u&&this.fire("solfkeyclick",{key:c})}else if(2===s){var h=this.byteToNumber(this.buffer[n+4],this.buffer[n+5]),f=this.byteToNumber(this.buffer[n+6],this.buffer[n+7]),d=this.byteToNumber(this.buffer[n+8],this.buffer[n+9]);1===u?(this.touched?this.penStatus=o.MOVE:this.penStatus=o.DOWN,this.touched=!0):2===u?(this.touched?this.penStatus=o.UP:this.penStatus=o.HOVER,this.touched=!1):0===u&&(this.touched?this.penStatus=o.UP:this.penStatus=o.LEAVE,this.touched=!1);var p=h/this.boardWidth,v=f/this.boardHight,g=d/this.boardMaxPress;this.dispatchEvent({status:this.penStatus,bleX:h,bleY:f,x:p,y:v,pressure:g})}i=n+=10}}else if(65278===a){var E=this.buffer[n+2],_=this.byteToNumberBig(this.buffer[n+3],this.buffer[n+4]);E<200&&_<512&&n+7+_<=e&&(97===E?(this.boardType=255&this.buffer[n+7],this.boardWidth=this.byteToNumberBig(this.buffer[n+8],this.buffer[n+9]),this.boardHight=this.byteToNumberBig(this.buffer[n+10],this.buffer[n+11]),this.boardMaxPress=this.byteToNumberBig(this.buffer[n+12],this.buffer[n+13])+1,this.snumber||this.whiteCharacteristic.writeValue(new Uint8Array([254,254,2,0,0,0,0]))):3===E&&(this.snumber=this.uint8ArrayToString(this.buffer.subarray(n+7,n+7+_))),r=!0,i=n+=7+_)}r||(n+=1);var y=e-i;i>0&&i<e&&y>0&&this.buffer.set(this.buffer.subarray(i,e),0),this.bufferLeft=y}}}},{key:"apply",value:function(t){this.canvas=t.canvas,this.applyed=!0}},{key:"byteToNumber",value:function(t,e){return 255&t|(255&e)<<8}},{key:"byteToNumberBig",value:function(t,e){var n=255&t;return(n<<=8)|255&e}},{key:"uint8ArrayToString",value:function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}}]),v}(_.default);e.default=S,(0,E.default)(S,"PEN_STAUS",o),(0,E.default)(S,"ERROR",r),(0,E.default)(S,"CONNECT_STATUS",a)},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(3)),a=i(n(4)),o=i(n(5)),s=i(n(113)),u=function(){function t(){(0,r.default)(this,t),(0,o.default)(this,"emitter",void 0),this.emitter=new s.default(!0)}return(0,a.default)(t,[{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,e,n),this}},{key:"off",value:function(t,e){return this.emitter.off(t,e),this}},{key:"fire",value:function(t,e){this.emitter.fire(t,e)}}]),t}();e.default=u},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(7)),a=i(n(3)),o=i(n(4)),s=i(n(12)),u=i(n(9)),l=i(n(10)),c=i(n(8)),h=i(n(322)),f=i(n(5)),d=function(t){(0,u.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!r.default)return!1;if(r.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,r.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,c.default)(t);if(e){var a=(0,c.default)(this).constructor;n=(0,r.default)(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}(n);function n(t,i){var r;return(0,a.default)(this,n),r=e.call(this),(0,f.default)((0,s.default)(r),"code",void 0),r.code=t,r.message="[code: ".concat(r.code,"] ").concat(i||""),r}return(0,o.default)(n,[{key:"getCode",value:function(){return this.code}}]),n}((0,h.default)(Error));e.default=d},function(t,e,n){var i=n(132),r=n(157),a=n(8),o=n(101),s=n(323),u=n(324);function l(e){var n="function"==typeof r?new r:void 0;return t.exports=l=function(t){if(null===t||!s(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return u(t,arguments,a(this).constructor)}return e.prototype=i(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o(e,t)},l(e)}t.exports=l},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(t,e,n){var i=n(7),r=n(101),a=n(325);function o(e,n,s){return a()?t.exports=o=i:t.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return n&&r(a,n.prototype),a},o.apply(null,arguments)}t.exports=o},function(t,e,n){var i=n(7);t.exports=function(){if("undefined"==typeof Reflect||!i)return!1;if(i.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(i(Date,[],(function(){}))),!0}catch(t){return!1}}},function(t,e,n){"use strict";var i=n(1);n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n(159)),a=i(n(3)),o=i(n(4)),s=i(n(5)),u=function(){function t(e){(0,a.default)(this,t),(0,s.default)(this,"timeout",void 0),(0,s.default)(this,"timer",void 0),(0,s.default)(this,"resolve",void 0),(0,s.default)(this,"reject",void 0),(0,s.default)(this,"startTime",void 0),this.timeout=e}return(0,o.default)(t,[{key:"then",value:function(t,e){var n=this;this.resolve=t,this.reject=e,this.startTime=(0,r.default)(),this.timer=setTimeout((function(){n.resolve((0,r.default)()-n.startTime),n.timer=null}),1e3*this.timeout)}},{key:"stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.timer&&(clearTimeout(this.timer),this.timer=null,this.resolve&&t?this.resolve((0,r.default)()-this.startTime):this.reject&&!t&&this.reject((0,r.default)()-this.startTime))}}]),t}();e.default=u}]).default},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.TOOLS=e.DEFAULT_SIDE=e.DEFAULT_FONT_ITALIC=e.DEFAULT_BLOD_ENABLE=e.DEFAULT_DASH_SEGMENT=e.DEFAULT_DASH_ENABLE=e.DEFAULT_CARET_COLOR=e.DEFALUT_FONT_FAMILY=e.DEFALUT_STROKE_WIDTH=e.DEFALUT_TOOL=e.DEFALUT_FONT_SIZE=e.DEFAULT_HOVER_COLOR=e.DEFALUT_STROKE_COLOR=e.DEFALUT_FILL_COLOR=e.ERASER=e.TEXT=e.ARROW=e.REGULAR_POLYGON=e.CIRCLE=e.RECT=e.LINE=e.DOODLE=e.SELECT=void 0;var a=r(n(156)),o=a.default.shapeType.SELECT;e.SELECT=o;var s=a.default.shapeType.DOODLE;e.DOODLE=s;var u=a.default.shapeType.LINE;e.LINE=u;var l=a.default.shapeType.RECT;e.RECT=l;var c=a.default.shapeType.CIRCLE;e.CIRCLE=c;var h=a.default.shapeType.REGULAR_POLYGON;e.REGULAR_POLYGON=h;var f=a.default.shapeType.ARROW;e.ARROW=f;var d=a.default.shapeType.TEXT;e.TEXT=d;var p=a.default.shapeType.ERASER;e.ERASER=p;e.DEFALUT_FILL_COLOR="#1795FF";e.DEFALUT_STROKE_COLOR="#1795FF";e.DEFAULT_HOVER_COLOR="#fff000";e.DEFALUT_FONT_SIZE=20;var v=o;e.DEFALUT_TOOL=v;e.DEFALUT_STROKE_WIDTH=2;e.DEFALUT_FONT_FAMILY="sans-serif";e.DEFAULT_CARET_COLOR="#fff";e.DEFAULT_DASH_ENABLE=!1;e.DEFAULT_DASH_SEGMENT=[10,10];e.DEFAULT_BLOD_ENABLE=!1;e.DEFAULT_FONT_ITALIC=!1;e.DEFAULT_SIDE=3;var g={SELECT:o,DOODLE:s,LINE:u,RECT:l,CIRCLE:c,REGULAR_POLYGON:h,ARROW:f,TEXT:d,ERASER:p};e.TOOLS=g},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t){return/img\.gsxservice\.com/.test(t)||/imgs?\.genshuixue\.com/.test(t)||/imgs?\.baijiayun\.com/.test(t)}},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t,e,n){t<e?t=e:t>n&&(t=n);return t}},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=function(t,e,n,i,r,o,s){n*=r;((e*=r)>16384||n>16384)&&(e*=Math.min(16384/e,16384/n));return(0,a.default)({url:t,width:e,quality:null!=i?i:1,noCrop:!0,hasWebp:o,watermark:s})};var a=r(n(314))},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t,e){var n,i=0;return function r(){t[i]&&(t[i](),n=setTimeout((function(){n=null,i++,r()}),e))}(),function(){n&&clearTimeout(n)}}},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var a,o=r(n(5)),s=r(n(6)),u=r(n(318)),l=r(n(13));(0,u.default)().then((function(t){a=t}));var c=function(){function t(e){(0,o.default)(this,t),this.element=void 0,this.status=void 0,this.options=void 0,this.timer=void 0,this.options=e,this.status=t.STATUS_EMPTY}return(0,s.default)(t,[{key:"load",value:function(){var e,n=this,i=this.options.width,r=this.options.height,o=this.options.quality,s=a&&this.options.hasWebp,u=this.options.url,c=(0,l.default)(this.options.compress,this,[u,i,r,o,1,s,this.options.watermark]),h=(0,l.default)(this.options.compress,this,[u,i,r,o,2,s,this.options.watermark]);this.element=null!==(e=this.element)&&void 0!==e?e:document.createElement("img"),this.element.crossOrigin="Anonymous",this.options.class&&(this.element.className=this.options.class),this.status===t.STATUS_SUCCESS&&this.element.src===c&&this.options.onSame&&(0,l.default)(this.options.onSame,this);var f,d=function(){n.timer&&(clearTimeout(n.timer),n.timer=null)},p=-1,v=function(e,i,r,a){d(),n.options.timeout>0&&(n.timer=setTimeout((function(){n.timer=null,g(t.STATUS_TIMEOUT,"onTimeout")}),n.options.timeout)),e.src=r,e.srcset=a+" 2x",e.setAttribute("data-raw",i),e.setAttribute("data-real",window.devicePixelRatio>1?a:r)},g=function(t,e){if("onFailure"!==e&&"onTimeout"!==e||!n.options.hostFallbacks||(p++,!n.options.hostFallbacks[p])){var i;n.status=t,d(),(i=n.element).onload=i.onerror=i.onabort=null,e&&n.options[e]&&(0,l.default)(n.options[e],n)}else{var r=/(https?:\/\/)[^\/]+(\/.+)/,a="$1"+n.options.hostFallbacks[p]+"$2";v(n.element,u.replace(r,a),c.replace(r,a),h.replace(r,a))}};this.status===t.STATUS_LOADING&&g(t.STATUS_EMPTY),this.status=t.STATUS_LOADING,this.options.onLoading&&(0,l.default)(this.options.onLoading,this),(f=this.element).onload=function(){g(t.STATUS_SUCCESS,"onSuccess")},f.onerror=function(){g(t.STATUS_FAILURE,"onFailure")},f.onabort=function(){g(t.STATUS_ABORT,"onAbort")},v(this.element,u,c,h)}},{key:"update",value:function(e,n,i){var r,a,o,s=this.status;if(e!==(null===(r=this.options)||void 0===r?void 0:r.width)||n!==(null===(a=this.options)||void 0===a?void 0:a.height)||i!==(null===(o=this.options)||void 0===o?void 0:o.quality)){if(s===t.STATUS_LOADING)this.abort();else if(s===t.STATUS_SUCCESS){var u,c;if(e<(null===(u=this.options)||void 0===u?void 0:u.width)&&n<(null===(c=this.options)||void 0===c?void 0:c.height))return void(this.options.onSame&&(0,l.default)(this.options.onSame,this))}this.options.width=e,this.options.height=n,this.options.quality=i,this.load()}else if(s===t.STATUS_SUCCESS)this.options.onSame&&(0,l.default)(this.options.onSame,this);else if(s===t.STATUS_LOADING){var h;null!==(h=this.options)&&void 0!==h&&h.onLoading&&(0,l.default)(this.options.onLoading,this)}else s===t.STATUS_TIMEOUT||s===t.STATUS_FAILURE?(this.element&&(this.remove(),this.element=null),this.load()):s===t.STATUS_EMPTY&&this.load()}},{key:"abort",value:function(){var t=this.element;null!=t&&t.abort&&t.abort()}},{key:"getWidth",value:function(){var t;return null!==(t=this.element.width)&&void 0!==t?t:0}},{key:"getHeight",value:function(){var t;return null!==(t=this.element.height)&&void 0!==t?t:0}},{key:"remove",value:function(){var t;null!==(t=this.element)&&void 0!==t&&t.parentNode&&this.element.parentNode.removeChild(this.element)}},{key:"appendTo",value:function(t){this.element&&t.append(this.element)}},{key:"prependTo",value:function(t){this.element&&t.prepend(this.element)}},{key:"destroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.remove(),this.element=null,this.status=t.STATUS_EMPTY}},{key:"getStatus",value:function(){return this.status}},{key:"docId",get:function(){return this.options.docId}},{key:"page",get:function(){return this.options.page}},{key:"pageId",get:function(){return this.options.pageId},set:function(t){this.options.pageId=t}},{key:"rawWidth",get:function(){return this.options.rawWidth}},{key:"rawHeight",get:function(){return this.options.rawHeight}}]),t}();e.default=c,c.STATUS_EMPTY=0,c.STATUS_LOADING=1,c.STATUS_SUCCESS=2,c.STATUS_FAILURE=3,c.STATUS_TIMEOUT=4,c.STATUS_ABORT=5},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.createClient=function(t){return new l.default(t)},e.createDocumentPlayer=function(t,e,n,i){return new g.default(t,e,n,i)},e.createPainterConfig=function(){return new m.default},e.setEnvTest=function(){(0,f.setRequestEnv)(h.DEVELOPMENT),c.info("set env ".concat(h.DEVELOPMENT))},e.Canvas=e.version=e.util=e.Events=e.Logger=void 0;var u=n(28),l=s(n(188)),c=x(n(62)),h=x(n(61)),f=n(63),d=s(n(155)),p=x(n(145)),v=x(n(109)),g=s(n(311)),E=x(n(153)),_=x(n(146)),y=x(n(84)),m=s(n(320)),T=x(n(10)),A=x(n(116)),R=x(n(115));function S(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(S=function(t){return t?n:e})(t)}function x(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=S(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var P=c;e.Logger=P;var O={Room:T.extend(p,y),User:_,Chat:E,Document:R,DocumentPlayer:A};e.Events=O;var I={number2Base64:v};e.util=I,c.setLevel(c.WARN);var w=u.VERSION;e.version=w;var b=d.default;e.Canvas=b,console.log("******************************************************************************\n*   欢迎使用 BRTM(v".concat(u.VERSION,") Web SDK - 百家云实时消息通信\n*   API 文档：https://docs.baijiayun.com/rtm/\n******************************************************************************"))},function(t,e,n){n(42),n(44),t.exports=n(96).f("iterator")},function(t,e,n){var i=n(86),r=n(65);t.exports=function(t){return function(e,n){var a,o,s=String(r(e)),u=i(n),l=s.length;return u<0||u>=l?t?"":void 0:(a=s.charCodeAt(u))<55296||a>56319||u+1===l||(o=s.charCodeAt(u+1))<56320||o>57343?t?s.charAt(u):a:t?s.slice(u,u+2):o-56320+(a-55296<<10)+65536}}},function(t,e,n){"use strict";var i=n(50),r=n(49),a=n(53),o={};n(35)(o,n(19)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(o,{next:r(1,n)}),a(t,e+" Iterator")}},function(t,e,n){var i=n(36),r=n(66),a=n(168);t.exports=function(t){return function(e,n,o){var s,u=i(e),l=r(u.length),c=a(o,l);if(t&&n!=n){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((t||c in u)&&u[c]===n)return t||c||0;return!t&&-1}}},function(t,e,n){var i=n(86),r=Math.max,a=Math.min;t.exports=function(t,e){return(t=i(t))<0?r(t+e,0):a(t,e)}},function(t,e,n){"use strict";var i=n(170),r=n(122),a=n(43),o=n(36);t.exports=n(87)(Array,"Array",(function(t,e){this._t=o(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},function(t,e){t.exports=function(){}},function(t,e,n){n(123),n(71),n(174),n(175),t.exports=n(7).Symbol},function(t,e,n){var i=n(51),r=n(69),a=n(70);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var o,s=n(t),u=a.f,l=0;s.length>l;)u.call(t,o=s[l++])&&e.push(o);return e}},function(t,e,n){var i=n(36),r=n(99).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return o&&"[object Window]"==a.call(t)?function(t){try{return r(t)}catch(t){return o.slice()}}(t):r(i(t))}},function(t,e,n){n(97)("asyncIterator")},function(t,e,n){n(97)("observable")},function(t,e,n){n(71),n(44),n(177),n(182),n(183),t.exports=n(7).WeakMap},function(t,e,n){"use strict";var i,r=n(12),a=n(100)(0),o=n(90),s=n(45),u=n(180),l=n(181),c=n(16),h=n(55),f=n(55),d=!r.ActiveXObject&&"ActiveXObject"in r,p=s.getWeak,v=Object.isExtensible,g=l.ufstore,E=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},_={get:function(t){if(c(t)){var e=p(t);return!0===e?g(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(h(this,"WeakMap"),t,e)}},y=t.exports=n(126)("WeakMap",E,_,l,!0,!0);f&&d&&(u((i=l.getConstructor(E,"WeakMap")).prototype,_),s.NEED=!0,a(["delete","has","get","set"],(function(t){var e=y.prototype,n=e[t];o(e,t,(function(e,r){if(c(e)&&!v(e)){this._f||(this._f=new i);var a=this._f[t](e,r);return"set"==t?this:a}return n.call(this,e,r)}))})))},function(t,e,n){var i=n(179);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){var i=n(16),r=n(98),a=n(19)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var i=n(22),r=n(51),a=n(69),o=n(70),s=n(40),u=n(91),l=Object.assign;t.exports=!l||n(32)((function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach((function(t){e[t]=t})),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=i}))?function(t,e){for(var n=s(t),l=arguments.length,c=1,h=a.f,f=o.f;l>c;)for(var d,p=u(arguments[c++]),v=h?r(p).concat(h(p)):r(p),g=v.length,E=0;g>E;)d=v[E++],i&&!f.call(p,d)||(n[d]=p[d]);return n}:l},function(t,e,n){"use strict";var i=n(72),r=n(45).getWeak,a=n(20),o=n(16),s=n(73),u=n(46),l=n(100),c=n(33),h=n(55),f=l(5),d=l(6),p=0,v=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},E=function(t,e){return f(t.a,(function(t){return t[0]===e}))};g.prototype={get:function(t){var e=E(this,t);if(e)return e[1]},has:function(t){return!!E(this,t)},set:function(t,e){var n=E(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,a){var l=t((function(t,i){s(t,l,e,"_i"),t._t=e,t._i=p++,t._l=void 0,null!=i&&u(i,n,t[a],t)}));return i(l.prototype,{delete:function(t){if(!o(t))return!1;var n=r(t);return!0===n?v(h(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!o(t))return!1;var n=r(t);return!0===n?v(h(this,e)).has(t):n&&c(n,this._i)}}),l},def:function(t,e,n){var i=r(a(e),!0);return!0===i?v(t).set(e,n):i[t._i]=n,t},ufstore:v}},function(t,e,n){n(127)("WeakMap")},function(t,e,n){n(128)("WeakMap")},function(t,e,n){n(185);var i=n(7).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){var i=n(11);i(i.S+i.F*!n(22),"Object",{defineProperty:n(25).f})},function(t,e,n){n(187);var i=n(7).Object;t.exports=function(t,e){return i.getOwnPropertyDescriptor(t,e)}},function(t,e,n){var i=n(36),r=n(54).f;n(75)("getOwnPropertyDescriptor",(function(){return function(t,e){return r(i(t),e)}}))},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u,l,c,h,f,d,p,v=s(n(14)),g=s(n(17)),E=s(n(3)),_=s(n(15)),y=s(n(5)),m=s(n(6)),T=s(n(56)),A=s(n(198)),R=Q(n(268)),S=n(28),x=n(21),P=s(n(23)),O=Q(n(62)),I=s(n(139)),w=Q(n(61)),b=Q(n(24)),D=n(63),C=s(n(59)),L=s(n(271)),N=s(n(280)),M=s(n(281)),k=n(64),U=s(n(300)),G=Q(n(109)),F=Q(n(8)),V=s(n(301)),H=s(n(154)),W=Q(n(84)),B=s(n(82)),Y=s(n(41)),j=Q(n(9)),z=Q(n(10)),X=s(n(13)),q=s(n(302)),K=s(n(27));function J(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(J=function(t){return t?n:e})(t)}function Q(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=J(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var Z=(u=(0,k.frequency)((function(t,e){var n;return t-(null!==(n=e[e.length-2])&&void 0!==n?n:-1)<x.SECOND}),2,"join 调用超出频率限制，一秒钟不能超过 2 次"),l=(0,k.frequency60)(),c=(0,k.frequency60)(),h=(0,k.frequency60)(),f=(0,k.frequency60)(),d=(0,k.frequency60)(),p=function(){function t(e){var n=this;if((0,y.default)(this,t),this.appId=void 0,this.roomId="",this.userSig=void 0,this.userId=void 0,this.role=void 0,this.userInfo=void 0,this.roomData=void 0,this.emitter=void 0,this.commandMap=void 0,this.room=void 0,this.class=void 0,this.document=void 0,this.user=void 0,this.chat=void 0,this.joinConfig=void 0,this.isJoinning=void 0,this.isJoined=void 0,!e||!F.string(e.appId))throw new P.default(b.INVALID_PARAMETER,"appId 类型错误，请检查");this.appId=e.appId,this.commandMap=new H.default(!0),this.emitter=new B.default(!0),this.class=new V.default(this.emitter),this.document=new q.default,this.user=new L.default,this.chat=new N.default,this.role="user",this.isJoinning=!1,this.isJoined=!1,this.class.addCommandMessageType(w.BRTM_COMMAND_TYPE,(function(t,e){n.commandMap.execute(t.rtm_custom_key,[t.rtm_custom_value,e])}))}var e,n,i,r,a,o,s,u;return(0,m.default)(t,[{key:"join",value:(u=(0,_.default)(v.default.mark((function t(e,n,i){var r,a,o,s,u,l,c,h,f,d,p,E,_,y=arguments;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=y.length>3&&void 0!==y[3]?y[3]:{},!this.isJoinning){t.next=3;break}throw new P.default(b.INVALID_OPERATION,"正在 join，请勿重复调用");case 3:if(!this.isJoined){t.next=5;break}throw new P.default(b.INVALID_OPERATION,"重复 join，请先调用 leave");case 5:if(F.string(e)){t.next=7;break}throw new P.default(b.INVALID_PARAMETER,"roomId 类型错误，请检查");case 7:if(F.number(n)){t.next=9;break}throw new P.default(b.INVALID_PARAMETER,"userId 类型错误，请检查");case 9:if(!(n>Math.pow(2,31)-1||n<-Math.pow(2,31)||Math.floor(n)!==n)){t.next=11;break}throw new P.default(b.INVALID_PARAMETER,"userId 为 uint32 整型");case 11:if(F.string(i)){t.next=13;break}throw new P.default(b.INVALID_PARAMETER,"sign 类型错误，请检查");case 13:return this.roomId=e,this.userId=n,this.userSig=i,this.joinConfig=a,this.joinConfig.role&&(this.role=a.role),this.userInfo=null!==(r=this.joinConfig.userInfo)&&void 0!==r?r:{},this.isJoinning=!0,t.prev=20,t.next=23,(0,D.checkSign)(this.appId,this.roomId,this.userSig,(0,K.default)(this.userId),null!==(o=S.Role2Type[this.role])&&void 0!==o?o:0,null!==(s=this.userInfo.name)&&void 0!==s?s:"",null!==(u=this.userInfo.avatar)&&void 0!==u?u:"");case 23:if(200!==(l=t.sent).code||!l.data){t.next=45;break}if(this.roomId===l.data.room_no){t.next=27;break}throw new P.default(b.INVALID_PARAMETER,"sig 中的 roomId 与传入的 roomId 不匹配");case 27:if(this.userId===(0,C.default)(l.data.user_no)){t.next=29;break}throw new P.default(b.USER_SIG_ERROR,"sig 中的 userId 与传入的 userId 不匹配");case 29:return this.roomData=l.data,this.room=new A.default({env:D.env,token:l.data.token,class:{id:l.data.room_id},ms:{ip:l.data.partner_config.ms.ip,port:l.data.partner_config.ms.port,wssIp:l.data.partner_config.ms.wss_ip,wssPort:l.data.partner_config.ms.wss_port},msProxies:(0,U.default)(null!==(c=l.data.partner_config.ms.proxy)&&void 0!==c?c:[],null!==(h=l.data.partner_config.ms.wss_proxy)&&void 0!==h?h:[]),user:{number:(0,K.default)(this.userId),type:null!==(f=S.Role2Type[this.role])&&void 0!==f?f:0,name:null!==(d=this.userInfo.name)&&void 0!==d?d:"",avatar:null!==(p=this.userInfo.avatar)&&void 0!==p?p:"",endType:this.userInfo.endType,group:0,auth:G.encode(null!==(E=this.userInfo.auth)&&void 0!==E?E:[])},privateDomain:null!==(_=l.data.partner_config.private_domain)&&void 0!==_?_:""}),t.next=33,this.room.join();case 33:return this.class.run(this.room),this.user.run(this.room),this.chat.run(this.room),this.document.run(this.room),t.next=39,g.default.all([this.user.requestActive(),this.user.requestState(this.room.store.get("user.number"))]);case 39:this.user.requestMore(),this.handleEvent(),this.isJoinning=!1,this.isJoined=!0,t.next=46;break;case 45:throw new P.default(b.FETCH_ERROR,l.msg);case 46:t.next=55;break;case 48:if(t.prev=48,t.t0=t.catch(20),this.isJoinning=!1,this.isJoined=!1,!P.default.instanceOf(t.t0)){t.next=54;break}throw new P.default(t.t0.code,t.t0.message);case 54:throw new P.default(b.JOIN_ROOM_ERROR,"join 房间失败，".concat(F.string(t.t0)?t.t0:""),t.t0);case 55:case"end":return t.stop()}}),t,this,[[20,48]])}))),function(t,e,n){return u.apply(this,arguments)})},{key:"leave",value:(s=(0,_.default)(v.default.mark((function t(){return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new P.default(b.INVALID_OPERATION,"没有 joined");case 2:if(t.prev=2,!this.room){t.next=13;break}return this.class.stop(),this.user.stop(),this.document.stop(),this.chat.stop(),t.next=10,this.room.leave();case 10:this.room=null,this.isJoined=!1,this.isJoinning=!1;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),O.error("leave fail",w.LOGGER_TAG_CLIENT,this.userId,[t.t0]);case 18:case"end":return t.stop()}}),t,this,[[2,15]])}))),function(){return s.apply(this,arguments)})},{key:"sendMessage",value:(o=(0,_.default)(v.default.mark((function t(e,n,i){var r;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new P.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(F.string(n)&&n){t.next=4;break}throw new P.default(b.INVALID_PARAMETER,"message_type 类型错误");case 4:return void 0===i&&(i=null),t.next=7,this.room.findUser((0,K.default)(e));case 7:if(r=t.sent){t.next=10;break}throw new P.default(b.INVALID_OPERATION,"找不到 user");case 10:this.class.sendCommand(r.id,{command_type:w.BRTM_COMMAND_TYPE,rtm_custom_key:n,rtm_custom_value:i});case 11:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return o.apply(this,arguments)})},{key:"sendBroadcastMessage",value:(a=(0,_.default)(v.default.mark((function t(e,n,i){var r,a;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new P.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(F.string(e)&&e){t.next=4;break}throw new P.default(b.INVALID_PARAMETER,"message_type 类型错误");case 4:void 0===n&&(n=null),this.class.sendCustomcast({key:e,value:n,options:{all:null===(r=null==i?void 0:i.all)||void 0===r||r,cache:null===(a=null==i?void 0:i.cache)||void 0===a||a}});case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return a.apply(this,arguments)})},{key:"getCachedBroadcastMessage",value:(r=(0,_.default)(v.default.mark((function t(e){return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new P.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(F.string(e)&&e){t.next=4;break}throw new P.default(b.INVALID_PARAMETER,"message_type 类型错误");case 4:return t.abrupt("return",this.class.getCachedCustomcast(e));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"onMessage",value:function(t,e){return this.commandMap.add(t,e),this}},{key:"offMessage",value:function(t,e){return this.commandMap.remove(t,e),this}},{key:"onBroadcastMessage",value:function(t,e){return this.class.addCustomcastType(t,e),this}},{key:"offBroadcastMessage",value:function(t,e){return this.class.removeCustomcastType(t,e),this}},{key:"createDocUploader",value:function(t){if(!this.room)throw new P.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");return new M.default(this,t)}},{key:"enableDocumentAbility",value:(i=(0,_.default)(v.default.mark((function t(){return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new P.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(!this.room.ability.canUseDocument()){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,this.class.updateAbility(this.room.computeAbilitiesCode(I.default.ABILITY_DOCUMENT,!0));case 6:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"disableDocumentAbility",value:(n=(0,_.default)(v.default.mark((function t(){return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new P.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,this.class.updateAbility(this.room.computeAbilitiesCode(I.default.ABILITY_DOCUMENT,!1));case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"getAbilities",value:function(){if(!this.room)throw new P.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");return this.room.ability.getAbilities()}},{key:"fire",value:function(t,e){this.emitter.fire(t,F.array(e)?e:(0,Y.default)(e)?[e]:void 0)}},{key:"one",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,{fn:e,ctx:n.ctx?n.ctx:this,max:1}),this}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,{fn:e,ctx:n.ctx?n.ctx:this}),this}},{key:"off",value:function(t,e){return arguments.length>1?this.emitter.off(t,e):this.emitter.off(t),this}},{key:"getRoom",value:function(){return this.room}},{key:"getApiDomain",value:function(){return this.room.store.get("apiDomain")}},{key:"handleEvent",value:function(){var t=this,e=R.EventsMap,n=R.ParameterHanlderMap,i=R.events.concat(z.keys(W));function r(e,i){t.room.on(e,(function(){var e=j.toArray(arguments);n[i]&&(e=(0,X.default)(n[i],t,e)),e&&F.func(e.then)?e.then((function(e){!1!==e&&(F.array(e)&&2===e.length?t.fire(e[0],e[1]):t.fire(i,e),O.debug("client event ".concat(i),w.LOGGER_TAG_CLIENT,t.userId,[e]))})):!1!==e&&(F.array(e)&&2===e.length?t.fire(e[0],e[1]):t.fire(i,e),O.debug("client event ".concat(i),w.LOGGER_TAG_CLIENT,t.userId,[e]))}))}j.each(i,(function(t){e[t]&&(F.array(e[t])?j.each(e[t],(function(e,n){r(e,t)})):F.string(e[t])&&e[t]&&r(e[t],t))})),O.debug("add event hanlder success",w.LOGGER_TAG_CLIENT,this.userId,[i.join(",")])}},{key:"destroy",value:(e=(0,_.default)(v.default.mark((function t(){return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.class.destroy(),this.document.destroy(),this.user.destroy(),this.chat.destroy(),!this.room){t.next=7;break}return t.next=7,this.leave();case 7:this.emitter.off(),this.emitter=null,this.commandMap.destroy(),this.commandMap=null,this.chat=this.document=this.user=this.class=null;case 12:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}(),(0,T.default)(p.prototype,"join",[u],(0,E.default)(p.prototype,"join"),p.prototype),(0,T.default)(p.prototype,"sendMessage",[l],(0,E.default)(p.prototype,"sendMessage"),p.prototype),(0,T.default)(p.prototype,"sendBroadcastMessage",[c],(0,E.default)(p.prototype,"sendBroadcastMessage"),p.prototype),(0,T.default)(p.prototype,"getCachedBroadcastMessage",[h],(0,E.default)(p.prototype,"getCachedBroadcastMessage"),p.prototype),(0,T.default)(p.prototype,"enableDocumentAbility",[f],(0,E.default)(p.prototype,"enableDocumentAbility"),p.prototype),(0,T.default)(p.prototype,"disableDocumentAbility",[d],(0,E.default)(p.prototype,"disableDocumentAbility"),p.prototype),p);e.default=Z},function(t,e,n){var i=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var r=e&&e.prototype instanceof h?e:h,a=Object.create(r.prototype),o=new R(i||[]);return a._invoke=function(t,e,n){var i="suspendedStart";return function(r,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw a;return x()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=m(o,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=l(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(t,n,o),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var c={};function h(){}function f(){}function d(){}var p={};p[r]=function(){return this};var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==e&&n.call(g,r)&&(p=g);var E=d.prototype=h.prototype=Object.create(p);function _(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function y(t,e){var i;this._invoke=function(r,a){function o(){return new e((function(i,o){!function i(r,a,o,s){var u=l(t[r],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,s)}),(function(t){i("throw",t,o,s)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,s)}))}s(u.arg)}(r,a,i,o)}))}return i=i?i.then(o,o):o()}}function m(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,m(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var i=l(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,c;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function S(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=E.constructor=d,d.constructor=f,f.displayName=s(d,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,o,"GeneratorFunction")),t.prototype=Object.create(E),t},t.awrap=function(t){return{__await:t}},_(y.prototype),y.prototype[a]=function(){return this},t.AsyncIterator=y,t.async=function(e,n,i,r,a){void 0===a&&(a=Promise);var o=new y(u(e,n,i,r),a);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},_(E),s(E,o,"Generator"),E[r]=function(){return this},E.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=S,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return o.type="throw",o.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,c):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;A(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=i}catch(t){Function("r","regeneratorRuntime = r")(i)}},function(t,e,n){n(71),n(42),n(44),n(191),n(194),n(195),t.exports=n(7).Promise},function(t,e,n){"use strict";var i,r,a,o,s=n(48),u=n(12),l=n(31),c=n(74),h=n(11),f=n(16),d=n(39),p=n(73),v=n(46),g=n(129),E=n(102).set,_=n(192)(),y=n(103),m=n(131),T=n(193),A=n(132),R=u.TypeError,S=u.process,x=S&&S.versions,P=x&&x.v8||"",O=u.Promise,I="process"==c(S),w=function(){},b=r=y.f,D=!!function(){try{var t=O.resolve(1),e=(t.constructor={})[n(19)("species")]=function(t){t(w,w)};return(I||"function"==typeof PromiseRejectionEvent)&&t.then(w)instanceof e&&0!==P.indexOf("6.6")&&-1===T.indexOf("Chrome/66")}catch(t){}}(),C=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;_((function(){for(var i=t._v,r=1==t._s,a=0,o=function(e){var n,a,o,s=r?e.ok:e.fail,u=e.resolve,l=e.reject,c=e.domain;try{s?(r||(2==t._h&&k(t),t._h=1),!0===s?n=i:(c&&c.enter(),n=s(i),c&&(c.exit(),o=!0)),n===e.promise?l(R("Promise-chain cycle")):(a=C(n))?a.call(n,u,l):u(n)):l(i)}catch(t){c&&!o&&c.exit(),l(t)}};n.length>a;)o(n[a++]);t._c=[],t._n=!1,e&&!t._h&&N(t)}))}},N=function(t){E.call(u,(function(){var e,n,i,r=t._v,a=M(t);if(a&&(e=m((function(){I?S.emit("unhandledRejection",r,t):(n=u.onunhandledrejection)?n({promise:t,reason:r}):(i=u.console)&&i.error&&i.error("Unhandled promise rejection",r)})),t._h=I||M(t)?2:1),t._a=void 0,a&&e.e)throw e.v}))},M=function(t){return 1!==t._h&&0===(t._a||t._c).length},k=function(t){E.call(u,(function(){var e;I?S.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})}))},U=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},G=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw R("Promise can't be resolved itself");(e=C(t))?_((function(){var i={_w:n,_d:!1};try{e.call(t,l(G,i,1),l(U,i,1))}catch(t){U.call(i,t)}})):(n._v=t,n._s=1,L(n,!1))}catch(t){U.call({_w:n,_d:!1},t)}}};D||(O=function(t){p(this,O,"Promise","_h"),d(t),i.call(this);try{t(l(G,this,1),l(U,this,1))}catch(t){U.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(72)(O.prototype,{then:function(t,e){var n=b(g(this,O));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=I?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),a=function(){var t=new i;this.promise=t,this.resolve=l(G,t,1),this.reject=l(U,t,1)},y.f=b=function(t){return t===O||t===o?new a(t):r(t)}),h(h.G+h.W+h.F*!D,{Promise:O}),n(53)(O,"Promise"),n(133)("Promise"),o=n(7).Promise,h(h.S+h.F*!D,"Promise",{reject:function(t){var e=b(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!D),"Promise",{resolve:function(t){return A(s&&this===o?O:this,t)}}),h(h.S+h.F*!(D&&n(134)((function(t){O.all(t).catch(w)}))),"Promise",{all:function(t){var e=this,n=b(e),i=n.resolve,r=n.reject,a=m((function(){var n=[],a=0,o=1;v(t,!1,(function(t){var s=a++,u=!1;n.push(void 0),o++,e.resolve(t).then((function(t){u||(u=!0,n[s]=t,--o||i(n))}),r)})),--o||i(n)}));return a.e&&r(a.v),n.promise},race:function(t){var e=this,n=b(e),i=n.reject,r=m((function(){v(t,!1,(function(t){e.resolve(t).then(n.resolve,i)}))}));return r.e&&i(r.v),n.promise}})},function(t,e,n){var i=n(12),r=n(102).set,a=i.MutationObserver||i.WebKitMutationObserver,o=i.process,s=i.Promise,u="process"==n(52)(o);t.exports=function(){var t,e,n,l=function(){var i,r;for(u&&(i=o.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(u)n=function(){o.nextTick(l)};else if(!a||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(l)}}else n=function(){r.call(i,l)};else{var h=!0,f=document.createTextNode("");new a(l).observe(f,{characterData:!0}),n=function(){f.data=h=!h}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},function(t,e,n){var i=n(12).navigator;t.exports=i&&i.userAgent||""},function(t,e,n){"use strict";var i=n(11),r=n(7),a=n(12),o=n(129),s=n(132);i(i.P+i.R,"Promise",{finally:function(t){var e=o(this,r.Promise||a.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then((function(){return n}))}:t,n?function(n){return s(e,t()).then((function(){throw n}))}:t)}})},function(t,e,n){"use strict";var i=n(11),r=n(103),a=n(131);i(i.S,"Promise",{try:function(t){var e=r.f(this),n=a(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){n(197),t.exports=n(7).Object.keys},function(t,e,n){var i=n(40),r=n(51);n(75)("keys",(function(){return function(t){return r(i(t))}}))},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(14)),l=s(n(17)),c=s(n(15)),h=s(n(5)),f=s(n(6)),d=s(n(135)),p=s(n(202)),v=U(n(21)),g=s(n(216)),E=s(n(217)),_=s(n(227)),y=s(n(228)),m=s(n(139)),T=s(n(229)),A=s(n(23)),R=U(n(60)),S=U(n(61)),x=s(n(248)),P=s(n(258)),O=U(n(24)),I=s(n(263)),w=U(n(8)),b=s(n(41)),D=s(n(82)),C=s(n(267)),L=s(n(138)),N=s(n(27)),M=s(n(47));function k(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(k=function(t){return t?n:e})(t)}function U(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=k(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var G=function(){function t(e){var n;(0,h.default)(this,t),this.emitter=void 0,this.store=void 0,this.ability=void 0,this.userData=void 0,this.shapeData=void 0,this.pageData=void 0,this.classData=void 0,this.serverData=void 0,this.docData=void 0,this.masterServer=void 0,this.roomServer=void 0,this.chatServer=void 0,this.store=new d.default({}),this.ability=new m.default(this.store),e.env||(e.env,S.PRODUCTION),e.userState={};var i=e.user;i.type=(0,L.default)(i.type),i.group=(0,L.default)(i.group,v.NONE_GROUP_ID),i.number=(0,N.default)(i.number),i.endType=null!==(n=i.endType)&&void 0!==n?n:(0,C.default)(i.endType),this.formatClass(e.class),e.apiDomain="".concat("file:"===location.protocol?"https:":location.protocol,"//").concat(e.privateDomain).concat(e.privateDomain?".":"").concat(e.env&&"production"!==e.env?e.env+"-":"","at.baijiayun.com"),this.store.set(e),this.serverData=new T.default(this.store,e.ms,e.msProxies),this.classData=new _.default(this.store),this.userData=new E.default(this.store),this.docData=new p.default,this.pageData=new g.default(this.docData),this.shapeData=new y.default(this.docData),this.emitter=new D.default(!0),this.masterServer=new I.default(this.store,this.emitter,this.serverData.getMasterServerList()[0],this.serverData.getMasterServerList().slice(1)),this.roomServer=new P.default(this.store,this.emitter),this.chatServer=new x.default(this.store,this.emitter)}var e,n,i,r,a,o;return(0,f.default)(t,[{key:"formatClass",value:function(t){t.id=(0,N.default)(t.id),t.hasMoreUser=!0}},{key:"join",value:(o=(0,c.default)(u.default.mark((function t(){var e,n=this;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.masterServer.connect();case 3:return t.next=5,this.masterServer.login();case 5:return e=t.sent,this.masterServer.destroy(),this.serverData.setActiveMasterServer(this.masterServer.getActiveServer()),this.serverData.addRoomServer(e.room_server,!0),this.serverData.addChatServer(e.chat_server,!0),this.serverData.setRoomProxyServerList(e.proxy_room_server_list),this.serverData.setChatProxyServerList(e.proxy_chat_server_list),this.roomServer.setServer(this.serverData.getRoomServerList()[0]),this.roomServer.setProxies(this.serverData.getRoomProxyServerList()),this.chatServer.setServer(this.serverData.getChatServerList()[0]),this.chatServer.setProxies(this.serverData.getChatProxyServerList()),t.next=18,l.default.all([this.roomServer.connect().then((0,c.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.roomServer.login().then((function(t){if(t!==R.ROOM_SERVER_LOGIN_SUCCESS)throw new A.default(O.SIGNAL_SETUP_FAILED,t)})));case 1:case"end":return t.stop()}}),t)}))))]);case 18:this.chatServer.connect().then((function(){return n.chatServer.login()})),t.next=27;break;case 21:throw t.prev=21,t.t0=t.catch(0),this.masterServer.logout(),this.roomServer.logout(),this.chatServer.logout(),t.t0;case 27:case"end":return t.stop()}}),t,this,[[0,21]])}))),function(){return o.apply(this,arguments)})},{key:"leave",value:(a=(0,c.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,this.roomServer.logout(),this.chatServer.logout(),t.next=8;break;case 5:throw t.prev=5,t.t0=t.catch(0),t.t0;case 8:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(){return a.apply(this,arguments)})},{key:"fire",value:function(t,e){this.emitter.fire(t,w.array(e)?e:(0,b.default)(e)?[e]:void 0)}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,{fn:e,ctx:n.ctx?n.ctx:this}),this}},{key:"one",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,{fn:e,ctx:n.ctx?n.ctx:this,max:1}),this}},{key:"off",value:function(t,e){return arguments.length>1?this.emitter.off(t,e):this.emitter.off(t),this}},{key:"computeAbilitiesCode",value:function(t,e){return this.ability.getAbilitiesCode(m.default.ABILITY_DOCUMENT,e)}},{key:"searchRawUser",value:(r=(0,c.default)(u.default.mark((function t(e,n){var i=this;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.roomServer.request({message_type:"user_search_req",field:e,query:n}).then((function(t){var e=(0,M.default)(t.result||[]);return i.userData.add(e),e})));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"findUser",value:(i=(0,c.default)(u.default.mark((function t(e){var n;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.userData.findByNumber(e)){t.next=5;break}return t.next=4,this.searchRawUser("number",e);case 4:n=t.sent[0];case 5:return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"findUserById",value:(n=(0,c.default)(u.default.mark((function t(e){var n;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.userData.find(e)){t.next=5;break}return t.next=4,this.searchRawUser("id",e)[0];case 4:n=t.sent;case 5:return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"destroy",value:(e=(0,c.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.leave();case 2:this.store.destroy(),this.store=null,this.emitter.off(),this.emitter=null,this.serverData.destroy(),this.classData.destroy(),this.userData.destroy(),this.serverData=this.classData=this.userData=null,this.docData.destroy(),this.pageData.destroy(),this.shapeData.destroy(),this.docData=this.pageData=this.shapeData=null,this.masterServer.destroy(),this.roomServer.destroy,this.chatServer.destroy,this.masterServer=this.roomServer=this.chatServer=null;case 18:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}();e.default=G},function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function a(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new a(r.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new a(r.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(200),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(58))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,r,a,o,s,u=1,l={},c=!1,h=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){p(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((a=new MessageChannel).port1.onmessage=function(t){p(t.data)},i=function(t){a.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,i=function(t){var e=h.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):i=function(t){setTimeout(p,0,t)}:(o="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&p(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),i=function(e){t.postMessage(o+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return l[u]=r,i(u),u++},f.clearImmediate=d}function d(t){delete l[t]}function p(t){if(c)setTimeout(p,0,t);else{var e=l[t];if(e){c=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{d(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(58),n(201))},function(t,e){var n,i,r=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var u,l=[],c=!1,h=-1;function f(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&d())}function d(){if(!c){var t=s(f);c=!0;for(var e=l.length;e;){for(u=l,l=[];++h<e;)u&&u[h].run();h=-1,e=l.length}u=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||c||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=v,r.addListener=v,r.once=v,r.off=v,r.removeListener=v,r.removeAllListeners=v,r.emit=v,r.prependListener=v,r.prependOnceListener=v,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=E(n(21)),h=E(n(203)),f=E(n(8)),d=E(n(9)),p=E(n(10)),v=s(n(138));function g(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(g=function(t){return t?n:e})(t)}function E(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=g(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var _=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.DOC_QUALITY_LOW,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.DOC_FIT_VIEW;(0,u.default)(this,t),this.raw=void 0,this.quality=void 0,this.fit=void 0,this.scale=void 0,this.whiteboardImageConfig=void 0,this.pageUrlFormat=void 0,this.whiteboardImageConfig={},this.scale=1,this.raw=[],this.quality=e,this.fit=(0,v.default)(h.get(h.LOCAL_DOC_FIT),n),this.pageUrlFormat=function(t,e,n){return t?"".concat(t,"_").concat(e+1,".png"):c.DEFAULT_IMAGE_URL_OF_DOC}}return(0,l.default)(t,[{key:"clear",value:function(){this.raw=[]}},{key:"getDocumentById",value:function(t){var e;return d.each(this.raw,(function(n,i){if(t==n.id)return e=n,!1})),e}},{key:"getDocumentByNumber",value:function(t){var e;return d.each(this.raw,(function(n,i){if(t==n.number)return e=n,!1})),e}},{key:"isWhiteboardDoc",value:function(t){return t===c.DOC_ID_OF_WHITEBOARD}},{key:"isAnimationDoc",value:function(t){var e;return!(null===(e=this.getDocumentById(t))||void 0===e||!e.pptUrl)}},{key:"isNormalDoc",value:function(t){var e;return!(this.isWhiteboardDoc(t)||null!==(e=this.getDocumentById(t))&&void 0!==e&&e.pageInfo.isH5Doc)}},{key:"isH5PPT",value:function(t){var e;return null===(e=this.getDocumentById(t))||void 0===e?void 0:e.pageInfo.isH5Doc}},{key:"add",value:function(t){t&&(f.array(t)||(t=[t]),this.raw=this.raw.concat(t))}},{key:"update",value:function(t,e){var n=this,i=this.getDocumentById(t);i&&p.each(e,(function(t,e){i.hasOwnProperty(e)&&(i[e]=f.isPlainObject(i[e])?p.extend(i[e],t):t,"pageInfo"===e&&n.updatePageList(i))}))}},{key:"remove",value:function(t){var e=-1;if(d.each(this.raw,(function(n,i){n.id===t&&(e=i)})),e>=0)return this.raw.splice(e,1)[0]}},{key:"updatePageList",value:function(t){if(f.string(t)&&(t=this.getDocumentById(t)),f.object(t)){f.array(t.pageList)?t.pageList.length=0:t.pageList=[];for(var e=t.pageInfo,n=e.isDoc,i=e.pageIds,r=this.isWhiteboardDoc(t.id)&&f.array(i),a=0;a<e.totalPages;a++){var o={width:+e.width,height:+e.height,url:e.url};n&&(o.url=this.pageUrlFormat(e.urlPrefix,a,t)),r&&(o.pageId=i[a]),t.pageList.push(o)}return t.pageList}}},{key:"getQuality",value:function(){return this.quality}},{key:"setQuality",value:function(t){this.quality=t}},{key:"getFit",value:function(){return this.fit}},{key:"setFit",value:function(t){this.fit=t,h.set(h.LOCAL_DOC_FIT,t)}},{key:"getWhiteboardDocCount",value:function(){return this.isWhiteboardDoc(this.raw[0]&&this.raw[0].id)?1:0}},{key:"all",value:function(){return this.raw.slice()}},{key:"getWhiteboardList",value:function(){return this.raw.slice(0,this.getWhiteboardDocCount())}},{key:"getDocumentList",value:function(){return this.raw.slice(this.getWhiteboardDocCount())}},{key:"getPageInfoByDoc",value:function(t,e){var n;return null===(n=this.getDocumentById(t))||void 0===n?void 0:n.pageList[e]}},{key:"getRemarkInfoByDoc",value:function(t,e){var n,i;return null!==(n=null===(i=this.getDocumentById(t))||void 0===i?void 0:i.remarkInfo[e])&&void 0!==n?n:""}},{key:"getPageById",value:function(t,e){var n=this.getDocumentById(t);if(n){var i=n.pageInfo.pageIds;if(f.array(i)){var r=d.indexOf(i,e);if(r>-1)return r}}return 0}},{key:"getIdByPage",value:function(t,e){if(this.isWhiteboardDoc(t)){var n=this.getPageInfoByDoc(t,e);return n?n.pageId:0}return e}},{key:"getLocalPage",value:function(t,e){return this.isWhiteboardDoc(t)?this.getPageById(t,e):e}},{key:"getServerPage",value:function(t,e){return this.isWhiteboardDoc(t)?this.getIdByPage(t,e):e}},{key:"addPage",value:function(t,e){var n=this.getDocumentById(t),i=n.pageInfo;n.pageList.push({width:i.width,height:i.height,url:i.url,pageId:e});var r=i.pageIds;return r||(r=[]),r.push(e),i.pageIds=r,i.totalPages=i.totalPages+1,{docId:t,pageId:e,page:this.getPageById(t,e)}}},{key:"deletePage",value:function(t,e){var n=this.getDocumentById(t);if(n){var i=n.pageInfo,r=n.pageList,a=this.getPageById(t,e);if(i.totalPages>1&&a>-1)return r.splice(a,1),i.pageIds&&i.pageIds.splice(a,1),i.totalPages=i.totalPages-1,{docId:t,pageId:e,page:a}}}},{key:"setScale",value:function(t){this.scale=t}},{key:"getScale",value:function(){return this.scale}},{key:"setWhiteboardImageConfig",value:function(t){p.extend(this.whiteboardImageConfig,t);var e=this.getDocumentById(c.DOC_ID_OF_WHITEBOARD);e&&(this.whiteboardImageConfig.url&&(e.pageInfo.url=this.whiteboardImageConfig.url),this.whiteboardImageConfig.width&&(e.pageInfo.width=this.whiteboardImageConfig.width),this.whiteboardImageConfig.height&&(e.pageInfo.height=this.whiteboardImageConfig.height),this.updatePageList(e))}},{key:"getWhiteboardImageConfig",value:function(){return this.whiteboardImageConfig}},{key:"setPageUrlFormat",value:function(t){this.pageUrlFormat=t}},{key:"destroy",value:function(){this.raw=null,this.whiteboardImageConfig=null}}]),t}();e.default=_},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.init=f,e.set=function(t,e){s||f();s.set(t,e)},e.get=function(t,e){s||f();return void 0===s.get(t)?e:s.get(t)},e.remove=function(t){s||f();s.remove(t)},e.LOCAL_DOC_FIT=void 0;var s,u=h(n(204)),l=h(n(215));function c(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(c=function(t){return t?n:e})(t)}function h(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function f(){s||(s=l.support?l:u)}e.LOCAL_DOC_FIT="brtm_doc_image_fit"},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.get=function(t){var e=function(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));var e={};try{t=decodeURIComponent(t.replace(/\+/g," ")),l.each((0,u.default)(t,";"),(function(t,n){var i=(0,u.default)(t,"="),r=i[0],a=i[1];r&&(e[r]=a)}))}catch(t){}return e}(document.cookie);return c.string(t)?e[t]:e},e.set=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=h.extend({},p);h.extend(i,n),c.isPlainObject(t)?h.each(t,(function(t,e){v(e,t,i)})):v(t,e,i)},e.remove=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.expires=-1;var n=h.extend({},p);h.extend(n,e),v(t,"",n)};var u=s(n(136)),l=d(n(9)),c=d(n(8)),h=d(n(10));function f(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(f=function(t){return t?n:e})(t)}function d(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var p={};function v(t,e,n){var i=n.expires;c.number(i)&&(i=new Date((new Date).getTime()+60*i*60*1e3)),document.cookie=[encodeURIComponent(t),"=",encodeURIComponent(e),i?";expires="+i.toUTCString():"",n.path?";path="+n.path:"",n.domain?";domain="+n.domain:"",n.secure?";secure":""].join("")}},function(t,e,n){n(206),t.exports=n(7).Array.isArray},function(t,e,n){var i=n(11);i(i.S,"Array",{isArray:n(98)})},function(t,e,n){t.exports=n(208)},function(t,e,n){n(209),t.exports=n(7).parseFloat},function(t,e,n){var i=n(11),r=n(210);i(i.G+i.F*(parseFloat!=r),{parseFloat:r})},function(t,e,n){var i=n(12).parseFloat,r=n(137).trim;t.exports=1/i(n(104)+"-0")!=-1/0?function(t){var e=r(String(t),3),n=i(e);return 0===n&&"-"==e.charAt(0)?-0:n}:i},function(t,e,n){t.exports=n(212)},function(t,e,n){n(213),t.exports=n(7).Object.freeze},function(t,e,n){var i=n(16),r=n(45).onFreeze;n(75)("freeze",(function(t){return function(e){return t&&i(e)?t(r(e)):e}}))},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.match=function(t,e){if(t===e)return e.length;return e+=u.RAW_DOT,s.startsWith(t,e)?e.length:u.MINUS_ONE},e.each=function(t,e){for(var n=p.hasOwnProperty(t)?p[t]:p[t]=t.split(u.RAW_DOT),i=0,r=n.length-1;i<=r&&e(n[i],i===r)!==u.FALSE;i++);},e.join=function(t,e){return t&&e?t+u.RAW_DOT+e:t||e},e.isFuzzy=function(t){return s.has(t,u.RAW_WILDCARD)},e.matchFuzzy=function(t,e){var n=v[e];if(!n){var i=e.replace(h,"\\.").replace(f,"(\\w+)").replace(d,"([.\\w]+?)");n=v[e]=new RegExp("^".concat(i,"$"))}var r=t.match(n);if(r)return r[1]},e.rootPath=function(t){return t&&t.split(u.RAW_DOT).shift()};var s=c(n(77)),u=c(n(18));function l(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(l=function(t){return t?n:e})(t)}function c(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=l(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var c=s?o(t,u):null;c&&(c.get||c.set)?a(r,u,c):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var h=/\./g,f=/\*/g,d=/\*\*/g,p={},v={}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.remove=e.get=e.set=e.support=void 0;var s=n(18),u=h(n(8)),l=h(n(10));function c(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(c=function(t){return t?n:e})(t)}function h(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var f=void 0!==window.localStorage;e.support=f;var d=s.EMPTY_FUNCTION,p=s.EMPTY_FUNCTION,v=s.EMPTY_FUNCTION;f&&(d=function(t,e){if(u.isPlainObject(t))l.each(t,(function(t,e){d(e,t)}));else try{localStorage[t]=e}catch(t){}},p=function(t){var e;try{e=localStorage[t]}catch(t){}return e},v=function(t){try{localStorage.removeItem(t)}catch(t){}});var g=d;e.set=g;var E=p;e.get=E;var _=v;e.remove=_},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(21));function h(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(h=function(t){return t?n:e})(t)}var f=function(){function t(e){(0,u.default)(this,t),this.docData=void 0,this.serverDocId=void 0,this.serverPage=void 0,this.serverStep=void 0,this.clientDocId=void 0,this.clientPage=void 0,this.clientStep=void 0,this.maxPage=void 0,this.maxStep=void 0,this.docData=e,this.serverDocId=c.DOC_ID_OF_WHITEBOARD,this.serverPage=0,this.serverPage=0,this.clientDocId=c.DOC_ID_OF_WHITEBOARD,this.clientPage=0,this.clientStep=0,this.maxPage=0,this.maxStep=0}return(0,l.default)(t,[{key:"setMaxPage",value:function(t,e){this.maxPage=t,this.maxStep=null==e?this.maxStep:e}},{key:"getClientDocId",value:function(){return this.clientDocId}},{key:"getServerDocId",value:function(){return this.serverDocId}},{key:"hasPrevPage",value:function(t){return t>0}},{key:"hasNextPage",value:function(t){var e=this.docData.getDocumentById(this.serverDocId);return!!e&&(this.clientDocId===this.serverDocId&&t<e.pageList.length-1)}},{key:"hasPrevStep",value:function(t,e){return t===this.clientPage&&e>0}},{key:"hasNextStep",value:function(t,e,n){return e<n-1}},{key:"prevPage",value:function(){return!!this.hasPrevPage(this.clientPage)&&(this.clientPage--,!0)}},{key:"nextPage",value:function(){return!!this.hasNextPage(this.clientPage)&&(this.clientPage++,!0)}},{key:"setClientPage",value:function(t){t>=0&&(this.clientPage=t)}},{key:"getClientPage",value:function(){return this.clientPage}},{key:"getClientStep",value:function(){return this.clientStep}},{key:"getServerPage",value:function(){return this.serverPage}},{key:"getServerStep",value:function(){return this.serverStep}},{key:"getMaxPage",value:function(){return this.maxPage}},{key:"getMaxStep",value:function(){return this.maxStep}},{key:"isSamePageWithServer",value:function(t){return this.clientDocId===this.serverDocId&&this.clientPage===this.serverPage&&(!t||this.clientStep===this.serverStep)}},{key:"serverPageChange",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.docData.getDocumentById(t);!i||i.id===this.clientDocId&&0!==this.maxPage||this.setMaxPage(i.pageList.length-1),this.serverDocId=this.clientDocId=t,this.serverPage=this.clientPage=e,this.serverStep=this.clientStep=n}},{key:"clientPageChange",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.clientDocId=t,this.clientPage=e,this.clientStep=n}},{key:"pageCountChange",value:function(t,e){t===this.clientDocId&&this.setMaxPage(e-1)}},{key:"destroy",value:function(){this.docData=null}}]),t}();e.default=f,f.PAGE_TURNING_INTERVAL=300},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(26)),l=s(n(5)),c=s(n(6)),h=y(n(21)),f=n(28),d=s(n(59)),p=y(n(8)),v=y(n(9)),g=y(n(10)),E=s(n(47));function _(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(_=function(t){return t?n:e})(t)}function y(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=_(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var m=function(){function t(e){(0,l.default)(this,t),this.store=void 0,this.idToUserMap=void 0,this.numberToUserMap=void 0,this.store=e,this.idToUserMap=new u.default,this.numberToUserMap=new u.default}return(0,c.default)(t,[{key:"isValidUserId",value:function(t){return t||"0"==t}},{key:"getValidUser",value:function(t){var e=this.idToUserMap.get(t);if(e&&e===this.numberToUserMap.get(e.number))return e}},{key:"updateUser",value:function(t,e){var n=t.type===h.ROLE_TYPE_TEACHER,i=t.id===this.store.get("user.id"),r=g.extend({},e);return n&&g.extend(r,this.store.get("teacher")),i&&g.extend(r,this.store.get("user")),g.extend(r,t),r=(0,E.default)(r),n&&this.store.set("teacher",r),i&&this.store.set("user",r),r}},{key:"add",value:function(t){var e=this;p.array(t)||(t=[t]);var n=[],i=[];return v.each(t,(function(t){e.isValidUserId(t.id)&&(e.getValidUser(t.id)?(e.update(t),i.push(t)):(t=e.updateUser(t),e.idToUserMap.set(t.id,t),e.numberToUserMap.set(t.number,t),n.push(t)))})),{addList:n,updateList:i}}},{key:"update",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.getValidUser(t.id);if(n){var i=g.diff(t,n);if(0===i.length)return{add:null,update:null,diff:null};v.each(i,(function(i){if(v.has(e,i))return t[i]=n[i],!0}));var r=this.updateUser(t,n);return this.idToUserMap.set(t.id,r),this.numberToUserMap.set(t.number,r),{add:null,update:r,diff:i}}if(!this.numberToUserMap.get(t.name))return this.add(t),{add:t,update:null,diff:null}}},{key:"remove",value:function(t){var e=this.getValidUser(t);return!!e&&(this.idToUserMap.delete(e.id),this.numberToUserMap.delete(e.number),e)}},{key:"find",value:function(t){return this.getValidUser(t)}},{key:"findByNumber",value:function(t){var e=this.numberToUserMap.get(t);return e&&this.getValidUser(e.id)}},{key:"toBRTMUser",value:function(t){return{id:(0,d.default)(t.number),role:f.Type2Role[t.type],endType:t.endType,avatar:t.avatar,name:t.name}}},{key:"toBRTMUsers",value:function(t){var e=this;return t.map((function(t){return e.toBRTMUser(t)}))}},{key:"all",value:function(){var t=this,e=[];return this.idToUserMap.forEach((function(n,i){var r=t.getValidUser(i);r&&e.push(r)})),e}},{key:"getSelf",value:function(){return this.toBRTMUser(this.store.get("user"))}},{key:"clear",value:function(){this.idToUserMap.clear(),this.numberToUserMap.clear()}},{key:"destroy",value:function(){this.store=null,this.idToUserMap.clear(),this.idToUserMap=null,this.numberToUserMap.clear(),this.numberToUserMap=null}}]),t}();e.default=m},function(t,e,n){n(71),n(42),n(44),n(219),n(221),n(224),n(225),t.exports=n(7).Map},function(t,e,n){"use strict";var i=n(220),r=n(55);t.exports=n(126)("Map",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=i.getEntry(r(this,"Map"),t);return e&&e.v},set:function(t,e){return i.def(r(this,"Map"),0===t?0:t,e)}},i,!0)},function(t,e,n){"use strict";var i=n(25).f,r=n(50),a=n(72),o=n(31),s=n(73),u=n(46),l=n(87),c=n(122),h=n(133),f=n(22),d=n(45).fastKey,p=n(55),v=f?"_s":"size",g=function(t,e){var n,i=d(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,l){var c=t((function(t,i){s(t,c,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[v]=0,null!=i&&u(i,n,t[l],t)}));return a(c.prototype,{clear:function(){for(var t=p(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),i=g(n,t);if(i){var r=i.n,a=i.p;delete n._i[i.i],i.r=!0,a&&(a.n=r),r&&(r.p=a),n._f==i&&(n._f=r),n._l==i&&(n._l=a),n[v]--}return!!i},forEach:function(t){p(this,e);for(var n,i=o(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(p(this,e),t)}}),f&&i(c.prototype,"size",{get:function(){return p(this,e)[v]}}),c},def:function(t,e,n){var i,r,a=g(t,e);return a?a.v=n:(t._l=a={i:r=d(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=a),i&&(i.n=a),t[v]++,"F"!==r&&(t._i[r]=a)),t},getEntry:g,setStrong:function(t,e,n){l(t,e,(function(t,n){this._t=p(t,e),this._k=n,this._l=void 0}),(function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?c(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,c(1))}),n?"entries":"values",!n,!0),h(e)}}},function(t,e,n){var i=n(11);i(i.P+i.R,"Map",{toJSON:n(222)("Map")})},function(t,e,n){var i=n(74),r=n(223);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return r(this)}}},function(t,e,n){var i=n(46);t.exports=function(t,e){var n=[];return i(t,!1,n.push,n,e),n}},function(t,e,n){n(127)("Map")},function(t,e,n){n(128)("Map")},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/\_(\w)/g;return(t=(0,a.default)(t)).replace(e,(function(t,e){return e.toUpperCase()}))};var a=r(n(27))},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(5)),o=r(n(6)),s=function(){function t(e){(0,a.default)(this,t),this.store=void 0,this.store=e}return(0,o.default)(t,[{key:"getToken",value:function(){return this.store.get("token")}},{key:"destroy",value:function(){this.store=null}}]),t}();e.default=s},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(26)),l=s(n(5)),c=s(n(6)),h=v(n(8)),f=v(n(9)),d=v(n(10));function p(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(p=function(t){return t?n:e})(t)}function v(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=p(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var g=function(){function t(e){(0,l.default)(this,t),this.docData=void 0,this.loadMap=void 0,this.layer=void 0,this.shapePreview=void 0,this.docData=e,this.loadMap=new u.default,this.shapePreview=new u.default}return(0,c.default)(t,[{key:"getLoadKey",value:function(t){var e=t.docId,n=this.docData.getServerPage(e,t.page);return"".concat(e,"-").concat(n)}},{key:"getShapeList",value:function(t){return this.loadMap.get(this.getLoadKey(t))}},{key:"removePageShape",value:function(t,e){this.loadMap.delete(this.getLoadKey({docId:t,page:e}))}},{key:"get",value:function(t,e){return this.getShapeList({docId:t,page:e})}},{key:"add",value:function(t,e,n){var i=this.get(t,e);if(h.array(i)){var r=n;h.array(n)||(r=[n]);var a=f.toObject(i,"id");f.each(r,(function(t){t.hasAppend&&(t.fromAdd=!0),a[t.id]?f.each(i,(function(e,n){e.id===t.id&&i.splice(n,1,t)})):i.push(t)}))}}},{key:"append",value:function(t,e,n){var i=this.get(t,e);if(h.array(i)){var r=n;h.array(n)||(r=[n]);var a=f.toObject(i,"id");f.each(r,(function(t){a[t.id]?a[t.id].fromAdd||(a[t.id].points=(a[t.id].points||[]).concat(t.points||[]),a[t.id].speeds=(a[t.id].speeds||[]).concat(t.speeds||[])):i.push(t)}))}}},{key:"remove",value:function(t,e,n){var i=this.get(t,e);if(h.array(i)){var r=-1;f.each(i,(function(t,e){if(t.id===n)return r=e,!1})),r>-1&&i.splice(r,1)}}},{key:"update",value:function(t,e,n){var i=this.get(t,e);if(h.array(i)){h.array(n)||(n=[n]);var r=f.toObject(i,"id");f.each(n,(function(t){var e=r[t.id];e&&d.extend(e,t)}))}}},{key:"getBitmaps",value:function(t,e){var n=this.get(t,e);return n&&n.filter((function(t){return"Bitmap"===t.name}))||[]}},{key:"getLayer",value:function(){return this.layer}},{key:"setLayer",value:function(t){t&&(this.layer=t)}},{key:"setShapePreview",value:function(t,e,n){if(this.docData.getPageInfoByDoc(t,e)){var i=this.getLoadKey({docId:t,page:e});this.shapePreview.set(i,n)}}},{key:"getShapePreview",value:function(t,e){var n;return null!==(n=this.shapePreview.get(this.getLoadKey({docId:t,page:e})))&&void 0!==n?n:""}},{key:"getShapePreviewMap",value:function(){var t=new u.default;return this.shapePreview.forEach((function(e,n){t.set(n,e)})),t}},{key:"clear",value:function(t,e){if(null!=t&&null!=e){var n=this.get(t,e);h.array(n)&&(n.length=0)}else this.loadMap.clear(),this.shapePreview.clear()}},{key:"setShapes",value:function(t,e,n){this.loadMap.set(this.getLoadKey({docId:t,page:e}),n)}},{key:"destroy",value:function(){this.loadMap.clear(),this.loadMap=null,this.shapePreview.clear(),this.shapePreview=null,this.docData=null}}]),t}();e.default=g},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=v(n(8)),h=v(n(9)),f=s(n(230)),d=s(n(140));function p(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(p=function(t){return t?n:e})(t)}function v(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=p(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function g(t,e,n){c.array(e)||(e=[e]);var i={},r=function(t){return t.ip+t.port};h.each(t,(function(t,e){i[r(t)]=1})),h.each(e,(function(e,a){i[r(e)]||(n?t.unshift(e):t.push(e))}))}function E(t){return t&&h.each(t,(function(t){t.url=(0,f.default)(t)})),t}var _=function(){function t(e,n,i){(0,u.default)(this,t),this.store=void 0,this.masterServerList=void 0,this.roomServerList=void 0,this.roomProxyServerList=void 0,this.chatServerList=void 0,this.chatProxyServerList=void 0,this.activeMasterServer=void 0,this.activeRoomServer=void 0,this.activeChatServer=void 0,this.store=e,this.masterServerList=[],this.roomServerList=[],this.roomProxyServerList=[],this.chatServerList=[],this.chatProxyServerList=[],this.activeMasterServer=this.activeRoomServer=this.activeChatServer=null;var r=(0,d.default)(),a=i||[];g(a,{ip:r?n.wssIp:n.ip,port:r?n.wssPort:n.port},!0),E(a),this.masterServerList=a}return(0,l.default)(t,[{key:"getMasterServerList",value:function(){return this.masterServerList}},{key:"takeTurnMasterServerList",value:function(){this.masterServerList.push(this.masterServerList.shift())}},{key:"getRoomProxyServerList",value:function(){return this.roomProxyServerList}},{key:"setRoomProxyServerList",value:function(t){this.roomProxyServerList=E(t)}},{key:"getChatProxyServerList",value:function(){return this.chatProxyServerList}},{key:"setChatProxyServerList",value:function(t){this.chatProxyServerList=E(t)}},{key:"getRoomServerList",value:function(){return this.roomServerList}},{key:"addRoomServer",value:function(t,e){e&&(this.roomServerList.length=0),g(this.roomServerList,t)}},{key:"getChatServerList",value:function(){return this.chatServerList}},{key:"addChatServer",value:function(t,e){e&&(this.chatServerList.length=0),g(this.chatServerList,t)}},{key:"getActiveMasterServer",value:function(){return this.activeMasterServer}},{key:"setActiveMasterServer",value:function(t){this.activeMasterServer=t}},{key:"getActiveRoomServer",value:function(){return this.activeRoomServer}},{key:"setActiveRoomServer",value:function(t){this.activeRoomServer=t}},{key:"getActiveChatServer",value:function(){return this.activeChatServer}},{key:"setActiveChatServer",value:function(t){this.activeChatServer=t}},{key:"destroy",value:function(){this.store=null,this.masterServerList=this.roomServerList=this.roomProxyServerList=this.chatServerList=this.chatProxyServerList=null,this.activeMasterServer=this.activeRoomServer=this.activeChatServer=null}}]),t}();e.default=_},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=function(t){return a?"wss://"+(t.wssIp||t.ip)+":"+(t.wssPort||t.port):"ws://"+(t.ip||t.wssIp)+":"+(t.port||t.wssPort)};var a=(0,r(n(140)).default)()},function(t,e,n){n(232),t.exports=n(7).Reflect.construct},function(t,e,n){var i=n(11),r=n(50),a=n(39),o=n(20),s=n(16),u=n(32),l=n(233),c=(n(12).Reflect||{}).construct,h=u((function(){function t(){}return!(c((function(){}),[],t)instanceof t)})),f=!u((function(){c((function(){}))}));i(i.S+i.F*(h||f),"Reflect",{construct:function(t,e){a(t),o(e);var n=arguments.length<3?t:a(arguments[2]);if(f&&!h)return c(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(l.apply(t,i))}var u=n.prototype,d=r(s(u)?u:Object.prototype),p=Function.apply.call(t,d,e);return s(p)?p:d}})},function(t,e,n){"use strict";var i=n(39),r=n(16),a=n(130),o=[].slice,s={},u=function(t,e,n){if(!(e in s)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";s[e]=Function("F,a","return new F("+i.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=i(this),n=o.call(arguments,1),s=function(){var i=n.concat(o.call(arguments));return this instanceof s?u(e,i.length,i):a(e,i,t)};return r(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e,n){n(235);var i=n(7).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){var i=n(11);i(i.S,"Object",{create:n(50)})},function(t,e,n){n(237),t.exports=n(7).Object.setPrototypeOf},function(t,e,n){var i=n(11);i(i.S,"Object",{setPrototypeOf:n(238).set})},function(t,e,n){var i=n(16),r=n(20),a=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=n(31)(Function.call,n(54).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return a(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:a}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){t.exports=n(241)},function(t,e,n){n(242),t.exports=n(7).Object.getPrototypeOf},function(t,e,n){var i=n(40),r=n(95);n(75)("getPrototypeOf",(function(){return function(t){return r(i(t))}}))},function(t,e,n){var i=n(141),r=n(26),a=n(30),o=n(105),s=n(244),u=n(245);function l(e){var n="function"==typeof r?new r:void 0;return t.exports=l=function(t){if(null===t||!s(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return u(t,arguments,a(this).constructor)}return e.prototype=i(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o(e,t)},l(e)}t.exports=l},function(t,e){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},function(t,e,n){var i=n(29),r=n(105),a=n(246);function o(e,n,s){return a()?t.exports=o=i:t.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return n&&r(a,n.prototype),a},o.apply(null,arguments)}t.exports=o},function(t,e,n){var i=n(29);t.exports=function(){if("undefined"==typeof Reflect||!i)return!1;if(i.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(i(Date,[],(function(){}))),!0}catch(t){return!1}}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.BRTCErrorMessage=e.TencentErrorMap=void 0;var u,l=s(n(34)),c=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(24));function h(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(h=function(t){return t?n:e})(t)}var f={4096:c.INVALID_PARAMETER,4097:c.INVALID_OPERATION,16385:c.SIGNAL_SETUP_FAILED,16386:c.SIGNAL_ERROR,16388:c.JOIN_ROOM_ERROR,16448:c.CLIENT_BANNED,65535:c.UNKNOWN};e.TencentErrorMap=f;var d="contact with BaiJiaYun for more information",p=(u={},(0,l.default)(u,c.LOCAL_ERROR,{name:"local error",message:d}),(0,l.default)(u,c.INVALID_PARAMETER,{name:"param invalid",message:"参数类型错误"}),(0,l.default)(u,c.INVALID_OPERATION,{name:"invalid operation",message:"非法操作"}),(0,l.default)(u,c.NOT_SUPPORTED,{name:"not support",message:"不支持"}),(0,l.default)(u,c.JOIN_ROOM_ERROR,{name:"join channel error",message:"进入房间失败"}),(0,l.default)(u,c.SIGNAL_SETUP_FAILED,{name:"signal setup failed",message:"信令通道建立失败"}),(0,l.default)(u,c.SIGNAL_ERROR,{name:"signal error",message:"信令通道错误"}),(0,l.default)(u,c.CLIENT_BANNED,{name:"client banned",message:"用户被踢出"}),(0,l.default)(u,c.FETCH_ERROR,{name:"fetch fail",message:"网络请求失败，请检查网络状态"}),(0,l.default)(u,c.USER_SIG_ERROR,{name:"userSig error",message:"userSig 验证失败"}),(0,l.default)(u,c.UNKNOWN,{name:"unknow",message:d}),(0,l.default)(u,c.PERMISSION_DENY,{name:"permission deny",message:"权限验证失败"}),u);e.BRTCErrorMessage=p},function(t,e,n){"use strict";var i=n(2),r=n(29),a=n(4),o=n(0),s=n(3),u=n(1);o(e,"__esModule",{value:!0}),e.default=void 0;var l=u(n(14)),c=u(n(17)),h=u(n(78)),f=u(n(15)),d=u(n(5)),p=u(n(6)),v=u(n(79)),g=u(n(37)),E=u(n(38)),_=u(n(30)),y=u(n(106)),m=x(n(21)),T=x(n(60)),A=u(n(107)),R=u(n(47));function S(t){if("function"!=typeof a)return null;var e=new a,n=new a;return(S=function(t){return t?n:e})(t)}function x(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=S(e);if(n&&n.has(t))return n.get(t);var r={},a=o&&s;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=a?s(t,u):null;l&&(l.get||l.set)?o(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function P(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,_.default)(t);if(e){var a=(0,_.default)(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return(0,E.default)(this,n)}}var O=function(t){(0,g.default)(r,t);var e,n,i=P(r);function r(t,e,n,a){var o;return(0,d.default)(this,r),(o=i.call(this,e,n,a)).store=void 0,o.heartbeatTimer=void 0,o.tag="chat-server",o.store=t,o.heartbeatTimer=new A.default((function(){o.heartbeat()}),null,m.HEARTBEAT_INTERVAL),o}return(0,p.default)(r,[{key:"connect",value:(n=(0,f.default)(l.default.mark((function t(){var e=this;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new c.default((function(t,n){(0,v.default)((0,_.default)(r.prototype),"connect",e).call(e,{seqPrefix:e.store.get("user.number"),timeout:m.CHAT_SERVER_CONNECT_TIMEOUT,onOpen:function(n){t(),e.fire(T.CHAT_SERVER_CONNECT_SUCCESS,n)},onClose:function(t){e.fire(T.WEBSOCKET_CLOSE,t),e.fire(T.CHAT_SERVER_OFFLINE),e.endHeartbeat()},onSend:function(t){},onReceive:function(t){},onError:function(t){e.fire(T.CHAT_SERVER_LOGIN_FAIL,t),n(T.CHAT_SERVER_LOGIN_FAIL)},onTimeout:function(t){e.fire(T.CHAT_SERVER_CONNECT_FAIL,t),n(T.CHAT_SERVER_CONNECT_FAIL)}})})));case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"heartbeat",value:function(){this.send({message_type:"heart_beat"})}},{key:"startHeartbeat",value:function(){this.endHeartbeat(),this.heartbeatTimer.start()}},{key:"endHeartbeat",value:function(){this.heartbeatTimer.stop()}},{key:"login",value:(e=(0,f.default)(l.default.mark((function t(){var e,n,i=this;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.store.get("user"),n={message_type:"login_req",class_id:this.store.get("class.id"),user:{id:e.id,number:e.number,group:e.group,type:e.type,name:e.name,avatar:e.avatar,status:0,end_type:e.endType}},t.abrupt("return",this.request(n).then((function(t){return i.startHeartbeat(),0===t.code?i.fire(T.CHAT_SERVER_LOGIN_SUCCESS,{messageList:(0,R.default)(t.message_list)}):i.fire(T.CHAT_SERVER_LOGIN_FAIL),t})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"send",value:function(t){t.class_id=this.store.get("class.id"),t.user_id=this.store.get("user.id"),t.ts=t.ts||(0,h.default)(),(0,v.default)((0,_.default)(r.prototype),"send",this).call(this,t)}},{key:"logout",value:function(){this.heartbeatTimer&&this.heartbeatTimer.stop(),(0,v.default)((0,_.default)(r.prototype),"logout",this).call(this)}},{key:"destroy",value:function(){this.close(),this.heartbeatTimer.destroy(),this.heartbeatTimer=null}}]),r}(y.default);e.default=O},function(t,e,n){n(250),t.exports=n(7).Date.now},function(t,e,n){var i=n(11);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){t.exports=n(252)},function(t,e,n){n(253),t.exports=n(7).Reflect.get},function(t,e,n){var i=n(54),r=n(95),a=n(33),o=n(11),s=n(16),u=n(20);o(o.S,"Reflect",{get:function t(e,n){var o,l,c=arguments.length<3?e:arguments[2];return u(e)===c?e[n]:(o=i.f(e,n))?a(o,"value")?o.value:void 0!==o.get?o.get.call(c):void 0:s(l=r(e))?t(l,n,c):void 0}})},function(t,e,n){var i=n(30);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(80)),l=s(n(5)),c=s(n(6)),h=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(10));function f(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(f=function(t){return t?n:e})(t)}var d=function(){function t(e){(0,l.default)(this,t),this.status=void 0,this.retryIndex=void 0,this.url=void 0,this.socket=void 0,h.extend(this,e),this.status=0,e.retryCount>0&&(this.retryIndex=0)}return(0,c.default)(t,[{key:"isOpen",value:function(){return 1===this.status}},{key:"isConnecting",value:function(){return 5===this.status}},{key:"connect",value:function(t,e){var n=this;if(1!==n.status&&5!==n.status){var i=[t];e&&e.length&&(i=i.concat(e));var r=-1,a=function(){5===n.status&&function(t,e){var i,r=new n.native(t.url),a=function(n){i&&clearTimeout(i),r.onopen=r.onerror=null,e(r,t,n)};r.onopen=function(){a(1)},r.onerror=function(){a(2)},n.timeout>0&&(i=setTimeout((function(){i=null,a(4)}),n.timeout))}(i[++r],(function(t,a,s){if(5===n.status)if(1===s)n.url=a.url,n.socket=t,n.status=1,t.onmessage=function(t){1===n.status&&n.onReceive(JSON.parse(t.data))},t.onclose=function(t){1===n.status&&(n.connectOnClose?(n.status=0,n.connect(a,e)):n.onClose&&n.onClose(t))},n.retryCount>0&&(n.retryIndex=0),n.onOpen&&n.onOpen({server:a});else if(r===i.length-1){if(n.retryCount>0&&n.retryIndex++<n.retryCount)return r=-1,void o();switch(n.status=s){case 2:n.onError&&n.onError({server:a});break;case 4:n.onTimeout&&n.onTimeout({server:a})}}else o()}))},o=function(){n.interval>0?setTimeout(a,n.interval):a()};n.status=5,a()}}},{key:"send",value:function(t){var e=this.socket;e&&(e.send("string"==typeof t?t:(0,u.default)(t)),this.onSend&&this.onSend(t))}},{key:"close",value:function(){var t=this.socket;this.socket=null,this.status=3,t&&(t.onmessage=t.onclose=null,t.close())}}]),t}();e.default=d},function(t,e,n){var i=n(7),r=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(5)),o=r(n(6)),s=r(n(13)),u=function(){function t(e){var n=this;(0,a.default)(this,t),this.ws=void 0,this.url=void 0,this.onopen=void 0,this.onclose=void 0,this.onerror=void 0,this.onmessage=void 0,this.url=e,this.ws=wx.connectSocket({url:this.url}),this.ws.onOpen((function(t){n.onopen&&(0,s.default)(n.onopen,n,[t])})),this.ws.onClose((function(t){n.onclose&&(0,s.default)(n.onclose,n,[t])})),this.ws.onError((function(t){n.onerror&&(0,s.default)(n.onerror,n,[t])})),this.ws.onMessage((function(t){n.onmessage&&(0,s.default)(n.onmessage,n,[t])}))}return(0,o.default)(t,[{key:"send",value:function(t){this.ws.send({data:t})}},{key:"close",value:function(){this.ws.close({code:1e3}),this.ws=null}}]),t}();e.default=u},function(t,e,n){"use strict";var i=n(2),r=n(29),a=n(4),o=n(0),s=n(3),u=n(1);o(e,"__esModule",{value:!0}),e.default=void 0;var l=u(n(14)),c=u(n(17)),h=u(n(78)),f=u(n(15)),d=u(n(5)),p=u(n(6)),v=u(n(79)),g=u(n(37)),E=u(n(38)),_=u(n(30)),y=u(n(106)),m=x(n(21)),T=x(n(60)),A=n(143),R=u(n(107));function S(t){if("function"!=typeof a)return null;var e=new a,n=new a;return(S=function(t){return t?n:e})(t)}function x(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=S(e);if(n&&n.has(t))return n.get(t);var r={},a=o&&s;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=a?s(t,u):null;l&&(l.get||l.set)?o(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function P(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,_.default)(t);if(e){var a=(0,_.default)(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return(0,E.default)(this,n)}}var O=function(t){(0,g.default)(r,t);var e,n,i=P(r);function r(t,e,n,a){var o;return(0,d.default)(this,r),(o=i.call(this,e,n,a)).store=void 0,o.heartbeatTimer=void 0,o.tag="room-server",o.store=t,o.heartbeatTimer=new R.default((function(){o.heartbeat()}),null,m.HEARTBEAT_INTERVAL),o}return(0,p.default)(r,[{key:"connect",value:(n=(0,f.default)(l.default.mark((function t(){var e=this;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new c.default((function(t,n){(0,v.default)((0,_.default)(r.prototype),"connect",e).call(e,{seqPrefix:e.store.get("user.number"),timeout:m.ROOM_SERVER_CONNECT_TIMEOUT,onOpen:function(n){t(),e.fire(T.ROOM_SERVER_CONNECT_SUCCESS,n)},onClose:function(t){e.fire(T.WEBSOCKET_CLOSE,t),e.endHeartbeat()},onSend:function(t){},onReceive:function(t){},onError:function(t){e.fire(T.ROOM_SERVER_CONNECT_FAIL,t),n(T.ROOM_SERVER_CONNECT_FAIL)},onTimeout:function(t){e.fire(T.ROOM_SERVER_CONNECT_TIMEOUT,t),n(T.ROOM_SERVER_CONNECT_TIMEOUT)}})})));case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"heartbeat",value:function(){var t=new Date,e=t.getTime();this.send({message_type:"heart_beat",timestamp:Math.round(e/1e3)+60*t.getTimezoneOffset(),ts:e})}},{key:"startHeartbeat",value:function(){this.endHeartbeat(),this.heartbeatTimer.start()}},{key:"endHeartbeat",value:function(){this.heartbeatTimer.stop()}},{key:"login",value:(e=(0,f.default)(l.default.mark((function t(){var e,n,i=this;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.store.get("user"),n={message_type:"login_req",token:this.store.get("token"),speak_state:0,user:{number:e.number,type:e.type,name:e.name,avatar:e.avatar,end_type:e.endType,group:e.group,auth:e.auth},support:{points_decoder:2,doodle_version:1,protocol_version:1}},t.abrupt("return",this.request(n).then((function(t){var e;return 0==t.code?(i.store.set({"class.started":t.started,"class.totalUserCount":t.accumulative_user_count,"class.userCount":t.user_count,"class.loginTime":1e3*t.timestamp,"class.diffNTP":1e3*t.timestamp-(0,A.timestampMillisecond)(),"class.rtmAbilities":null!==(e=t.rtm_abilities)&&void 0!==e?e:1}),i.startHeartbeat(),i.fire(T.ROOM_SERVER_LOGIN_SUCCESS),T.ROOM_SERVER_LOGIN_SUCCESS):1==t.code?(i.fire(T.ROOM_SERVER_LOGIN_FAIL),T.ROOM_SERVER_LOGIN_FAIL):2==t.code?(i.fire(T.ROOM_SERVER_LOGIN_OVERFLOW),T.ROOM_SERVER_LOGIN_OVERFLOW):3==t.code?(i.fire(T.ROOM_SERVER_LOGIN_KICKED_OUT),T.ROOM_SERVER_LOGIN_KICKED_OUT):4==t.code?(i.fire(T.ROOM_SERVER_LOGIN_CONFLICT),T.ROOM_SERVER_LOGIN_CONFLICT):5===t.code?(i.fire(T.ROOM_SERVER_LOGIN_AUDITION_END),T.ROOM_SERVER_LOGIN_AUDITION_END):6===t.code?(i.fire(T.ROOM_SERVER_LOGIN_EXPIRED),T.ROOM_SERVER_LOGIN_EXPIRED):void 0})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"send",value:function(t){var e=this.store.get("user");t.class_id=this.store.get("class.id"),t.user_id=e.id,t.ts=t.ts||(0,h.default)(),t.signal_send_by={id:e.id,number:e.number,type:e.type,group:e.group,end_type:e.endType},(0,v.default)((0,_.default)(r.prototype),"send",this).call(this,t)}},{key:"logout",value:function(){this.send({message_type:"logout_req"}),this.heartbeatTimer&&this.heartbeatTimer.stop(),(0,v.default)((0,_.default)(r.prototype),"logout",this).call(this)}},{key:"destroy",value:function(){this.close(),this.heartbeatTimer.destroy(),this.heartbeatTimer=null}}]),r}(y.default);e.default=O},function(t,e,n){t.exports=n(260)},function(t,e,n){n(261),t.exports=n(7).setImmediate},function(t,e,n){var i=n(11),r=n(102);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=function(t){return u.func(t)&&l.has((0,c.default)(t),"[native code]")};var u=f(n(8)),l=f(n(77)),c=s(n(27));function h(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(h=function(t){return t?n:e})(t)}function f(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}},function(t,e,n){"use strict";var i=n(2),r=n(29),a=n(4),o=n(0),s=n(3),u=n(1);o(e,"__esModule",{value:!0}),e.default=void 0;var l=u(n(14)),c=u(n(17)),h=u(n(15)),f=u(n(5)),d=u(n(6)),p=u(n(79)),v=u(n(37)),g=u(n(38)),E=u(n(30)),_=u(n(106)),y=R(n(21)),m=R(n(60)),T=u(n(144));function A(t){if("function"!=typeof a)return null;var e=new a,n=new a;return(A=function(t){return t?n:e})(t)}function R(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=A(e);if(n&&n.has(t))return n.get(t);var r={},a=o&&s;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=a?s(t,u):null;l&&(l.get||l.set)?o(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function S(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,E.default)(t);if(e){var a=(0,E.default)(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return(0,g.default)(this,n)}}var x=function(t){(0,v.default)(r,t);var e,n,i=S(r);function r(t,e,n,a){var o;return(0,f.default)(this,r),(o=i.call(this,e,n,a)).store=void 0,o.tag="master-server",o.store=t,o}return(0,d.default)(r,[{key:"connect",value:(n=(0,h.default)(l.default.mark((function t(){var e=this;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new c.default((function(t,n){(0,p.default)((0,E.default)(r.prototype),"connect",e).call(e,{seqPrefix:e.store.get("user.number"),timeout:y.MASTER_SERVER_CONNECT_TIMEOUT,onOpen:function(n){t(),e.fire(m.MASTER_SERVER_CONNECT_SUCCESS,n)},onClose:function(t){e.fire(m.WEBSOCKET_CLOSE,t)},onSend:function(t){},onReceive:function(t){},onError:function(t){e.fire(m.MASTER_SERVER_CONNECT_FAIL,t),n(m.MASTER_SERVER_CONNECT_FAIL)},onTimeout:function(t){e.fire(m.MASTER_SERVER_CONNECT_TIMEOUT,t),n(m.MASTER_SERVER_CONNECT_TIMEOUT)}})})));case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"login",value:(e=(0,h.default)(l.default.mark((function t(){var e,n,i,r=this;return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.store.get("class"),n=e.freeOfCharge,i={message_type:"server_info_req",class_id:this.store.get("class.id"),class_type:2,webrtc_type:0,link_capability:this.store.get("class.linkCapability")||0,teacher_number:this.store.get("teacher.number"),user_type:this.store.get("user.type"),live_chat_mode:this.store.get("partner.liveChatMode"),client_ip:this.store.get("user.clientIp"),end_type:this.store.get("user.endType"),free_of_charge:!!n,special_customer:this.store.get("partner.specialCustomer",""),udp_foreign_proxy:0,tcp_foreign_proxy:0,ms_config:(0,T.default)(this.store.get("partner.msConfig"))},t.abrupt("return",this.request(i).then((function(t){return r.store.set("user.id",t.id),r.store.set("user.ip",t.user_ip),t})));case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"destroy",value:function(){this.close()}}]),r}(_.default);e.default=x},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=function(t){return t=(t=(0,a.default)(t)).replace(/([A-Z])/g,"_$1").toLowerCase()};var a=r(n(27))},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(18));function h(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(h=function(t){return t?n:e})(t)}var f=function(){function t(e,n){(0,u.default)(this,t),this.type=void 0,this.phase=void 0,this.ns=void 0,this.target=void 0,this.originalEvent=void 0,this.isPrevented=void 0,this.isStoped=void 0,this.listener=void 0,this.type=e,this.phase=t.PHASE_CURRENT,n&&(this.originalEvent=n)}return(0,l.default)(t,[{key:"preventDefault",value:function(){if(!this.isPrevented){var t=this.originalEvent;t&&t.preventDefault(),this.isPrevented=c.TRUE}return this}},{key:"stopPropagation",value:function(){if(!this.isStoped){var t=this.originalEvent;t&&t.stopPropagation(),this.isStoped=c.TRUE}return this}},{key:"prevent",value:function(){return this.preventDefault()}},{key:"stop",value:function(){return this.stopPropagation()}}]),t}();e.default=f,f.PHASE_CURRENT=0,f.PHASE_UPWARD=1,f.PHASE_DOWNWARD=c.MINUS_ONE},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.debug=function(t,e){g()<=1&&v(e||"brtm debug",t,E("#999"))},e.info=function(t,e){g()<=2&&v(e||"brtm info",t,E("#2db7f5"))},e.call=function(t,e,n){g()<=2&&v(e||"brtm info",t,E("#66cdaa"),n)},e.warn=function(t,e){g()<=3&&v(e||"brtm warn",t,E("#f90"))},e.error=function(t,e){g()<=4&&v(e||"brtm error",t,E("#ed4014"))},e.fatal=function(t,e){if(g()<=5)throw new Error("[".concat(e||"brtm fatal","]: ").concat(t))},e.FATAL=e.ERROR=e.WARN=e.INFO=e.DEBUG=void 0;var u=s(n(2)),l=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(18)),c=s(n(27));function h(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(h=function(t){return t?n:e})(t)}e.DEBUG=1;e.INFO=2;e.WARN=3;e.ERROR=4;e.FATAL=5;var f=("undefined"==typeof console?"undefined":(0,u.default)(console))!==l.RAW_UNDEFINED?console:l.NULL,d=/bjy/.test((0,c.default)(l.EMPTY_FUNCTION))?2:3,p=l.WINDOW&&/edge|msie|trident/i.test(l.WINDOW.navigator.userAgent)?l.EMPTY_STRING:"%c",v=f?p?function(t,e,n,i){i?f.log(p+t,n,e,i):f.log(p+t,n,e)}:function(t,e,n){n?f.log(t,e,n):f.log(t,e)}:l.EMPTY_FUNCTION;function g(){if(l.GLOBAL){var t=l.GLOBAL.YOX_LOG_LEVEL;if(t>=1&&t<=5)return t}return d}function E(t){return"background-color:".concat(t,";border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;")}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=function(t){if(null!=t)return t;t=l.default.android||l.default.ios||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1?u.END_TYPE_MOBILE_BROWSER:u.END_TYPE_PC_BROWSER;return t};var u=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(21)),l=s(n(108));function c(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(c=function(t){return t?n:e})(t)}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.ParameterHanlderMap=e.EventsMap=e.events=void 0;var u=s(n(34)),l=n(145),c=s(n(23)),h=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(24));function f(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(f=function(t){return t?n:e})(t)}var d=[l.ERROR];e.events=d;var p=(0,u.default)({},l.ERROR,["chat_server_connect_fail","chat_server_login_fail","chat_server_offline","room_server_connect_fail","room_server_connect_timeout"]);e.EventsMap=p;var v=(0,u.default)({},l.ERROR,(function(){return new c.default(h.SIGNAL_ERROR,"信令通道失败")}));e.ParameterHanlderMap=v},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(78)),o=r(n(5)),s=r(n(6)),u=function(){function t(e){(0,o.default)(this,t),this.timeout=void 0,this.timer=void 0,this.resolve=void 0,this.reject=void 0,this.startTime=void 0,this.timeout=e}return(0,s.default)(t,[{key:"then",value:function(t,e){var n=this;this.resolve=t,this.reject=e,this.startTime=(0,a.default)(),this.timer=setTimeout((function(){n.resolve((0,a.default)()-n.startTime),n.timer=null}),1e3*this.timeout)}},{key:"stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.timer&&(clearTimeout(this.timer),this.timer=null,this.resolve&&t?this.resolve((0,a.default)()-this.startTime):this.reject&&!t&&this.reject((0,a.default)()-this.startTime))}}]),t}();e.default=u},function(t,e,n){"use strict";var i;n(0)(e,"__esModule",{value:!0}),e.default=void 0;var r=navigator.userAgent||"",a={ethernet:"ethernet",wifi:"wifi","5g":"5g","4g":"4g","3g":"3g","3gnet":"3g","2g":"2g","slow-2g":"2g"};if(!(i=a[(r.match(/NetType\/\w+/)?r.match(/NetType\/\w+/)[0]:"NetType/other").toLowerCase().replace("nettype/","")])){var o=navigator.connection||navigator.mozConnection||navigator.webkitConnection;o&&((i=a[o.type])||(i=a[o.effectiveType]))}i||(i="unknown");var s={name:i};e.default=s},function(t,e,n){"use strict";var i=n(2),r=n(29),a=n(4),o=n(0),s=n(3),u=n(1);o(e,"__esModule",{value:!0}),e.default=void 0;var l,c,h,f,d,p,v,g,E,_,y,m,T=u(n(17)),A=u(n(3)),R=u(n(14)),S=u(n(15)),x=u(n(5)),P=u(n(6)),O=u(n(37)),I=u(n(38)),w=u(n(30)),b=u(n(56)),D=u(n(83)),C=Y(n(21)),L=Y(n(146)),N=u(n(23)),M=n(64),k=Y(n(24)),U=Y(n(109)),G=Y(n(8)),F=Y(n(9)),V=Y(n(10)),H=u(n(27)),W=u(n(47));function B(t){if("function"!=typeof a)return null;var e=new a,n=new a;return(B=function(t){return t?n:e})(t)}function Y(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=B(e);if(n&&n.has(t))return n.get(t);var r={},a=o&&s;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=a?s(t,u):null;l&&(l.get||l.set)?o(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function j(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,w.default)(t);if(e){var a=(0,w.default)(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return(0,I.default)(this,n)}}var z=(l=(0,M.frequency60)(),c=(0,M.frequency60)(),h=(0,M.frequency60)(),f=(0,M.frequency60)(),d=(0,M.frequency60)(),p=(0,M.frequency60)(),v=(0,M.frequency60)(),g=(0,M.frequency60)(),E=(0,M.frequency60)(),_=(0,M.frequency60)(),y=(0,M.frequency60)(),m=function(t){(0,O.default)(d,t);var e,n,i,r,a,o,s,u,l,c,h,f=j(d);function d(){var t;return(0,x.default)(this,d),(t=f.call(this)).addMessageTypes({user_in:function(e){var n=(0,W.default)(e.user),i=t.room.userData.findByNumber(n.number);i&&(t.room.userData.remove(i.id),t.fire(L.USER_OUT,{user:i})),t.room.userData.add(n),n.id!==t.room.store.get("user.id")&&t.fire(L.USER_IN,t.userData.toBRTMUser(n))},user_out:function(e){var n=e.user_id,i=t.room.userData.find(n);i&&(t.room.userData.remove(n),t.fire(L.USER_OUT,t.userData.toBRTMUser(i)))},user_update:function(e){if(e.id!==t.room.store.get("user.id")){var n=(0,W.default)(e),i=t.room.userData.update(V.extend(V.extend({},t.userData.findByNumber(n.userNumber)),n.user)),r=i.diff,a=i.update;r&&F.has(r,"auth")&&t.fire(L.USER_AUTH_CHANGED,U.decode(a.auth))}},report_user_in_and_out:function(e){t.fire(L.USER_REPORT,{inCount:e.in_count,outCount:e.out_count,userInList:t.userData.toBRTMUsers((0,W.default)(e.user_in_list)),userOutList:t.userData.toBRTMUsers((0,W.default)(e.user_out_list))})},user_count_change:function(e){t.fire(L.USER_COUNT_CHANGED,{userCount:e.user_count,accumulativeUserCount:e.accumulative_user_count})}}),t}return(0,P.default)(d,[{key:"requestActive",value:(h=(0,S.default)(R.default.mark((function t(){var e=this;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.room.roomServer.request({message_type:"user_active_req"}).then((function(t){var n=(0,W.default)(t.user_list||[]),i=t.presenter_id;e.room.store.set("presenterId",i),e.room.userData.add(n);var r=e.room.userData.find(i);return r?e.room.store.set("presenter",r):e.room.store.set("presenterId"),e.userData.toBRTMUsers(n)})));case 1:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"requestMore",value:(c=(0,S.default)(R.default.mark((function t(){var e,n=this,i=arguments;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:C.MORE_USER_COUNT,!this.room.store.get("class.hasMoreUser")){t.next=3;break}return t.abrupt("return",this.room.roomServer.request({message_type:"user_more_req",count:e}).then((function(t){var e=(0,W.default)(t.user_list||[]);return n.room.store.set("class.hasMoreUser",t.has_more),n.room.userData.add(e),{hasMore:t.has_more,userList:n.userData.toBRTMUsers(e)}})));case 3:return t.abrupt("return",T.default.resolve({hasMore:!1,userList:[]}));case 4:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"hasMore",value:function(){return this.room.store.get("class.hasMoreUser")}},{key:"requestState",value:(l=(0,S.default)(R.default.mark((function t(e){var n=this;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.room.roomServer.request({message_type:"user_state_req",user_number:(0,H.default)(e)}).then((function(t){var e=t.user_number,i=(0,W.default)(t.user_state);if(n.room.store.get("user").number===e){var r=V.extend({},n.room.store.get("userState"));r=V.extend(r,i),n.room.store.set("userState",r)}return i})));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"search",value:(u=(0,S.default)(R.default.mark((function t(e){var n=this;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new N.default(k.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.abrupt("return",this.room.roomServer.request({message_type:"user_fuzzy_query_req",sname:e}).then((function(t){var e=[];return F.each(t.user_list,(function(t){e.push((0,W.default)(JSON.parse(t)))})),n.userData.add(e),n.userData.toBRTMUsers(e)})));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"find",value:(s=(0,S.default)(R.default.mark((function t(e){var n;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new N.default(k.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.next=4,this.room.findUser((0,H.default)(e));case 4:if(!(n=t.sent)){t.next=7;break}return t.abrupt("return",this.userData.toBRTMUser(n));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"kickOut",value:(o=(0,S.default)(R.default.mark((function t(e){var n;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new N.default(k.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.next=4,this.room.findUser((0,H.default)(e));case 4:if(n=t.sent){t.next=7;break}throw new N.default(k.INVALID_OPERATION,"找不到 user");case 7:this.room.roomServer.send({message_type:"command_send",from:this.room.store.get("user.id"),to:n.id,data:{command_type:"logout"}});case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"updateUser",value:(a=(0,S.default)(R.default.mark((function t(e,n){var i=this;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.room.roomServer.request({message_type:"user_update_trigger",user_number:(0,H.default)(e),user:n}).then((function(t){var e=(0,W.default)(t);i.room.userData.update(V.extend(V.extend({},i.userData.findByNumber(e.userNumber)),e.user))})));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"getUserAuth",value:(r=(0,S.default)(R.default.mark((function t(e){var n,i;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new N.default(k.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.next=4,this.room.findUser((0,H.default)(e));case 4:if(!(i=t.sent)||G.string(i.auth)){t.next=9;break}return t.next=8,this.room.searchRawUser("number",(0,H.default)(e));case 8:i=t.sent[0];case 9:if(i){t.next=11;break}throw new N.default(k.INVALID_PARAMETER,"未找到该 user");case 11:return t.abrupt("return",U.decode(null!==(n=i.auth)&&void 0!==n?n:""));case 12:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"getUserAuthByIndex",value:(i=(0,S.default)(R.default.mark((function t(e){var n,i,r,a=arguments;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=a.length>1&&void 0!==a[1]?a[1]:0,this.room){t.next=3;break}throw new N.default(k.INVALID_OPERATION,"未加入房间，请先执行 join");case 3:return t.next=5,this.room.findUser((0,H.default)(e));case 5:if(!(r=t.sent)||r.auth){t.next=10;break}return t.next=9,this.room.searchRawUser("number",(0,H.default)(e))[0];case 9:r=t.sent;case 10:if(r){t.next=12;break}throw new N.default(k.INVALID_PARAMETER,"未找到该 user");case 12:return t.abrupt("return",U.getBooleanByIndex(null!==(n=r.auth)&&void 0!==n?n:"",i));case 13:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"updateUserAuth",value:(n=(0,S.default)(R.default.mark((function t(e){var n,i=arguments;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:[],this.room){t.next=3;break}throw new N.default(k.INVALID_OPERATION,"未加入房间，请先执行 join");case 3:return t.abrupt("return",this.updateUser(e,{auth:U.encode(n)}));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"updateUserAuthByIndex",value:(e=(0,S.default)(R.default.mark((function t(e,n){var i,r,a=arguments;return R.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=a.length>2&&void 0!==a[2]&&a[2],this.room){t.next=3;break}throw new N.default(k.INVALID_OPERATION,"未加入房间，请先执行 join");case 3:if(G.range(n,0,63)){t.next=5;break}throw new N.default(k.INVALID_PARAMETER,"index 范围非法");case 5:return t.next=7,this.getUserAuth(e);case 7:if(r=t.sent){t.next=10;break}throw new N.default(k.INVALID_PARAMETER,"未找到该 user");case 10:return r[n]=i,t.abrupt("return",this.updateUser(e,{auth:U.encode(r)}));case 12:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"all",value:function(){return this.userData.toBRTMUsers(this.userData.all())}},{key:"userData",get:function(){return this.room.userData}}]),d}(D.default),(0,b.default)(m.prototype,"requestActive",[l],(0,A.default)(m.prototype,"requestActive"),m.prototype),(0,b.default)(m.prototype,"requestMore",[c],(0,A.default)(m.prototype,"requestMore"),m.prototype),(0,b.default)(m.prototype,"requestState",[h],(0,A.default)(m.prototype,"requestState"),m.prototype),(0,b.default)(m.prototype,"search",[f],(0,A.default)(m.prototype,"search"),m.prototype),(0,b.default)(m.prototype,"find",[d],(0,A.default)(m.prototype,"find"),m.prototype),(0,b.default)(m.prototype,"kickOut",[p],(0,A.default)(m.prototype,"kickOut"),m.prototype),(0,b.default)(m.prototype,"updateUser",[v],(0,A.default)(m.prototype,"updateUser"),m.prototype),(0,b.default)(m.prototype,"getUserAuth",[g],(0,A.default)(m.prototype,"getUserAuth"),m.prototype),(0,b.default)(m.prototype,"getUserAuthByIndex",[E],(0,A.default)(m.prototype,"getUserAuthByIndex"),m.prototype),(0,b.default)(m.prototype,"updateUserAuth",[_],(0,A.default)(m.prototype,"updateUserAuth"),m.prototype),(0,b.default)(m.prototype,"updateUserAuthByIndex",[y],(0,A.default)(m.prototype,"updateUserAuthByIndex"),m.prototype),m);e.default=z},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=function(t,e,n){var i;return function(){var r=this;if(!i){var a=l.toArray(arguments);n&&(0,u.default)(t,r,a),i=setTimeout((function(){i=c.UNDEFINED,n||(0,u.default)(t,r,a)}),e)}}};var u=s(n(13)),l=f(n(9)),c=f(n(18));function h(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(h=function(t){return t?n:e})(t)}function f(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}},function(t,e,n){var i=n(76),r=n(149);t.exports=function(t){if(i(t))return r(t)}},function(t,e,n){var i=n(110),r=n(151),a=n(68);t.exports=function(t){if(void 0!==a&&r(Object(t)))return i(t)}},function(t,e,n){n(42),n(276),t.exports=n(7).Array.from},function(t,e,n){"use strict";var i=n(31),r=n(11),a=n(40),o=n(124),s=n(125),u=n(66),l=n(150),c=n(101);r(r.S+r.F*!n(134)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,h,f=a(t),d="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,g=void 0!==v,E=0,_=c(f);if(g&&(v=i(v,p>2?arguments[2]:void 0,2)),null==_||d==Array&&s(_))for(n=new d(e=u(f.length));e>E;E++)l(n,E,g?v(f[E],E):f[E]);else for(h=_.call(f),n=new d;!(r=h.next()).done;E++)l(n,E,g?o(h,v,[r.value,E],!0):r.value);return n.length=E,n}})},function(t,e,n){n(44),n(42),t.exports=n(278)},function(t,e,n){var i=n(74),r=n(19)("iterator"),a=n(43);t.exports=n(7).isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||a.hasOwnProperty(i(e))}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){"use strict";var i=n(2),r=n(29),a=n(4),o=n(0),s=n(3),u=n(1);o(e,"__esModule",{value:!0}),e.default=void 0;var l,c,h,f,d,p,v=u(n(3)),g=u(n(14)),E=u(n(15)),_=u(n(5)),y=u(n(6)),m=u(n(37)),T=u(n(38)),A=u(n(30)),R=u(n(56)),S=u(n(83)),x=M(n(21)),P=M(n(153)),O=n(28),I=u(n(23)),w=n(64),b=M(n(24)),D=u(n(59)),C=u(n(27)),L=u(n(47));function N(t){if("function"!=typeof a)return null;var e=new a,n=new a;return(N=function(t){return t?n:e})(t)}function M(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=N(e);if(n&&n.has(t))return n.get(t);var r={},a=o&&s;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=a?s(t,u):null;l&&(l.get||l.set)?o(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function k(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,A.default)(t);if(e){var a=(0,A.default)(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return(0,T.default)(this,n)}}var U=(l=(0,w.frequency60)(),c=(0,w.frequency60)(),h=(0,w.frequency60)(),f=(0,w.frequency60)(),d=(0,w.frequency60)(),p=function(t){(0,m.default)(s,t);var e,n,i,r,a,o=k(s);function s(){var t,e;return(0,_.default)(this,s),(t=o.call(this)).addMessageTypes({message_revoke:(e=(0,E.default)(g.default.mark((function e(n){return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.fire(P.MESSAGE_REVOKED,{id:n.id,operator:(0,D.default)(n.user_number)});case 1:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)}),message_whisper_receive:function(e){e.user_id!==t.room.store.get("user.id")&&t.fire(P.MESSAGE_WHISPER_REVEIVED,t.onWhisperMessageReceived(e))},message_receive:function(e){e.user_id!==t.room.store.get("user.id")&&t.fire(P.MESSAGE_RECEIVED,t.onMessageReceived(e))}}),t}return(0,y.default)(s,[{key:"onWhisperMessageReceived",value:function(t,e){var n=(0,L.default)(t.from),i={id:t.id,time:t.time,content:t.content,data:t.data,to:null!=e?e:(0,D.default)(this.room.store.get("user.number")),from:{id:(0,D.default)(n.number),name:n.name,role:O.Type2Role[n.type],endType:n.endType,avatar:n.avatar}};return this.room.userData.add(n),i}},{key:"onMessageReceived",value:function(t){var e=(0,L.default)(t.from),n={id:t.id,time:t.time,content:t.content,channel:t.channel,data:t.data,from:{id:(0,D.default)(e.number),name:e.name,role:O.Type2Role[e.type],endType:e.endType,avatar:e.avatar}};if(t.reference){var i=(0,L.default)(t.reference.from);n.reference={content:t.reference.content,from:{id:(0,D.default)(i.number),name:i.name,role:O.Type2Role[i.type],endType:i.endType,avatar:i.avatar},data:t.reference.data}}return this.room.userData.add(e),n}},{key:"run",value:function(t){this.runned&&this.stop(),this.room=t,this.room.chatServer.addMessageTypes(this.messageTypes),this.runned=!0}},{key:"stop",value:function(){this.runned&&(this.room.chatServer.removeMessageTypes(this.messageTypes),this.runned=!1,this.room=null)}},{key:"pull",value:(a=(0,E.default)(g.default.mark((function t(e){var n,i,r,a=arguments;return g.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:-1,i=a.length>2&&void 0!==a[2]?a[2]:10,this.room){t.next=4;break}throw new I.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 4:return r={message_type:"message_pull_req",channel:e,next:n,count:i},t.abrupt("return",this.room.chatServer.request(r).then((function(t){var e=(0,L.default)(t.message_list);return e=e.map((function(t){var e=t.from,n={id:t.id,time:t.time,content:t.content,channel:t.channel,data:t.data,from:{id:(0,D.default)(e.number),name:e.name,role:O.Type2Role[e.type],endType:e.endType,avatar:e.avatar}};if(t.reference){var i=t.reference.from;n.reference={content:t.reference.content,from:{id:(0,D.default)(i.number),name:i.name,role:O.Type2Role[i.type],endType:i.endType,avatar:i.avatar},data:t.reference.data}}return n})),{next:t.next,channel:t.channel,hasMore:!!t.has_more,messageList:e}})));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"send",value:(r=(0,E.default)(g.default.mark((function t(e){var n,i,r,a=this;return g.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new I.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return i=this.room.store.get("user"),r={message_type:"message_send",content:e.content,channel:e.channel,to:x.MESSAGE_TO_ALL,from:{id:i.id,number:i.number,type:i.type,name:i.name,avatar:i.avatar,status:null!==(n=i.status)&&void 0!==n?n:0,end_type:i.endType,group:i.group}},e.data&&(r.data=e.data),e.reference&&(r.reference=e.reference),t.abrupt("return",this.room.chatServer.request(r).then((function(t){return a.onMessageReceived(t)})));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"sendTo",value:(i=(0,E.default)(g.default.mark((function t(e,n){var i,r,a,o,s=this;return g.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new I.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.next=4,this.room.findUser((0,C.default)(e));case 4:if(r=t.sent){t.next=7;break}throw new I.default(b.INVALID_PARAMETER,"user 不存在");case 7:return a=this.room.store.get("user"),o={message_type:"message_whisper_send",content:n.content,channel:n.channel,to:r.id,to_num:r.number,from:{id:a.id,number:a.number,type:a.type,name:a.name,avatar:a.avatar,status:null!==(i=a.status)&&void 0!==i?i:0,end_type:a.endType,group:a.group}},n.data&&(o.data=n.data),n.reference&&(o.reference=n.reference),t.abrupt("return",this.room.chatServer.request(o).then((function(t){return s.onWhisperMessageReceived(t,e)})));case 12:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"translate",value:(n=(0,E.default)(g.default.mark((function t(e,n,i){return g.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new I.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.abrupt("return",this.room.chatServer.request({message_type:"message_translate_send",content:e,from:n,to:i}).then((function(t){return t.result})));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,i){return n.apply(this,arguments)})},{key:"revoke",value:(e=(0,E.default)(g.default.mark((function t(e,n){var i;return g.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new I.default(b.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.next=4,this.room.findUser((0,C.default)(n));case 4:return i=t.sent,t.abrupt("return",this.room.chatServer.request({message_type:"message_revoke_req",id:e,from_uid:i.id,user_number:this.room.store.get("user.number")}).then((function(t){return 0==t.flag})));case 6:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})}]),s}(S.default),(0,R.default)(p.prototype,"pull",[l],(0,v.default)(p.prototype,"pull"),p.prototype),(0,R.default)(p.prototype,"send",[c],(0,v.default)(p.prototype,"send"),p.prototype),(0,R.default)(p.prototype,"sendTo",[h],(0,v.default)(p.prototype,"sendTo"),p.prototype),(0,R.default)(p.prototype,"translate",[f],(0,v.default)(p.prototype,"translate"),p.prototype),(0,R.default)(p.prototype,"revoke",[d],(0,v.default)(p.prototype,"revoke"),p.prototype),p);e.default=U},function(t,e,n){"use strict";var i=n(2),r=n(57),a=n(112),o=n(3),s=n(113),u=n(114),l=n(0),c=n(110),h=n(68),f=n(117),d=n(76),p=n(4),v=n(1);l(e,"__esModule",{value:!0}),e.default=void 0;var g=v(n(14)),E=v(n(26)),_=v(n(17)),y=v(n(288)),m=v(n(34)),T=v(n(15)),A=v(n(5)),R=v(n(6)),S=v(n(295)),x=U(n(28)),P=n(63),O=v(n(23)),I=v(n(297)),w=U(n(24)),b=U(n(8)),D=U(n(9)),C=U(n(10)),L=v(n(13)),N=v(n(27)),M=(v(n(298)),v(n(299)));function k(t){if("function"!=typeof p)return null;var e=new p,n=new p;return(k=function(t){return t?n:e})(t)}function U(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=k(e);if(n&&n.has(t))return n.get(t);var r={},a=l&&o;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var u=a?o(t,s):null;u&&(u.get||u.set)?l(r,s,u):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}function G(t,e){var n=void 0!==h&&t[f]||t["@@iterator"];if(!n){if(d(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return F(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return c(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function V(t,e){var n=r(t);if(a){var i=a(t);e&&(i=i.filter((function(e){return o(t,e).enumerable}))),n.push.apply(n,i)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){(0,m.default)(t,e,n[e])})):s?u(t,s(n)):V(Object(n)).forEach((function(e){l(t,e,o(n,e))}))}return t}var W=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,A.default)(this,t),this.loader=void 0,this.options=void 0,this.md5=void 0,this.checkTransform=void 0,this.client=void 0,this.idToFile=void 0,this.client=e,this.options=i,this.idToFile=new E.default,this.md5=new S.default;var r=this.client.getRoom().store,a={path:this.client.getApiDomain()+x.URL_COMMON_DOC_UPLOAD,uploadprogress:function(t,e,i){n.onprogress(t,e,i)},header:{}};this.loader=new M.default(a),this.checkTransform=new I.default(this.client.getApiDomain()+x.URL_COMMON_DOC_UPLOAD,{action:"getProgress",token:r.get("token"),room_id:r.get("class.id")},(function(t,e,i){n.onprogress(t,e,i)}),r.get("privateDomain"))}var e,n,i,r;return(0,R.default)(t,[{key:"upload",value:(r=(0,T.default)(g.default.mark((function t(e,n){var i,r,a=this,o=arguments;return g.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=o.length>2&&void 0!==o[2]?o[2]:{},r=e.name.split(".").pop(),b.string(r)&&(r=r.toLocaleLowerCase()),D.has(n.isAnimated?x.ACCEPT_FORMAT_OF_ANIMATION:x.ACCEPT_FORMAT_OF_STATIC,r)){t.next=5;break}throw new O.default(w.DOC_FORMAT_ERROR,"文件格式 ".concat(r," 不支持添加"));case 5:return t.abrupt("return",new _.default((function(t,o){a.md5.file(e,(function(t){a.onprogress(e,"md5",t)})).then((function(t){return a.onprogress(e,"md5",100),a.request(x.MD5_SEARCH_URL,{file_md5:t,is_ppt:n.isAnimated?1:0})})).then((function(t){var o,s;if((null==t||null===(o=t.data)||void 0===o?void 0:o.fid)>0)return a.onprogress(e,"upload",100),i.fid=(0,N.default)(t.data.fid),a.idToFile.set((0,N.default)(t.data.fid),e),{name:null!==(s=n.fileName)&&void 0!==s?s:e.name,ext:"."+r,number:(0,N.default)(t.data.fid)};var u=a.client.getRoom().store;return a.loader.upload(e,"Filedata",{uid:u.get("user.number"),token:u.get("token"),room_id:u.get("class.id"),action:"uploadFile",use_short_url:1,ppt_animation:n.isAnimated?1:0}).then((function(t){return i.fid=(0,N.default)(t.fid),a.idToFile.set((0,N.default)(t.fid),e),a.onprogress(e,"upload",100),a.checkTransform.check((0,N.default)(t.fid),e).then((function(){var e;return{name:null!==(e=n.fileName)&&void 0!==e?e:t.name,ext:t.fext,number:(0,N.default)(t.fid)}}))}))})).then((function(t){var e=".zip"===t.ext;return a.request(x.URL_COMMON_DOC_UPLOAD,e?{action:"getZipInfo",fid:t.number}:{action:"getImage",fids:t.number}).then((function(n){if(e)return H(H({},t),{},{pptUrl:n.data.ppt_html_url,pageInfo:{width:1280,height:720,totalPages:1,isDoc:n.data.is_doc,isH5Doc:!0}});var i=n.data[t.number][0];return H(H({},t),{},{pptUrl:i.ppt_html_url,pageInfo:{width:i.width,height:i.height,totalPages:+i.total_pages,isDoc:i.is_doc,isH5Doc:!1,url:i.url,urlPrefix:i.url_prefix}})}))})).then((function(n){return a.onprogress(e,"success",100),a.idToFile.delete(n.number),t(n)})).catch((function(t){i.fid&&a.idToFile.delete(i.fid),o(t)}))})));case 6:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})},{key:"addDoc",value:(i=(0,T.default)(g.default.mark((function t(e,n){var i,r,a=arguments;return g.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.length>2&&void 0!==a[2]?a[2]:{},t.prev=1,t.next=4,this.upload(e,n,i);case 4:return r=t.sent,t.next=7,this.client.document.addDoc(r);case 7:return t.abrupt("return",t.sent);case 10:if(t.prev=10,t.t0=t.catch(1),console.log(t.t0),!(t.t0 instanceof O.default)){t.next=17;break}throw t.t0;case 17:throw new O.default(w.DOC_ADD_ERROR,b.string(t.t0)?t.t0:"文档上传失败",b.object(t.t0)?t.t0:null);case 18:case"end":return t.stop()}}),t,this,[[1,10]])}))),function(t,e){return i.apply(this,arguments)})},{key:"switchToStaticDocument",value:(n=(0,T.default)(g.default.mark((function t(e,n){var i,r=this,a=arguments;return g.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=!(a.length>2&&void 0!==a[2])||a[2],e){t.next=3;break}throw new O.default(w.INVALID_PARAMETER,"未传入文件 id");case 3:return t.abrupt("return",this.request(x.URL_COMMON_DOC_UPLOAD,{action:"getImage",fids:e}).then((function(t){if(t.data&&t.data[e]){var i=t.data[e][0];return{name:n.fileName,number:e,ext:n.ext,pptUrl:i.ppt_html_url,pageInfo:{width:i.width,height:i.height,totalPages:+i.total_pages,isDoc:i.is_doc,isH5Doc:!1,url:i.url,urlPrefix:i.url_prefix}}}throw new O.default(w.FETCH_ERROR,"".concat(e," 未找到资源，请检查 fid 是否正确或者重新上传"))})).then((function(t){return i?r.client.document.addDoc(t):t})));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"cancel",value:function(t){this.md5.abort(t),this.loader.abort(t),this.checkTransform.abort(this.getFidByFile(t))}},{key:"getFidByFile",value:function(t){var e,n="",i=G(this.idToFile);try{for(i.s();!(e=i.n()).done;){var r=(0,y.default)(e.value,2),a=r[0];if(t===r[1]){n=a;break}}}catch(t){i.e(t)}finally{i.f()}return n}},{key:"request",value:(e=(0,T.default)(g.default.mark((function t(e,n){var i;return g.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.client.getRoom().store,C.extend(n,{uid:i.get("user.number"),token:i.get("token"),room_id:i.get("class.id")}),t.abrupt("return",(0,P.post)(this.client.getApiDomain()+e,n,i.get("privateDomain"),"application/x-www-form-urlencoded").then((function(t){if(0==t.code)return t;throw new O.default(w.FETCH_ERROR,"".concat(e," ").concat(t.msg||"接口请求失败"))})));case 3:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"onprogress",value:function(t,e,n){this.options.onprogress&&(0,L.default)(this.options.onprogress,this,[t,e,n])}},{key:"destroy",value:function(){this.loader.destroy(),this.md5.destroy(),this.checkTransform.destroy(),this.idToFile.clear(),this.idToFile=null,this.loader=null,this.md5=null,this.checkTransform=null,this.options=null}}]),t}();e.default=W},function(t,e,n){n(123),t.exports=n(7).Object.getOwnPropertySymbols},function(t,e,n){n(284),t.exports=n(7).Object.getOwnPropertyDescriptors},function(t,e,n){var i=n(11),r=n(285),a=n(36),o=n(54),s=n(150);i(i.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,i=a(t),u=o.f,l=r(i),c={},h=0;l.length>h;)void 0!==(n=u(i,e=l[h++]))&&s(c,e,n);return c}})},function(t,e,n){var i=n(99),r=n(69),a=n(20),o=n(12).Reflect;t.exports=o&&o.ownKeys||function(t){var e=i.f(a(t)),n=r.f;return n?e.concat(n(t)):e}},function(t,e,n){n(287);var i=n(7).Object;t.exports=function(t,e){return i.defineProperties(t,e)}},function(t,e,n){var i=n(11);i(i.S+i.F*!n(22),"Object",{defineProperties:n(119)})},function(t,e,n){var i=n(289),r=n(290),a=n(152),o=n(294);t.exports=function(t,e){return i(t)||r(t,e)||a(t,e)||o()}},function(t,e,n){var i=n(76);t.exports=function(t){if(i(t))return t}},function(t,e,n){var i=n(291),r=n(151),a=n(68);t.exports=function(t,e){if(void 0!==a&&r(Object(t))){var n=[],o=!0,s=!1,u=void 0;try{for(var l,c=i(t);!(o=(l=c.next()).done)&&(n.push(l.value),!e||n.length!==e);o=!0);}catch(t){s=!0,u=t}finally{try{o||null==c.return||c.return()}finally{if(s)throw u}}return n}}},function(t,e,n){t.exports=n(292)},function(t,e,n){n(44),n(42),t.exports=n(293)},function(t,e,n){var i=n(20),r=n(101);t.exports=n(7).getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(14)),o=r(n(26)),s=r(n(17)),u=r(n(15)),l=r(n(5)),c=r(n(6)),h=r(n(296)),f=function(){function t(){(0,l.default)(this,t),this.map=void 0,this.map=new o.default}var e;return(0,c.default)(t,[{key:"file",value:(e=(0,u.default)(a.default.mark((function t(e,n){var i=this;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new s.default((function(t,r){i.map.set(e,{resolve:t,reject:r,abort:!1});var a,o=new h.default.ArrayBuffer,s=0,u=Math.ceil(e.size/2097152),l=i,c=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,f=new FileReader;a=function(){var t=2097152*s,n=t+2097152>=e.size?e.size:t+2097152;f.readAsArrayBuffer(c.call(e,t,n))},f.onloadend=function(i){!function(i){if(s++,o.append(i),l.map.get(e).abort)return l.map.delete(e),void r("aborted");s<u?(n(Math.floor(s/u*100)),a()):(n(100),l.map.delete(e),t(o.end()))}(i.target.result)},a(),n(0)})));case 1:case"end":return t.stop()}}),t)}))),function(t,n){return e.apply(this,arguments)})},{key:"string",value:function(t){return h.default.hash(t)}},{key:"abort",value:function(t){var e;null===(e=this.map.get(t))||void 0===e||e.reject("abort")}},{key:"destroy",value:function(){this.map.forEach((function(t){t.reject("md5 destroyed")})),this.map.clear(),this.map=null}}]),t}();e.default=f},function(t,e,n){t.exports=function(t){"use strict";var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(t,e){var n=t[0],i=t[1],r=t[2],a=t[3];i=((i+=((r=((r+=((a=((a+=((n=((n+=(i&r|~i&a)+e[0]-680876936|0)<<7|n>>>25)+i|0)&i|~n&r)+e[1]-389564586|0)<<12|a>>>20)+n|0)&n|~a&i)+e[2]+606105819|0)<<17|r>>>15)+a|0)&a|~r&n)+e[3]-1044525330|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i&r|~i&a)+e[4]-176418897|0)<<7|n>>>25)+i|0)&i|~n&r)+e[5]+1200080426|0)<<12|a>>>20)+n|0)&n|~a&i)+e[6]-1473231341|0)<<17|r>>>15)+a|0)&a|~r&n)+e[7]-45705983|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i&r|~i&a)+e[8]+1770035416|0)<<7|n>>>25)+i|0)&i|~n&r)+e[9]-1958414417|0)<<12|a>>>20)+n|0)&n|~a&i)+e[10]-42063|0)<<17|r>>>15)+a|0)&a|~r&n)+e[11]-1990404162|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i&r|~i&a)+e[12]+1804603682|0)<<7|n>>>25)+i|0)&i|~n&r)+e[13]-40341101|0)<<12|a>>>20)+n|0)&n|~a&i)+e[14]-1502002290|0)<<17|r>>>15)+a|0)&a|~r&n)+e[15]+1236535329|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i&a|r&~a)+e[1]-165796510|0)<<5|n>>>27)+i|0)&r|i&~r)+e[6]-1069501632|0)<<9|a>>>23)+n|0)&i|n&~i)+e[11]+643717713|0)<<14|r>>>18)+a|0)&n|a&~n)+e[0]-373897302|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i&a|r&~a)+e[5]-701558691|0)<<5|n>>>27)+i|0)&r|i&~r)+e[10]+38016083|0)<<9|a>>>23)+n|0)&i|n&~i)+e[15]-660478335|0)<<14|r>>>18)+a|0)&n|a&~n)+e[4]-405537848|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i&a|r&~a)+e[9]+568446438|0)<<5|n>>>27)+i|0)&r|i&~r)+e[14]-1019803690|0)<<9|a>>>23)+n|0)&i|n&~i)+e[3]-187363961|0)<<14|r>>>18)+a|0)&n|a&~n)+e[8]+1163531501|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i&a|r&~a)+e[13]-1444681467|0)<<5|n>>>27)+i|0)&r|i&~r)+e[2]-51403784|0)<<9|a>>>23)+n|0)&i|n&~i)+e[7]+1735328473|0)<<14|r>>>18)+a|0)&n|a&~n)+e[12]-1926607734|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i^r^a)+e[5]-378558|0)<<4|n>>>28)+i|0)^i^r)+e[8]-2022574463|0)<<11|a>>>21)+n|0)^n^i)+e[11]+1839030562|0)<<16|r>>>16)+a|0)^a^n)+e[14]-35309556|0)<<23|i>>>9)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i^r^a)+e[1]-1530992060|0)<<4|n>>>28)+i|0)^i^r)+e[4]+1272893353|0)<<11|a>>>21)+n|0)^n^i)+e[7]-155497632|0)<<16|r>>>16)+a|0)^a^n)+e[10]-1094730640|0)<<23|i>>>9)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i^r^a)+e[13]+681279174|0)<<4|n>>>28)+i|0)^i^r)+e[0]-358537222|0)<<11|a>>>21)+n|0)^n^i)+e[3]-722521979|0)<<16|r>>>16)+a|0)^a^n)+e[6]+76029189|0)<<23|i>>>9)+r|0,i=((i+=((r=((r+=((a=((a+=((n=((n+=(i^r^a)+e[9]-640364487|0)<<4|n>>>28)+i|0)^i^r)+e[12]-421815835|0)<<11|a>>>21)+n|0)^n^i)+e[15]+530742520|0)<<16|r>>>16)+a|0)^a^n)+e[2]-995338651|0)<<23|i>>>9)+r|0,i=((i+=((a=((a+=(i^((n=((n+=(r^(i|~a))+e[0]-198630844|0)<<6|n>>>26)+i|0)|~r))+e[7]+1126891415|0)<<10|a>>>22)+n|0)^((r=((r+=(n^(a|~i))+e[14]-1416354905|0)<<15|r>>>17)+a|0)|~n))+e[5]-57434055|0)<<21|i>>>11)+r|0,i=((i+=((a=((a+=(i^((n=((n+=(r^(i|~a))+e[12]+1700485571|0)<<6|n>>>26)+i|0)|~r))+e[3]-1894986606|0)<<10|a>>>22)+n|0)^((r=((r+=(n^(a|~i))+e[10]-1051523|0)<<15|r>>>17)+a|0)|~n))+e[1]-2054922799|0)<<21|i>>>11)+r|0,i=((i+=((a=((a+=(i^((n=((n+=(r^(i|~a))+e[8]+1873313359|0)<<6|n>>>26)+i|0)|~r))+e[15]-30611744|0)<<10|a>>>22)+n|0)^((r=((r+=(n^(a|~i))+e[6]-1560198380|0)<<15|r>>>17)+a|0)|~n))+e[13]+1309151649|0)<<21|i>>>11)+r|0,i=((i+=((a=((a+=(i^((n=((n+=(r^(i|~a))+e[4]-145523070|0)<<6|n>>>26)+i|0)|~r))+e[11]-1120210379|0)<<10|a>>>22)+n|0)^((r=((r+=(n^(a|~i))+e[2]+718787259|0)<<15|r>>>17)+a|0)|~n))+e[9]-343485551|0)<<21|i>>>11)+r|0,t[0]=n+t[0]|0,t[1]=i+t[1]|0,t[2]=r+t[2]|0,t[3]=a+t[3]|0}function i(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function r(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function a(t){var e,r,a,o,s,u,l=t.length,c=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=l;e+=64)n(c,i(t.substring(e-64,e)));for(r=(t=t.substring(e-64)).length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<r;e+=1)a[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(n(c,a),e=0;e<16;e+=1)a[e]=0;return o=(o=8*l).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(o[2],16),u=parseInt(o[1],16)||0,a[14]=s,a[15]=u,n(c,a),c}function o(t){var n,i="";for(n=0;n<4;n+=1)i+=e[t>>8*n+4&15]+e[t>>8*n&15];return i}function s(t){var e;for(e=0;e<t.length;e+=1)t[e]=o(t[e]);return t.join("")}function u(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function l(t){var e,n=[],i=t.length;for(e=0;e<i-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function c(){this.reset()}return s(a("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return(t=0|t||0)<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,i){var r,a,o,s,u=this.byteLength,l=e(n,u),c=u;return i!==t&&(c=e(i,u)),l>c?new ArrayBuffer(0):(r=c-l,a=new ArrayBuffer(r),o=new Uint8Array(a),s=new Uint8Array(this,l,r),o.set(s),a)}}(),c.prototype.append=function(t){return this.appendBinary(u(t)),this},c.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,r=this._buff.length;for(e=64;e<=r;e+=64)n(this._hash,i(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},c.prototype.end=function(t){var e,n,i=this._buff,r=i.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)a[e>>2]|=i.charCodeAt(e)<<(e%4<<3);return this._finish(a,r),n=s(this._hash),t&&(n=l(n)),this.reset(),n},c.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},c.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},c.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},c.prototype._finish=function(t,e){var i,r,a,o=e;if(t[o>>2]|=128<<(o%4<<3),o>55)for(n(this._hash,t),o=0;o<16;o+=1)t[o]=0;i=(i=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(i[2],16),a=parseInt(i[1],16)||0,t[14]=r,t[15]=a,n(this._hash,t)},c.hash=function(t,e){return c.hashBinary(u(t),e)},c.hashBinary=function(t,e){var n=s(a(t));return e?l(n):n},c.ArrayBuffer=function(){this.reset()},c.ArrayBuffer.prototype.append=function(t){var e,i,a,o,s,u=(i=this._buff.buffer,a=t,o=!0,(s=new Uint8Array(i.byteLength+a.byteLength)).set(new Uint8Array(i)),s.set(new Uint8Array(a),i.byteLength),o?s:s.buffer),l=u.length;for(this._length+=t.byteLength,e=64;e<=l;e+=64)n(this._hash,r(u.subarray(e-64,e)));return this._buff=e-64<l?new Uint8Array(u.buffer.slice(e-64)):new Uint8Array(0),this},c.ArrayBuffer.prototype.end=function(t){var e,n,i=this._buff,r=i.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)a[e>>2]|=i[e]<<(e%4<<3);return this._finish(a,r),n=s(this._hash),t&&(n=l(n)),this.reset(),n},c.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.ArrayBuffer.prototype.getState=function(){var t,e=c.prototype.getState.call(this);return e.buff=(t=e.buff,String.fromCharCode.apply(null,new Uint8Array(t))),e},c.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,e){var n,i=t.length,r=new ArrayBuffer(i),a=new Uint8Array(r);for(n=0;n<i;n+=1)a[n]=t.charCodeAt(n);return e?a:r}(t.buff,!0),c.prototype.setState.call(this,t)},c.ArrayBuffer.prototype.destroy=c.prototype.destroy,c.ArrayBuffer.prototype._finish=c.prototype._finish,c.ArrayBuffer.hash=function(t,e){var i=s(function(t){var e,i,a,o,s,u,l=t.length,c=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=l;e+=64)n(c,r(t.subarray(e-64,e)));for(t=e-64<l?t.subarray(e-64):new Uint8Array(0),i=t.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<i;e+=1)a[e>>2]|=t[e]<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(n(c,a),e=0;e<16;e+=1)a[e]=0;return o=(o=8*l).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(o[2],16),u=parseInt(o[1],16)||0,a[14]=s,a[15]=u,n(c,a),c}(new Uint8Array(t)));return e?l(i):i},c}()},function(t,e,n){"use strict";var i=n(2),r=n(57),a=n(112),o=n(3),s=n(113),u=n(114),l=n(0),c=n(4),h=n(1);l(e,"__esModule",{value:!0}),e.default=void 0;var f=h(n(26)),d=h(n(17)),p=h(n(148)),v=h(n(34)),g=h(n(5)),E=h(n(6)),_=n(63),y=P(n(62)),m=h(n(23)),T=P(n(24)),A=h(n(107)),R=P(n(10)),S=h(n(13));function x(t){if("function"!=typeof c)return null;var e=new c,n=new c;return(x=function(t){return t?n:e})(t)}function P(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=x(e);if(n&&n.has(t))return n.get(t);var r={},a=l&&o;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var u=a?o(t,s):null;u&&(u.get||u.set)?l(r,s,u):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}function O(t,e){var n=r(t);if(a){var i=a(t);e&&(i=i.filter((function(e){return o(t,e).enumerable}))),n.push.apply(n,i)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){(0,v.default)(t,e,n[e])})):s?u(t,s(n)):O(Object(n)).forEach((function(e){l(t,e,o(n,e))}))}return t}var w=function(){function t(e,n,i,r){var a=this;(0,g.default)(this,t),this.map=void 0,this.url=void 0,this.parms=void 0,this.timer=void 0,this.privateDomain=void 0,this.onprogress=void 0,this.url=e,this.parms=n,this.onprogress=i,this.privateDomain=r,this.map=new f.default,this.timer=new A.default((function(){a.request()}),null,2e3)}return(0,E.default)(t,[{key:"check",value:function(t,e){var n=this;return new d.default((function(i,r){n.map.set(t,{file:e,resolve:i,reject:r}),n.timer.isStarted()||n.timer.start(),n.progress(e,"queue")}))}},{key:"abort",value:function(t){var e=this.map.get(t);e&&(this.map.delete(t),e.reject("abort"),this.map.size||this.timer.stop())}},{key:"request",value:function(){var e=this;(0,_.post)(this.url,I(I({},this.parms),{},{fids:(0,p.default)(this.map.keys()).join(",")}),this.privateDomain,"application/x-www-form-urlencoded").then((function(n){0!=n.code&&y.error("".concat(e.url," request fail"),"CheckTransform"),R.each(n.data,(function(n,i){var r=e.map.get(i);if(!r)return!0;n.status===t.TRANSFORM_STATUS_END?(e.progress(r.file,"transform",100),e.map.delete(i),r.resolve()):n.status===t.TRANSFORM_STATUS_PPT_FAIL?(e.map.delete(i),r.reject(new m.default(T.DOC_ANIMATION_TRANSFORM_ERROR,"动态文档转码失败，你可切换为静态文档"))):n.status===t.TRANSFORM_STATUS_FAIL?(e.map.delete(i),r.reject(new m.default(T.DOC_TRANSFORM_ERROR,"转码失败"))):n.status===t.TRANSFORM_STATUS_WAIT?e.progress(r.file,"queue"):n.status===t.TRANSFORM_STATUS_START&&e.progress(r.file,"transform"),e.map.size||e.timer.stop()}))}))}},{key:"progress",value:function(t){function e(e,n,i){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e,n){this.onprogress&&(0,S.default)(this.onprogress,this,[t,e,n])}))},{key:"destroy",value:function(){this.timer.stop(),this.map.forEach((function(t){t.reject("checkTransform destroyed")})),this.map.clear()}}]),t}();e.default=w,w.TRANSFORM_STATUS_WAIT=20,w.TRANSFORM_STATUS_START=30,w.TRANSFORM_STATUS_PPT_FAIL=90,w.TRANSFORM_STATUS_END=100,w.TRANSFORM_STATUS_FAIL=3},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(14)),l=s(n(17)),c=s(n(15)),h=s(n(5)),f=s(n(6)),d=s(n(13)),p=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=v(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(9));function v(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(v=function(t){return t?n:e})(t)}var g=function(){function t(e){(0,h.default)(this,t),this.options=void 0,this.task=void 0,this.status=void 0,this.holder=void 0,this.queue=void 0,this.queue=[],this.options=e,this.status=t.STATUS_UNSTART}var e;return(0,f.default)(t,[{key:"upload",value:(e=(0,c.default)(u.default.mark((function t(e,n,i){var r,a=this;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((null===(r=this.holder)||void 0===r?void 0:r.file)===e||this.findFile(e)>-1)){t.next=2;break}throw new Error("the file has already uploaded");case 2:if(this.canUpload()){t.next=4;break}return t.abrupt("return",new l.default((function(t,r){a.queue.push({file:e,fileName:n,data:i,resolve:t,reject:r}),(0,d.default)(a.options.uploadprogress,a,[e,"wait"])})));case 4:return t.abrupt("return",new l.default((function(t,r){a._upload(e,n,t,r,i)})));case 5:case"end":return t.stop()}}),t,this)}))),function(t,n,i){return e.apply(this,arguments)})},{key:"next",value:function(){if(this.queue.length&&(this.status!==t.STATUS_WAIT||this.status!==t.STATUS_LOADING)){var e=this.queue.shift();this._upload(e.file,e.fileName,e.resolve,e.reject,e.data)}}},{key:"_upload",value:function(e,n,i,r,a){var o=this;this.status=t.STATUS_WAIT,this.holder={file:e,resolve:i,reject:r},this.task=wx.uploadFile({url:this.options.path,filePath:e.path,name:n,header:this.options.header,formData:a,success:function(e){try{var n=JSON.parse(e.data);0===(null==n?void 0:n.code)?(o.status=t.STATUS_SUCCESS,o.options.uploadsuccess&&(0,d.default)(o.options.uploadsuccess,o,[e,n.data]),o.holder.resolve&&o.holder.resolve(n.data)):(o.options.uploaderror&&(0,d.default)(o.options.uploaderror,o,[null==n?void 0:n.msg]),o.holder.reject&&o.holder.reject(null==n?void 0:n.msg))}catch(t){o.options.uploaderror&&(0,d.default)(o.options.uploaderror,o,[t]),o.holder.reject&&o.holder.reject("upload error")}o.status=t.STATUS_UNSTART,o.next()},fail:function(e){o.status=t.STATUS_FAIL,o.options.uploaderror&&(0,d.default)(o.options.uploaderror,o,[e.errMsg]),o.holder.reject&&o.holder.reject(e.errMsg),o.next()}}),this.task.onProgressUpdate((function(t){var e=o.holder.file.size,n=t.totalBytesSent,i=Math.floor(n/e*100);i<0?i=0:i>100&&(i=100),o.options.uploadprogress&&(0,d.default)(o.options.uploadprogress,o,[o.holder.file,"upload",i])})),this.status=t.STATUS_LOADING,this.options.uploadstart&&(0,d.default)(this.options.uploadstart,this),(0,d.default)(this.options.uploadprogress,this,[this.holder.file,"upload",0])}},{key:"findFile",value:function(t){var e=-1;return p.each(this.queue,(function(n,i){if(n.file===t)return e=i,!1})),e}},{key:"abort",value:function(e){var n,i=this.findFile(e);i>-1?(this.queue[i].reject("abort"),this.queue.splice(i,1)):(null===(n=this.holder)||void 0===n?void 0:n.file)===e&&(this.holder.reject("abort"),this.task&&this.status===t.STATUS_LOADING&&this.task.abort(),this.status=t.STATUS_UNSTART,this.next())}},{key:"canUpload",value:function(){return this.status===t.STATUS_UNSTART}},{key:"destroy",value:function(){var t=this;this.task&&this.task.abort(),this.holder&&this.holder.reject("loader destroyed"),this.queue.length&&p.each(this.queue,(function(e){e.reject("loader destroyed"),t.options.uploaderror&&(0,d.default)(t.options.uploaderror,t,["loader destroyed"])})),this.queue=null,this.task=null}}]),t}();e.default=g,g.STATUS_UNSTART=0,g.STATUS_WAIT=1,g.STATUS_LOADING=2,g.STATUS_SUCCESS=3,g.STATUS_FAIL=4},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(14)),l=s(n(17)),c=s(n(15)),h=s(n(5)),f=s(n(6)),d=s(n(13)),p=E(n(10)),v=E(n(9));function g(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(g=function(t){return t?n:e})(t)}function E(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=g(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var _=function(){function t(e){var n=this;(0,h.default)(this,t),this.options=void 0,this.xhr=void 0,this.status=void 0,this.holder=void 0,this.queue=void 0,this.queue=[],this.options=e,this.xhr=new XMLHttpRequest,this.xhr.onloadstart=function(e){n.status=t.STATUS_LOADING,n.options.uploadstart&&(0,d.default)(n.options.uploadstart,n,[e])},this.xhr.onload=function(e){try{var i=JSON.parse(n.xhr.responseText);0===(null==i?void 0:i.code)?(n.status=t.STATUS_SUCCESS,n.options.uploadsuccess&&(0,d.default)(n.options.uploadsuccess,n,[e,i.data]),n.holder.resolve&&n.holder.resolve(i.data)):(n.options.uploaderror&&(0,d.default)(n.options.uploaderror,n,[null==i?void 0:i.msg]),n.holder.reject&&n.holder.reject(null==i?void 0:i.msg))}catch(t){n.options.uploaderror&&(0,d.default)(n.options.uploaderror,n,[t]),n.holder.reject&&n.holder.reject("upload error")}n.status=t.STATUS_UNSTART,n.next()},this.xhr.onerror=function(e){n.status=t.STATUS_FAIL,n.options.uploaderror&&(0,d.default)(n.options.uploaderror,n,[e]),n.holder.reject&&n.holder.reject(e),n.next()},this.xhr.upload.onprogress=function(t){var e=n.holder.file.size,i=t.loaded,r=Math.floor(i/e*100);r<0?r=0:r>100&&(r=100),n.options.uploadprogress&&(0,d.default)(n.options.uploadprogress,n,[n.holder.file,"upload",r])},this.status=t.STATUS_UNSTART}var e;return(0,f.default)(t,[{key:"upload",value:(e=(0,c.default)(u.default.mark((function t(e,n,i){var r,a=this;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((null===(r=this.holder)||void 0===r?void 0:r.file)===e||this.findFile(e)>-1)){t.next=2;break}throw new Error("the file has already uploaded");case 2:if(this.canUpload()){t.next=4;break}return t.abrupt("return",new l.default((function(t,r){a.queue.push({file:e,fileName:n,data:i,resolve:t,reject:r}),(0,d.default)(a.options.uploadprogress,a,[e,"wait"])})));case 4:return t.abrupt("return",new l.default((function(t,r){a._upload(e,n,t,r,i)})));case 5:case"end":return t.stop()}}),t,this)}))),function(t,n,i){return e.apply(this,arguments)})},{key:"next",value:function(){if(this.queue.length&&(this.status!==t.STATUS_WAIT||this.status!==t.STATUS_LOADING)){var e=this.queue.shift();this._upload(e.file,e.fileName,e.resolve,e.reject,e.data)}}},{key:"_upload",value:function(e,n,i,r,a){var o=this;this.xhr.open("post",this.options.path,!0),this.status=t.STATUS_WAIT,this.holder={file:e,resolve:i,reject:r};var s=new FormData;a&&p.each(a,(function(t,e){s.append(e,t)})),s.append(n,e),this.options.header&&p.each(this.options.header,(function(t,e){o.xhr.setRequestHeader(e,t)})),this.xhr.send(s),(0,d.default)(this.options.uploadprogress,this,[this.holder.file,"upload",0])}},{key:"findFile",value:function(t){var e=-1;return v.each(this.queue,(function(n,i){if(n.file===t)return e=i,!1})),e}},{key:"abort",value:function(e){var n,i=this.findFile(e);i>-1?(this.queue[i].reject("abort"),this.queue.splice(i,1)):(null===(n=this.holder)||void 0===n?void 0:n.file)===e&&(this.holder.reject("abort"),this.xhr&&this.status===t.STATUS_LOADING&&this.xhr.abort(),this.status=t.STATUS_UNSTART,this.next())}},{key:"canUpload",value:function(){return this.status===t.STATUS_UNSTART}},{key:"destroy",value:function(){var t=this;this.holder&&this.holder.reject("loader destroyed"),this.queue.length&&v.each(this.queue,(function(e){e.reject("loader destroyed"),t.options.uploaderror&&(0,d.default)(t.options.uploaderror,t,["loader destroyed"])})),this.queue=null,this.xhr=null}}]),t}();e.default=_,_.STATUS_UNSTART=0,_.STATUS_WAIT=1,_.STATUS_LOADING=2,_.STATUS_SUCCESS=3,_.STATUS_FAIL=4},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.default=function(t,e){for(var n=Math.min(t.length,e.length),i=[],r=0;r<n;r++)i.push({ip:t[r].ip,wssIp:e[r].ip||e[r].wssIp,port:t[r].port,wssPort:e[r].wssPort||e[r].port});t.length>e.length?i=i.concat(t.slice(n)):t.length<e.length&&(i=i.concat(e.slice(n)));return i}},function(t,e,n){"use strict";var i=n(2),r=n(29),a=n(4),o=n(0),s=n(3),u=n(1);o(e,"__esModule",{value:!0}),e.default=void 0;var l,c,h,f=u(n(3)),d=u(n(14)),p=u(n(15)),v=u(n(5)),g=u(n(6)),E=u(n(37)),_=u(n(38)),y=u(n(30)),m=u(n(56)),T=u(n(83)),A=C(n(84)),R=u(n(23)),S=n(64),x=C(n(61)),P=C(n(24)),O=n(28),I=u(n(59)),w=u(n(154)),b=C(n(10));function D(t){if("function"!=typeof a)return null;var e=new a,n=new a;return(D=function(t){return t?n:e})(t)}function C(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=D(e);if(n&&n.has(t))return n.get(t);var r={},a=o&&s;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=a?s(t,u):null;l&&(l.get||l.set)?o(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function L(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,y.default)(t);if(e){var a=(0,y.default)(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return(0,_.default)(this,n)}}var N=(l=(0,S.frequency60)(),c=(0,S.frequency60)(),h=function(t){(0,E.default)(c,t);var e,n,i,r,a,o,s,u,l=L(c);function c(t){var e;return(0,v.default)(this,c),(e=l.call(this,t)).commandTypes=void 0,e.broadcastTypes=void 0,e.customcastTypes=void 0,e.commandTypes=new w.default(!0),e.customcastTypes=new w.default(!0),e.broadcastTypes=new w.default(!0),e.commandTypes.add("logout",(function(t,n){e.fire(A.USER_KICKED,(0,I.default)(n))})),e.addMessageTypes({login_conflict:function(t){e.room&&e.room.leave(),e.fire(A.CLIENT_BANNED,t.end_type)},broadcast_receive:function(t){if(t.user_id!==e.room.store.get("user.id")){var n,i,r=(0,I.default)(null!==(n=null===(i=t.signal_send_by)||void 0===i?void 0:i.number)&&void 0!==n?n:t.user_id);e.fire(A.BROADCAST_MESSAGE_RECEIVED,{messageType:t.key,message:t.value,fromId:r}),e.broadcastTypes.execute(t.key,[t.value,r])}},customcast_receive:function(t){if(t.user_id!==e.room.store.get("user.id")){var n,i,r=(0,I.default)(null!==(n=null===(i=t.signal_send_by)||void 0===i?void 0:i.number)&&void 0!==n?n:t.user_id);e.fire(A.CUSTOMCAST_MESSAGE_RECEIVED,{messageType:t.key,message:t.value,fromId:r}),e.customcastTypes.execute(t.key,[t.value,r])}},command_receive:function(t){if(t.user_id!==e.room.store.get("user.id")){var n,i,r=(0,I.default)(null!==(n=null===(i=t.signal_send_by)||void 0===i?void 0:i.number)&&void 0!==n?n:t.from),a=t.data,o=a.command_type;o===x.BRTM_COMMAND_TYPE&&e.fire(A.MESSAGE_RECEIVED,{messageType:a.rtm_custom_key,message:a.rtm_custom_value,fromId:r}),e.commandTypes.execute(o,[a,r])}},class_start:function(t){e.room.store.set("class.started",!0)},class_end:function(t){e.room.store.set("class.started",!1)},presenter_change:function(t){var n,i=t.presenter_id;i?n=e.room.userData.find(i):i="",e.room.store.set({presenterId:i,presenter:n})},rtm_abilities_change:function(t){t.user_id!==e.room.store.get("user.id")&&(e.room.store.set("class.rtmAbilities",t.rtm_abilities),e.fire(A.BRTM_ABILITIES_CHANGED,e.room.ability.getAbilities()))}}),e}return(0,g.default)(c,[{key:"sendCommand",value:function(t,e){if(!this.room)throw new R.default(P.INVALID_OPERATION,"未加入房间，请先执行 join");var n=this.room.store.get("user");this.room.roomServer.send({message_type:"command_send",from:n.id,to:t,data:e})}},{key:"sendBroadcast",value:(u=(0,p.default)(d.default.mark((function t(e){var n,i,r,a,o;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new R.default(P.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:o={message_type:"broadcast_send",key:e.key,value:e.value,options:{cache:null!==(n=null===(i=e.options)||void 0===i?void 0:i.cache)&&void 0!==n&&n,all:null===(r=null===(a=e.options)||void 0===a?void 0:a.all)||void 0===r||r}},this.room.roomServer.request(o).then((function(){}));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"getCachedBroadcast",value:(s=(0,p.default)(d.default.mark((function t(e){return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new R.default(P.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.abrupt("return",this.room.roomServer.request({message_type:"broadcast_cache_req",key:e}).then((function(t){var e,n;return{message:t.value,fromId:(0,I.default)(null!==(e=null===(n=t.signal_send_by)||void 0===n?void 0:n.number)&&void 0!==e?e:t.user_id)}})));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"sendCustomcast",value:(o=(0,p.default)(d.default.mark((function t(e){var n,i,r,a,o;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new R.default(P.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return o={message_type:"customcast_send",key:e.key,value:e.value,options:{cache:null!==(n=null===(i=e.options)||void 0===i?void 0:i.cache)&&void 0!==n&&n,all:null===(r=null===(a=e.options)||void 0===a?void 0:a.all)||void 0===r||r},role:this.room.store.get("user.type")},t.abrupt("return",this.room.roomServer.request(o));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"getCachedCustomcast",value:(a=(0,p.default)(d.default.mark((function t(e){return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new R.default(P.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.abrupt("return",this.room.roomServer.request({message_type:"customcast_cache_req",key:e}).then((function(t){var e,n;return{message:t.value,fromId:(0,I.default)(null!==(e=null===(n=t.signal_send_by)||void 0===n?void 0:n.number)&&void 0!==e?e:t.user_id)}})));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"startClass",value:(r=(0,p.default)(d.default.mark((function t(){return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new R.default(P.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.abrupt("return",this.room.roomServer.request({message_type:"class_start_trigger"}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"endClass",value:(i=(0,p.default)(d.default.mark((function t(){return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new R.default(P.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.abrupt("return",this.room.roomServer.request({message_type:"class_end_trigger"}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"changePresenter",value:(n=(0,p.default)(d.default.mark((function t(e){var n=this;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new R.default(P.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.abrupt("return",this.room.roomServer.request({message_type:"presenter_change_trigger",presenter_id:e}).then((function(t){var e;return t.presenter_id&&(e=n.room.userData.find(t.presenter_id)),e})));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"updateAbility",value:(e=(0,p.default)(d.default.mark((function t(e){var n=this;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new R.default(P.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:return t.abrupt("return",this.room.roomServer.request({message_type:"rtm_abilities_change_trigger",rtm_abilities:e}).then((function(t){return n.room.store.set("class.rtmAbilities",t.rtm_abilities),n.fire(O.PRIVATE_EVENT_PREFIX+A.BRTM_ABILITIES_CHANGED,n.room.ability.getAbilities()),n.room.ability.getAbilities()})));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"addCommandMessageType",value:function(t,e){this.commandTypes.add(t,e)}},{key:"removeCommandMeaageType",value:function(t,e){this.commandTypes.remove(t,e)}},{key:"addBroadcastType",value:function(t,e){this.broadcastTypes.add(t,e)}},{key:"removeBroadcastType",value:function(t,e){this.broadcastTypes.remove(t,e)}},{key:"addCustomcastType",value:function(t,e){this.customcastTypes.add(t,e)}},{key:"removeCustomcastType",value:function(t,e){this.customcastTypes.remove(t,e)}},{key:"addCommandMessageTypes",value:function(t){var e=this;b.each(t,(function(t,n){e.addCommandMessageType(n,t)}))}},{key:"removeCommandMeaageTypes",value:function(t){var e=this;b.each(t,(function(t,n){e.removeCommandMeaageType(n,t)}))}},{key:"addBroadcastTypes",value:function(t){var e=this;b.each(t,(function(t,n){e.addBroadcastType(n,t)}))}},{key:"removeBroadcastTypes",value:function(t){var e=this;b.each(t,(function(t,n){e.removeBroadcastType(n,t)}))}},{key:"addCustomcastTypes",value:function(t){var e=this;b.each(t,(function(t,n){e.addCustomcastType(n,t)}))}},{key:"removeCustomcastTypes",value:function(t){var e=this;b.each(t,(function(t,n){e.removeCustomcastType(n,t)}))}},{key:"destroy",value:function(){this.stop(),this.messageTypes=null,this.emitter=null,this.commandTypes.destroy(),this.broadcastTypes.destroy(),this.customcastTypes.destroy(),this.commandTypes=this.broadcastTypes=this.customcastTypes=null}}]),c}(T.default),(0,m.default)(h.prototype,"sendCustomcast",[l],(0,f.default)(h.prototype,"sendCustomcast"),h.prototype),(0,m.default)(h.prototype,"getCachedCustomcast",[c],(0,f.default)(h.prototype,"getCachedCustomcast"),h.prototype),h);e.default=N},function(t,e,n){"use strict";var i=n(2),r=n(29),a=n(4),o=n(0),s=n(3),u=n(1);o(e,"__esModule",{value:!0}),e.default=void 0;var l,c,h,f,d,p,v,g,E,_,y=u(n(14)),m=u(n(26)),T=u(n(17)),A=u(n(3)),R=u(n(15)),S=u(n(5)),x=u(n(6)),P=u(n(79)),O=u(n(37)),I=u(n(38)),w=u(n(30)),b=u(n(56)),D=u(n(83)),C=q(n(21)),L=q(n(115)),N=n(63),M=u(n(23)),k=n(28),U=q(n(24)),G=n(64),F=u(n(59)),V=q(n(9)),H=u(n(147)),W=q(n(303)),B=q(n(304)),Y=u(n(47)),j=u(n(144)),z=u(n(41));function X(t){if("function"!=typeof a)return null;var e=new a,n=new a;return(X=function(t){return t?n:e})(t)}function q(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=X(e);if(n&&n.has(t))return n.get(t);var r={},a=o&&s;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=a?s(t,u):null;l&&(l.get||l.set)?o(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function K(t){var e=function(){if("undefined"==typeof Reflect||!r)return!1;if(r.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,w.default)(t);if(e){var a=(0,w.default)(this).constructor;n=r(i,arguments,a)}else n=i.apply(this,arguments);return(0,I.default)(this,n)}}function J(t){return t<0?+(""+t).slice(0,9):+(""+t).slice(0,8)}var Q=(l=(0,G.frequency60)(),c=(0,G.frequency60)(),h=(0,G.frequency60)(),f=(0,G.frequency60)(),d=(0,G.frequency60)(),p=(0,G.limit)(),v=(0,G.limit)(),g=(0,G.frequency60)(),E=(0,G.frequency60)(),_=function(t){(0,O.default)(v,t);var e,n,i,r,a,o,s,u,l,c,h,f,d,p=K(v);function v(){var t;return(0,S.default)(this,v),(t=p.call(this)).shapeLaserHandler=void 0,t.whiteboardImageConfig=void 0,t.pageUrlFormat=void 0,t.shapeLaserHandlerMap=void 0,t.shapeLaserHandlerMap=new m.default,t.addMessageTypes({doc_all_res:function(e){if(e.user_id!==t.room.store.get("user.id")){var n=t.onDocAllRes(e);t.fire(L.DOC_ALL,{docList:n.docList}),t.fire(L.PAGE_CHANGED,{docId:n.docId,page:n.page,step:n.step})}},doc_add:function(e){var n,i;e.user_id!==t.room.store.get("user.id")&&t.fire(L.DOC_ADDED,{fromId:(0,F.default)(null!==(n=null===(i=e.signal_send_by)||void 0===i?void 0:i.number)&&void 0!==n?n:e.user_id),doc:t.onDocAdd(e.doc)})},doc_update:function(e){var n,i;e.user_id!==t.room.store.get("user.id")&&t.fire(L.DOC_UPDATED,{fromId:(0,F.default)(null!==(n=null===(i=e.signal_send_by)||void 0===i?void 0:i.number)&&void 0!==n?n:e.user_id),docId:e.doc_id,extra:t.onDocUpdate(e)})},doc_del:function(e){if(e.user_id!==t.room.store.get("user.id")){var n,i,r=t.onDocDelete(e.doc_id);if(r)t.fire(L.DOC_REMOVED,{fromId:(0,F.default)(null!==(n=null===(i=e.signal_send_by)||void 0===i?void 0:i.number)&&void 0!==n?n:e.user_id),docId:r.id})}},page_change:function(e){e.user_id!==t.room.store.get("user.id")&&t.fire(L.PAGE_CHANGED,t.onPageChange(e))},page_add:function(e){if(e.user_id!==t.room.store.get("user.id")&&-1!==e.page_id){var n,i,r=t.room.docData.addPage(e.doc_id,e.page_id);if(r)r.fromId=(0,F.default)(null!==(n=null===(i=e.signal_send_by)||void 0===i?void 0:i.number)&&void 0!==n?n:e.user_id),t.fire(L.PAGE_ADDED,r)}},page_del:function(e){if(e.user_id!==t.room.store.get("user.id")){var n,i,r=t.room.docData.deletePage(e.doc_id,e.page_id);if(r)r.fromId=(0,F.default)(null!==(n=null===(i=e.signal_send_by)||void 0===i?void 0:i.number)&&void 0!==n?n:e.user_id),t.fire(L.PAGE_REMOVED,r)}},shape_add:function(e){e.user_id!==t.room.store.get("user.id")&&t.fire(L.SHAPE_ADDED,t.onShapeAdd(e))},shape_append:function(e){e.user_id!==t.room.store.get("user.id")&&t.fire(L.SHAPE_APPENDED,t.onShapeAppend(e))},shape_update:function(e){e.user_id!==t.room.store.get("user.id")&&t.fire(L.SHAPE_UPDATED,t.onShapeUpdate(e))},shape_del:function(e){e.user_id!==t.room.store.get("user.id")&&t.fire(L.SHAPE_REMOVED,t.onShapeRemove(e))},shape_laser:function(e){if(e.user_id!==t.room.store.get("user.id")){var n,i,r,a=[];null!==(n=e.shape)&&void 0!==n&&n.history&&(a=(0,W.default)({points:e.shape.history,encodeType:2})),e.shape.x=+e.shape.x,e.shape.y=+e.shape.y;var o={fromId:(0,F.default)(null!==(i=null===(r=e.signal_send_by)||void 0===r?void 0:r.number)&&void 0!==i?i:e.user_id),laser:e.shape,history:a,interval:e.interval};e.doc_id&&(o.docId=e.doc_id),(0,z.default)(e.page)&&(o.page=e.page),t.fire(L.LASER_RECEIVED,o)}}}),t}return(0,x.default)(v,[{key:"createShapeLaserHandler",value:function(t,e){var n=this,i="".concat(t,"_").concat(e);return this.shapeLaserHandlerMap.has(i)||this.shapeLaserHandlerMap.set(i,{history:[],handler:(0,H.default)((function(t,e,i){var r,a,o="".concat(e,"_").concat(i);t.history=(0,B.default)(null!==(r=null===(a=n.shapeLaserHandlerMap.get(o))||void 0===a?void 0:a.history)&&void 0!==r?r:[]),t.x+="",t.y+="";var s={message_type:"shape_laser_trigger",shape:t,interval:C.INTERVAL_PAINTER_LASER_BROADCAST};e&&(s.doc_id=e),(0,z.default)(i)&&(s.page=i),n.room.roomServer.send(s),n.shapeLaserHandlerMap.has(o)&&n.shapeLaserHandlerMap.delete(o)}),C.INTERVAL_PAINTER_LASER_BROADCAST)}),this.shapeLaserHandlerMap.get(i)}},{key:"onDocAdd",value:function(t){return t=(0,Y.default)(t),this.room.docData.updatePageList(t),this.room.docData.add(t),t}},{key:"onDocUpdate",value:function(t){return(t=(0,Y.default)(t)).extra&&null!=t.extra.scale&&(t.extra.scale=+t.extra.scale),this.room.docData.update(t.docId,{extra:t.extra}),t.extra}},{key:"onDocDelete",value:function(t){return this.room.docData.remove(t)}},{key:"onDocAllRes",value:function(t){var e=this,n=t.doc_list||[];n=n.map((function(t){return(0,Y.default)(t)})),V.each(n,(function(t){var n=t.pageInfo,i=t.pageInfo.pageIds;if(e.room.docData.isWhiteboardDoc(t.id)){var r,a,o,s=e.room.docData.getWhiteboardImageConfig();n.url=null!==(r=s.url)&&void 0!==r?r:n.url,n.width=null!==(a=s.width)&&void 0!==a?a:n.width,n.height=null!==(o=s.height)&&void 0!==o?o:n.height,i&&i.length||(i=[0],t.pageInfo.pageIds=i),t.pageInfo.totalPages=i.length}t.extra&&null!=t.extra.scale&&(t.extra.scale=+t.extra.scale),e.room.docData.updatePageList(t)})),this.room.docData.clear(),this.room.docData.add(n);var i=t.doc_id,r=t.page,a=t.step,o=t.page_id;return this.room.docData.getDocumentById(i)||(i=C.DOC_ID_OF_WHITEBOARD,r=0,a=null),this.room.docData.isWhiteboardDoc(i)&&o&&(r=this.room.docData.getPageById(i,o)),this.room.docData.update(i,{extra:{page:r,step:a}}),{docList:n,docId:i,page:r,step:a}}},{key:"onPageChange",value:function(t){var e,n,i={docId:t.doc_id,page:this.room.docData.isWhiteboardDoc(t.doc_id)?this.room.docData.getPageById(t.doc_id,t.page_id):t.page,fromId:(0,F.default)(null!==(e=null===(n=t.signal_send_by)||void 0===n?void 0:n.number)&&void 0!==e?e:t.user_id),step:t.step,ts:t.ts,event:null};return t.event&&(i.event=t.event),this.room.docData.update(i.docId,{extra:{page:i.page,step:i.step}}),i}},{key:"onShapeAdd",value:function(t){var e,n,i=t.shape;return i.points=(0,W.default)(i),i.speeds&&(i.speeds=(0,W.inflateNumbers)(i.speeds)),this.room.shapeData.add(t.doc_id,this.room.docData.getLocalPage(t.doc_id,t.page),i),{fromId:(0,F.default)(null!==(e=null===(n=t.signal_send_by)||void 0===n?void 0:n.number)&&void 0!==e?e:t.user_id),docId:t.doc_id,page:this.room.docData.getLocalPage(t.doc_id,t.page),shape:i}}},{key:"onShapeAppend",value:function(t){var e,n,i=t.shape;return i.points=(0,W.default)(i),i.speeds&&(i.speeds=(0,W.inflateNumbers)(i.speeds)),this.room.shapeData.append(t.doc_id,this.room.docData.getLocalPage(t.doc_id,t.page),i),{fromId:(0,F.default)(null!==(e=null===(n=t.signal_send_by)||void 0===n?void 0:n.number)&&void 0!==e?e:t.user_id),docId:t.doc_id,page:this.room.docData.getLocalPage(t.doc_id,t.page),shape:i}}},{key:"onShapeUpdate",value:function(t){var e,n,i=t.shape_list;V.each(i,(function(t){t.points=(0,W.default)(t),t.speeds&&(t.speeds=(0,W.inflateNumbers)(t.speeds))}));var r=t.doc_id,a=this.room.docData.getLocalPage(t.doc_id,t.page);return this.room.shapeData.update(r,a,i),{fromId:(0,F.default)(null!==(e=null===(n=t.signal_send_by)||void 0===n?void 0:n.number)&&void 0!==e?e:t.user_id),docId:r,page:a,shapeList:i}}},{key:"onShapeRemove",value:function(t){var e,n,i=this,r=t.shape_id||"",a=t.doc_id,o=this.room.docData.getLocalPage(t.doc_id,t.page);return""===r?this.room.shapeData.clear(a,o):V.each(r.split(","),(function(t){t&&i.room.shapeData.remove(a,o,t)})),{fromId:(0,F.default)(null!==(e=null===(n=t.signal_send_by)||void 0===n?void 0:n.number)&&void 0!==e?e:t.user_id),docId:t.doc_id,page:this.room.docData.getLocalPage(t.doc_id,t.page),shapeId:r}}},{key:"requestAllDocs",value:(d=(0,R.default)(y.default.mark((function t(){var e=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:return t.abrupt("return",this.room.roomServer.request({message_type:"doc_all_req"}).then((function(t){return e.onDocAllRes(t)})));case 5:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"addDoc",value:(f=(0,R.default)(y.default.mark((function t(e){var n,i=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:if(!this.docData.getDocumentByNumber(e.number)){t.next=6;break}throw new M.default(U.INVALID_OPERATION,"文档已经添加");case 6:return n={ext:e.ext,name:e.name,number:e.number,pptUrl:e.pptUrl,pageInfo:e.pageInfo,extra:{visible:0}},t.abrupt("return",this.room.roomServer.request({message_type:"doc_add_trigger",doc:(0,j.default)(n)}).then((function(t){return i.onDocAdd(t.doc)})));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"updateDoc",value:(h=(0,R.default)(y.default.mark((function t(e){var n=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:return(e=(0,j.default)(e)).extra&&null!=e.extra.scale&&(e.extra.scale=e.extra.scale+""),t.abrupt("return",this.room.roomServer.request({message_type:"doc_update_trigger",doc_id:e.doc_id,extra:e.extra}).then((function(t){return n.onDocUpdate(t)})));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"removeDoc",value:(c=(0,R.default)(y.default.mark((function t(e){var n=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:return t.abrupt("return",this.room.roomServer.request({message_type:"doc_del_trigger",doc_id:e}).then((function(t){return n.onDocDelete(t.doc_id)})));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"changePage",value:(l=(0,R.default)(y.default.mark((function t(e,n){var i,r,a,o=this,s=arguments;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=s.length>2&&void 0!==s[2]?s[2]:0,r=s.length>3?s[3]:void 0,this.room){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 4:if(this.room.ability.canUseDocument()){t.next=6;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 6:return e||(e=this.room.pageData.getClientDocId()),a={message_type:"page_change_trigger",doc_id:e,page:n,step:i},this.room.docData.isWhiteboardDoc(e)&&(a.page=0,a.page_id=this.room.docData.getIdByPage(e,n)),r&&(a.event=r),t.abrupt("return",this.room.roomServer.request(a).then((function(t){o.onPageChange(t)})));case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"addPage",value:(u=(0,R.default)(y.default.mark((function t(){var e=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:return t.abrupt("return",this.room.roomServer.request({message_type:"page_add_trigger",doc_id:C.DOC_ID_OF_WHITEBOARD}).then((function(t){if(-1!==t.page_id)return e.room.docData.addPage(t.doc_id,t.page_id);throw new M.default(U.INVALID_OPERATION,"添加 page 失败")})));case 5:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"removePage",value:(s=(0,R.default)(y.default.mark((function t(e){var n,i=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:return n=this.docData.getIdByPage(C.DOC_ID_OF_WHITEBOARD,e),t.abrupt("return",this.room.roomServer.request({message_type:"page_del_trigger",doc_id:C.DOC_ID_OF_WHITEBOARD,page_id:n}).then((function(t){return i.room.docData.deletePage(t.doc_id,t.page_id)})));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"requestAllShapes",value:(o=(0,R.default)(y.default.mark((function t(e,n){var i,r=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:if(!(i=this.room.shapeData.get(e,n))){t.next=7;break}return t.abrupt("return",i);case 7:return t.abrupt("return",this.room.roomServer.request({message_type:"shape_all_req",doc_id:e,page:this.room.docData.getServerPage(e,n)}).then((function(t){var i,a=t.shape_list||[],o=t.shape_append_list||[];return V.each(a,(function(t){t.points=(0,W.default)(t),t.speeds&&(t.speeds=(0,W.inflateNumbers)(t.speeds))})),t.layer||r.room.shapeData.setShapes(t.doc_id,r.room.docData.getLocalPage(t.doc_id,t.page),a),o.length&&V.each(o,(function(e){e.points=(0,W.default)(e),e.speeds&&(e.speeds=(0,W.inflateNumbers)(e.speeds)),t.layer||r.room.shapeData.append(t.doc_id,r.room.docData.getLocalPage(t.doc_id,t.page),e)})),null!==(i=r.room.shapeData.get(e,n))&&void 0!==i?i:a})));case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"addShape",value:(a=(0,R.default)(y.default.mark((function t(e,n,i){var r,a,o,s=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:if(r=i.points,a=i.speeds,i.points=(0,B.default)(i),i.speeds&&(i.speeds=(0,B.deflateNumbers)(i.speeds)),o={message_type:"shape_add_trigger",doc_id:e,page:this.room.docData.getServerPage(e,n),shape:i},1!=i.doodleVersion){t.next=16;break}return this.room.roomServer.send(o),i.points=r,a&&(i.speeds=a),t.abrupt("return",T.default.resolve({fromId:(0,F.default)(this.room.store.get("user.number")),docId:e,page:n,shape:i}));case 16:return t.abrupt("return",this.room.roomServer.request(o).then((function(t){return s.onShapeAdd(t)})));case 17:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return a.apply(this,arguments)})},{key:"appendShape",value:(r=(0,R.default)(y.default.mark((function t(e,n,i){var r,a=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:return r=this.room.store.get("user"),i.points=(0,B.default)(i),i.speeds&&(i.speeds=(0,B.deflateNumbers)(i.speeds)),i.userName=r.name,i.userNumber=r.number,i.userId=r.id,t.abrupt("return",this.room.roomServer.request({message_type:"shape_append_trigger",doc_id:e,page:this.room.docData.getServerPage(e,n),shape:i}).then((function(t){return a.onShapeAppend(t)})));case 11:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})},{key:"updateShapes",value:(i=(0,R.default)(y.default.mark((function t(e,n,i){var r=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:return V.each(i,(function(t){t.points=(0,B.default)(t),t.speeds&&(t.speeds=(0,B.deflateNumbers)(t.speeds))})),t.abrupt("return",this.room.roomServer.request({message_type:"shape_update_trigger",doc_id:e,page:this.room.docData.getServerPage(e,n),shape_list:i}).then((function(t){return r.onShapeUpdate(t)})));case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return i.apply(this,arguments)})},{key:"removeShapes",value:(n=(0,R.default)(y.default.mark((function t(e,n,i){var r=this;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.room){t.next=2;break}throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");case 2:if(this.room.ability.canUseDocument()){t.next=4;break}throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");case 4:return t.abrupt("return",this.room.roomServer.request({message_type:"shape_del_trigger",doc_id:e,page:this.room.docData.getServerPage(e,n),shape_id:null!=i?i:""}).then((function(t){return r.onShapeRemove(t)})));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,i){return n.apply(this,arguments)})},{key:"sendLaser",value:function(t,e,n){if(!this.room)throw new M.default(U.INVALID_OPERATION,"未加入房间，请先执行 join");if(!this.room.ability.canUseDocument())throw new M.default(U.INVALID_OPERATION,"没有开启文档功能");var i=this.createShapeLaserHandler(e,n),r=i.history,a=i.handler;r.push({x:J(t.x),y:J(t.y)}),a(t,e,n)}},{key:"requestRemark",value:(e=(0,R.default)(y.default.mark((function t(e){var n;return y.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.docData.getDocumentById(e)){t.next=3;break}throw new M.default(U.INVALID_PARAMETER,"文档 ".concat(e," 不存在"));case 3:return t.abrupt("return",(0,N.post)(this.room.store.get("apiDomain")+k.URL_REMARK_REQUEST,{fid:n.number,token:this.room.store.get("token"),room_id:this.room.store.get("class.id")},this.room.store.get("privateDomain"),"application/x-www-form-urlencoded").then((function(t){var e;if(null!==(e=t.data)&&void 0!==e&&e.list){var n={};return V.each(t.data.list,(function(t){n[t.page]=t.remark})),n}throw new M.default(U.FETCH_ERROR,"备注请求失败")})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"setWhiteboardImageConfig",value:function(t){this.whiteboardImageConfig=t,this.room&&this.room.docData.setWhiteboardImageConfig(t)}},{key:"setPageUrlFormat",value:function(t){this.pageUrlFormat=t,this.room&&this.room.docData.setPageUrlFormat(t)}},{key:"run",value:function(t){(0,P.default)((0,w.default)(v.prototype),"run",this).call(this,t),this.whiteboardImageConfig&&t.docData.setWhiteboardImageConfig(this.whiteboardImageConfig),this.pageUrlFormat&&t.docData.setPageUrlFormat(this.pageUrlFormat)}},{key:"docData",get:function(){return this.room.docData}},{key:"shapeData",get:function(){return this.room.shapeData}}]),v}(D.default),(0,b.default)(_.prototype,"requestAllDocs",[l],(0,A.default)(_.prototype,"requestAllDocs"),_.prototype),(0,b.default)(_.prototype,"addDoc",[c],(0,A.default)(_.prototype,"addDoc"),_.prototype),(0,b.default)(_.prototype,"updateDoc",[h],(0,A.default)(_.prototype,"updateDoc"),_.prototype),(0,b.default)(_.prototype,"removeDoc",[f],(0,A.default)(_.prototype,"removeDoc"),_.prototype),(0,b.default)(_.prototype,"changePage",[d],(0,A.default)(_.prototype,"changePage"),_.prototype),(0,b.default)(_.prototype,"addPage",[p],(0,A.default)(_.prototype,"addPage"),_.prototype),(0,b.default)(_.prototype,"removePage",[v],(0,A.default)(_.prototype,"removePage"),_.prototype),(0,b.default)(_.prototype,"requestAllShapes",[g],(0,A.default)(_.prototype,"requestAllShapes"),_.prototype),(0,b.default)(_.prototype,"requestRemark",[E],(0,A.default)(_.prototype,"requestRemark"),_.prototype),_);e.default=Q},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3);a(e,"__esModule",{value:!0}),e.default=function(t){var e=t.points;if(u.string(e)){if(2===t.encodeType){for(var n=[],i=0,r=e.length;i<r;i+=4)n.push({x:c(e.substr(i,2)),y:c(e.substr(i+2,2))});return n}return JSON.parse(e)}return e},e.inflateNumbers=function(t){for(var e=[],n=0,i=t.length;n<i;n+=2)e.push(c(t.substr(n,2)));return e};var s=n(111),u=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=l(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var c=s?o(t,u):null;c&&(c.get||c.set)?a(r,u,c):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(8));function l(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(l=function(t){return t?n:e})(t)}function c(t){return(64*s.map[t.charAt(0)]+s.map[t.charAt(1)])/4095}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=function(t){var e=c.array(t)?t:t.points;if(!c.array(e))return e;if(c.array(t)||"Doodle"===t.name&&!t.autoClosePath){var n=[];return e.forEach((function(t){var e=f(t.x)+f(t.y);n.push(e)})),t.encodeType=2,n.join("")}return t.encodeType=0,(0,u.default)(e)},e.deflateNumbers=function(t){var e=[];return t.forEach((function(t){e.push(f(t))})),e.join("")};var u=s(n(80)),l=n(111),c=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(8));function h(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(h=function(t){return t?n:e})(t)}function f(t){t<0&&(t=0),t>1&&(t=1),t=Math.floor(4095*t);var e=Math.floor(t/64),n=t%64;return l.list[e]+l.list[n]}},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.worker=e.webgl2=e.webgl=void 0;var a,o,s,u=r(n(306));e.webgl=a,e.webgl2=o,e.worker=s;try{if(u.default.ie||u.default.edge&&u.default.version<"79")e.webgl=a=!1;else{var l=document.createElement("canvas");e.webgl=a=!(!window.WebGLRenderingContext||!l.getContext("webgl")&&!l.getContext("experimental-webgl"))}}catch(t){e.webgl=a=!1}try{if(u.default.safari||u.default.ie||u.default.edge&&u.default.version<"79")e.webgl2=o=!1;else{var c=document.createElement("canvas");e.webgl2=o=!(!window.WebGL2RenderingContext||!c.getContext("webgl2")&&!c.getContext("experimental-webgl2"))}}catch(t){e.webgl2=o=!1}void 0!==window.Worker?e.worker=s=!0:e.worker=s=!1},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=void 0;var a=r(n(307)),o=n(9),s=[["alipay",/alipay/],["wechat",/micromessenger/],["baiduApp",/baiduboxapp/],["baidu",/baidubrowser/],["baidu",/bdbrowser/],["uc",/ucbrowser/],["uc",/ucweb/],["qq",/qqbrowser/],["qqApp",/qq/],["ie",/iemobile[ \/]([\d_.]+)/],["ie",/msie[ \/]([\d_.]+)/],["ie",/trident[ \/]([\d_.]+)/,4],["edge",/edge[ \/]([\d_.]+)/],["chrome",/chrome[ \/]([\d_.]+)/],["firefox",/firefox[ \/]([\d_.]+)/],["opera",/opera(?:.*version)?[ \/]([\d_.]+)/],["safari",/version[ \/]([\d_.]+) safari/],["safari",/safari/]];var u,l,c,h=(u=(navigator.userAgent||"").toLowerCase(),(0,o.each)(s,(function(t){var e=t[1].exec(u);if(e)return l=t[0],(c=e[1])&&(c=c.replace(/_/g,"."),t[2]&&(c=(0,a.default)(c,10)+t[2]+".0")),!1})),{name:l||"",version:c||""});h.name&&(h[h.name]=!0);var f=h;e.default=f},function(t,e,n){t.exports=n(308)},function(t,e,n){n(309),t.exports=n(7).parseInt},function(t,e,n){var i=n(11),r=n(310);i(i.G+i.F*(parseInt!=r),{parseInt:r})},function(t,e,n){var i=n(12).parseInt,r=n(137).trim,a=n(104),o=/^[-+]?0[xX]/;t.exports=8!==i(a+"08")||22!==i(a+"0x16")?function(t,e){var n=r(String(t),3);return i(n,e>>>0||(o.test(n)?16:10))}:i},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(14)),l=s(n(26)),c=s(n(15)),h=s(n(5)),f=s(n(6)),d=s(n(155)),p=s(n(23)),v=D(n(116)),g=D(n(62)),E=s(n(312)),_=s(n(313)),y=D(n(24)),m=n(28),T=s(n(317)),A=D(n(8)),R=D(n(84)),S=s(n(82)),x=s(n(41)),P=s(n(13)),O=s(n(159)),I=D(n(115)),w=s(n(81));function b(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(b=function(t){return t?n:e})(t)}function D(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=b(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var C=function(){function t(e,n,i,r){var a,o,s=this;if((0,h.default)(this,t),this.container=void 0,this.canvas=void 0,this.doc=void 0,this.client=void 0,this.painterConfig=void 0,this.options=void 0,this.painter=void 0,this.player=void 0,this.currentPageId=void 0,this.currentPage=void 0,this.currentStep=void 0,this.stepCount=void 0,this.emitter=void 0,this.quality=void 0,this.namespace=void 0,this.isAnimated=void 0,this.imageWidth=void 0,this.imageHeight=void 0,this.canPaint=void 0,this.resized=void 0,this.onmessageHandler=void 0,this.historyMap=void 0,!e||!n||!i)throw new p.default(y.INVALID_PARAMETER,"参数错误，请检查");if(!n.getAbilities().document)throw new p.default(y.INVALID_OPERATION,"未开启文档功能");if(i.hasPainter&&!r)throw new p.default(y.INVALID_PARAMETER,"未传入 PainterConfig");var u=n.document.docData.getDocumentById(e.id);this.doc=u||e,this.client=n,this.painterConfig=r,this.options=i,this.emitter=new S.default(!0),this.quality=(0,O.default)(null!==(a=i.quality)&&void 0!==a?a:1,.1,1),this.canPaint=null===(o=i.canDrawing)||void 0===o||o,this.namespace=".btrm_document_player"+Math.random(),this.currentPageId=-1,this.currentPage=-1,this.currentStep=-1,this.stepCount=0,this.options.container?this.createTemplat():this.options.canvas&&(this.canvas=this.options.canvas);var c,f,v,g,m=this,A=this.client.document.docData;if(this.isAnimated=A.isAnimationDoc(this.doc.id)&&!!this.options.container,this.options.container)if(this.isAnimated){var R,x,I,b;this.player=new E.default(this.doc,{urlQuery:m.options.urlQuery,allowPageByClick:m.options.allowClick,cdnHostFallbacks:null!==(R=m.options.cdnHostFallbacks)&&void 0!==R?R:null===(x=m.client.getRoom())||void 0===x?void 0:x.store.get("partner.cdnHostFallbacks",[]),ossOriginHost:null!==(I=m.options.ossOriginHost)&&void 0!==I?I:null===(b=m.client.getRoom())||void 0===b?void 0:b.store.get("partner.ossOriginHost",""),insertTo:function(t){m.container.prepend(t)},onReady:function(t){m.stepCount=t.stepCount,m.pageEnd("success")},onDocUpdate:function(t,e,n){n?m.client.document.updateDoc(e):m.client.document.docData.update(t,e)},onPageCountChange:function(t,e,n){m.doc.pageInfo.totalPages=n,m.onPageCountChage()},onPageChange:function(t,e,n,i){m.stepCount=n},onEventTrigger:function(t,e,n,i){m.sendEvent(e,n,i)},onStepChange:function(t,e,n,i,r){var a=e!==m.currentPage;r||e===m.currentPage&&n===m.currentStep?r&&e===m.currentPage&&n===m.currentStep&&(m.pageEnd("success",!0,0==n),m.onStepChange(e,n)):m.changePage(e,n).then((function(){m.pageEnd("success",!0,a),m.onStepChange(e,n)}))},onRequestChange:function(t,e,n){m.changePage(e,n)}}),this.onmessageHandler=function(t){s.onmessage(t)},window.addEventListener("message",this.onmessageHandler)}else{var D,C,L,N;this.player=new T.default(this.doc,{preloadCount:10,compressImage:this.options.compressImage,hostFallbacks:null!==(D=m.options.cdnHostFallbacks)&&void 0!==D?D:null===(C=m.client.getRoom())||void 0===C?void 0:C.store.get("partner.cdnHostFallbacks",[]),ossOriginHost:null!==(L=m.options.ossOriginHost)&&void 0!==L?L:null===(N=m.client.getRoom())||void 0===N?void 0:N.store.get("partner.ossOriginHost",""),isCurrentPage:function(t,e){return m.isCurrentPage(t,e)},insertTo:function(t,e){m.container.prepend(t.element),m.client.document.docData.isWhiteboardDoc(m.doc.id)&&t.pageId!==m.currentPageId&&(t.pageId=m.currentPageId,e=!0),m.pageEnd("success",!0,e)},watermark:this.options.waterMark,onLoading:function(t){},onSuccess:function(t,e){},onFailure:function(t){m.isCurrentPage(t.docId,t.page)&&m.pageEnd("failure")},onTimeout:function(t){m.isCurrentPage(t.docId,t.page)&&m.pageEnd("timeout")},onAbort:function(t){m.isCurrentPage(t.docId,t.page)&&m.pageEnd("abort")}})}else this.player=new _.default(this.doc,{compressImage:this.options.compressImage,watermark:this.options.waterMark,preloadCount:10,urlPreload:function(t,e){m.options.urlPreload&&(0,P.default)(m.options.urlPreload,m,[t,e])},hostFallbacks:null!==(c=m.options.cdnHostFallbacks)&&void 0!==c?c:null===(f=m.client.getRoom())||void 0===f?void 0:f.store.get("partner.cdnHostFallbacks",[]),ossOriginHost:null!==(v=m.options.ossOriginHost)&&void 0!==v?v:null===(g=m.client.getRoom())||void 0===g?void 0:g.store.get("partner.ossOriginHost",""),insertTo:function(t,e,n,i,r,a){m.options.onUrlChange&&(0,P.default)(m.options.onUrlChange,m,[t,e,n,i,r,a])}});var M,k=this.getDocExtraInfo();this.options.hasPainter?(this.painter=new d.default(null!==(M=this.options.canvas)&&void 0!==M?M:this.canvas,this.container,this.painterConfig,this.emitter,{user:this.client.getRoom().userData.getSelf(),page:1,eraserSensitivity:i.eraserSensitivity,preserveDrawingBuffer:i.preserveDrawingBuffer,createTextarea:i.createTextarea,cacheCanvas:i.cacheCanvas,cacheCanvasContext:i.cacheCanvasContext,devicePixelRatio:i.devicePixelRatio,enableBrushTip:i.enableBrushTip,useWebgl:i.useWebgl}),this.painter.ready(this.canPaint,!1).then((function(){var t,e;s.setCanDrawing(s.canPaint),s.setPage(null!==(t=k.page)&&void 0!==t?t:0,null!==(e=k.step)&&void 0!==e?e:0,!0)})),this.historyMap=new l.default):(0,w.default)((function(){var t,e;s.setPage(null!==(t=k.page)&&void 0!==t?t:0,null!==(e=k.step)&&void 0!==e?e:0,!0)}));this.bindEvent()}var e,n,i,r,a,o;return(0,f.default)(t,[{key:"isAnimatedDocument",value:function(){return this.isAnimated}},{key:"changePage",value:(o=(0,c.default)(u.default.mark((function t(e){var n,i=this,r=arguments;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:0,A.number(e)){t.next=3;break}throw new p.default(y.INVALID_PARAMETER,"page 不是一个 number");case 3:if(!n||A.number(n)){t.next=5;break}throw new p.default(y.INVALID_PARAMETER,"step 不是一个 number");case 5:if(!(e<0||e>=this.doc.pageInfo.totalPages)){t.next=7;break}throw new p.default(y.INVALID_PARAMETER,"page 超出范围");case 7:if(!n||!(n<0||n>=this.stepCount)){t.next=9;break}throw new p.default(y.INVALID_PARAMETER,"step 超出范围");case 9:return t.abrupt("return",this.client.document.changePage(this.doc.id,e,n).then((function(t){i.setPage(e,n)})).catch((function(t){throw new p.default(y.SIGNAL_ERROR,"信令超时")})));case 10:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"setPage",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!A.number(t))throw new p.default(y.INVALID_PARAMETER,"page 不是一个 number");if(e&&!A.number(e))throw new p.default(y.INVALID_PARAMETER,"step 不是一个 number");if(t<0||t>=this.doc.pageInfo.totalPages)throw new p.default(y.INVALID_PARAMETER,"page 超出范围");if(!n&&e&&(e<0||e>=this.stepCount))throw new p.default(y.INVALID_PARAMETER,"step 超出范围");this.painter&&this.historyMap.set(this.currentPage,this.painter.getHistoryData());var i=this.currentPage!==t,r=this.currentStep!==e;if(this.client.document.docData.isWhiteboardDoc(this.doc.id)){var a=this.client.document.docData.getIdByPage(this.doc.id,t);i=i||this.currentPageId!==a,this.currentPageId=a}this.currentPage=t,this.currentStep=e;var o=+this.doc.pageInfo.width,s=+this.doc.pageInfo.height,u=(0,P.default)(this.options.getImageDimension,this,[o,s]),l=u.width,c=u.height;if(!A.number(l)||l<=0||!A.number(c)||c<=0)throw new p.default(y.INVALID_PARAMETER,"getImageDimension 返回非法，请检查");var h=this.imageWidth!==l||this.imageHeight!==c;this.imageWidth=l,this.imageHeight=c,this.pageStart(i),this.player.setPage(t,e),this.player.setConfig(l,c,this.quality),this.painter&&i&&this.painter.clear(!0),this.resized=h,(!this.isAnimated||i||r)&&this.options.container||this.pageEnd("success",!0,!this.options.container&&i)}},{key:"sendEvent",value:(a=(0,c.default)(u.default.mark((function t(e,n,i){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.client.document.changePage(this.doc.id,e,n,i).catch((function(t){throw new p.default(y.SIGNAL_ERROR,"信令超时")})));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return a.apply(this,arguments)})},{key:"dispatchEvent",value:function(t){if(!this.isAnimated)throw new p.default(y.INVALID_OPERATION,"当前文档不是动态文档");this.player.dispatchEvent(t)}},{key:"sendMessage",value:function(t){if(!this.isAnimated)throw new p.default(y.INVALID_OPERATION,"当前文档不是动态文档");this.player.sendMessage(t)}},{key:"reload",value:function(){this.setPage(this.currentPage,this.currentStep)}},{key:"hasPrev",value:function(){return this.currentPage>0||this.currentStep>0}},{key:"hasNext",value:function(){return this.currentPage<this.doc.pageInfo.totalPages-1||this.currentStep<this.stepCount-1}},{key:"prev",value:(r=(0,c.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.hasPrev()){t.next=10;break}if(!(this.currentStep>0)){t.next=6;break}return t.next=4,this.changePage(this.currentPage,this.currentStep-1);case 4:t.next=8;break;case 6:return t.next=8,this.changePage(this.currentPage-1,0);case 8:t.next=11;break;case 10:throw new p.default(y.INVALID_OPERATION,"没有上一步");case 11:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"next",value:(i=(0,c.default)(u.default.mark((function t(){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.hasNext()){t.next=10;break}if(this.stepCount&&(!this.stepCount||this.currentStep!==this.stepCount-1)){t.next=6;break}return t.next=4,this.changePage(this.currentPage+1,0);case 4:t.next=8;break;case 6:return t.next=8,this.changePage(this.currentPage,this.currentStep+1);case 8:t.next=11;break;case 10:throw new p.default(y.INVALID_OPERATION,"没有下一步");case 11:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"clientPrev",value:function(){if(!this.hasPrev())throw new p.default(y.INVALID_OPERATION,"没有上一步");this.currentStep>0?this.setPage(this.currentPage,this.currentStep-1):this.setPage(this.currentPage-1,0)}},{key:"clientNext",value:function(){if(!this.hasNext())throw new p.default(y.INVALID_OPERATION,"没有下一步");this.stepCount&&this.currentStep===this.stepCount-1?this.setPage(this.currentPage+1,0):this.setPage(this.currentPage,this.currentStep+1)}},{key:"setCanDrawing",value:function(t){this.canPaint=t,this.painter&&this.painter.updatePaintAuth(t)}},{key:"clearShapes",value:function(){this.painter&&this.painter.clear()}},{key:"deleteSelectShapes",value:function(){this.painter&&this.painter.deleteActive()}},{key:"getTotalPage",value:function(){return this.doc.pageInfo.totalPages}},{key:"getCurrentDocId",value:function(){return this.doc.id}},{key:"getCurrentPage",value:function(){return this.currentPage}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"getStepCount",value:function(){return this.stepCount}},{key:"canOperatePage",value:function(){return this.client.document.docData.isWhiteboardDoc(this.doc.id)}},{key:"getImageWidth",value:function(){return this.imageWidth}},{key:"getImageHeight",value:function(){return this.imageHeight}},{key:"addPage",value:(n=(0,c.default)(u.default.mark((function t(){var e;return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.canOperatePage()){t.next=9;break}return t.next=3,this.client.document.addPage();case 3:return e=t.sent,this.updateDoc(),this.onPageCountChage(),t.abrupt("return",e.page);case 9:throw new p.default(y.INVALID_OPERATION,"当前 Doc 不能操作页码");case 10:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"removePage",value:(e=(0,c.default)(u.default.mark((function t(e){return u.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.canOperatePage()){t.next=13;break}if(A.number(e)){t.next=3;break}throw new p.default(y.INVALID_PARAMETER,"参数 page 类型错误");case 3:if(!(e<0||e>=this.getTotalPage())){t.next=5;break}throw new p.default(y.INVALID_PARAMETER,"参数 page 超出范围");case 5:if(1!==this.getTotalPage()){t.next=7;break}throw new p.default(y.INVALID_OPERATION,"至少需要保留一页");case 7:return t.next=9,this.client.document.removePage(e);case 9:this.updateDoc(),this.onPageCountChage(),t.next=14;break;case 13:throw new p.default(y.INVALID_OPERATION,"当前 Doc 不能操作页码");case 14:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"snapshot",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!this.options.preserveDrawingBuffer)throw new p.default(y.INVALID_OPERATION,"配置项 preserveDrawingBuffer 未设置为 true");if(t&&!this.isAnimated&&this.player){var i=document.createElement("canvas");i.width=this.imageWidth,i.height=this.imageHeight;var r=i.getContext("2d"),a=this.player.getCurrentImage();return r.drawImage(a.element,0,0,a.rawWidth,a.rawHeight,0,0,this.imageWidth,this.imageHeight),r.drawImage(this.canvas,0,0,this.imageWidth*this.painter.getDevicePixelRatio(),this.imageHeight*this.painter.getDevicePixelRatio(),0,0,this.imageWidth,this.imageHeight),i.toDataURL("image/".concat(e),n)}if(this.canvas)return this.canvas.toDataURL("image/".concat(e),n)}},{key:"addImage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.painter&&this.painter.addBitmap({url:t,position:{x:e,y:n}})}},{key:"fire",value:function(t,e){this.emitter.fire(t,A.array(e)?e:(0,x.default)(e)?[e]:void 0)}},{key:"one",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,{fn:e,ctx:n.ctx?n.ctx:this,max:1}),this}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.emitter.on(t,{fn:e,ctx:n.ctx?n.ctx:this}),this}},{key:"off",value:function(t,e){return arguments.length>1?this.emitter.off(t,e):this.emitter.off(t),this}},{key:"setQuality",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.quality=(0,O.default)(t,.1,1)}},{key:"recreatePainter",value:function(t){var e=this;this.painter&&(t&&(this.container.replaceChild(t,this.canvas),this.canvas=t),this.painter.destroy(),this.painter=new d.default(this.canvas,this.container,this.painterConfig,this.emitter,{user:this.client.getRoom().userData.getSelf(),page:1,eraserSensitivity:this.options.eraserSensitivity,preserveDrawingBuffer:this.options.preserveDrawingBuffer}),this.painter.ready(this.canPaint,!1).then((function(){e.pageEnd("recreatePainter",!1)})))}},{key:"hasPainterPrev",value:function(){if(this.painter)return this.painter.hasPrev()}},{key:"hasPainterNext",value:function(){if(this.painter)return this.painter.hasNext()}},{key:"painterPrev",value:function(){this.painter&&this.painter.prev()}},{key:"painterNext",value:function(){this.painter&&this.painter.next()}},{key:"createTemplat",value:function(){var t=document.createElement("div");if(t.className="brtm-whiteboard",t.style.position="relative",this.options.hasPainter)if(this.options.canvas)this.canvas=this.options.canvas;else{var e=document.createElement("canvas");e.style.cssText="\n          position: absolute;\n          top: 0;\n          left: 0;\n        ",e.ondragstart=function(){return!1},t.appendChild(e),this.canvas=e}this.options.container.appendChild(t),this.container=t}},{key:"isCurrentPage",value:function(t,e){return this.currentPage===e}},{key:"pageStart",value:function(t){this.onLoadingStart(t)}},{key:"pageEnd",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n&&this.onLoadingEnd(t,i),i&&this.onPageChange(t),this.painter&&(i||this.resized)&&(this.painter.clear(!0),this.painter.setCanvasLayer(this.doc.id,this.currentPage),this.painter.updatePaintAuth(this.canPaint),this.painter.resize(this.imageWidth,this.imageHeight).then((function(){e.canvas.style&&(e.canvas.style.width=e.imageWidth+"px"),setTimeout((function(){e.client.document.requestAllShapes(e.doc.id,e.currentPage).then((function(t){e.painter.loadLayerShape(t),e.historyMap.get(e.currentPage)?e.painter.setHistoryData(e.historyMap.get(e.currentPage)):e.fire(v.HISTORY_RECORD_CHANGED,{record:0})}))}),0)})))}},{key:"getDocExtraInfo",value:function(){var t=this.client.document.docData.getDocumentById(this.doc.id);return t&&t.extra||{}}},{key:"bindEvent",value:function(){var t=this;if(this.painter){var e=this.painter;this.emitter.on(v.SHAPE_ADD_TRIGGER+this.namespace,function(){var n=(0,c.default)(u.default.mark((function n(i){var r;return u.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.client.document.addShape(i.docId,i.page,i.shape);case 2:r=n.sent,e.emitShapeAdd(r);case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).on(v.SHAPE_APPEND_TRIGGER+this.namespace,function(){var n=(0,c.default)(u.default.mark((function n(i){var r;return u.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.client.document.appendShape(i.docId,i.page,i.shape);case 2:r=n.sent,e.emitShapeAppend(r);case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).on(v.SHAPE_UPDATE_TRIGGER+this.namespace,function(){var n=(0,c.default)(u.default.mark((function n(i){var r;return u.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.client.document.updateShapes(i.docId,i.page,i.shapeList);case 2:r=n.sent,e.emitShapeUpdate(r);case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).on(v.SHAPE_REMOVE_TRIGGER+this.namespace,function(){var n=(0,c.default)(u.default.mark((function n(i){var r;return u.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.client.document.removeShapes(i.docId,i.page,i.shapeId);case 2:r=n.sent,e.emitShapeRemove(r);case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).on(v.PAINTER_RECTEARE_TRIGGER+this.namespace,(function(e){if(e.canvas===t.painter){if(e.switchContext){if(t.options.canvas)return void t.fire(v.PAINTER_ERROR);var n=document.createElement("canvas");n.style.cssText="\n                  position: absolute;\n                  top: 0;\n                  left: 0;\n                ",n.ondragstart=function(){return!1},t.container.replaceChild(n,t.canvas),t.canvas=n}t.recreatePainter()}})),this.client.document.on(I.SHAPE_ADDED+this.namespace,(function(n){n.docId===t.doc.id&&n.page===t.currentPage&&e.emitShapeAdd(n)})).on(I.SHAPE_APPENDED+this.namespace,(function(n){n.docId===t.doc.id&&n.page===t.currentPage&&e.emitShapeAppend(n)})).on(I.SHAPE_UPDATED+this.namespace,(function(n){n.docId===t.doc.id&&n.page===t.currentPage&&e.emitShapeUpdate(n)})).on(I.SHAPE_REMOVED+this.namespace,(function(n){n.docId===t.doc.id&&n.page===t.currentPage&&e.emitShapeRemove(n)})).on(I.PAGE_CHANGED+this.namespace,(function(e){if(e.docId===t.doc.id)if(e.event)t.isAnimated&&t.dispatchEvent(e.event);else{var n=!(e.page===t.currentPage&&!t.isAnimated);if(!n&&t.client.document.docData.isWhiteboardDoc(t.doc.id)){var i=t.client.document.docData.getIdByPage(t.doc.id,e.page);n=t.currentPageId!==i}n&&t.setPage(e.page,e.step)}})).on(I.PAGE_ADDED+this.namespace,(function(e){e.docId===t.doc.id&&(t.updateDoc(),t.onPageCountChage())})).on(I.PAGE_REMOVED+this.namespace,(function(e){e.docId===t.doc.id&&(t.updateDoc(),t.onPageCountChage())})).on(I.DOC_UPDATED+this.namespace,(function(e){e.docId===t.doc.id&&t.isAnimated&&t.sendMessage({name:"recordChange",record:e.extra.pptOperation,fromId:e.fromId})})).on(I.DOC_ALL+this.namespace,(function(e){var n=t.client.document.docData.getDocumentById(t.doc.id);if(n){var i,r,a,o,s=null!==(i=null===(r=n.extra)||void 0===r?void 0:r.page)&&void 0!==i?i:0,u=null!==(a=null===(o=n.extra)||void 0===o?void 0:o.step)&&void 0!==a?a:0;(t.currentPage!==s||t.isAnimated&&t.currentStep!==u)&&t.setPage(s,u,!0)}else t.destroy(),g.error("文档 ".concat(t.doc.id," 已不存在"),"DocumentPlayer")})),this.client.on(R.BRTM_ABILITIES_CHANGED+this.namespace,(function(e){null!=e&&e.document||(t.destroy(),g.debug("文档功能已关闭","DocumentPlayer"))})).on(m.PRIVATE_EVENT_PREFIX+R.BRTM_ABILITIES_CHANGED+this.namespace,(function(e){null!=e&&e.document||(t.destroy(),g.debug("文档功能已关闭","DocumentPlayer"))}))}}},{key:"onmessage",value:function(t){var e;try{e=JSON.parse(t.data)}catch(t){}if(e){var n=this.player;if(e.id&&n.getId()===e.id)switch(e.name){case"ready":n.onReady(e);break;case"pagechange":n.onPageChange(e);break;case"stepchange":n.onStepChange(e);break;case"click":n.onClickEvent(e);break;case"syncVideo":n.onSyncVideo(e);break;case"requestchangepage":n.onRequestChangePage(e);break;case"requestchangerecord":n.onRequestChangeRecord(e)}}}},{key:"onLoadingStart",value:function(t){this.options.onLoadingStart&&(0,P.default)(this.options.onLoadingStart,this,[this.currentPage,this.currentStep,t]),this.fire(v.LOADING_START,{page:this.currentPage,step:this.currentStep,pageChanged:t})}},{key:"onLoadingEnd",value:function(t,e){this.options.onLoadingEnd&&(0,P.default)(this.options.onLoadingEnd,this,[this.currentPage,this.currentStep,e,t]),this.fire(v.LOADING_ENDED,{page:this.currentPage,step:this.currentStep,status:t,pageChanged:e})}},{key:"onPageChange",value:function(t){this.options.onPageChange&&(0,P.default)(this.options.onPageChange,this,[this.currentPage,this.currentStep,t]),this.fire(v.PAGE_CHANGED,{page:this.currentPage,step:this.currentStep,status:t})}},{key:"onStepChange",value:function(t,e){this.options.onStepChange&&(0,P.default)(this.options.onStepChange,this,[t,e]),this.fire(v.STEP_CHANGED,{page:this.currentPage,step:this.currentStep})}},{key:"onPageCountChage",value:function(){this.options.onPageCountChage&&(0,P.default)(this.options.onPageCountChage,this,[this.getTotalPage()]),this.fire(v.PAGE_COUNT_CHANGED,this.getTotalPage())}},{key:"updateDoc",value:function(){this.doc=this.client.document.docData.getDocumentById(this.doc.id),this.player&&!this.isAnimated&&this.player.updateDoc(this.doc)}},{key:"destroy",value:function(){this.emitter&&(this.namespace&&(this.client.document.off(this.namespace),this.client.off(this.namespace)),this.emitter.off(),this.onmessageHandler&&window.removeEventListener("message",this.onmessageHandler),this.historyMap&&(this.historyMap.clear(),this.historyMap=null),this.emitter=null,this.client=null,this.player&&this.player.destroy(),this.painter&&this.painter.destroy(),this.player=null,this.painter=null,this.container&&this.options.container.removeChild(this.container),this.container=null,this.canvas=null)}}]),t}();e.default=C},function(t,e,n){"use strict";var i=n(2),r=n(57),a=n(112),o=n(3),s=n(113),u=n(114),l=n(0),c=n(4),h=n(1);l(e,"__esModule",{value:!0}),e.default=void 0;var f=h(n(80)),d=h(n(34)),p=h(n(5)),v=h(n(6)),g=h(n(108)),E=h(n(85)),_=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=m(e);if(n&&n.has(t))return n.get(t);var r={},a=l&&o;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var u=a?o(t,s):null;u&&(u.get||u.set)?l(r,s,u):r[s]=t[s]}r.default=t,n&&n.set(t,r);return r}(n(10)),y=h(n(13));function m(t){if("function"!=typeof c)return null;var e=new c,n=new c;return(m=function(t){return t?n:e})(t)}function T(t,e){var n=r(t);if(a){var i=a(t);e&&(i=i.filter((function(e){return o(t,e).enumerable}))),n.push.apply(n,i)}return n}var A=0,R=function(){function t(e,n){var i;(0,p.default)(this,t),this.isReady=void 0,this.id=void 0,this.hostIndex=void 0,this.reloadCount=void 0,this.pierceClickEvent=void 0,this.doc=void 0,this.options=void 0,this.hostFallbacks=void 0,this.iframe=void 0,this.loadTimer=void 0,this.width=void 0,this.height=void 0,this.rawWidth=void 0,this.rawHeight=void 0,this.page=void 0,this.step=void 0,this.pageCount=void 0,this.stepCount=void 0,this.version=void 0,this.doc=e,this.options=n,this.id="brtm-ppt-"+A++,this.hostIndex=-1,this.reloadCount=0,this.pierceClickEvent=null,this.hostFallbacks=[],this.isReady=!1,null!==(i=this.options.cdnHostFallbacks)&&void 0!==i&&i.length&&(this.hostFallbacks=this.options.cdnHostFallbacks.slice()),this.options.ossOriginHost&&this.hostFallbacks.push(this.options.ossOriginHost),t.instances[this.id]=this}return(0,v.default)(t,[{key:"getIframeUrl",value:function(t){if(this.hostIndex>-1){if(this.hostFallbacks[this.hostIndex]){var e="$1"+this.hostFallbacks[this.hostIndex]+"$2";return t.replace(/(https?:\/\/)[^\/]+(\/.+)/,e)}return t}return t}},{key:"createIframe",value:function(t){var e=this,n=document.createElement("iframe");return n.className="brtm-ppt-iframe",n.src=this.getIframeUrl(t),n.allow="autoplay",n.frameBorder="0",n.scrolling="no",n.width=this.width+"",n.height=this.height+"",this.options.insertTo(n),this.removeLoadTimer(),this.loadTimer=setTimeout((function(){e.loadTimer=null,e.reloadCount++,e.reloadCount>3*(e.hostFallbacks.length+1)?(e.reloadCount=0,e.showIfNeeded()):n&&(e.removeIframe(n),setTimeout((function(){e.iframe||(e.hostIndex++,e.hostIndex===e.hostFallbacks.length&&(e.hostIndex=-1),e.createIframe(t))}),100))}),4e4),this.iframe=n}},{key:"load",value:function(){var t,e=this.doc.pptUrl,n=this.iframe;this.hostIndex=-1,e=(0,E.default)(e)+(e.indexOf("?")>-1?"&":"?")+_.param(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){(0,d.default)(t,e,n[e])})):s?u(t,s(n)):T(Object(n)).forEach((function(e){l(t,e,o(n,e))}))}return t}({id:this.id,docId:this.doc.id},this.options.urlQuery)),(null===(t=n)||void 0===t?void 0:t.src)===e&&this.removeIframe(),n?n.className=n.className.replace(" brtm-active",""):n=this.createIframe(e)}},{key:"updateDoc",value:function(t){}},{key:"showIfNeeded",value:function(t,e){if(this.isHidden()){var n=this.iframe;return n.className=n.className.replace(" brtm-active","")+" brtm-active",this.options.onReady&&(0,y.default)(this.options.onReady,this,[{docId:this.doc.id,page:null==t?this.page:t,pageCount:this.pageCount,step:null==e?this.step:e,stepCount:this.stepCount}]),!0}}},{key:"sendMessage",value:function(t){if(this.isReady){var e=this.iframe.contentWindow;e&&e.postMessage((0,f.default)(t),"*")}}},{key:"onReady",value:function(t){if(this.isReady=!0,this.version=t.version,this.rawWidth=t.width,this.rawHeight=t.height,this.pageCount=t.pageCount,this.stepCount=t.stepCount,this.reloadCount=0,this.removeLoadTimer(),this.setConfig(this.width,this.height),t.pageCount>0&&this.doc.pageInfo.totalPages!==t.pageCount&&((0,y.default)(this.options.onDocUpdate,this,[this.doc.id,{pageInfo:{totalPages:t.pageCount}}]),(0,y.default)(this.options.onPageCountChange,this,[this.doc.id,t.page,t.pageCount])),t.page!==this.page||t.step!==this.step){var e;this.sendMessage({name:"goto",page:this.page,step:this.step});var n=null===(e=this.doc.extra)||void 0===e?void 0:e.pptOperation;n&&this.sendMessage({name:"recordChange",record:n})}this.showIfNeeded(t.page,t.step)}},{key:"onPageChange",value:function(t){var e=t.page,n=t.stepCount;this.shouldLimitForPierceClickEvent()||(e===this.page||this.options.allowPageByClick&&!t.isTriggerByGoTo)&&(this.stepCount=n,this.isHidden()||(0,y.default)(this.options.onPageChange,this,[this.doc.id,e,n,t.isTriggerByGoTo]))}},{key:"onStepChange",value:function(t){if(t.isTriggerByGoTo)(0,y.default)(this.options.onStepChange,this,[this.doc.id,t.page,t.step,{name:t.name},t.isTriggerByGoTo]);else{var e=t.step;this.shouldLimitForPierceClickEvent()||(this.options.allowPageByClick||e===this.step||0===e)&&(this.showIfNeeded()||(0,y.default)(this.options.onStepChange,this,[this.doc.id,t.page,e,{name:t.name}]))}}},{key:"onClickEvent",value:function(t){this.shouldLimitForPierceClickEvent()||this.options.allowPageByClick&&!this.isHidden()&&t.page===this.page&&t.step===this.step&&(0,y.default)(this.options.onEventTrigger,this,[this.doc.id,this.page,this.step,{name:t.name,x:t.x,y:t.y}])}},{key:"onSyncVideo",value:function(t){this.options.allowPageByClick&&!this.isHidden()&&t.page===this.page&&(0,y.default)(this.options.onEventTrigger,this,[this.doc.id,this.page,this.step,{videoTargetId:t.videoTargetId,fullscreen:t.fullscreen,name:t.name,paused:t.paused,currentTime:t.currentTime}])}},{key:"onRequestChangeRecord",value:function(t){this.options.allowPageByClick&&!this.isHidden()&&(0,y.default)(this.options.onDocUpdate,this,[this.doc.id,{docId:this.doc.id,extra:{ppt_operation:t.record}},!0])}},{key:"onRequestChangePage",value:function(t){this.options.allowPageByClick&&!this.isHidden()&&(0,y.default)(this.options.onRequestChange,this,[this.doc.id,t.targetPage,t.targetStep])}},{key:"removeLoadTimer",value:function(){this.loadTimer&&(clearTimeout(this.loadTimer),this.loadTimer=null)}},{key:"isHidden",value:function(){var t,e;return-1===(null===(t=this.iframe)||void 0===t||null===(e=t.className)||void 0===e?void 0:e.indexOf(" brtm-active"))}},{key:"removeIframe",value:function(t){var e=null!=t?t:this.iframe;null!=e&&e.parentElement&&e.parentElement.removeChild(e),this.iframe=null}},{key:"shouldLimitForPierceClickEvent",value:function(){return this.pierceClickEvent&&(new Date).getTime()-this.pierceClickEvent.time<200}},{key:"dispatchEvent",value:function(t){!t||"click"!==t.name&&"syncVideo"!==t.name||("click"===t.name&&(this.pierceClickEvent={time:(new Date).getTime(),data:t}),this.sendMessage(t))}},{key:"setPage",value:function(t,e,n){null==e&&(e=0),this.page=t,this.step=e,this.isReady&&this.sendMessage({name:"goto",page:t,step:e,fromId:n})}},{key:"setConfig",value:function(t,e){this.width=t,this.height=e;var n=this.version,i=this.iframe,r=this.rawWidth,a=this.rawHeight;if(i){if(!n){var o=t/r,s=e/a,u=Math.min(o,s);t=Math.floor(r*u),e=Math.floor(a*u),g.default.ios||g.default.android||this.sendMessage({name:"setScale",scale:u})}return i.width=t+"",i.height=e+"",!0}this.load()}},{key:"destroy",value:function(){this.removeLoadTimer(),this.removeIframe(),delete t.instances[this.id],this.doc=this.options=this.pierceClickEvent=null}},{key:"getId",value:function(){return this.id}}]),t}();e.default=R,R.instances=[]},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=s(n(85)),h=s(n(160)),f=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=v(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(9)),d=s(n(161)),p=s(n(13));function v(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(v=function(t){return t?n:e})(t)}var g=function(){function t(e,n){(0,u.default)(this,t),this.doc=void 0,this.options=void 0,this.currentUrl=void 0,this.currentPage=void 0,this.pageChanged=void 0,this.stopPreloadTask=void 0,this.width=void 0,this.height=void 0,this.quality=void 0,this.options=n,this.doc=e,this.currentPage=-1}return(0,l.default)(t,[{key:"compress",value:function(t,e,n,i,r,a,o){return a>e?this.options.compressImage?(0,p.default)(this.options.compressImage,null,[t,e,n,i,r,!0,o]):(0,h.default)(t,e,n,i,r,!0,o):(0,c.default)(t)}},{key:"getUrls",value:function(t,e,n,i){var r=this,a=this.doc.pageList[t].url,o=this.doc.pageList[this.currentPage].width,s=[];return this.options.hostFallbacks&&f.each(this.options.hostFallbacks,(function(t){s.push(a.replace(/(https?:\/\/)[^\/]+(\/.+)/,"$1"+t+"$2"))})),this.options.ossOriginHost&&s.push(a.replace(/(https?:\/\/)[^\/]+(\/.+)/,"$1"+this.options.ossOriginHost+"$2")),{url:{url:a,url1x:this.compress(a,e,n,i,1,o,this.options.watermark),url2x:this.compress(a,e,n,i,2,o,this.options.watermark)},backups:s.map((function(t){return{url:t,url1x:r.compress(t,e,n,i,1,o,r.options.watermark),url2x:r.compress(t,e,n,i,2,o,r.options.watermark)}}))}}},{key:"setPage",value:function(t){this.pageChanged=this.currentPage!==t,this.currentPage=t}},{key:"setConfig",value:function(t,e,n){this.stopPreload();var i=this.getUrls(this.currentPage,t,e,n),r=i.url,a=i.backups,o=[r,t,e,this.pageChanged,this.doc.pageList[this.currentPage]];a.length&&o.push(a),this.currentUrl=r.url,(0,p.default)(this.options.insertTo,this,o),this.pageChanged=!1,this.width=t,this.height=e,this.quality=n,this.startPreload()}},{key:"startPreload",value:function(){var t;if(this.options.urlPreload){var e=this.currentPage,n=Math.floor(null!==(t=this.options.preloadCount)&&void 0!==t?t:5);this.currentPage>0&&(e=this.currentPage-n)<0&&(e=0);var i=this.currentPage+n;i>this.doc.pageList.length-1&&(i=this.doc.pageList.length-1);for(var r=this,a=[],o=e;o<=i;o++)o!==this.currentPage&&function(t){a.push((function(){var e=r.getUrls(t,r.width,r.height,r.quality),n=e.url,i=e.backups;(0,p.default)(r.options.urlPreload,r,[n,i])}))}(o);this.stopPreloadTask=(0,d.default)(a,2e3)}}},{key:"stopPreload",value:function(){this.stopPreloadTask&&(this.stopPreloadTask(),this.stopPreloadTask=null)}},{key:"getCurrentUrl",value:function(){return this.currentUrl}},{key:"updateDoc",value:function(t){this.doc=t}},{key:"destroy",value:function(){this.stopPreload(),this.options=null,this.doc=null}}]),t}();e.default=g},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=function(t){var e=t.url;if(!t.force&&!(0,u.default)(e))return e;var n=(e=(0,l.default)(e)).split(".").pop();"gif"===n&&(n="jpg");var i=Math.floor(100*(t.quality||1)),r=t.width,a=t.height;return r=Math.floor(r),a=Math.floor(a),c.mixin(function(t,e,n,i,r,a,o){var s=e||n,u=r?"m_lfit":"m_mfit",l="";o&&o.text&&(o=h.extend({text:"",position:"se",x:10,y:10,voffset:0,type:"wqy-zenhei",rotate:0,size:40,opacity:100,fill:0,color:"000000",shadow:0},o),l="/watermark,text_"+f.encodeURI(o.text)+",size_"+o.size+",t_"+o.opacity+",rotate_"+o.rotate+",fill_"+o.fill+",g_"+o.position+",x_"+o.x+",y_"+o.y+",voffset_"+o.voffset+",type_"+f.encodeURI(o.type)+",color_"+o.color+",shadow_"+o.shadow);return{"x-oss-process":"image/"+(s?"resize,limit_0,"+u+",":"")+(e?"w_"+e+(n?",":"/"):"")+(n?"h_"+n+"/":"")+"quality,q_"+i+"/format,"+(a?"webp":t.toLowerCase())+l}}(n,r,a,i,t.noCrop,t.hasWebp,t.watermark),!1,e)};var u=s(n(158)),l=s(n(85)),c=p(n(315)),h=p(n(10)),f=p(n(316));function d(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(d=function(t){return t?n:e})(t)}function p(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=d(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.parseQuery=p,e.stringifyQuery=function(t){var e=[];l.isPlainObject(t)&&h.each(t,(function(t,n){e.push(n+"="+encodeURIComponent(t))}));return e.join("&")},e.parse=v,e.mixin=function(t,e,n){null==n&&(n=document.URL);var i=v(n),r=p(e?i.hash:i.search);h.extend(r,t),r=h.param(r),n=i.origin+i.pathname,e?n+=i.search:r&&(n+="?"+r);e?r&&(n+="#"+r):n+=i.hash;return n};var u=s(n(136)),l=d(n(8)),c=d(n(9)),h=d(n(10));function f(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(f=function(t){return t?n:e})(t)}function d(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}function p(t){var e={};if(l.string(t)&&t.indexOf("=")>=0){var n=t.charAt(0),i="?"===n||"#"===n?1:0;i>0&&(t=t.substr(i)),c.each((0,u.default)(t,"&"),(function(t){var n=t.split("=");if(2===n.length){var i,r=null===(i=n[0])||void 0===i?void 0:i.trim();r&&(e[r]=decodeURIComponent(n[1]))}}))}return e}function v(t){for(var e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],n={},i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t),r=14;r--;){var a;n[e[r]]=null!==(a=i[r])&&void 0!==a?a:""}return{origin:"".concat(n.protocol,"://").concat(n.authority),pathname:n.path,search:"?".concat(n.query),hash:n.anchor?"#".concat(n.anchor):""}}},function(t,e,n){"use strict";n(0)(e,"__esModule",{value:!0}),e.encodeURI=function(t){return function(t){return btoa(function(t){return t.replace(r,a)}(t))}(String(t)).replace(/[+\/]/g,(function(t){return"+"===t?"-":"_"})).replace(/=/g,"")};var i=String.fromCharCode,r=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,a=function(t){if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?i(192|e>>>6)+i(128|63&e):i(224|e>>>12&15)+i(128|e>>>6&63)+i(128|63&e)}var n=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return i(240|n>>>18&7)+i(128|n>>>12&63)+i(128|n>>>6&63)+i(128|63&n)}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=s(n(162)),h=s(n(319)),f=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=p(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(9)),d=s(n(13));function p(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(p=function(t){return t?n:e})(t)}var v=function(){function t(e,n){(0,u.default)(this,t),this.doc=void 0,this.options=void 0,this.currentImage=void 0,this.imagePreloader=void 0,this.options=n,this.doc=e;var i=this;this.imagePreloader=new h.default(this.doc,{watermark:this.options.watermark,preloadCount:this.options.preloadCount,maxCacheCount:this.options.maxCacheCount,hostFallbacks:this.options.hostFallbacks,ossOriginHost:this.options.ossOriginHost,compressImage:this.options.compressImage,onLoading:function(t){var e;null!==(e=i.options)&&void 0!==e&&e.isCurrentPage(t.docId,t.page)&&i.options.onLoading&&(0,d.default)(i.options.onLoading,i,[t])},onAbort:function(t){var e;null!==(e=i.options)&&void 0!==e&&e.isCurrentPage(t.docId,t.page)&&i.options.onAbort&&(0,d.default)(i.options.onAbort,i,[t])},onComplete:function(t){var e;null!==(e=i.options)&&void 0!==e&&e.isCurrentPage(t.docId,t.page)&&i.options.onComplete&&(0,d.default)(i.options.onComplete,i,[t])},onSuccess:function(t){var e;if(null!==(e=i.options)&&void 0!==e&&e.isCurrentPage(t.docId,t.page)){t.element.style.width=this.width+"px",t.element.style.height=this.height+"px";var n=!i.currentImage||i.currentImage.page!==t.page,r=i.currentImage,a=r===t;i.options.onSuccess&&(0,d.default)(i.options.onSuccess,i,[t,a]),r&&r.remove(),(0,d.default)(i.options.insertTo,i,[t,n]),i.currentImage=t}},onFailure:function(t){var e,n;null!==(e=i.options)&&void 0!==e&&e.isCurrentPage(t.docId,t.page)&&setTimeout((function(){i.imagePreloader.load()}),1e3),null!==(n=i.options)&&void 0!==n&&n.onFailure&&(0,d.default)(i.options.onFailure,i,[t])},onTimeout:function(t){var e,n;null!==(e=i.options)&&void 0!==e&&e.isCurrentPage(t.docId,t.page)&&i.imagePreloader.load(),null!==(n=i.options)&&void 0!==n&&n.onTimeout&&(0,d.default)(i.options.onTimeout,i,[t])}}),t.instances[this.doc.id]=this}return(0,l.default)(t,[{key:"setPage",value:function(t){this.imagePreloader.setPage(t)}},{key:"setConfig",value:function(t,e,n){this.imagePreloader.setConfig(t,e,n)}},{key:"removeCurrentImage",value:function(){this.currentImage&&this.currentImage.remove()}},{key:"hasCache",value:function(t){var e=this.imagePreloader.getCache(t);return!((null==e?void 0:e.getStatus())!==c.default.STATUS_SUCCESS)}},{key:"getCurrentImage",value:function(){return this.currentImage}},{key:"updateDoc",value:function(t){this.doc=t,this.imagePreloader&&this.imagePreloader.updateDoc(t)}},{key:"destroy",value:function(){delete t.instances[this.doc.id],this.options=null,this.doc=null,this.imagePreloader.destroy(),this.imagePreloader=null,this.currentImage=null}}],[{key:"clearAll",value:function(){f.each(t.instances,(function(t){t.destroy()})),t.instances=[]}}]),t}();e.default=v,v.instances=[]},function(t,e,n){"use strict";var i=n(0),r=n(1);i(e,"__esModule",{value:!0}),e.default=function(){return l.apply(this,arguments)};var a,o=r(n(14)),s=r(n(17)),u=r(n(15));function l(){return(l=(0,u.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==a){t.next=3;break}return t.abrupt("return",s.default.resolve(a));case 3:return t.abrupt("return",new s.default((function(t,e){var n=new Image;n.onload=n.onerror=function(){2===n.height?t(a=!0):t(a=!1)}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(26)),l=s(n(5)),c=s(n(6)),h=s(n(162)),f=s(n(85)),d=s(n(160)),p=s(n(161)),v=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=_(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}r.default=t,n&&n.set(t,r);return r}(n(10)),g=s(n(13)),E=s(n(81));function _(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(_=function(t){return t?n:e})(t)}var y=function(){function t(e,n){var i,r;(0,l.default)(this,t),this.doc=void 0,this.options=void 0,this.cachedImages=void 0,this.cachedPages=void 0,this.imageDefaultOptions=void 0,this.page=void 0,this.fromPage=void 0,this.toPage=void 0,this.loadTimer=void 0,this.lazyLoadTimer=void 0,this.width=void 0,this.height=void 0,this.quality=void 0,this.isDisposed=void 0,this.doc=e,this.options=n,this.isDisposed=!1;var a=this;this.imageDefaultOptions={hostFallbacks:null!==(i=this.options.hostFallbacks)&&void 0!==i?i:[],class:"brtm-ppt-image",compress:function(t,e,n,i,r,o,s){return this.rawWidth>e?a.options.compressImage?(0,g.default)(a.options.compressImage,null,[t,e,n,i,r,o,s]):(0,d.default)(t,e,n,i,r,o,s):(0,f.default)(t)},onLoading:function(){a.callHook("onLoading",this)},onSuccess:function(){this.page===a.page&&a.startLazyLoad(),a.callHook("onSuccess",this),a.callHook("onComplete",this)},onFailure:function(){a.callHook("onFailure",this),a.callHook("onComplete",this)},onTimeout:function(){a.callHook("onTimeout",this),a.callHook("onComplete",this)},onAbort:function(){a.callHook("onAbort",this),a.callHook("onComplete",this)},onSame:function(){var t=this;a.callHook("onLoading",t),(0,E.default)((function(){a.callHook("onSuccess",t),a.callHook("onComplete",t),t.page===a.page&&a.startLazyLoad()}))},quality:null!==(r=this.quality)&&void 0!==r?r:1},this.cachedImages=new u.default,this.cachedPages=[]}return(0,c.default)(t,[{key:"callHook",value:function(t,e){this.options[t]&&(0,g.default)(this.options[t],this,[e])}},{key:"load",value:function(){this.stopLoad(),this.stopLazyLoad(),null!=this.page&&this.startLoad()}},{key:"startLoad",value:function(){var t=this,e=this.cachedImages.get(this.page);e?this.loadTimer=setTimeout((function(){e.update(t.width,t.height,t.quality),t.loadTimer=null}),300):this.startLazyLoad()}},{key:"stopLoad",value:function(){this.loadTimer&&(clearTimeout(this.loadTimer),this.loadTimer=null)}},{key:"startLazyLoad",value:function(){var t=this;t.stopLazyLoad();for(var e=t.cachedImages,n=[],i=t.fromPage;i<=t.toPage;i++)i!==t.page&&function(e){n.push((function(){e&&e.update(t.width,t.height,t.quality)}))}(e.get(i));t.lazyLoadTimer=(0,p.default)(n,2e3)}},{key:"stopLazyLoad",value:function(){this.lazyLoadTimer&&(this.lazyLoadTimer(),this.lazyLoadTimer=null)}},{key:"setPage",value:function(t){var e,n=this.page;this.page=t;var i=this.doc.pageList,r=this.options.preloadCount,a=t,o=Math.floor(r/2);t>0&&(a=t-o)<0&&(a=0);var s=t+o;s>i.length-1&&(s=i.length-1),this.fromPage=a,this.toPage=s;for(var u,l,c=this.doc.id,f=this.cachedPages,d=this.cachedImages,p=this.options.ossOriginHost,g=a;g<=s;g++){var E,_;if(!d.get(g))u=i[g].url,p&&(l=u.replace(/(https?:\/\/)[^\/]+(\/.+)/,"$1"+p+"$2")),d.set(g,new h.default(v.extend({docId:c,page:g,pageId:null!==(E=i[g].pageId)&&void 0!==E?E:-1,url:u,source:l,rawWidth:i[g].width,rawHeight:i[g].height,width:this.width,height:this.height,quality:this.quality,watermark:this.options.watermark,hasWebp:!0,timeout:null!==(_=this.options.timeout)&&void 0!==_?_:5e3},this.imageDefaultOptions))),f.push(g)}var y=null!==(e=this.options.maxCacheCount)&&void 0!==e?e:this.options.preloadCount;f.length>y&&(f.sort((function(t,e){return t-e})),n>t?d.delete(f.pop()):d.delete(f.shift()))}},{key:"setConfig",value:function(t,e,n){this.width=t,this.height=e,this.quality=n,this.load()}},{key:"isDestroy",value:function(){return this.isDisposed}},{key:"getCache",value:function(t){return this.cachedImages.get(t)}},{key:"updateDoc",value:function(t){this.doc=t}},{key:"destroy",value:function(){this.isDisposed=!0,this.stopLoad(),this.stopLazyLoad(),this.cachedImages.clear(),this.cachedImages=null,this.cachedPages=null}}]),t}();e.default=y},function(t,e,n){"use strict";var i=n(2),r=n(4),a=n(0),o=n(3),s=n(1);a(e,"__esModule",{value:!0}),e.default=void 0;var u=s(n(5)),l=s(n(6)),c=s(n(135)),h=p(n(157)),f=p(n(9));function d(t){if("function"!=typeof r)return null;var e=new r,n=new r;return(d=function(t){return t?n:e})(t)}function p(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=d(e);if(n&&n.has(t))return n.get(t);var r={},s=a&&o;for(var u in t)if("default"!==u&&Object.prototype.hasOwnProperty.call(t,u)){var l=s?o(t,u):null;l&&(l.get||l.set)?a(r,u,l):r[u]=t[u]}return r.default=t,n&&n.set(t,r),r}var v=function(){function t(){var e=this;(0,u.default)(this,t),this.store=void 0,this.handler=void 0,this.store=new c.default({data:{options:{shapeType:h.DEFALUT_TOOL,fontSize:h.DEFALUT_FONT_SIZE,caretColor:h.DEFAULT_CARET_COLOR,dash:h.DEFAULT_DASH_ENABLE,bold:h.DEFAULT_BLOD_ENABLE,fontItalic:h.DEFAULT_FONT_ITALIC,fillColor:h.DEFALUT_FILL_COLOR,strokeColor:h.DEFALUT_STROKE_COLOR,isStroke:!0,isFill:!1,sides:h.DEFAULT_SIDE,lineWidth:h.DEFALUT_STROKE_WIDTH,hoverColor:h.DEFAULT_HOVER_COLOR,double:!1}}}),this.handler=[];var n=this.store.get("options");this.store.watch("options.**",(function(t,i,r){f.each(e.handler,(function(t){t(e.store.get("options"),n,r),n=e.store.get("options")}))}),!0)}return(0,l.default)(t,[{key:"setShapeType",value:function(t){this.store.set("options.shapeType",t),t===h.DOODLE&&this.store.set({isStroke:!0,isFill:!1})}},{key:"setFill",value:function(t){this.store.set("options.isFill",t)}},{key:"setStroke",value:function(t){this.store.set("options.isStroke",t)}},{key:"setDouble",value:function(t){this.store.set("options.double",t)}},{key:"setFontSize",value:function(t){this.store.set("options.fontSize",t)}},{key:"setCaretColor",value:function(t){this.store.set("options.caretColor",t)}},{key:"enableDash",value:function(t){this.store.set("options.dash",t)}},{key:"enableBold",value:function(t){this.store.set("options.bold",t)}},{key:"enableFontItalic",value:function(t){this.store.set("options.fontItalic",t)}},{key:"setFillColor",value:function(t){this.store.set("options.fillColor",t)}},{key:"setStrokeColor",value:function(t){this.store.set("options.strokeColor",t)}},{key:"setSides",value:function(t){this.store.set("options.sides",t)}},{key:"setLineWidth",value:function(t){this.store.set("options.lineWidth",t)}},{key:"setHoverColor",value:function(t){this.store.set("options.hoverColor",t)}},{key:"watch",value:function(t){this.handler.push(t),t(this.store.get("options"),null,"")}},{key:"unwatch",value:function(t){var e=this;f.each(this.handler,(function(n,i){if(t===n)return e.handler.splice(i,1),!1}))}},{key:"options",get:function(){return this.store.get("options")}},{key:"tools",get:function(){return h.TOOLS}},{key:"destroy",value:function(){this.handler=null,this.store.destroy()}}]),t}();e.default=v}])}));