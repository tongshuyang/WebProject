(function(e){function t(t){for(var s,a,o=t[0],c=t[1],l=t[2],d=0,m=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&m.push(i[a][0]),i[a]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(m.length)m.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],s=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(s=!1)}s&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var s={},i={app:0},r=[];function a(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=s,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0498":function(e,t,n){},"05a8":function(e,t,n){"use strict";n("0eb3")},"0a68":function(e,t,n){"use strict";n("f830")},"0eb3":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("139e"),n("fae9"),n("3ff7"),n("d6dc");var s,i=n("a593"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.loaded?e._e():n("Loading"),e.loaded?n("div",{attrs:{id:"main"}},[n("Player",{ref:"player"}),n("div",{staticClass:"header"},[n("Presenter",{staticClass:"presenter"}),n("ExitLive")],1),n("div",{staticClass:"message-wrapper",attrs:{"data-show-sender":e.showMessageSender}},[n("Message-List",{on:{"toggle-show-sender":e.toggleShowSender}})],1),n("CustomShop",{staticClass:"shopping-wrapper"})],1):e._e()],1)},a=[],o=(n("72b3"),n("c726"),n("a543"),n("d0bf"),n("0bd5"),n("b784"),n("5a4c"),n("79a8"),n("270f"),function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)}),c=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"loading"}},[n("div",{staticClass:"placeholder"})])}],l={components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){var e=BJY.Loading.create({element:$("#loading .placeholder"),logoUrl:"http://img.baijiayun.com/0baijiacloud/logo/ydzb/v5/www-loading.png"}),t=BJY.eventEmitter;t.one(t.LOADING_PANEL_START,(function(e,t){})).one(t.LOADING_PANEL_END,(function(t,n){e.destroy()})).one(t.VIEW_RENDER_TRIGGER,(function(e,t){}))},beforeDestroy:function(){}},u=l,d=(n("0a68"),n("5d22")),m=Object(d["a"])(u,o,c,!1,null,"5edd41c7",null),p=m.exports,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"h5-player"}},[!e.started||e.tip?n("div",{staticClass:"tip"},[n("i",{staticClass:"sprite-icon wait"}),n("div",[e._v(" "+e._s(e.tip)+" ")])]):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.started&&!e.isPlaying&&!e.tip,expression:"started && !isPlaying && !tip"}],attrs:{id:"btn-wrap"}},[n("i",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"sprite-icon icon-live",on:{click:function(t){return e.togglePlay(!0)}}}),n("i",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],staticClass:"sprite-icon icon-loading",on:{click:function(t){return e.togglePlay(!0)}}})])])},h=[],v=(n("13cf"),BJY.eventEmitter),g=BJY.store,_=BJY.data.user,w=BJY.data.class,b=(BJY.auth,BJY.loggerManager.create({prefix:"demo player"})),y=BJY.Player,C="进入直播间",E="正在进入直播间…";function S(){return _.find(g.get("presenterId"))}function O(){b("createPlayer"),window.player=s=new y({element:$("#h5-player"),user:S(),extension:y.html})}var P={components:{},data:function(){return{tip:"",started:!1,isPlaying:!1,isLoading:!1,eventList:[],user:S()}},computed:{btnText:function(){return this.isLoading?E:C}},watch:{},methods:{togglePlay:function(){(s.videoOn||s.audioOn)&&s.playAVClose(),s.playAV(g.get("teacher.videoOn")),this.isLoading=!0},replay:function(){s&&s.replay()},checkStatus:function(){b("checkStatus");var e=S();this.started=g.get("class.started"),this.started||(w.isEndTimeReached()?this.tip="直播已结束":this.tip="主播不在，请稍后"),e&&e.videoOn?this.tip="":(e||(this.isPlaying=!1,this.tip="主播不在，请稍后"),e&&!e.videoOn&&(this.isPlaying=!1,this.tip="主播未开摄像头"))}},created:function(){var e=this;this.started=g.get("class.started")&&e.user,y.html.init(),v.on(v.TEACHER_MEDIA_ON,(function(){b("主播媒体开启"),s||O(),e.togglePlay(),e.tip="",e.started=!0})).on(v.TEACHER_MEDIA_OFF,(function(){b("主播已关摄像头"),e.tip="主播已关摄像头",e.started=!1,e.checkStatus(),e.isPlaying=!1})).on(v.TEACHER_ADD,(function(){b("主播进入教室"),e.checkStatus()})).on(v.TEACHER_REMOVE,(function(){b("主播离开"),e.tip="主播离开",e.started=!1,e.checkStatus(),s&&(s.dispose(),s=null),e.isPlaying=!1})).on(v.HTML_VIDEO_PLAY,(function(){b("视频开始播放"),e.tip="",e.checkStatus();var t=setInterval((function(){var n=$("video",$("#h5-player"))[0];n||clearInterval(t);var s=n.paused;e.isPlaying=!s,e.isLoading&&(e.isLoading=s||!n.currentTime),!s&&n.currentTime&&clearInterval(t)}),200)})).on(v.PRESENTER_CHANGE,(function(t,n){n.id!==e.user.id&&(e.user=n,O(),e.togglePlay())})).on(v.USER_UPDATE,(function(t,n){b("USER_UPDATE",n),n.id==e.user.id&&(e.user=n),e.checkStatus()})).on(v.HTML_VIDEO_LOAD_START,(function(){})).on(v.HTML_VIDEO_PAUSE,(function(){e.isPlaying=!1})).on(v.HTML_VIDEO_LOAD_TIMEOUT,(function(){})).on(v.HTML_VIDEO_LOAD_FAIL,(function(){e.isPlaying=!1,e.isPlayError=!0})).on(v.CLASS_END,(function(){e.checkStatus(),e.isPlaying=!1}))},mounted:function(){$("#btn-wrap"),this.started?O():this.tip="主播不在，请稍后"},beforeDestroy:function(){}},I=P,L=(n("74c9"),Object(d["a"])(I,f,h,!1,null,null,null)),j=L.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.userName,expression:"userName"}],staticClass:"bjy-presenter"},[e.userAvatar?n("img",{staticClass:"bjy-presenter-avatar",attrs:{src:e.userAvatar}}):e._e(),n("div",{staticClass:"content"},[n("span",{staticClass:"user-name"},[e._v(e._s(e.userName))]),n("span",{staticClass:"user-count-wrapper"},[n("span",{staticClass:"user-count"},[e._v(e._s(e.userCount))]),e._v(" 人观看 ")])])])},x=[],N=(n("1d7a"),BJY.eventEmitter),A=BJY.data.user,R=BJY.store,Y="主播",k="https://test-img.baijiayun.com/0bjcloud/live/avatar/v2/teacherv3.png?x-oss-process=image%2Fresize%2Climit_0%2Cm_mfit%2Cw_36%2Ch_36%2Fquality%2Cq_100%2Fformat%2Cpng";function D(){return A.find(R.get("presenterId"))}var J={data:function(){var e=D()||{};return{userAvatar:e.avatar||k,userName:e.name||Y,userCount:1,namespace:"_presenter"+Math.random()}},mounted:function(){var e=this;N.on(N.USER_COUNT_CHANGE,(function(t,n){var s=R.get("teacher"),i=n.userCount;s&&i&&i--,e.userCount!==i&&(e.userCount=i)})),R.watch("presenterId",(function(){var e=D()||{};this.userAvatar=e.avatar||k,this.userName=e.name||Y}))}},B=J,M=(n("da28"),Object(d["a"])(B,T,x,!1,null,"64939c98",null)),H=M.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bjy-live-close"},[n("i",{staticClass:"sprite-icon close",on:{click:e.exitRoom}})])},G=[],V={methods:{exitRoom:function(){this.$Confirm.show("确定要退出直播间吗？").then((function(){history&&history.length>1?history.go(-1):window.close()}))}}},F=V,q=(n("df18"),Object(d["a"])(F,U,G,!1,null,null,null)),z=q.exports,W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"message-panel"}},[n("div",{staticClass:"message-list"}),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.showSender,expression:"!showSender"}],staticClass:"message-sender-holder",on:{click:e.displaySender}},[n("i",{staticClass:"sprite-icon icon-sender"}),n("span",[e._v("说点什么吧~")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showSender,expression:"showSender"}],staticClass:"message-sender"})])},K=[],Q={},X=BJY.config;Q[X.ROLE_TYPE_TEACHER]={en:"teacher",cn:"主播"},Q[X.ROLE_TYPE_ASSISTANT]={en:"assistant",cn:"管理"},Q[X.ROLE_TYPE_STUDENT]={en:"student",cn:"观众"},Q[X.ROLE_TYPE_GUEST]={en:"guest",cn:"观众"};var Z=Q,ee=(BJY.eventEmitter,{components:{},data:function(){return{showSender:!1,input:null}},computed:{},watch:{},methods:{displaySender:function(){var e=this;this.showSender=!0,this.$emit("toggle-show-sender",{showSender:this.showSender}),setTimeout((function(){return e.input&&e.input.focus()}))}},mounted:function(){var e=this;BJY.MessageList.create({element:$("#message-panel .message-list"),replace:!1,skin:"simple",newMessageHint:"条新消息",renderEmoji:function(e,t){return BJY.isAlicloudImage(t)?'<img ondragstart="return false" src="'+t+'@100w_1e_1l.png" srcset="'+t+'@200w_1e_1l.png 2x">':'<img ondragstart="return false" src="'+t+'">'},renderImage:function(e){return BJY.isAlicloudImage(e)?'<img ondragstart="return false" src="'+e+'@100w_1e_1l.png" srcset="'+e+'@200w_1e_1l.png 2x">':'<img ondragstart="return false" src="'+e+'">'},renderUser:function(e,t,n){return{id:e.id,name:e.name,number:e.number,avatar:BJY.compressImage({url:e.avatar,width:t,height:n}),avatar2x:BJY.compressImage({url:e.avatar,width:2*t,height:2*n}),role:Z[e.type].en,localRole:Z[e.type].cn}},loadDistance:0});var t=BJY.MessageSender.create({element:$("#message-panel .message-sender"),replace:!1,canSendEmoji:!1,multiline:!0,messageMaxLength:140,placeholder:""});setTimeout((function(){var n=t&&t.$refs&&t.$refs.bjyInput,s=n&&n.$refs&&n.$refs.input;e.input=s&&$(s),s&&$(s).on("blur",(function(){setTimeout((function(){e.showSender=!1,e.$emit("toggle-show-sender",{showSender:e.showSender})}),1e3)}))}),2e3)},beforeDestroy:function(){}}),te=ee,ne=(n("05a8"),Object(d["a"])(te,W,K,!1,null,null,null)),se=ne.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"custom-shop"},[n("i",{staticClass:"sprite-icon shopping",on:{click:e.showList}}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.recommendItem&&e.recommendItem.img,expression:"recommendItem && recommendItem.img"}],staticClass:"recommend-item"},[n("i",{staticClass:"sprite-icon small-close",on:{click:e.hideRecommend}}),n("img",{staticClass:"brand",attrs:{src:e.recommendItem&&e.recommendItem.img},on:{click:function(t){return e.buy(e.recommendItem)}}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],staticClass:"list"},[n("div",{staticClass:"list-head"},[n("span",[e._v("共"+e._s(e.list&&e.list.length)+"件商品")]),n("i",{staticClass:"sprite-icon small-close",on:{click:e.hideList}})]),n("div",{staticClass:"list-content"},e._l(e.list,(function(t,s){return n("div",{key:t.itemId,staticClass:"item"},[n("div",{staticClass:"item-img-wrap"},[n("span",{staticClass:"seq"},[e._v(e._s(s+1))]),n("img",{staticClass:"item-img",attrs:{src:t.img}})]),n("div",{staticClass:"item-content"},[n("p",{staticClass:"item-desc"},[e._v(e._s(t.desc))]),n("div",{staticClass:"item-price-wrapper"},[n("span",{staticClass:"price"},[n("span",{staticClass:"price-prefix"},[e._v("￥")]),e._v(e._s(t.price)+" ")]),n("span",{staticClass:"origin-price"},[n("span",{staticClass:"price-prefix"},[e._v("￥")]),e._v(e._s(t.originalPrice)+" ")]),n("span",{staticClass:"button-buy",on:{click:function(n){return e.buy(t)}}},[e._v("去购买")])])])])})),0)])])},re=[],ae=(n("989e"),{data:function(){return{isShowList:!1,recommendItem:{},list:[]}},methods:{showList:function(){this.isShowList=!0},hideList:function(){this.isShowList=!1},hideRecommend:function(){this.recommendItem={}},removeItem:function(e){for(var t,n=0,s=this.list.length;n<s;n++)if(t=this.list[n],t.itemId===e.itemId)break;t&&this.list.splice(n,1)},buy:function(e){e&&e.url&&window.open(e&&e.url)}},mounted:function(){var e=this;BJY.api.getCachedBroadcast("bjy_product_shelf_change"),BJY.api.onReceiveBroadcast("customProduct",(function(t,n,s){if(console.log(n),n&&"string"===typeof n&&(n=JSON.parse(n)),n){var i=e.list.find((function(e){return e.itemId===n.itemId}));n.isOnShelf?e.list.push({itemId:n.itemId,desc:n.name,price:499.99,originalPrice:99999,img:"https://test-img.baijiayun.com/baijiacloud/1237788_o92r2znp.png",url:"https://www.baijiayun.com/"}):i&&e.removeItem(i),e.recommendItem={img:e.list[0]&&e.list[0].img,url:e.list[0]&&e.list[0].url}}}))}}),oe=ae,ce=(n("e74a"),Object(d["a"])(oe,ie,re,!1,null,"7d7f7bb8",null)),le=ce.exports,ue=BJY.eventEmitter;BJY.logger.enable();var de={data:function(){return{loaded:!1,showMessageSender:!1}},methods:{toggleShowSender:function(e){this.showMessageSender=e&&e.showSender},urlParser:function(e){var t={};if(e)try{var n=e.split("?")[1],s=n.split("&");s.forEach((function(e){var n=e.split("=");t[n[0]]=n[1]})),t.prefixName=e.split(".")[0].split("//")[1],t.env=t.env||this.getEnv(e)}catch(i){console.log(i)}return t},getEnv:function(e){if(!~e.indexOf("."))return"test";var t=e.match(/\/\/(.*)\./)[1];return/test/.test(t)||/localhost/.test(t)||/\d{1,3}\.\d{1,3}\.\d{1,3}/.test(t)?"test":/beta/.test(t)?"beta":(/www/.test(t),"")}},components:{Loading:p,Player:j,Presenter:H,ExitLive:z,MessageList:se,CustomShop:le},created:function(){var e=this;console.log("******************************************************************************"),console.log("*   欢迎使用 BJY JS SDK - 百家云直播 - "+BJY.version),console.log("*   API 文档：https://www.baijiayun.com/js-sdk/doc/#/README"),console.log("*   版本更新日志：https://www.baijiayun.com/js-sdk/doc/#/change-log"),console.log("*   常见问题：https://www.baijiayun.com/js-sdk/doc/#/live?id=%e5%b8%b8%e8%a7%81%e9%97%ae%e9%a2%98"),console.log("*   注意事项：H5 Demo 需要在真机上预览，PC上不支持m3u8流类型， 自己创建教室测试时，注意非webrtc类型教室传入webrtc: 0"),console.log("*   sign签名规则：https://dev.baijiayun.com/wiki/detail/1"),console.log("******************************************************************************");var t={prefixName:"e70655665",env:"production",room_id:"20121171444643",user_number:"10086",user_avatar:"https://img.baijiayun.com/0bjcloud/live/avatar/v2/103.jpg",user_name:"audience",user_role:0,sign:"3cd26d2d9c8811820070be455462d407",webrtc:1};if(~location.href.indexOf("?")&&(t=Object.assign(t,this.urlParser(location.href)),t.prefixName=""),location.href.includes("debug=1")){var n=prompt("输入传送门链接进入教室,webrtc课程请在链接后加上&webrtc=1");t=Object.assign(t,this.urlParser(n))}console.log(t);var s={id:t.room_id};Number(t.webrtc)&&(s.webrtcType=Number(t.webrtc)),BJY.init({env:t.env,privateDomainPrefix:t.prefixName,class:s,user:{number:t.user_number,avatar:decodeURIComponent(t.user_avatar),name:decodeURIComponent(t.user_name),type:Number(t.user_role)},teacher:{type:1},sign:t.sign}),ue.on(ue.CLASSROOM_CONNECT_TRIGGER,(function(e,t){})).on(ue.VIEW_RENDER_TRIGGER,(function(t,n){e.loaded=!0})).one(ue.LOADING_PANEL_END,(function(e,t){$("#main").css({top:0,bottom:0})})).on(ue.LOGIN_CONFLICT,(function(){alert("你已被踢，请确保user_number唯一")}))}},me=de,pe=(n("5c0b"),Object(d["a"])(me,r,a,!1,null,null,null)),fe=pe.exports,he=(n("ae17"),n("402f"),n("3e83")),ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"fade"}},[e.visible?n("div",{staticClass:"confirm-wrap",on:{click:function(t){return e.cancel()}}},[n("div",{staticClass:"confirm",on:{click:function(e){e.stopPropagation()}}},[e.title?n("h3",{staticClass:"title"},[e._v(e._s(e.title))]):e._e(),n("p",{staticClass:"content"},[e._v(e._s(e.content))]),n("p",{staticClass:"btn-wrap"},[n("button",{staticClass:"btn cancel-btn",on:{click:function(t){return e.cancel()}}},[e._v(" "+e._s(e.cancelText)+" ")]),n("button",{staticClass:"btn confirm-btn",on:{click:function(t){return e.confirm()}}},[e._v(" "+e._s(e.confirmText)+" ")])])])]):e._e()])},ge=[],_e={name:"confirm",props:{title:{type:String,default:"提示"},content:{type:String,default:"确定要执行该操作吗？"},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确定"}},data:function(){return{visible:!1,resolve:"",reject:"",promise:""}},methods:{confirm:function(){this.visible=!1,this.resolve("confirm"),this.remove()},cancel:function(){this.visible=!1,this.reject("cancel"),this.remove()},show:function(){var e=this;return this.visible=!0,this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),this.promise},remove:function(){var e=this;setTimeout((function(){e.$destroy(),document.body.removeChild(e.$el)}),100)}}},we=_e,be=(n("b7a7"),Object(d["a"])(we,ve,ge,!1,null,"5a145ef6",null)),ye=be.exports,Ce={install:function(e,t){var n,s=e.extend(ye),i=function(){n=new s;var e=n.$mount().$el;document.body.appendChild(e)};e.prototype.$Confirm={show:function(e){return n||i(),"string"===typeof e?n.content=e:"object"===Object(he["a"])(e)&&Object.assign(n,e),n.show().then((function(e){return n=null,Promise.resolve(e)})).catch((function(e){return n=null,Promise.reject(e)}))},hide:function(){if(n)return n.cancel()}}}},Ee=Ce;i["a"].use(Ee),i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(fe)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";n("ac27")},"74c9":function(e,t,n){"use strict";n("0498")},a8a5:function(e,t,n){},ac27:function(e,t,n){},ae17:function(e,t,n){},b7a7:function(e,t,n){"use strict";n("beac")},beac:function(e,t,n){},bf83:function(e,t,n){},d1ec:function(e,t,n){},da28:function(e,t,n){"use strict";n("a8a5")},df18:function(e,t,n){"use strict";n("d1ec")},e74a:function(e,t,n){"use strict";n("bf83")},f830:function(e,t,n){}});
//# sourceMappingURL=app.07c06a90.js.map